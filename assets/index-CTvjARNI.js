var PE=Object.defineProperty;var RE=(t,e,n)=>e in t?PE(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var M=(t,e,n)=>RE(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var IE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tp(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Sy={exports:{}},Qu={},Cy={exports:{}},dt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nA=Symbol.for("react.element"),ME=Symbol.for("react.portal"),NE=Symbol.for("react.fragment"),OE=Symbol.for("react.strict_mode"),DE=Symbol.for("react.profiler"),BE=Symbol.for("react.provider"),FE=Symbol.for("react.context"),LE=Symbol.for("react.forward_ref"),UE=Symbol.for("react.suspense"),zE=Symbol.for("react.memo"),VE=Symbol.for("react.lazy"),xm=Symbol.iterator;function jE(t){return t===null||typeof t!="object"?null:(t=xm&&t[xm]||t["@@iterator"],typeof t=="function"?t:null)}var ky={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Py=Object.assign,Ry={};function xa(t,e,n){this.props=t,this.context=e,this.refs=Ry,this.updater=n||ky}xa.prototype.isReactComponent={};xa.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};xa.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Iy(){}Iy.prototype=xa.prototype;function np(t,e,n){this.props=t,this.context=e,this.refs=Ry,this.updater=n||ky}var rp=np.prototype=new Iy;rp.constructor=np;Py(rp,xa.prototype);rp.isPureReactComponent=!0;var Tm=Array.isArray,My=Object.prototype.hasOwnProperty,ip={current:null},Ny={key:!0,ref:!0,__self:!0,__source:!0};function Oy(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)My.call(e,r)&&!Ny.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var f=Array(a),p=0;p<a;p++)f[p]=arguments[p+2];i.children=f}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:nA,type:t,key:s,ref:o,props:i,_owner:ip.current}}function WE(t,e){return{$$typeof:nA,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function sp(t){return typeof t=="object"&&t!==null&&t.$$typeof===nA}function $E(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Em=/\/+/g;function Gf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?$E(""+t.key):e.toString(36)}function ac(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case nA:case ME:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Gf(o,0):r,Tm(i)?(n="",t!=null&&(n=t.replace(Em,"$&/")+"/"),ac(i,e,n,"",function(p){return p})):i!=null&&(sp(i)&&(i=WE(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Em,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Tm(t))for(var a=0;a<t.length;a++){s=t[a];var f=r+Gf(s,a);o+=ac(s,e,n,f,i)}else if(f=jE(t),typeof f=="function")for(t=f.call(t),a=0;!(s=t.next()).done;)s=s.value,f=r+Gf(s,a++),o+=ac(s,e,n,f,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function TA(t,e,n){if(t==null)return t;var r=[],i=0;return ac(t,r,"","",function(s){return e.call(n,s,i++)}),r}function HE(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ir={current:null},lc={transition:null},XE={ReactCurrentDispatcher:ir,ReactCurrentBatchConfig:lc,ReactCurrentOwner:ip};function Dy(){throw Error("act(...) is not supported in production builds of React.")}dt.Children={map:TA,forEach:function(t,e,n){TA(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return TA(t,function(){e++}),e},toArray:function(t){return TA(t,function(e){return e})||[]},only:function(t){if(!sp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};dt.Component=xa;dt.Fragment=NE;dt.Profiler=DE;dt.PureComponent=np;dt.StrictMode=OE;dt.Suspense=UE;dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XE;dt.act=Dy;dt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Py({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=ip.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(f in e)My.call(e,f)&&!Ny.hasOwnProperty(f)&&(r[f]=e[f]===void 0&&a!==void 0?a[f]:e[f])}var f=arguments.length-2;if(f===1)r.children=n;else if(1<f){a=Array(f);for(var p=0;p<f;p++)a[p]=arguments[p+2];r.children=a}return{$$typeof:nA,type:t.type,key:i,ref:s,props:r,_owner:o}};dt.createContext=function(t){return t={$$typeof:FE,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:BE,_context:t},t.Consumer=t};dt.createElement=Oy;dt.createFactory=function(t){var e=Oy.bind(null,t);return e.type=t,e};dt.createRef=function(){return{current:null}};dt.forwardRef=function(t){return{$$typeof:LE,render:t}};dt.isValidElement=sp;dt.lazy=function(t){return{$$typeof:VE,_payload:{_status:-1,_result:t},_init:HE}};dt.memo=function(t,e){return{$$typeof:zE,type:t,compare:e===void 0?null:e}};dt.startTransition=function(t){var e=lc.transition;lc.transition={};try{t()}finally{lc.transition=e}};dt.unstable_act=Dy;dt.useCallback=function(t,e){return ir.current.useCallback(t,e)};dt.useContext=function(t){return ir.current.useContext(t)};dt.useDebugValue=function(){};dt.useDeferredValue=function(t){return ir.current.useDeferredValue(t)};dt.useEffect=function(t,e){return ir.current.useEffect(t,e)};dt.useId=function(){return ir.current.useId()};dt.useImperativeHandle=function(t,e,n){return ir.current.useImperativeHandle(t,e,n)};dt.useInsertionEffect=function(t,e){return ir.current.useInsertionEffect(t,e)};dt.useLayoutEffect=function(t,e){return ir.current.useLayoutEffect(t,e)};dt.useMemo=function(t,e){return ir.current.useMemo(t,e)};dt.useReducer=function(t,e,n){return ir.current.useReducer(t,e,n)};dt.useRef=function(t){return ir.current.useRef(t)};dt.useState=function(t){return ir.current.useState(t)};dt.useSyncExternalStore=function(t,e,n){return ir.current.useSyncExternalStore(t,e,n)};dt.useTransition=function(){return ir.current.useTransition()};dt.version="18.3.1";Cy.exports=dt;var pe=Cy.exports;const Sm=tp(pe);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QE=pe,YE=Symbol.for("react.element"),KE=Symbol.for("react.fragment"),qE=Object.prototype.hasOwnProperty,ZE=QE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,GE={key:!0,ref:!0,__self:!0,__source:!0};function By(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)qE.call(e,r)&&!GE.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:YE,type:t,key:s,ref:o,props:i,_owner:ZE.current}}Qu.Fragment=KE;Qu.jsx=By;Qu.jsxs=By;Sy.exports=Qu;var V=Sy.exports,Fy={exports:{}},wr={},Ly={exports:{}},Uy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(me,ye){var De=me.length;me.push(ye);e:for(;0<De;){var Me=De-1>>>1,Oe=me[Me];if(0<i(Oe,ye))me[Me]=ye,me[De]=Oe,De=Me;else break e}}function n(me){return me.length===0?null:me[0]}function r(me){if(me.length===0)return null;var ye=me[0],De=me.pop();if(De!==ye){me[0]=De;e:for(var Me=0,Oe=me.length,Le=Oe>>>1;Me<Le;){var xt=2*(Me+1)-1,Rt=me[xt],Ct=xt+1,sn=me[Ct];if(0>i(Rt,De))Ct<Oe&&0>i(sn,Rt)?(me[Me]=sn,me[Ct]=De,Me=Ct):(me[Me]=Rt,me[xt]=De,Me=xt);else if(Ct<Oe&&0>i(sn,De))me[Me]=sn,me[Ct]=De,Me=Ct;else break e}}return ye}function i(me,ye){var De=me.sortIndex-ye.sortIndex;return De!==0?De:me.id-ye.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var f=[],p=[],m=1,v=null,w=3,T=!1,E=!1,N=!1,j=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(me){for(var ye=n(p);ye!==null;){if(ye.callback===null)r(p);else if(ye.startTime<=me)r(p),ye.sortIndex=ye.expirationTime,e(f,ye);else break;ye=n(p)}}function B(me){if(N=!1,k(me),!E)if(n(f)!==null)E=!0,je(Y);else{var ye=n(p);ye!==null&&ze(B,ye.startTime-me)}}function Y(me,ye){E=!1,N&&(N=!1,I(U),U=-1),T=!0;var De=w;try{for(k(ye),v=n(f);v!==null&&(!(v.expirationTime>ye)||me&&!ue());){var Me=v.callback;if(typeof Me=="function"){v.callback=null,w=v.priorityLevel;var Oe=Me(v.expirationTime<=ye);ye=t.unstable_now(),typeof Oe=="function"?v.callback=Oe:v===n(f)&&r(f),k(ye)}else r(f);v=n(f)}if(v!==null)var Le=!0;else{var xt=n(p);xt!==null&&ze(B,xt.startTime-ye),Le=!1}return Le}finally{v=null,w=De,T=!1}}var G=!1,ce=null,U=-1,$=5,K=-1;function ue(){return!(t.unstable_now()-K<$)}function ge(){if(ce!==null){var me=t.unstable_now();K=me;var ye=!0;try{ye=ce(!0,me)}finally{ye?le():(G=!1,ce=null)}}else G=!1}var le;if(typeof R=="function")le=function(){R(ge)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,Ue=he.port2;he.port1.onmessage=ge,le=function(){Ue.postMessage(null)}}else le=function(){j(ge,0)};function je(me){ce=me,G||(G=!0,le())}function ze(me,ye){U=j(function(){me(t.unstable_now())},ye)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(me){me.callback=null},t.unstable_continueExecution=function(){E||T||(E=!0,je(Y))},t.unstable_forceFrameRate=function(me){0>me||125<me?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<me?Math.floor(1e3/me):5},t.unstable_getCurrentPriorityLevel=function(){return w},t.unstable_getFirstCallbackNode=function(){return n(f)},t.unstable_next=function(me){switch(w){case 1:case 2:case 3:var ye=3;break;default:ye=w}var De=w;w=ye;try{return me()}finally{w=De}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(me,ye){switch(me){case 1:case 2:case 3:case 4:case 5:break;default:me=3}var De=w;w=me;try{return ye()}finally{w=De}},t.unstable_scheduleCallback=function(me,ye,De){var Me=t.unstable_now();switch(typeof De=="object"&&De!==null?(De=De.delay,De=typeof De=="number"&&0<De?Me+De:Me):De=Me,me){case 1:var Oe=-1;break;case 2:Oe=250;break;case 5:Oe=1073741823;break;case 4:Oe=1e4;break;default:Oe=5e3}return Oe=De+Oe,me={id:m++,callback:ye,priorityLevel:me,startTime:De,expirationTime:Oe,sortIndex:-1},De>Me?(me.sortIndex=De,e(p,me),n(f)===null&&me===n(p)&&(N?(I(U),U=-1):N=!0,ze(B,De-Me))):(me.sortIndex=Oe,e(f,me),E||T||(E=!0,je(Y))),me},t.unstable_shouldYield=ue,t.unstable_wrapCallback=function(me){var ye=w;return function(){var De=w;w=ye;try{return me.apply(this,arguments)}finally{w=De}}}})(Uy);Ly.exports=Uy;var JE=Ly.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eS=pe,vr=JE;function be(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var zy=new Set,Rl={};function ro(t,e){ra(t,e),ra(t+"Capture",e)}function ra(t,e){for(Rl[t]=e,t=0;t<e.length;t++)zy.add(e[t])}var Ci=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fd=Object.prototype.hasOwnProperty,tS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Cm={},km={};function nS(t){return fd.call(km,t)?!0:fd.call(Cm,t)?!1:tS.test(t)?km[t]=!0:(Cm[t]=!0,!1)}function rS(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function iS(t,e,n,r){if(e===null||typeof e>"u"||rS(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function sr(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Bn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Bn[t]=new sr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Bn[e]=new sr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Bn[t]=new sr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Bn[t]=new sr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Bn[t]=new sr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Bn[t]=new sr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Bn[t]=new sr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Bn[t]=new sr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Bn[t]=new sr(t,5,!1,t.toLowerCase(),null,!1,!1)});var op=/[\-:]([a-z])/g;function ap(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(op,ap);Bn[e]=new sr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(op,ap);Bn[e]=new sr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(op,ap);Bn[e]=new sr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Bn[t]=new sr(t,1,!1,t.toLowerCase(),null,!1,!1)});Bn.xlinkHref=new sr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Bn[t]=new sr(t,1,!1,t.toLowerCase(),null,!0,!0)});function lp(t,e,n,r){var i=Bn.hasOwnProperty(e)?Bn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(iS(e,n,i,r)&&(n=null),r||i===null?nS(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Ni=eS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,EA=Symbol.for("react.element"),Co=Symbol.for("react.portal"),ko=Symbol.for("react.fragment"),Ap=Symbol.for("react.strict_mode"),hd=Symbol.for("react.profiler"),Vy=Symbol.for("react.provider"),jy=Symbol.for("react.context"),cp=Symbol.for("react.forward_ref"),dd=Symbol.for("react.suspense"),pd=Symbol.for("react.suspense_list"),up=Symbol.for("react.memo"),Hi=Symbol.for("react.lazy"),Wy=Symbol.for("react.offscreen"),Pm=Symbol.iterator;function Va(t){return t===null||typeof t!="object"?null:(t=Pm&&t[Pm]||t["@@iterator"],typeof t=="function"?t:null)}var rn=Object.assign,Jf;function tl(t){if(Jf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Jf=e&&e[1]||""}return`
`+Jf+t}var eh=!1;function th(t,e){if(!t||eh)return"";eh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(p){var r=p}Reflect.construct(t,[],e)}else{try{e.call()}catch(p){r=p}t.call(e.prototype)}else{try{throw Error()}catch(p){r=p}t()}}catch(p){if(p&&r&&typeof p.stack=="string"){for(var i=p.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var f=`
`+i[o].replace(" at new "," at ");return t.displayName&&f.includes("<anonymous>")&&(f=f.replace("<anonymous>",t.displayName)),f}while(1<=o&&0<=a);break}}}finally{eh=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?tl(t):""}function sS(t){switch(t.tag){case 5:return tl(t.type);case 16:return tl("Lazy");case 13:return tl("Suspense");case 19:return tl("SuspenseList");case 0:case 2:case 15:return t=th(t.type,!1),t;case 11:return t=th(t.type.render,!1),t;case 1:return t=th(t.type,!0),t;default:return""}}function gd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ko:return"Fragment";case Co:return"Portal";case hd:return"Profiler";case Ap:return"StrictMode";case dd:return"Suspense";case pd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case jy:return(t.displayName||"Context")+".Consumer";case Vy:return(t._context.displayName||"Context")+".Provider";case cp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case up:return e=t.displayName||null,e!==null?e:gd(t.type)||"Memo";case Hi:e=t._payload,t=t._init;try{return gd(t(e))}catch{}}return null}function oS(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return gd(e);case 8:return e===Ap?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ps(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function $y(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function aS(t){var e=$y(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function SA(t){t._valueTracker||(t._valueTracker=aS(t))}function Hy(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=$y(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Pc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function md(t,e){var n=e.checked;return rn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Rm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ps(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Xy(t,e){e=e.checked,e!=null&&lp(t,"checked",e,!1)}function _d(t,e){Xy(t,e);var n=ps(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?yd(t,e.type,n):e.hasOwnProperty("defaultValue")&&yd(t,e.type,ps(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Im(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function yd(t,e,n){(e!=="number"||Pc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var nl=Array.isArray;function Qo(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ps(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function vd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(be(91));return rn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Mm(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(be(92));if(nl(n)){if(1<n.length)throw Error(be(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ps(n)}}function Qy(t,e){var n=ps(e.value),r=ps(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Nm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Yy(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function wd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Yy(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var CA,Ky=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(CA=CA||document.createElement("div"),CA.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=CA.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Il(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ul={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},lS=["Webkit","ms","Moz","O"];Object.keys(ul).forEach(function(t){lS.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ul[e]=ul[t]})});function qy(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ul.hasOwnProperty(t)&&ul[t]?(""+e).trim():e+"px"}function Zy(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=qy(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var AS=rn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function bd(t,e){if(e){if(AS[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(be(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(be(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(be(61))}if(e.style!=null&&typeof e.style!="object")throw Error(be(62))}}function xd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Td=null;function fp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ed=null,Yo=null,Ko=null;function Om(t){if(t=sA(t)){if(typeof Ed!="function")throw Error(be(280));var e=t.stateNode;e&&(e=Gu(e),Ed(t.stateNode,t.type,e))}}function Gy(t){Yo?Ko?Ko.push(t):Ko=[t]:Yo=t}function Jy(){if(Yo){var t=Yo,e=Ko;if(Ko=Yo=null,Om(t),e)for(t=0;t<e.length;t++)Om(e[t])}}function ev(t,e){return t(e)}function tv(){}var nh=!1;function nv(t,e,n){if(nh)return t(e,n);nh=!0;try{return ev(t,e,n)}finally{nh=!1,(Yo!==null||Ko!==null)&&(tv(),Jy())}}function Ml(t,e){var n=t.stateNode;if(n===null)return null;var r=Gu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(be(231,e,typeof n));return n}var Sd=!1;if(Ci)try{var ja={};Object.defineProperty(ja,"passive",{get:function(){Sd=!0}}),window.addEventListener("test",ja,ja),window.removeEventListener("test",ja,ja)}catch{Sd=!1}function cS(t,e,n,r,i,s,o,a,f){var p=Array.prototype.slice.call(arguments,3);try{e.apply(n,p)}catch(m){this.onError(m)}}var fl=!1,Rc=null,Ic=!1,Cd=null,uS={onError:function(t){fl=!0,Rc=t}};function fS(t,e,n,r,i,s,o,a,f){fl=!1,Rc=null,cS.apply(uS,arguments)}function hS(t,e,n,r,i,s,o,a,f){if(fS.apply(this,arguments),fl){if(fl){var p=Rc;fl=!1,Rc=null}else throw Error(be(198));Ic||(Ic=!0,Cd=p)}}function io(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function rv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Dm(t){if(io(t)!==t)throw Error(be(188))}function dS(t){var e=t.alternate;if(!e){if(e=io(t),e===null)throw Error(be(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Dm(i),t;if(s===r)return Dm(i),e;s=s.sibling}throw Error(be(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(be(189))}}if(n.alternate!==r)throw Error(be(190))}if(n.tag!==3)throw Error(be(188));return n.stateNode.current===n?t:e}function iv(t){return t=dS(t),t!==null?sv(t):null}function sv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=sv(t);if(e!==null)return e;t=t.sibling}return null}var ov=vr.unstable_scheduleCallback,Bm=vr.unstable_cancelCallback,pS=vr.unstable_shouldYield,gS=vr.unstable_requestPaint,fn=vr.unstable_now,mS=vr.unstable_getCurrentPriorityLevel,hp=vr.unstable_ImmediatePriority,av=vr.unstable_UserBlockingPriority,Mc=vr.unstable_NormalPriority,_S=vr.unstable_LowPriority,lv=vr.unstable_IdlePriority,Yu=null,Ai=null;function yS(t){if(Ai&&typeof Ai.onCommitFiberRoot=="function")try{Ai.onCommitFiberRoot(Yu,t,void 0,(t.current.flags&128)===128)}catch{}}var Yr=Math.clz32?Math.clz32:bS,vS=Math.log,wS=Math.LN2;function bS(t){return t>>>=0,t===0?32:31-(vS(t)/wS|0)|0}var kA=64,PA=4194304;function rl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Nc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=rl(a):(s&=o,s!==0&&(r=rl(s)))}else o=n&~i,o!==0?r=rl(o):s!==0&&(r=rl(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Yr(e),i=1<<n,r|=t[n],e&=~i;return r}function xS(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function TS(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Yr(s),a=1<<o,f=i[o];f===-1?(!(a&n)||a&r)&&(i[o]=xS(a,e)):f<=e&&(t.expiredLanes|=a),s&=~a}}function kd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Av(){var t=kA;return kA<<=1,!(kA&4194240)&&(kA=64),t}function rh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function rA(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Yr(e),t[e]=n}function ES(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Yr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function dp(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Yr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Mt=0;function cv(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var uv,pp,fv,hv,dv,Pd=!1,RA=[],is=null,ss=null,os=null,Nl=new Map,Ol=new Map,qi=[],SS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fm(t,e){switch(t){case"focusin":case"focusout":is=null;break;case"dragenter":case"dragleave":ss=null;break;case"mouseover":case"mouseout":os=null;break;case"pointerover":case"pointerout":Nl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ol.delete(e.pointerId)}}function Wa(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=sA(e),e!==null&&pp(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function CS(t,e,n,r,i){switch(e){case"focusin":return is=Wa(is,t,e,n,r,i),!0;case"dragenter":return ss=Wa(ss,t,e,n,r,i),!0;case"mouseover":return os=Wa(os,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Nl.set(s,Wa(Nl.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Ol.set(s,Wa(Ol.get(s)||null,t,e,n,r,i)),!0}return!1}function pv(t){var e=Ds(t.target);if(e!==null){var n=io(e);if(n!==null){if(e=n.tag,e===13){if(e=rv(n),e!==null){t.blockedOn=e,dv(t.priority,function(){fv(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ac(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Rd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Td=r,n.target.dispatchEvent(r),Td=null}else return e=sA(n),e!==null&&pp(e),t.blockedOn=n,!1;e.shift()}return!0}function Lm(t,e,n){Ac(t)&&n.delete(e)}function kS(){Pd=!1,is!==null&&Ac(is)&&(is=null),ss!==null&&Ac(ss)&&(ss=null),os!==null&&Ac(os)&&(os=null),Nl.forEach(Lm),Ol.forEach(Lm)}function $a(t,e){t.blockedOn===e&&(t.blockedOn=null,Pd||(Pd=!0,vr.unstable_scheduleCallback(vr.unstable_NormalPriority,kS)))}function Dl(t){function e(i){return $a(i,t)}if(0<RA.length){$a(RA[0],t);for(var n=1;n<RA.length;n++){var r=RA[n];r.blockedOn===t&&(r.blockedOn=null)}}for(is!==null&&$a(is,t),ss!==null&&$a(ss,t),os!==null&&$a(os,t),Nl.forEach(e),Ol.forEach(e),n=0;n<qi.length;n++)r=qi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<qi.length&&(n=qi[0],n.blockedOn===null);)pv(n),n.blockedOn===null&&qi.shift()}var qo=Ni.ReactCurrentBatchConfig,Oc=!0;function PS(t,e,n,r){var i=Mt,s=qo.transition;qo.transition=null;try{Mt=1,gp(t,e,n,r)}finally{Mt=i,qo.transition=s}}function RS(t,e,n,r){var i=Mt,s=qo.transition;qo.transition=null;try{Mt=4,gp(t,e,n,r)}finally{Mt=i,qo.transition=s}}function gp(t,e,n,r){if(Oc){var i=Rd(t,e,n,r);if(i===null)hh(t,e,r,Dc,n),Fm(t,r);else if(CS(i,t,e,n,r))r.stopPropagation();else if(Fm(t,r),e&4&&-1<SS.indexOf(t)){for(;i!==null;){var s=sA(i);if(s!==null&&uv(s),s=Rd(t,e,n,r),s===null&&hh(t,e,r,Dc,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else hh(t,e,r,null,n)}}var Dc=null;function Rd(t,e,n,r){if(Dc=null,t=fp(r),t=Ds(t),t!==null)if(e=io(t),e===null)t=null;else if(n=e.tag,n===13){if(t=rv(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Dc=t,null}function gv(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mS()){case hp:return 1;case av:return 4;case Mc:case _S:return 16;case lv:return 536870912;default:return 16}default:return 16}}var Gi=null,mp=null,cc=null;function mv(){if(cc)return cc;var t,e=mp,n=e.length,r,i="value"in Gi?Gi.value:Gi.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return cc=i.slice(t,1<r?1-r:void 0)}function uc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function IA(){return!0}function Um(){return!1}function br(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?IA:Um,this.isPropagationStopped=Um,this}return rn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=IA)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=IA)},persist:function(){},isPersistent:IA}),e}var Ta={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_p=br(Ta),iA=rn({},Ta,{view:0,detail:0}),IS=br(iA),ih,sh,Ha,Ku=rn({},iA,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ha&&(Ha&&t.type==="mousemove"?(ih=t.screenX-Ha.screenX,sh=t.screenY-Ha.screenY):sh=ih=0,Ha=t),ih)},movementY:function(t){return"movementY"in t?t.movementY:sh}}),zm=br(Ku),MS=rn({},Ku,{dataTransfer:0}),NS=br(MS),OS=rn({},iA,{relatedTarget:0}),oh=br(OS),DS=rn({},Ta,{animationName:0,elapsedTime:0,pseudoElement:0}),BS=br(DS),FS=rn({},Ta,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),LS=br(FS),US=rn({},Ta,{data:0}),Vm=br(US),zS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},VS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function WS(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=jS[t])?!!e[t]:!1}function yp(){return WS}var $S=rn({},iA,{key:function(t){if(t.key){var e=zS[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=uc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?VS[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yp,charCode:function(t){return t.type==="keypress"?uc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?uc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),HS=br($S),XS=rn({},Ku,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jm=br(XS),QS=rn({},iA,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yp}),YS=br(QS),KS=rn({},Ta,{propertyName:0,elapsedTime:0,pseudoElement:0}),qS=br(KS),ZS=rn({},Ku,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),GS=br(ZS),JS=[9,13,27,32],vp=Ci&&"CompositionEvent"in window,hl=null;Ci&&"documentMode"in document&&(hl=document.documentMode);var e4=Ci&&"TextEvent"in window&&!hl,_v=Ci&&(!vp||hl&&8<hl&&11>=hl),Wm=" ",$m=!1;function yv(t,e){switch(t){case"keyup":return JS.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vv(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Po=!1;function t4(t,e){switch(t){case"compositionend":return vv(e);case"keypress":return e.which!==32?null:($m=!0,Wm);case"textInput":return t=e.data,t===Wm&&$m?null:t;default:return null}}function n4(t,e){if(Po)return t==="compositionend"||!vp&&yv(t,e)?(t=mv(),cc=mp=Gi=null,Po=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return _v&&e.locale!=="ko"?null:e.data;default:return null}}var r4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!r4[t.type]:e==="textarea"}function wv(t,e,n,r){Gy(r),e=Bc(e,"onChange"),0<e.length&&(n=new _p("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var dl=null,Bl=null;function i4(t){Mv(t,0)}function qu(t){var e=Mo(t);if(Hy(e))return t}function s4(t,e){if(t==="change")return e}var bv=!1;if(Ci){var ah;if(Ci){var lh="oninput"in document;if(!lh){var Xm=document.createElement("div");Xm.setAttribute("oninput","return;"),lh=typeof Xm.oninput=="function"}ah=lh}else ah=!1;bv=ah&&(!document.documentMode||9<document.documentMode)}function Qm(){dl&&(dl.detachEvent("onpropertychange",xv),Bl=dl=null)}function xv(t){if(t.propertyName==="value"&&qu(Bl)){var e=[];wv(e,Bl,t,fp(t)),nv(i4,e)}}function o4(t,e,n){t==="focusin"?(Qm(),dl=e,Bl=n,dl.attachEvent("onpropertychange",xv)):t==="focusout"&&Qm()}function a4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return qu(Bl)}function l4(t,e){if(t==="click")return qu(e)}function A4(t,e){if(t==="input"||t==="change")return qu(e)}function c4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var qr=typeof Object.is=="function"?Object.is:c4;function Fl(t,e){if(qr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!fd.call(e,i)||!qr(t[i],e[i]))return!1}return!0}function Ym(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Km(t,e){var n=Ym(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ym(n)}}function Tv(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Tv(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Ev(){for(var t=window,e=Pc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Pc(t.document)}return e}function wp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function u4(t){var e=Ev(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Tv(n.ownerDocument.documentElement,n)){if(r!==null&&wp(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Km(n,s);var o=Km(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var f4=Ci&&"documentMode"in document&&11>=document.documentMode,Ro=null,Id=null,pl=null,Md=!1;function qm(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Md||Ro==null||Ro!==Pc(r)||(r=Ro,"selectionStart"in r&&wp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),pl&&Fl(pl,r)||(pl=r,r=Bc(Id,"onSelect"),0<r.length&&(e=new _p("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ro)))}function MA(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Io={animationend:MA("Animation","AnimationEnd"),animationiteration:MA("Animation","AnimationIteration"),animationstart:MA("Animation","AnimationStart"),transitionend:MA("Transition","TransitionEnd")},Ah={},Sv={};Ci&&(Sv=document.createElement("div").style,"AnimationEvent"in window||(delete Io.animationend.animation,delete Io.animationiteration.animation,delete Io.animationstart.animation),"TransitionEvent"in window||delete Io.transitionend.transition);function Zu(t){if(Ah[t])return Ah[t];if(!Io[t])return t;var e=Io[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Sv)return Ah[t]=e[n];return t}var Cv=Zu("animationend"),kv=Zu("animationiteration"),Pv=Zu("animationstart"),Rv=Zu("transitionend"),Iv=new Map,Zm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _s(t,e){Iv.set(t,e),ro(e,[t])}for(var ch=0;ch<Zm.length;ch++){var uh=Zm[ch],h4=uh.toLowerCase(),d4=uh[0].toUpperCase()+uh.slice(1);_s(h4,"on"+d4)}_s(Cv,"onAnimationEnd");_s(kv,"onAnimationIteration");_s(Pv,"onAnimationStart");_s("dblclick","onDoubleClick");_s("focusin","onFocus");_s("focusout","onBlur");_s(Rv,"onTransitionEnd");ra("onMouseEnter",["mouseout","mouseover"]);ra("onMouseLeave",["mouseout","mouseover"]);ra("onPointerEnter",["pointerout","pointerover"]);ra("onPointerLeave",["pointerout","pointerover"]);ro("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ro("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ro("onBeforeInput",["compositionend","keypress","textInput","paste"]);ro("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ro("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ro("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var il="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),p4=new Set("cancel close invalid load scroll toggle".split(" ").concat(il));function Gm(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,hS(r,e,void 0,t),t.currentTarget=null}function Mv(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],f=a.instance,p=a.currentTarget;if(a=a.listener,f!==s&&i.isPropagationStopped())break e;Gm(i,a,p),s=f}else for(o=0;o<r.length;o++){if(a=r[o],f=a.instance,p=a.currentTarget,a=a.listener,f!==s&&i.isPropagationStopped())break e;Gm(i,a,p),s=f}}}if(Ic)throw t=Cd,Ic=!1,Cd=null,t}function Xt(t,e){var n=e[Fd];n===void 0&&(n=e[Fd]=new Set);var r=t+"__bubble";n.has(r)||(Nv(e,t,2,!1),n.add(r))}function fh(t,e,n){var r=0;e&&(r|=4),Nv(n,t,r,e)}var NA="_reactListening"+Math.random().toString(36).slice(2);function Ll(t){if(!t[NA]){t[NA]=!0,zy.forEach(function(n){n!=="selectionchange"&&(p4.has(n)||fh(n,!1,t),fh(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[NA]||(e[NA]=!0,fh("selectionchange",!1,e))}}function Nv(t,e,n,r){switch(gv(e)){case 1:var i=PS;break;case 4:i=RS;break;default:i=gp}n=i.bind(null,e,n,t),i=void 0,!Sd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function hh(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var f=o.tag;if((f===3||f===4)&&(f=o.stateNode.containerInfo,f===i||f.nodeType===8&&f.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Ds(a),o===null)return;if(f=o.tag,f===5||f===6){r=s=o;continue e}a=a.parentNode}}r=r.return}nv(function(){var p=s,m=fp(n),v=[];e:{var w=Iv.get(t);if(w!==void 0){var T=_p,E=t;switch(t){case"keypress":if(uc(n)===0)break e;case"keydown":case"keyup":T=HS;break;case"focusin":E="focus",T=oh;break;case"focusout":E="blur",T=oh;break;case"beforeblur":case"afterblur":T=oh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":T=zm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":T=NS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":T=YS;break;case Cv:case kv:case Pv:T=BS;break;case Rv:T=qS;break;case"scroll":T=IS;break;case"wheel":T=GS;break;case"copy":case"cut":case"paste":T=LS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":T=jm}var N=(e&4)!==0,j=!N&&t==="scroll",I=N?w!==null?w+"Capture":null:w;N=[];for(var R=p,k;R!==null;){k=R;var B=k.stateNode;if(k.tag===5&&B!==null&&(k=B,I!==null&&(B=Ml(R,I),B!=null&&N.push(Ul(R,B,k)))),j)break;R=R.return}0<N.length&&(w=new T(w,E,null,n,m),v.push({event:w,listeners:N}))}}if(!(e&7)){e:{if(w=t==="mouseover"||t==="pointerover",T=t==="mouseout"||t==="pointerout",w&&n!==Td&&(E=n.relatedTarget||n.fromElement)&&(Ds(E)||E[ki]))break e;if((T||w)&&(w=m.window===m?m:(w=m.ownerDocument)?w.defaultView||w.parentWindow:window,T?(E=n.relatedTarget||n.toElement,T=p,E=E?Ds(E):null,E!==null&&(j=io(E),E!==j||E.tag!==5&&E.tag!==6)&&(E=null)):(T=null,E=p),T!==E)){if(N=zm,B="onMouseLeave",I="onMouseEnter",R="mouse",(t==="pointerout"||t==="pointerover")&&(N=jm,B="onPointerLeave",I="onPointerEnter",R="pointer"),j=T==null?w:Mo(T),k=E==null?w:Mo(E),w=new N(B,R+"leave",T,n,m),w.target=j,w.relatedTarget=k,B=null,Ds(m)===p&&(N=new N(I,R+"enter",E,n,m),N.target=k,N.relatedTarget=j,B=N),j=B,T&&E)t:{for(N=T,I=E,R=0,k=N;k;k=_o(k))R++;for(k=0,B=I;B;B=_o(B))k++;for(;0<R-k;)N=_o(N),R--;for(;0<k-R;)I=_o(I),k--;for(;R--;){if(N===I||I!==null&&N===I.alternate)break t;N=_o(N),I=_o(I)}N=null}else N=null;T!==null&&Jm(v,w,T,N,!1),E!==null&&j!==null&&Jm(v,j,E,N,!0)}}e:{if(w=p?Mo(p):window,T=w.nodeName&&w.nodeName.toLowerCase(),T==="select"||T==="input"&&w.type==="file")var Y=s4;else if(Hm(w))if(bv)Y=A4;else{Y=a4;var G=o4}else(T=w.nodeName)&&T.toLowerCase()==="input"&&(w.type==="checkbox"||w.type==="radio")&&(Y=l4);if(Y&&(Y=Y(t,p))){wv(v,Y,n,m);break e}G&&G(t,w,p),t==="focusout"&&(G=w._wrapperState)&&G.controlled&&w.type==="number"&&yd(w,"number",w.value)}switch(G=p?Mo(p):window,t){case"focusin":(Hm(G)||G.contentEditable==="true")&&(Ro=G,Id=p,pl=null);break;case"focusout":pl=Id=Ro=null;break;case"mousedown":Md=!0;break;case"contextmenu":case"mouseup":case"dragend":Md=!1,qm(v,n,m);break;case"selectionchange":if(f4)break;case"keydown":case"keyup":qm(v,n,m)}var ce;if(vp)e:{switch(t){case"compositionstart":var U="onCompositionStart";break e;case"compositionend":U="onCompositionEnd";break e;case"compositionupdate":U="onCompositionUpdate";break e}U=void 0}else Po?yv(t,n)&&(U="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(U="onCompositionStart");U&&(_v&&n.locale!=="ko"&&(Po||U!=="onCompositionStart"?U==="onCompositionEnd"&&Po&&(ce=mv()):(Gi=m,mp="value"in Gi?Gi.value:Gi.textContent,Po=!0)),G=Bc(p,U),0<G.length&&(U=new Vm(U,t,null,n,m),v.push({event:U,listeners:G}),ce?U.data=ce:(ce=vv(n),ce!==null&&(U.data=ce)))),(ce=e4?t4(t,n):n4(t,n))&&(p=Bc(p,"onBeforeInput"),0<p.length&&(m=new Vm("onBeforeInput","beforeinput",null,n,m),v.push({event:m,listeners:p}),m.data=ce))}Mv(v,e)})}function Ul(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Bc(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Ml(t,n),s!=null&&r.unshift(Ul(t,s,i)),s=Ml(t,e),s!=null&&r.push(Ul(t,s,i))),t=t.return}return r}function _o(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Jm(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,f=a.alternate,p=a.stateNode;if(f!==null&&f===r)break;a.tag===5&&p!==null&&(a=p,i?(f=Ml(n,s),f!=null&&o.unshift(Ul(n,f,a))):i||(f=Ml(n,s),f!=null&&o.push(Ul(n,f,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var g4=/\r\n?/g,m4=/\u0000|\uFFFD/g;function e2(t){return(typeof t=="string"?t:""+t).replace(g4,`
`).replace(m4,"")}function OA(t,e,n){if(e=e2(e),e2(t)!==e&&n)throw Error(be(425))}function Fc(){}var Nd=null,Od=null;function Dd(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Bd=typeof setTimeout=="function"?setTimeout:void 0,_4=typeof clearTimeout=="function"?clearTimeout:void 0,t2=typeof Promise=="function"?Promise:void 0,y4=typeof queueMicrotask=="function"?queueMicrotask:typeof t2<"u"?function(t){return t2.resolve(null).then(t).catch(v4)}:Bd;function v4(t){setTimeout(function(){throw t})}function dh(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Dl(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Dl(e)}function as(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function n2(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ea=Math.random().toString(36).slice(2),si="__reactFiber$"+Ea,zl="__reactProps$"+Ea,ki="__reactContainer$"+Ea,Fd="__reactEvents$"+Ea,w4="__reactListeners$"+Ea,b4="__reactHandles$"+Ea;function Ds(t){var e=t[si];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ki]||n[si]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=n2(t);t!==null;){if(n=t[si])return n;t=n2(t)}return e}t=n,n=t.parentNode}return null}function sA(t){return t=t[si]||t[ki],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Mo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(be(33))}function Gu(t){return t[zl]||null}var Ld=[],No=-1;function ys(t){return{current:t}}function Qt(t){0>No||(t.current=Ld[No],Ld[No]=null,No--)}function $t(t,e){No++,Ld[No]=t.current,t.current=e}var gs={},Gn=ys(gs),cr=ys(!1),Hs=gs;function ia(t,e){var n=t.type.contextTypes;if(!n)return gs;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function ur(t){return t=t.childContextTypes,t!=null}function Lc(){Qt(cr),Qt(Gn)}function r2(t,e,n){if(Gn.current!==gs)throw Error(be(168));$t(Gn,e),$t(cr,n)}function Ov(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(be(108,oS(t)||"Unknown",i));return rn({},n,r)}function Uc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||gs,Hs=Gn.current,$t(Gn,t),$t(cr,cr.current),!0}function i2(t,e,n){var r=t.stateNode;if(!r)throw Error(be(169));n?(t=Ov(t,e,Hs),r.__reactInternalMemoizedMergedChildContext=t,Qt(cr),Qt(Gn),$t(Gn,t)):Qt(cr),$t(cr,n)}var yi=null,Ju=!1,ph=!1;function Dv(t){yi===null?yi=[t]:yi.push(t)}function x4(t){Ju=!0,Dv(t)}function vs(){if(!ph&&yi!==null){ph=!0;var t=0,e=Mt;try{var n=yi;for(Mt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}yi=null,Ju=!1}catch(i){throw yi!==null&&(yi=yi.slice(t+1)),ov(hp,vs),i}finally{Mt=e,ph=!1}}return null}var Oo=[],Do=0,zc=null,Vc=0,Sr=[],Cr=0,Xs=null,Ti=1,Ei="";function Ms(t,e){Oo[Do++]=Vc,Oo[Do++]=zc,zc=t,Vc=e}function Bv(t,e,n){Sr[Cr++]=Ti,Sr[Cr++]=Ei,Sr[Cr++]=Xs,Xs=t;var r=Ti;t=Ei;var i=32-Yr(r)-1;r&=~(1<<i),n+=1;var s=32-Yr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Ti=1<<32-Yr(e)+i|n<<i|r,Ei=s+t}else Ti=1<<s|n<<i|r,Ei=t}function bp(t){t.return!==null&&(Ms(t,1),Bv(t,1,0))}function xp(t){for(;t===zc;)zc=Oo[--Do],Oo[Do]=null,Vc=Oo[--Do],Oo[Do]=null;for(;t===Xs;)Xs=Sr[--Cr],Sr[Cr]=null,Ei=Sr[--Cr],Sr[Cr]=null,Ti=Sr[--Cr],Sr[Cr]=null}var _r=null,mr=null,Zt=!1,$r=null;function Fv(t,e){var n=kr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function s2(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,_r=t,mr=as(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,_r=t,mr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Xs!==null?{id:Ti,overflow:Ei}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=kr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,_r=t,mr=null,!0):!1;default:return!1}}function Ud(t){return(t.mode&1)!==0&&(t.flags&128)===0}function zd(t){if(Zt){var e=mr;if(e){var n=e;if(!s2(t,e)){if(Ud(t))throw Error(be(418));e=as(n.nextSibling);var r=_r;e&&s2(t,e)?Fv(r,n):(t.flags=t.flags&-4097|2,Zt=!1,_r=t)}}else{if(Ud(t))throw Error(be(418));t.flags=t.flags&-4097|2,Zt=!1,_r=t}}}function o2(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;_r=t}function DA(t){if(t!==_r)return!1;if(!Zt)return o2(t),Zt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Dd(t.type,t.memoizedProps)),e&&(e=mr)){if(Ud(t))throw Lv(),Error(be(418));for(;e;)Fv(t,e),e=as(e.nextSibling)}if(o2(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(be(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){mr=as(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}mr=null}}else mr=_r?as(t.stateNode.nextSibling):null;return!0}function Lv(){for(var t=mr;t;)t=as(t.nextSibling)}function sa(){mr=_r=null,Zt=!1}function Tp(t){$r===null?$r=[t]:$r.push(t)}var T4=Ni.ReactCurrentBatchConfig;function Xa(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(be(309));var r=n.stateNode}if(!r)throw Error(be(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(be(284));if(!n._owner)throw Error(be(290,t))}return t}function BA(t,e){throw t=Object.prototype.toString.call(e),Error(be(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function a2(t){var e=t._init;return e(t._payload)}function Uv(t){function e(I,R){if(t){var k=I.deletions;k===null?(I.deletions=[R],I.flags|=16):k.push(R)}}function n(I,R){if(!t)return null;for(;R!==null;)e(I,R),R=R.sibling;return null}function r(I,R){for(I=new Map;R!==null;)R.key!==null?I.set(R.key,R):I.set(R.index,R),R=R.sibling;return I}function i(I,R){return I=us(I,R),I.index=0,I.sibling=null,I}function s(I,R,k){return I.index=k,t?(k=I.alternate,k!==null?(k=k.index,k<R?(I.flags|=2,R):k):(I.flags|=2,R)):(I.flags|=1048576,R)}function o(I){return t&&I.alternate===null&&(I.flags|=2),I}function a(I,R,k,B){return R===null||R.tag!==6?(R=bh(k,I.mode,B),R.return=I,R):(R=i(R,k),R.return=I,R)}function f(I,R,k,B){var Y=k.type;return Y===ko?m(I,R,k.props.children,B,k.key):R!==null&&(R.elementType===Y||typeof Y=="object"&&Y!==null&&Y.$$typeof===Hi&&a2(Y)===R.type)?(B=i(R,k.props),B.ref=Xa(I,R,k),B.return=I,B):(B=_c(k.type,k.key,k.props,null,I.mode,B),B.ref=Xa(I,R,k),B.return=I,B)}function p(I,R,k,B){return R===null||R.tag!==4||R.stateNode.containerInfo!==k.containerInfo||R.stateNode.implementation!==k.implementation?(R=xh(k,I.mode,B),R.return=I,R):(R=i(R,k.children||[]),R.return=I,R)}function m(I,R,k,B,Y){return R===null||R.tag!==7?(R=zs(k,I.mode,B,Y),R.return=I,R):(R=i(R,k),R.return=I,R)}function v(I,R,k){if(typeof R=="string"&&R!==""||typeof R=="number")return R=bh(""+R,I.mode,k),R.return=I,R;if(typeof R=="object"&&R!==null){switch(R.$$typeof){case EA:return k=_c(R.type,R.key,R.props,null,I.mode,k),k.ref=Xa(I,null,R),k.return=I,k;case Co:return R=xh(R,I.mode,k),R.return=I,R;case Hi:var B=R._init;return v(I,B(R._payload),k)}if(nl(R)||Va(R))return R=zs(R,I.mode,k,null),R.return=I,R;BA(I,R)}return null}function w(I,R,k,B){var Y=R!==null?R.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return Y!==null?null:a(I,R,""+k,B);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case EA:return k.key===Y?f(I,R,k,B):null;case Co:return k.key===Y?p(I,R,k,B):null;case Hi:return Y=k._init,w(I,R,Y(k._payload),B)}if(nl(k)||Va(k))return Y!==null?null:m(I,R,k,B,null);BA(I,k)}return null}function T(I,R,k,B,Y){if(typeof B=="string"&&B!==""||typeof B=="number")return I=I.get(k)||null,a(R,I,""+B,Y);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case EA:return I=I.get(B.key===null?k:B.key)||null,f(R,I,B,Y);case Co:return I=I.get(B.key===null?k:B.key)||null,p(R,I,B,Y);case Hi:var G=B._init;return T(I,R,k,G(B._payload),Y)}if(nl(B)||Va(B))return I=I.get(k)||null,m(R,I,B,Y,null);BA(R,B)}return null}function E(I,R,k,B){for(var Y=null,G=null,ce=R,U=R=0,$=null;ce!==null&&U<k.length;U++){ce.index>U?($=ce,ce=null):$=ce.sibling;var K=w(I,ce,k[U],B);if(K===null){ce===null&&(ce=$);break}t&&ce&&K.alternate===null&&e(I,ce),R=s(K,R,U),G===null?Y=K:G.sibling=K,G=K,ce=$}if(U===k.length)return n(I,ce),Zt&&Ms(I,U),Y;if(ce===null){for(;U<k.length;U++)ce=v(I,k[U],B),ce!==null&&(R=s(ce,R,U),G===null?Y=ce:G.sibling=ce,G=ce);return Zt&&Ms(I,U),Y}for(ce=r(I,ce);U<k.length;U++)$=T(ce,I,U,k[U],B),$!==null&&(t&&$.alternate!==null&&ce.delete($.key===null?U:$.key),R=s($,R,U),G===null?Y=$:G.sibling=$,G=$);return t&&ce.forEach(function(ue){return e(I,ue)}),Zt&&Ms(I,U),Y}function N(I,R,k,B){var Y=Va(k);if(typeof Y!="function")throw Error(be(150));if(k=Y.call(k),k==null)throw Error(be(151));for(var G=Y=null,ce=R,U=R=0,$=null,K=k.next();ce!==null&&!K.done;U++,K=k.next()){ce.index>U?($=ce,ce=null):$=ce.sibling;var ue=w(I,ce,K.value,B);if(ue===null){ce===null&&(ce=$);break}t&&ce&&ue.alternate===null&&e(I,ce),R=s(ue,R,U),G===null?Y=ue:G.sibling=ue,G=ue,ce=$}if(K.done)return n(I,ce),Zt&&Ms(I,U),Y;if(ce===null){for(;!K.done;U++,K=k.next())K=v(I,K.value,B),K!==null&&(R=s(K,R,U),G===null?Y=K:G.sibling=K,G=K);return Zt&&Ms(I,U),Y}for(ce=r(I,ce);!K.done;U++,K=k.next())K=T(ce,I,U,K.value,B),K!==null&&(t&&K.alternate!==null&&ce.delete(K.key===null?U:K.key),R=s(K,R,U),G===null?Y=K:G.sibling=K,G=K);return t&&ce.forEach(function(ge){return e(I,ge)}),Zt&&Ms(I,U),Y}function j(I,R,k,B){if(typeof k=="object"&&k!==null&&k.type===ko&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case EA:e:{for(var Y=k.key,G=R;G!==null;){if(G.key===Y){if(Y=k.type,Y===ko){if(G.tag===7){n(I,G.sibling),R=i(G,k.props.children),R.return=I,I=R;break e}}else if(G.elementType===Y||typeof Y=="object"&&Y!==null&&Y.$$typeof===Hi&&a2(Y)===G.type){n(I,G.sibling),R=i(G,k.props),R.ref=Xa(I,G,k),R.return=I,I=R;break e}n(I,G);break}else e(I,G);G=G.sibling}k.type===ko?(R=zs(k.props.children,I.mode,B,k.key),R.return=I,I=R):(B=_c(k.type,k.key,k.props,null,I.mode,B),B.ref=Xa(I,R,k),B.return=I,I=B)}return o(I);case Co:e:{for(G=k.key;R!==null;){if(R.key===G)if(R.tag===4&&R.stateNode.containerInfo===k.containerInfo&&R.stateNode.implementation===k.implementation){n(I,R.sibling),R=i(R,k.children||[]),R.return=I,I=R;break e}else{n(I,R);break}else e(I,R);R=R.sibling}R=xh(k,I.mode,B),R.return=I,I=R}return o(I);case Hi:return G=k._init,j(I,R,G(k._payload),B)}if(nl(k))return E(I,R,k,B);if(Va(k))return N(I,R,k,B);BA(I,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,R!==null&&R.tag===6?(n(I,R.sibling),R=i(R,k),R.return=I,I=R):(n(I,R),R=bh(k,I.mode,B),R.return=I,I=R),o(I)):n(I,R)}return j}var oa=Uv(!0),zv=Uv(!1),jc=ys(null),Wc=null,Bo=null,Ep=null;function Sp(){Ep=Bo=Wc=null}function Cp(t){var e=jc.current;Qt(jc),t._currentValue=e}function Vd(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Zo(t,e){Wc=t,Ep=Bo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ar=!0),t.firstContext=null)}function Nr(t){var e=t._currentValue;if(Ep!==t)if(t={context:t,memoizedValue:e,next:null},Bo===null){if(Wc===null)throw Error(be(308));Bo=t,Wc.dependencies={lanes:0,firstContext:t}}else Bo=Bo.next=t;return e}var Bs=null;function kp(t){Bs===null?Bs=[t]:Bs.push(t)}function Vv(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,kp(e)):(n.next=i.next,i.next=n),e.interleaved=n,Pi(t,r)}function Pi(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Xi=!1;function Pp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function jv(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Si(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ls(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,vt&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Pi(t,n)}return i=r.interleaved,i===null?(e.next=e,kp(r)):(e.next=i.next,i.next=e),r.interleaved=e,Pi(t,n)}function fc(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,dp(t,n)}}function l2(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function $c(t,e,n,r){var i=t.updateQueue;Xi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var f=a,p=f.next;f.next=null,o===null?s=p:o.next=p,o=f;var m=t.alternate;m!==null&&(m=m.updateQueue,a=m.lastBaseUpdate,a!==o&&(a===null?m.firstBaseUpdate=p:a.next=p,m.lastBaseUpdate=f))}if(s!==null){var v=i.baseState;o=0,m=p=f=null,a=s;do{var w=a.lane,T=a.eventTime;if((r&w)===w){m!==null&&(m=m.next={eventTime:T,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var E=t,N=a;switch(w=e,T=n,N.tag){case 1:if(E=N.payload,typeof E=="function"){v=E.call(T,v,w);break e}v=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=N.payload,w=typeof E=="function"?E.call(T,v,w):E,w==null)break e;v=rn({},v,w);break e;case 2:Xi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,w=i.effects,w===null?i.effects=[a]:w.push(a))}else T={eventTime:T,lane:w,tag:a.tag,payload:a.payload,callback:a.callback,next:null},m===null?(p=m=T,f=v):m=m.next=T,o|=w;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;w=a,a=w.next,w.next=null,i.lastBaseUpdate=w,i.shared.pending=null}}while(!0);if(m===null&&(f=v),i.baseState=f,i.firstBaseUpdate=p,i.lastBaseUpdate=m,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ys|=o,t.lanes=o,t.memoizedState=v}}function A2(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(be(191,i));i.call(r)}}}var oA={},ci=ys(oA),Vl=ys(oA),jl=ys(oA);function Fs(t){if(t===oA)throw Error(be(174));return t}function Rp(t,e){switch($t(jl,e),$t(Vl,t),$t(ci,oA),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:wd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=wd(e,t)}Qt(ci),$t(ci,e)}function aa(){Qt(ci),Qt(Vl),Qt(jl)}function Wv(t){Fs(jl.current);var e=Fs(ci.current),n=wd(e,t.type);e!==n&&($t(Vl,t),$t(ci,n))}function Ip(t){Vl.current===t&&(Qt(ci),Qt(Vl))}var en=ys(0);function Hc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var gh=[];function Mp(){for(var t=0;t<gh.length;t++)gh[t]._workInProgressVersionPrimary=null;gh.length=0}var hc=Ni.ReactCurrentDispatcher,mh=Ni.ReactCurrentBatchConfig,Qs=0,nn=null,vn=null,Pn=null,Xc=!1,gl=!1,Wl=0,E4=0;function $n(){throw Error(be(321))}function Np(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!qr(t[n],e[n]))return!1;return!0}function Op(t,e,n,r,i,s){if(Qs=s,nn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,hc.current=t===null||t.memoizedState===null?P4:R4,t=n(r,i),gl){s=0;do{if(gl=!1,Wl=0,25<=s)throw Error(be(301));s+=1,Pn=vn=null,e.updateQueue=null,hc.current=I4,t=n(r,i)}while(gl)}if(hc.current=Qc,e=vn!==null&&vn.next!==null,Qs=0,Pn=vn=nn=null,Xc=!1,e)throw Error(be(300));return t}function Dp(){var t=Wl!==0;return Wl=0,t}function ri(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pn===null?nn.memoizedState=Pn=t:Pn=Pn.next=t,Pn}function Or(){if(vn===null){var t=nn.alternate;t=t!==null?t.memoizedState:null}else t=vn.next;var e=Pn===null?nn.memoizedState:Pn.next;if(e!==null)Pn=e,vn=t;else{if(t===null)throw Error(be(310));vn=t,t={memoizedState:vn.memoizedState,baseState:vn.baseState,baseQueue:vn.baseQueue,queue:vn.queue,next:null},Pn===null?nn.memoizedState=Pn=t:Pn=Pn.next=t}return Pn}function $l(t,e){return typeof e=="function"?e(t):e}function _h(t){var e=Or(),n=e.queue;if(n===null)throw Error(be(311));n.lastRenderedReducer=t;var r=vn,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,f=null,p=s;do{var m=p.lane;if((Qs&m)===m)f!==null&&(f=f.next={lane:0,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null}),r=p.hasEagerState?p.eagerState:t(r,p.action);else{var v={lane:m,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null};f===null?(a=f=v,o=r):f=f.next=v,nn.lanes|=m,Ys|=m}p=p.next}while(p!==null&&p!==s);f===null?o=r:f.next=a,qr(r,e.memoizedState)||(Ar=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=f,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,nn.lanes|=s,Ys|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function yh(t){var e=Or(),n=e.queue;if(n===null)throw Error(be(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);qr(s,e.memoizedState)||(Ar=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function $v(){}function Hv(t,e){var n=nn,r=Or(),i=e(),s=!qr(r.memoizedState,i);if(s&&(r.memoizedState=i,Ar=!0),r=r.queue,Bp(Yv.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Pn!==null&&Pn.memoizedState.tag&1){if(n.flags|=2048,Hl(9,Qv.bind(null,n,r,i,e),void 0,null),Rn===null)throw Error(be(349));Qs&30||Xv(n,e,i)}return i}function Xv(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=nn.updateQueue,e===null?(e={lastEffect:null,stores:null},nn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Qv(t,e,n,r){e.value=n,e.getSnapshot=r,Kv(e)&&qv(t)}function Yv(t,e,n){return n(function(){Kv(e)&&qv(t)})}function Kv(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!qr(t,n)}catch{return!0}}function qv(t){var e=Pi(t,1);e!==null&&Kr(e,t,1,-1)}function c2(t){var e=ri();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$l,lastRenderedState:t},e.queue=t,t=t.dispatch=k4.bind(null,nn,t),[e.memoizedState,t]}function Hl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=nn.updateQueue,e===null?(e={lastEffect:null,stores:null},nn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Zv(){return Or().memoizedState}function dc(t,e,n,r){var i=ri();nn.flags|=t,i.memoizedState=Hl(1|e,n,void 0,r===void 0?null:r)}function ef(t,e,n,r){var i=Or();r=r===void 0?null:r;var s=void 0;if(vn!==null){var o=vn.memoizedState;if(s=o.destroy,r!==null&&Np(r,o.deps)){i.memoizedState=Hl(e,n,s,r);return}}nn.flags|=t,i.memoizedState=Hl(1|e,n,s,r)}function u2(t,e){return dc(8390656,8,t,e)}function Bp(t,e){return ef(2048,8,t,e)}function Gv(t,e){return ef(4,2,t,e)}function Jv(t,e){return ef(4,4,t,e)}function e3(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function t3(t,e,n){return n=n!=null?n.concat([t]):null,ef(4,4,e3.bind(null,e,t),n)}function Fp(){}function n3(t,e){var n=Or();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Np(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function r3(t,e){var n=Or();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Np(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function i3(t,e,n){return Qs&21?(qr(n,e)||(n=Av(),nn.lanes|=n,Ys|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ar=!0),t.memoizedState=n)}function S4(t,e){var n=Mt;Mt=n!==0&&4>n?n:4,t(!0);var r=mh.transition;mh.transition={};try{t(!1),e()}finally{Mt=n,mh.transition=r}}function s3(){return Or().memoizedState}function C4(t,e,n){var r=cs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},o3(t))a3(e,n);else if(n=Vv(t,e,n,r),n!==null){var i=rr();Kr(n,t,r,i),l3(n,e,r)}}function k4(t,e,n){var r=cs(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(o3(t))a3(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,qr(a,o)){var f=e.interleaved;f===null?(i.next=i,kp(e)):(i.next=f.next,f.next=i),e.interleaved=i;return}}catch{}finally{}n=Vv(t,e,i,r),n!==null&&(i=rr(),Kr(n,t,r,i),l3(n,e,r))}}function o3(t){var e=t.alternate;return t===nn||e!==null&&e===nn}function a3(t,e){gl=Xc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function l3(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,dp(t,n)}}var Qc={readContext:Nr,useCallback:$n,useContext:$n,useEffect:$n,useImperativeHandle:$n,useInsertionEffect:$n,useLayoutEffect:$n,useMemo:$n,useReducer:$n,useRef:$n,useState:$n,useDebugValue:$n,useDeferredValue:$n,useTransition:$n,useMutableSource:$n,useSyncExternalStore:$n,useId:$n,unstable_isNewReconciler:!1},P4={readContext:Nr,useCallback:function(t,e){return ri().memoizedState=[t,e===void 0?null:e],t},useContext:Nr,useEffect:u2,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,dc(4194308,4,e3.bind(null,e,t),n)},useLayoutEffect:function(t,e){return dc(4194308,4,t,e)},useInsertionEffect:function(t,e){return dc(4,2,t,e)},useMemo:function(t,e){var n=ri();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=ri();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=C4.bind(null,nn,t),[r.memoizedState,t]},useRef:function(t){var e=ri();return t={current:t},e.memoizedState=t},useState:c2,useDebugValue:Fp,useDeferredValue:function(t){return ri().memoizedState=t},useTransition:function(){var t=c2(!1),e=t[0];return t=S4.bind(null,t[1]),ri().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=nn,i=ri();if(Zt){if(n===void 0)throw Error(be(407));n=n()}else{if(n=e(),Rn===null)throw Error(be(349));Qs&30||Xv(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,u2(Yv.bind(null,r,s,t),[t]),r.flags|=2048,Hl(9,Qv.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=ri(),e=Rn.identifierPrefix;if(Zt){var n=Ei,r=Ti;n=(r&~(1<<32-Yr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Wl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=E4++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},R4={readContext:Nr,useCallback:n3,useContext:Nr,useEffect:Bp,useImperativeHandle:t3,useInsertionEffect:Gv,useLayoutEffect:Jv,useMemo:r3,useReducer:_h,useRef:Zv,useState:function(){return _h($l)},useDebugValue:Fp,useDeferredValue:function(t){var e=Or();return i3(e,vn.memoizedState,t)},useTransition:function(){var t=_h($l)[0],e=Or().memoizedState;return[t,e]},useMutableSource:$v,useSyncExternalStore:Hv,useId:s3,unstable_isNewReconciler:!1},I4={readContext:Nr,useCallback:n3,useContext:Nr,useEffect:Bp,useImperativeHandle:t3,useInsertionEffect:Gv,useLayoutEffect:Jv,useMemo:r3,useReducer:yh,useRef:Zv,useState:function(){return yh($l)},useDebugValue:Fp,useDeferredValue:function(t){var e=Or();return vn===null?e.memoizedState=t:i3(e,vn.memoizedState,t)},useTransition:function(){var t=yh($l)[0],e=Or().memoizedState;return[t,e]},useMutableSource:$v,useSyncExternalStore:Hv,useId:s3,unstable_isNewReconciler:!1};function jr(t,e){if(t&&t.defaultProps){e=rn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function jd(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:rn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var tf={isMounted:function(t){return(t=t._reactInternals)?io(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=rr(),i=cs(t),s=Si(r,i);s.payload=e,n!=null&&(s.callback=n),e=ls(t,s,i),e!==null&&(Kr(e,t,i,r),fc(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=rr(),i=cs(t),s=Si(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=ls(t,s,i),e!==null&&(Kr(e,t,i,r),fc(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=rr(),r=cs(t),i=Si(n,r);i.tag=2,e!=null&&(i.callback=e),e=ls(t,i,r),e!==null&&(Kr(e,t,r,n),fc(e,t,r))}};function f2(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Fl(n,r)||!Fl(i,s):!0}function A3(t,e,n){var r=!1,i=gs,s=e.contextType;return typeof s=="object"&&s!==null?s=Nr(s):(i=ur(e)?Hs:Gn.current,r=e.contextTypes,s=(r=r!=null)?ia(t,i):gs),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=tf,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function h2(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&tf.enqueueReplaceState(e,e.state,null)}function Wd(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Pp(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Nr(s):(s=ur(e)?Hs:Gn.current,i.context=ia(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(jd(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&tf.enqueueReplaceState(i,i.state,null),$c(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function la(t,e){try{var n="",r=e;do n+=sS(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function vh(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function $d(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var M4=typeof WeakMap=="function"?WeakMap:Map;function c3(t,e,n){n=Si(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Kc||(Kc=!0,e0=r),$d(t,e)},n}function u3(t,e,n){n=Si(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){$d(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){$d(t,e),typeof r!="function"&&(As===null?As=new Set([this]):As.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function d2(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new M4;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=X4.bind(null,t,e,n),e.then(t,t))}function p2(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function g2(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Si(-1,1),e.tag=2,ls(n,e,1))),n.lanes|=1),t)}var N4=Ni.ReactCurrentOwner,Ar=!1;function nr(t,e,n,r){e.child=t===null?zv(e,null,n,r):oa(e,t.child,n,r)}function m2(t,e,n,r,i){n=n.render;var s=e.ref;return Zo(e,i),r=Op(t,e,n,r,s,i),n=Dp(),t!==null&&!Ar?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ri(t,e,i)):(Zt&&n&&bp(e),e.flags|=1,nr(t,e,r,i),e.child)}function _2(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Hp(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,f3(t,e,s,r,i)):(t=_c(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Fl,n(o,r)&&t.ref===e.ref)return Ri(t,e,i)}return e.flags|=1,t=us(s,r),t.ref=e.ref,t.return=e,e.child=t}function f3(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Fl(s,r)&&t.ref===e.ref)if(Ar=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Ar=!0);else return e.lanes=t.lanes,Ri(t,e,i)}return Hd(t,e,n,r,i)}function h3(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},$t(Lo,dr),dr|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,$t(Lo,dr),dr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,$t(Lo,dr),dr|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,$t(Lo,dr),dr|=r;return nr(t,e,i,n),e.child}function d3(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Hd(t,e,n,r,i){var s=ur(n)?Hs:Gn.current;return s=ia(e,s),Zo(e,i),n=Op(t,e,n,r,s,i),r=Dp(),t!==null&&!Ar?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ri(t,e,i)):(Zt&&r&&bp(e),e.flags|=1,nr(t,e,n,i),e.child)}function y2(t,e,n,r,i){if(ur(n)){var s=!0;Uc(e)}else s=!1;if(Zo(e,i),e.stateNode===null)pc(t,e),A3(e,n,r),Wd(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var f=o.context,p=n.contextType;typeof p=="object"&&p!==null?p=Nr(p):(p=ur(n)?Hs:Gn.current,p=ia(e,p));var m=n.getDerivedStateFromProps,v=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function";v||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||f!==p)&&h2(e,o,r,p),Xi=!1;var w=e.memoizedState;o.state=w,$c(e,r,o,i),f=e.memoizedState,a!==r||w!==f||cr.current||Xi?(typeof m=="function"&&(jd(e,n,m,r),f=e.memoizedState),(a=Xi||f2(e,n,a,r,w,f,p))?(v||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=f),o.props=r,o.state=f,o.context=p,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,jv(t,e),a=e.memoizedProps,p=e.type===e.elementType?a:jr(e.type,a),o.props=p,v=e.pendingProps,w=o.context,f=n.contextType,typeof f=="object"&&f!==null?f=Nr(f):(f=ur(n)?Hs:Gn.current,f=ia(e,f));var T=n.getDerivedStateFromProps;(m=typeof T=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==v||w!==f)&&h2(e,o,r,f),Xi=!1,w=e.memoizedState,o.state=w,$c(e,r,o,i);var E=e.memoizedState;a!==v||w!==E||cr.current||Xi?(typeof T=="function"&&(jd(e,n,T,r),E=e.memoizedState),(p=Xi||f2(e,n,p,r,w,E,f)||!1)?(m||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,E,f),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,E,f)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),o.props=r,o.state=E,o.context=f,r=p):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),r=!1)}return Xd(t,e,n,r,s,i)}function Xd(t,e,n,r,i,s){d3(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&i2(e,n,!1),Ri(t,e,s);r=e.stateNode,N4.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=oa(e,t.child,null,s),e.child=oa(e,null,a,s)):nr(t,e,a,s),e.memoizedState=r.state,i&&i2(e,n,!0),e.child}function p3(t){var e=t.stateNode;e.pendingContext?r2(t,e.pendingContext,e.pendingContext!==e.context):e.context&&r2(t,e.context,!1),Rp(t,e.containerInfo)}function v2(t,e,n,r,i){return sa(),Tp(i),e.flags|=256,nr(t,e,n,r),e.child}var Qd={dehydrated:null,treeContext:null,retryLane:0};function Yd(t){return{baseLanes:t,cachePool:null,transitions:null}}function g3(t,e,n){var r=e.pendingProps,i=en.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),$t(en,i&1),t===null)return zd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=sf(o,r,0,null),t=zs(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Yd(n),e.memoizedState=Qd,t):Lp(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return O4(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var f={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=f,e.deletions=null):(r=us(i,f),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=us(a,s):(s=zs(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Yd(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Qd,r}return s=t.child,t=s.sibling,r=us(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Lp(t,e){return e=sf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function FA(t,e,n,r){return r!==null&&Tp(r),oa(e,t.child,null,n),t=Lp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function O4(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=vh(Error(be(422))),FA(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=sf({mode:"visible",children:r.children},i,0,null),s=zs(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&oa(e,t.child,null,o),e.child.memoizedState=Yd(o),e.memoizedState=Qd,s);if(!(e.mode&1))return FA(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(be(419)),r=vh(s,r,void 0),FA(t,e,o,r)}if(a=(o&t.childLanes)!==0,Ar||a){if(r=Rn,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Pi(t,i),Kr(r,t,i,-1))}return $p(),r=vh(Error(be(421))),FA(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=Q4.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,mr=as(i.nextSibling),_r=e,Zt=!0,$r=null,t!==null&&(Sr[Cr++]=Ti,Sr[Cr++]=Ei,Sr[Cr++]=Xs,Ti=t.id,Ei=t.overflow,Xs=e),e=Lp(e,r.children),e.flags|=4096,e)}function w2(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Vd(t.return,e,n)}function wh(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function m3(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(nr(t,e,r.children,n),r=en.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&w2(t,n,e);else if(t.tag===19)w2(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if($t(en,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Hc(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),wh(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Hc(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}wh(e,!0,n,null,s);break;case"together":wh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function pc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ri(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ys|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(be(153));if(e.child!==null){for(t=e.child,n=us(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=us(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function D4(t,e,n){switch(e.tag){case 3:p3(e),sa();break;case 5:Wv(e);break;case 1:ur(e.type)&&Uc(e);break;case 4:Rp(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;$t(jc,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?($t(en,en.current&1),e.flags|=128,null):n&e.child.childLanes?g3(t,e,n):($t(en,en.current&1),t=Ri(t,e,n),t!==null?t.sibling:null);$t(en,en.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return m3(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),$t(en,en.current),r)break;return null;case 22:case 23:return e.lanes=0,h3(t,e,n)}return Ri(t,e,n)}var _3,Kd,y3,v3;_3=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Kd=function(){};y3=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Fs(ci.current);var s=null;switch(n){case"input":i=md(t,i),r=md(t,r),s=[];break;case"select":i=rn({},i,{value:void 0}),r=rn({},r,{value:void 0}),s=[];break;case"textarea":i=vd(t,i),r=vd(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Fc)}bd(n,r);var o;n=null;for(p in i)if(!r.hasOwnProperty(p)&&i.hasOwnProperty(p)&&i[p]!=null)if(p==="style"){var a=i[p];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else p!=="dangerouslySetInnerHTML"&&p!=="children"&&p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(Rl.hasOwnProperty(p)?s||(s=[]):(s=s||[]).push(p,null));for(p in r){var f=r[p];if(a=i!=null?i[p]:void 0,r.hasOwnProperty(p)&&f!==a&&(f!=null||a!=null))if(p==="style")if(a){for(o in a)!a.hasOwnProperty(o)||f&&f.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in f)f.hasOwnProperty(o)&&a[o]!==f[o]&&(n||(n={}),n[o]=f[o])}else n||(s||(s=[]),s.push(p,n)),n=f;else p==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,a=a?a.__html:void 0,f!=null&&a!==f&&(s=s||[]).push(p,f)):p==="children"?typeof f!="string"&&typeof f!="number"||(s=s||[]).push(p,""+f):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&(Rl.hasOwnProperty(p)?(f!=null&&p==="onScroll"&&Xt("scroll",t),s||a===f||(s=[])):(s=s||[]).push(p,f))}n&&(s=s||[]).push("style",n);var p=s;(e.updateQueue=p)&&(e.flags|=4)}};v3=function(t,e,n,r){n!==r&&(e.flags|=4)};function Qa(t,e){if(!Zt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Hn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function B4(t,e,n){var r=e.pendingProps;switch(xp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hn(e),null;case 1:return ur(e.type)&&Lc(),Hn(e),null;case 3:return r=e.stateNode,aa(),Qt(cr),Qt(Gn),Mp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(DA(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,$r!==null&&(r0($r),$r=null))),Kd(t,e),Hn(e),null;case 5:Ip(e);var i=Fs(jl.current);if(n=e.type,t!==null&&e.stateNode!=null)y3(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(be(166));return Hn(e),null}if(t=Fs(ci.current),DA(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[si]=e,r[zl]=s,t=(e.mode&1)!==0,n){case"dialog":Xt("cancel",r),Xt("close",r);break;case"iframe":case"object":case"embed":Xt("load",r);break;case"video":case"audio":for(i=0;i<il.length;i++)Xt(il[i],r);break;case"source":Xt("error",r);break;case"img":case"image":case"link":Xt("error",r),Xt("load",r);break;case"details":Xt("toggle",r);break;case"input":Rm(r,s),Xt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Xt("invalid",r);break;case"textarea":Mm(r,s),Xt("invalid",r)}bd(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&OA(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&OA(r.textContent,a,t),i=["children",""+a]):Rl.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Xt("scroll",r)}switch(n){case"input":SA(r),Im(r,s,!0);break;case"textarea":SA(r),Nm(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Fc)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Yy(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[si]=e,t[zl]=r,_3(t,e,!1,!1),e.stateNode=t;e:{switch(o=xd(n,r),n){case"dialog":Xt("cancel",t),Xt("close",t),i=r;break;case"iframe":case"object":case"embed":Xt("load",t),i=r;break;case"video":case"audio":for(i=0;i<il.length;i++)Xt(il[i],t);i=r;break;case"source":Xt("error",t),i=r;break;case"img":case"image":case"link":Xt("error",t),Xt("load",t),i=r;break;case"details":Xt("toggle",t),i=r;break;case"input":Rm(t,r),i=md(t,r),Xt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=rn({},r,{value:void 0}),Xt("invalid",t);break;case"textarea":Mm(t,r),i=vd(t,r),Xt("invalid",t);break;default:i=r}bd(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var f=a[s];s==="style"?Zy(t,f):s==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,f!=null&&Ky(t,f)):s==="children"?typeof f=="string"?(n!=="textarea"||f!=="")&&Il(t,f):typeof f=="number"&&Il(t,""+f):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Rl.hasOwnProperty(s)?f!=null&&s==="onScroll"&&Xt("scroll",t):f!=null&&lp(t,s,f,o))}switch(n){case"input":SA(t),Im(t,r,!1);break;case"textarea":SA(t),Nm(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ps(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Qo(t,!!r.multiple,s,!1):r.defaultValue!=null&&Qo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Fc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Hn(e),null;case 6:if(t&&e.stateNode!=null)v3(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(be(166));if(n=Fs(jl.current),Fs(ci.current),DA(e)){if(r=e.stateNode,n=e.memoizedProps,r[si]=e,(s=r.nodeValue!==n)&&(t=_r,t!==null))switch(t.tag){case 3:OA(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&OA(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[si]=e,e.stateNode=r}return Hn(e),null;case 13:if(Qt(en),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Zt&&mr!==null&&e.mode&1&&!(e.flags&128))Lv(),sa(),e.flags|=98560,s=!1;else if(s=DA(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(be(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(be(317));s[si]=e}else sa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Hn(e),s=!1}else $r!==null&&(r0($r),$r=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||en.current&1?wn===0&&(wn=3):$p())),e.updateQueue!==null&&(e.flags|=4),Hn(e),null);case 4:return aa(),Kd(t,e),t===null&&Ll(e.stateNode.containerInfo),Hn(e),null;case 10:return Cp(e.type._context),Hn(e),null;case 17:return ur(e.type)&&Lc(),Hn(e),null;case 19:if(Qt(en),s=e.memoizedState,s===null)return Hn(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Qa(s,!1);else{if(wn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Hc(t),o!==null){for(e.flags|=128,Qa(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return $t(en,en.current&1|2),e.child}t=t.sibling}s.tail!==null&&fn()>Aa&&(e.flags|=128,r=!0,Qa(s,!1),e.lanes=4194304)}else{if(!r)if(t=Hc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Qa(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Zt)return Hn(e),null}else 2*fn()-s.renderingStartTime>Aa&&n!==1073741824&&(e.flags|=128,r=!0,Qa(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=fn(),e.sibling=null,n=en.current,$t(en,r?n&1|2:n&1),e):(Hn(e),null);case 22:case 23:return Wp(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?dr&1073741824&&(Hn(e),e.subtreeFlags&6&&(e.flags|=8192)):Hn(e),null;case 24:return null;case 25:return null}throw Error(be(156,e.tag))}function F4(t,e){switch(xp(e),e.tag){case 1:return ur(e.type)&&Lc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return aa(),Qt(cr),Qt(Gn),Mp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Ip(e),null;case 13:if(Qt(en),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(be(340));sa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Qt(en),null;case 4:return aa(),null;case 10:return Cp(e.type._context),null;case 22:case 23:return Wp(),null;case 24:return null;default:return null}}var LA=!1,Zn=!1,L4=typeof WeakSet=="function"?WeakSet:Set,Ve=null;function Fo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){An(t,e,r)}else n.current=null}function qd(t,e,n){try{n()}catch(r){An(t,e,r)}}var b2=!1;function U4(t,e){if(Nd=Oc,t=Ev(),wp(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,f=-1,p=0,m=0,v=t,w=null;t:for(;;){for(var T;v!==n||i!==0&&v.nodeType!==3||(a=o+i),v!==s||r!==0&&v.nodeType!==3||(f=o+r),v.nodeType===3&&(o+=v.nodeValue.length),(T=v.firstChild)!==null;)w=v,v=T;for(;;){if(v===t)break t;if(w===n&&++p===i&&(a=o),w===s&&++m===r&&(f=o),(T=v.nextSibling)!==null)break;v=w,w=v.parentNode}v=T}n=a===-1||f===-1?null:{start:a,end:f}}else n=null}n=n||{start:0,end:0}}else n=null;for(Od={focusedElem:t,selectionRange:n},Oc=!1,Ve=e;Ve!==null;)if(e=Ve,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ve=t;else for(;Ve!==null;){e=Ve;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var N=E.memoizedProps,j=E.memoizedState,I=e.stateNode,R=I.getSnapshotBeforeUpdate(e.elementType===e.type?N:jr(e.type,N),j);I.__reactInternalSnapshotBeforeUpdate=R}break;case 3:var k=e.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(be(163))}}catch(B){An(e,e.return,B)}if(t=e.sibling,t!==null){t.return=e.return,Ve=t;break}Ve=e.return}return E=b2,b2=!1,E}function ml(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&qd(e,n,s)}i=i.next}while(i!==r)}}function nf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Zd(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function w3(t){var e=t.alternate;e!==null&&(t.alternate=null,w3(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[si],delete e[zl],delete e[Fd],delete e[w4],delete e[b4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function b3(t){return t.tag===5||t.tag===3||t.tag===4}function x2(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||b3(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Gd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Fc));else if(r!==4&&(t=t.child,t!==null))for(Gd(t,e,n),t=t.sibling;t!==null;)Gd(t,e,n),t=t.sibling}function Jd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Jd(t,e,n),t=t.sibling;t!==null;)Jd(t,e,n),t=t.sibling}var Nn=null,Wr=!1;function zi(t,e,n){for(n=n.child;n!==null;)x3(t,e,n),n=n.sibling}function x3(t,e,n){if(Ai&&typeof Ai.onCommitFiberUnmount=="function")try{Ai.onCommitFiberUnmount(Yu,n)}catch{}switch(n.tag){case 5:Zn||Fo(n,e);case 6:var r=Nn,i=Wr;Nn=null,zi(t,e,n),Nn=r,Wr=i,Nn!==null&&(Wr?(t=Nn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Nn.removeChild(n.stateNode));break;case 18:Nn!==null&&(Wr?(t=Nn,n=n.stateNode,t.nodeType===8?dh(t.parentNode,n):t.nodeType===1&&dh(t,n),Dl(t)):dh(Nn,n.stateNode));break;case 4:r=Nn,i=Wr,Nn=n.stateNode.containerInfo,Wr=!0,zi(t,e,n),Nn=r,Wr=i;break;case 0:case 11:case 14:case 15:if(!Zn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&qd(n,e,o),i=i.next}while(i!==r)}zi(t,e,n);break;case 1:if(!Zn&&(Fo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){An(n,e,a)}zi(t,e,n);break;case 21:zi(t,e,n);break;case 22:n.mode&1?(Zn=(r=Zn)||n.memoizedState!==null,zi(t,e,n),Zn=r):zi(t,e,n);break;default:zi(t,e,n)}}function T2(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new L4),e.forEach(function(r){var i=Y4.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Lr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Nn=a.stateNode,Wr=!1;break e;case 3:Nn=a.stateNode.containerInfo,Wr=!0;break e;case 4:Nn=a.stateNode.containerInfo,Wr=!0;break e}a=a.return}if(Nn===null)throw Error(be(160));x3(s,o,i),Nn=null,Wr=!1;var f=i.alternate;f!==null&&(f.return=null),i.return=null}catch(p){An(i,e,p)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)T3(e,t),e=e.sibling}function T3(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Lr(e,t),ei(t),r&4){try{ml(3,t,t.return),nf(3,t)}catch(N){An(t,t.return,N)}try{ml(5,t,t.return)}catch(N){An(t,t.return,N)}}break;case 1:Lr(e,t),ei(t),r&512&&n!==null&&Fo(n,n.return);break;case 5:if(Lr(e,t),ei(t),r&512&&n!==null&&Fo(n,n.return),t.flags&32){var i=t.stateNode;try{Il(i,"")}catch(N){An(t,t.return,N)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,f=t.updateQueue;if(t.updateQueue=null,f!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Xy(i,s),xd(a,o);var p=xd(a,s);for(o=0;o<f.length;o+=2){var m=f[o],v=f[o+1];m==="style"?Zy(i,v):m==="dangerouslySetInnerHTML"?Ky(i,v):m==="children"?Il(i,v):lp(i,m,v,p)}switch(a){case"input":_d(i,s);break;case"textarea":Qy(i,s);break;case"select":var w=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var T=s.value;T!=null?Qo(i,!!s.multiple,T,!1):w!==!!s.multiple&&(s.defaultValue!=null?Qo(i,!!s.multiple,s.defaultValue,!0):Qo(i,!!s.multiple,s.multiple?[]:"",!1))}i[zl]=s}catch(N){An(t,t.return,N)}}break;case 6:if(Lr(e,t),ei(t),r&4){if(t.stateNode===null)throw Error(be(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(N){An(t,t.return,N)}}break;case 3:if(Lr(e,t),ei(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Dl(e.containerInfo)}catch(N){An(t,t.return,N)}break;case 4:Lr(e,t),ei(t);break;case 13:Lr(e,t),ei(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Vp=fn())),r&4&&T2(t);break;case 22:if(m=n!==null&&n.memoizedState!==null,t.mode&1?(Zn=(p=Zn)||m,Lr(e,t),Zn=p):Lr(e,t),ei(t),r&8192){if(p=t.memoizedState!==null,(t.stateNode.isHidden=p)&&!m&&t.mode&1)for(Ve=t,m=t.child;m!==null;){for(v=Ve=m;Ve!==null;){switch(w=Ve,T=w.child,w.tag){case 0:case 11:case 14:case 15:ml(4,w,w.return);break;case 1:Fo(w,w.return);var E=w.stateNode;if(typeof E.componentWillUnmount=="function"){r=w,n=w.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(N){An(r,n,N)}}break;case 5:Fo(w,w.return);break;case 22:if(w.memoizedState!==null){S2(v);continue}}T!==null?(T.return=w,Ve=T):S2(v)}m=m.sibling}e:for(m=null,v=t;;){if(v.tag===5){if(m===null){m=v;try{i=v.stateNode,p?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=v.stateNode,f=v.memoizedProps.style,o=f!=null&&f.hasOwnProperty("display")?f.display:null,a.style.display=qy("display",o))}catch(N){An(t,t.return,N)}}}else if(v.tag===6){if(m===null)try{v.stateNode.nodeValue=p?"":v.memoizedProps}catch(N){An(t,t.return,N)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===t)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===t)break e;for(;v.sibling===null;){if(v.return===null||v.return===t)break e;m===v&&(m=null),v=v.return}m===v&&(m=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:Lr(e,t),ei(t),r&4&&T2(t);break;case 21:break;default:Lr(e,t),ei(t)}}function ei(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(b3(n)){var r=n;break e}n=n.return}throw Error(be(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Il(i,""),r.flags&=-33);var s=x2(t);Jd(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=x2(t);Gd(t,a,o);break;default:throw Error(be(161))}}catch(f){An(t,t.return,f)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function z4(t,e,n){Ve=t,E3(t)}function E3(t,e,n){for(var r=(t.mode&1)!==0;Ve!==null;){var i=Ve,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||LA;if(!o){var a=i.alternate,f=a!==null&&a.memoizedState!==null||Zn;a=LA;var p=Zn;if(LA=o,(Zn=f)&&!p)for(Ve=i;Ve!==null;)o=Ve,f=o.child,o.tag===22&&o.memoizedState!==null?C2(i):f!==null?(f.return=o,Ve=f):C2(i);for(;s!==null;)Ve=s,E3(s),s=s.sibling;Ve=i,LA=a,Zn=p}E2(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Ve=s):E2(t)}}function E2(t){for(;Ve!==null;){var e=Ve;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Zn||nf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Zn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:jr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&A2(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}A2(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var f=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":f.autoFocus&&n.focus();break;case"img":f.src&&(n.src=f.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var p=e.alternate;if(p!==null){var m=p.memoizedState;if(m!==null){var v=m.dehydrated;v!==null&&Dl(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(be(163))}Zn||e.flags&512&&Zd(e)}catch(w){An(e,e.return,w)}}if(e===t){Ve=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ve=n;break}Ve=e.return}}function S2(t){for(;Ve!==null;){var e=Ve;if(e===t){Ve=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ve=n;break}Ve=e.return}}function C2(t){for(;Ve!==null;){var e=Ve;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{nf(4,e)}catch(f){An(e,n,f)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(f){An(e,i,f)}}var s=e.return;try{Zd(e)}catch(f){An(e,s,f)}break;case 5:var o=e.return;try{Zd(e)}catch(f){An(e,o,f)}}}catch(f){An(e,e.return,f)}if(e===t){Ve=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Ve=a;break}Ve=e.return}}var V4=Math.ceil,Yc=Ni.ReactCurrentDispatcher,Up=Ni.ReactCurrentOwner,Pr=Ni.ReactCurrentBatchConfig,vt=0,Rn=null,gn=null,Dn=0,dr=0,Lo=ys(0),wn=0,Xl=null,Ys=0,rf=0,zp=0,_l=null,lr=null,Vp=0,Aa=1/0,_i=null,Kc=!1,e0=null,As=null,UA=!1,Ji=null,qc=0,yl=0,t0=null,gc=-1,mc=0;function rr(){return vt&6?fn():gc!==-1?gc:gc=fn()}function cs(t){return t.mode&1?vt&2&&Dn!==0?Dn&-Dn:T4.transition!==null?(mc===0&&(mc=Av()),mc):(t=Mt,t!==0||(t=window.event,t=t===void 0?16:gv(t.type)),t):1}function Kr(t,e,n,r){if(50<yl)throw yl=0,t0=null,Error(be(185));rA(t,n,r),(!(vt&2)||t!==Rn)&&(t===Rn&&(!(vt&2)&&(rf|=n),wn===4&&Zi(t,Dn)),fr(t,r),n===1&&vt===0&&!(e.mode&1)&&(Aa=fn()+500,Ju&&vs()))}function fr(t,e){var n=t.callbackNode;TS(t,e);var r=Nc(t,t===Rn?Dn:0);if(r===0)n!==null&&Bm(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Bm(n),e===1)t.tag===0?x4(k2.bind(null,t)):Dv(k2.bind(null,t)),y4(function(){!(vt&6)&&vs()}),n=null;else{switch(cv(r)){case 1:n=hp;break;case 4:n=av;break;case 16:n=Mc;break;case 536870912:n=lv;break;default:n=Mc}n=N3(n,S3.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function S3(t,e){if(gc=-1,mc=0,vt&6)throw Error(be(327));var n=t.callbackNode;if(Go()&&t.callbackNode!==n)return null;var r=Nc(t,t===Rn?Dn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Zc(t,r);else{e=r;var i=vt;vt|=2;var s=k3();(Rn!==t||Dn!==e)&&(_i=null,Aa=fn()+500,Us(t,e));do try{$4();break}catch(a){C3(t,a)}while(!0);Sp(),Yc.current=s,vt=i,gn!==null?e=0:(Rn=null,Dn=0,e=wn)}if(e!==0){if(e===2&&(i=kd(t),i!==0&&(r=i,e=n0(t,i))),e===1)throw n=Xl,Us(t,0),Zi(t,r),fr(t,fn()),n;if(e===6)Zi(t,r);else{if(i=t.current.alternate,!(r&30)&&!j4(i)&&(e=Zc(t,r),e===2&&(s=kd(t),s!==0&&(r=s,e=n0(t,s))),e===1))throw n=Xl,Us(t,0),Zi(t,r),fr(t,fn()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(be(345));case 2:Ns(t,lr,_i);break;case 3:if(Zi(t,r),(r&130023424)===r&&(e=Vp+500-fn(),10<e)){if(Nc(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){rr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Bd(Ns.bind(null,t,lr,_i),e);break}Ns(t,lr,_i);break;case 4:if(Zi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Yr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=fn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*V4(r/1960))-r,10<r){t.timeoutHandle=Bd(Ns.bind(null,t,lr,_i),r);break}Ns(t,lr,_i);break;case 5:Ns(t,lr,_i);break;default:throw Error(be(329))}}}return fr(t,fn()),t.callbackNode===n?S3.bind(null,t):null}function n0(t,e){var n=_l;return t.current.memoizedState.isDehydrated&&(Us(t,e).flags|=256),t=Zc(t,e),t!==2&&(e=lr,lr=n,e!==null&&r0(e)),t}function r0(t){lr===null?lr=t:lr.push.apply(lr,t)}function j4(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!qr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Zi(t,e){for(e&=~zp,e&=~rf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Yr(e),r=1<<n;t[n]=-1,e&=~r}}function k2(t){if(vt&6)throw Error(be(327));Go();var e=Nc(t,0);if(!(e&1))return fr(t,fn()),null;var n=Zc(t,e);if(t.tag!==0&&n===2){var r=kd(t);r!==0&&(e=r,n=n0(t,r))}if(n===1)throw n=Xl,Us(t,0),Zi(t,e),fr(t,fn()),n;if(n===6)throw Error(be(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ns(t,lr,_i),fr(t,fn()),null}function jp(t,e){var n=vt;vt|=1;try{return t(e)}finally{vt=n,vt===0&&(Aa=fn()+500,Ju&&vs())}}function Ks(t){Ji!==null&&Ji.tag===0&&!(vt&6)&&Go();var e=vt;vt|=1;var n=Pr.transition,r=Mt;try{if(Pr.transition=null,Mt=1,t)return t()}finally{Mt=r,Pr.transition=n,vt=e,!(vt&6)&&vs()}}function Wp(){dr=Lo.current,Qt(Lo)}function Us(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,_4(n)),gn!==null)for(n=gn.return;n!==null;){var r=n;switch(xp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Lc();break;case 3:aa(),Qt(cr),Qt(Gn),Mp();break;case 5:Ip(r);break;case 4:aa();break;case 13:Qt(en);break;case 19:Qt(en);break;case 10:Cp(r.type._context);break;case 22:case 23:Wp()}n=n.return}if(Rn=t,gn=t=us(t.current,null),Dn=dr=e,wn=0,Xl=null,zp=rf=Ys=0,lr=_l=null,Bs!==null){for(e=0;e<Bs.length;e++)if(n=Bs[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Bs=null}return t}function C3(t,e){do{var n=gn;try{if(Sp(),hc.current=Qc,Xc){for(var r=nn.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Xc=!1}if(Qs=0,Pn=vn=nn=null,gl=!1,Wl=0,Up.current=null,n===null||n.return===null){wn=1,Xl=e,gn=null;break}e:{var s=t,o=n.return,a=n,f=e;if(e=Dn,a.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){var p=f,m=a,v=m.tag;if(!(m.mode&1)&&(v===0||v===11||v===15)){var w=m.alternate;w?(m.updateQueue=w.updateQueue,m.memoizedState=w.memoizedState,m.lanes=w.lanes):(m.updateQueue=null,m.memoizedState=null)}var T=p2(o);if(T!==null){T.flags&=-257,g2(T,o,a,s,e),T.mode&1&&d2(s,p,e),e=T,f=p;var E=e.updateQueue;if(E===null){var N=new Set;N.add(f),e.updateQueue=N}else E.add(f);break e}else{if(!(e&1)){d2(s,p,e),$p();break e}f=Error(be(426))}}else if(Zt&&a.mode&1){var j=p2(o);if(j!==null){!(j.flags&65536)&&(j.flags|=256),g2(j,o,a,s,e),Tp(la(f,a));break e}}s=f=la(f,a),wn!==4&&(wn=2),_l===null?_l=[s]:_l.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var I=c3(s,f,e);l2(s,I);break e;case 1:a=f;var R=s.type,k=s.stateNode;if(!(s.flags&128)&&(typeof R.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(As===null||!As.has(k)))){s.flags|=65536,e&=-e,s.lanes|=e;var B=u3(s,a,e);l2(s,B);break e}}s=s.return}while(s!==null)}R3(n)}catch(Y){e=Y,gn===n&&n!==null&&(gn=n=n.return);continue}break}while(!0)}function k3(){var t=Yc.current;return Yc.current=Qc,t===null?Qc:t}function $p(){(wn===0||wn===3||wn===2)&&(wn=4),Rn===null||!(Ys&268435455)&&!(rf&268435455)||Zi(Rn,Dn)}function Zc(t,e){var n=vt;vt|=2;var r=k3();(Rn!==t||Dn!==e)&&(_i=null,Us(t,e));do try{W4();break}catch(i){C3(t,i)}while(!0);if(Sp(),vt=n,Yc.current=r,gn!==null)throw Error(be(261));return Rn=null,Dn=0,wn}function W4(){for(;gn!==null;)P3(gn)}function $4(){for(;gn!==null&&!pS();)P3(gn)}function P3(t){var e=M3(t.alternate,t,dr);t.memoizedProps=t.pendingProps,e===null?R3(t):gn=e,Up.current=null}function R3(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=F4(n,e),n!==null){n.flags&=32767,gn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{wn=6,gn=null;return}}else if(n=B4(n,e,dr),n!==null){gn=n;return}if(e=e.sibling,e!==null){gn=e;return}gn=e=t}while(e!==null);wn===0&&(wn=5)}function Ns(t,e,n){var r=Mt,i=Pr.transition;try{Pr.transition=null,Mt=1,H4(t,e,n,r)}finally{Pr.transition=i,Mt=r}return null}function H4(t,e,n,r){do Go();while(Ji!==null);if(vt&6)throw Error(be(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(be(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(ES(t,s),t===Rn&&(gn=Rn=null,Dn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||UA||(UA=!0,N3(Mc,function(){return Go(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Pr.transition,Pr.transition=null;var o=Mt;Mt=1;var a=vt;vt|=4,Up.current=null,U4(t,n),T3(n,t),u4(Od),Oc=!!Nd,Od=Nd=null,t.current=n,z4(n),gS(),vt=a,Mt=o,Pr.transition=s}else t.current=n;if(UA&&(UA=!1,Ji=t,qc=i),s=t.pendingLanes,s===0&&(As=null),yS(n.stateNode),fr(t,fn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Kc)throw Kc=!1,t=e0,e0=null,t;return qc&1&&t.tag!==0&&Go(),s=t.pendingLanes,s&1?t===t0?yl++:(yl=0,t0=t):yl=0,vs(),null}function Go(){if(Ji!==null){var t=cv(qc),e=Pr.transition,n=Mt;try{if(Pr.transition=null,Mt=16>t?16:t,Ji===null)var r=!1;else{if(t=Ji,Ji=null,qc=0,vt&6)throw Error(be(331));var i=vt;for(vt|=4,Ve=t.current;Ve!==null;){var s=Ve,o=s.child;if(Ve.flags&16){var a=s.deletions;if(a!==null){for(var f=0;f<a.length;f++){var p=a[f];for(Ve=p;Ve!==null;){var m=Ve;switch(m.tag){case 0:case 11:case 15:ml(8,m,s)}var v=m.child;if(v!==null)v.return=m,Ve=v;else for(;Ve!==null;){m=Ve;var w=m.sibling,T=m.return;if(w3(m),m===p){Ve=null;break}if(w!==null){w.return=T,Ve=w;break}Ve=T}}}var E=s.alternate;if(E!==null){var N=E.child;if(N!==null){E.child=null;do{var j=N.sibling;N.sibling=null,N=j}while(N!==null)}}Ve=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Ve=o;else e:for(;Ve!==null;){if(s=Ve,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ml(9,s,s.return)}var I=s.sibling;if(I!==null){I.return=s.return,Ve=I;break e}Ve=s.return}}var R=t.current;for(Ve=R;Ve!==null;){o=Ve;var k=o.child;if(o.subtreeFlags&2064&&k!==null)k.return=o,Ve=k;else e:for(o=R;Ve!==null;){if(a=Ve,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:nf(9,a)}}catch(Y){An(a,a.return,Y)}if(a===o){Ve=null;break e}var B=a.sibling;if(B!==null){B.return=a.return,Ve=B;break e}Ve=a.return}}if(vt=i,vs(),Ai&&typeof Ai.onPostCommitFiberRoot=="function")try{Ai.onPostCommitFiberRoot(Yu,t)}catch{}r=!0}return r}finally{Mt=n,Pr.transition=e}}return!1}function P2(t,e,n){e=la(n,e),e=c3(t,e,1),t=ls(t,e,1),e=rr(),t!==null&&(rA(t,1,e),fr(t,e))}function An(t,e,n){if(t.tag===3)P2(t,t,n);else for(;e!==null;){if(e.tag===3){P2(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(As===null||!As.has(r))){t=la(n,t),t=u3(e,t,1),e=ls(e,t,1),t=rr(),e!==null&&(rA(e,1,t),fr(e,t));break}}e=e.return}}function X4(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=rr(),t.pingedLanes|=t.suspendedLanes&n,Rn===t&&(Dn&n)===n&&(wn===4||wn===3&&(Dn&130023424)===Dn&&500>fn()-Vp?Us(t,0):zp|=n),fr(t,e)}function I3(t,e){e===0&&(t.mode&1?(e=PA,PA<<=1,!(PA&130023424)&&(PA=4194304)):e=1);var n=rr();t=Pi(t,e),t!==null&&(rA(t,e,n),fr(t,n))}function Q4(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),I3(t,n)}function Y4(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(be(314))}r!==null&&r.delete(e),I3(t,n)}var M3;M3=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||cr.current)Ar=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ar=!1,D4(t,e,n);Ar=!!(t.flags&131072)}else Ar=!1,Zt&&e.flags&1048576&&Bv(e,Vc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;pc(t,e),t=e.pendingProps;var i=ia(e,Gn.current);Zo(e,n),i=Op(null,e,r,t,i,n);var s=Dp();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ur(r)?(s=!0,Uc(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Pp(e),i.updater=tf,e.stateNode=i,i._reactInternals=e,Wd(e,r,t,n),e=Xd(null,e,r,!0,s,n)):(e.tag=0,Zt&&s&&bp(e),nr(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(pc(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=q4(r),t=jr(r,t),i){case 0:e=Hd(null,e,r,t,n);break e;case 1:e=y2(null,e,r,t,n);break e;case 11:e=m2(null,e,r,t,n);break e;case 14:e=_2(null,e,r,jr(r.type,t),n);break e}throw Error(be(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:jr(r,i),Hd(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:jr(r,i),y2(t,e,r,i,n);case 3:e:{if(p3(e),t===null)throw Error(be(387));r=e.pendingProps,s=e.memoizedState,i=s.element,jv(t,e),$c(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=la(Error(be(423)),e),e=v2(t,e,r,n,i);break e}else if(r!==i){i=la(Error(be(424)),e),e=v2(t,e,r,n,i);break e}else for(mr=as(e.stateNode.containerInfo.firstChild),_r=e,Zt=!0,$r=null,n=zv(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(sa(),r===i){e=Ri(t,e,n);break e}nr(t,e,r,n)}e=e.child}return e;case 5:return Wv(e),t===null&&zd(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Dd(r,i)?o=null:s!==null&&Dd(r,s)&&(e.flags|=32),d3(t,e),nr(t,e,o,n),e.child;case 6:return t===null&&zd(e),null;case 13:return g3(t,e,n);case 4:return Rp(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=oa(e,null,r,n):nr(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:jr(r,i),m2(t,e,r,i,n);case 7:return nr(t,e,e.pendingProps,n),e.child;case 8:return nr(t,e,e.pendingProps.children,n),e.child;case 12:return nr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,$t(jc,r._currentValue),r._currentValue=o,s!==null)if(qr(s.value,o)){if(s.children===i.children&&!cr.current){e=Ri(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var f=a.firstContext;f!==null;){if(f.context===r){if(s.tag===1){f=Si(-1,n&-n),f.tag=2;var p=s.updateQueue;if(p!==null){p=p.shared;var m=p.pending;m===null?f.next=f:(f.next=m.next,m.next=f),p.pending=f}}s.lanes|=n,f=s.alternate,f!==null&&(f.lanes|=n),Vd(s.return,n,e),a.lanes|=n;break}f=f.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(be(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Vd(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}nr(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Zo(e,n),i=Nr(i),r=r(i),e.flags|=1,nr(t,e,r,n),e.child;case 14:return r=e.type,i=jr(r,e.pendingProps),i=jr(r.type,i),_2(t,e,r,i,n);case 15:return f3(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:jr(r,i),pc(t,e),e.tag=1,ur(r)?(t=!0,Uc(e)):t=!1,Zo(e,n),A3(e,r,i),Wd(e,r,i,n),Xd(null,e,r,!0,t,n);case 19:return m3(t,e,n);case 22:return h3(t,e,n)}throw Error(be(156,e.tag))};function N3(t,e){return ov(t,e)}function K4(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kr(t,e,n,r){return new K4(t,e,n,r)}function Hp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function q4(t){if(typeof t=="function")return Hp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===cp)return 11;if(t===up)return 14}return 2}function us(t,e){var n=t.alternate;return n===null?(n=kr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function _c(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Hp(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ko:return zs(n.children,i,s,e);case Ap:o=8,i|=8;break;case hd:return t=kr(12,n,e,i|2),t.elementType=hd,t.lanes=s,t;case dd:return t=kr(13,n,e,i),t.elementType=dd,t.lanes=s,t;case pd:return t=kr(19,n,e,i),t.elementType=pd,t.lanes=s,t;case Wy:return sf(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Vy:o=10;break e;case jy:o=9;break e;case cp:o=11;break e;case up:o=14;break e;case Hi:o=16,r=null;break e}throw Error(be(130,t==null?t:typeof t,""))}return e=kr(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function zs(t,e,n,r){return t=kr(7,t,r,e),t.lanes=n,t}function sf(t,e,n,r){return t=kr(22,t,r,e),t.elementType=Wy,t.lanes=n,t.stateNode={isHidden:!1},t}function bh(t,e,n){return t=kr(6,t,null,e),t.lanes=n,t}function xh(t,e,n){return e=kr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Z4(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=rh(0),this.expirationTimes=rh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rh(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Xp(t,e,n,r,i,s,o,a,f){return t=new Z4(t,e,n,a,f),e===1?(e=1,s===!0&&(e|=8)):e=0,s=kr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Pp(s),t}function G4(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Co,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function O3(t){if(!t)return gs;t=t._reactInternals;e:{if(io(t)!==t||t.tag!==1)throw Error(be(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ur(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(be(171))}if(t.tag===1){var n=t.type;if(ur(n))return Ov(t,n,e)}return e}function D3(t,e,n,r,i,s,o,a,f){return t=Xp(n,r,!0,t,i,s,o,a,f),t.context=O3(null),n=t.current,r=rr(),i=cs(n),s=Si(r,i),s.callback=e??null,ls(n,s,i),t.current.lanes=i,rA(t,i,r),fr(t,r),t}function of(t,e,n,r){var i=e.current,s=rr(),o=cs(i);return n=O3(n),e.context===null?e.context=n:e.pendingContext=n,e=Si(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ls(i,e,o),t!==null&&(Kr(t,i,o,s),fc(t,i,o)),o}function Gc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function R2(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Qp(t,e){R2(t,e),(t=t.alternate)&&R2(t,e)}function J4(){return null}var B3=typeof reportError=="function"?reportError:function(t){console.error(t)};function Yp(t){this._internalRoot=t}af.prototype.render=Yp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(be(409));of(t,e,null,null)};af.prototype.unmount=Yp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ks(function(){of(null,t,null,null)}),e[ki]=null}};function af(t){this._internalRoot=t}af.prototype.unstable_scheduleHydration=function(t){if(t){var e=hv();t={blockedOn:null,target:t,priority:e};for(var n=0;n<qi.length&&e!==0&&e<qi[n].priority;n++);qi.splice(n,0,t),n===0&&pv(t)}};function Kp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function lf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function I2(){}function eC(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var p=Gc(o);s.call(p)}}var o=D3(e,r,t,0,null,!1,!1,"",I2);return t._reactRootContainer=o,t[ki]=o.current,Ll(t.nodeType===8?t.parentNode:t),Ks(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var p=Gc(f);a.call(p)}}var f=Xp(t,0,!1,null,null,!1,!1,"",I2);return t._reactRootContainer=f,t[ki]=f.current,Ll(t.nodeType===8?t.parentNode:t),Ks(function(){of(e,f,n,r)}),f}function Af(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var f=Gc(o);a.call(f)}}of(e,o,t,i)}else o=eC(n,e,t,i,r);return Gc(o)}uv=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=rl(e.pendingLanes);n!==0&&(dp(e,n|1),fr(e,fn()),!(vt&6)&&(Aa=fn()+500,vs()))}break;case 13:Ks(function(){var r=Pi(t,1);if(r!==null){var i=rr();Kr(r,t,1,i)}}),Qp(t,1)}};pp=function(t){if(t.tag===13){var e=Pi(t,134217728);if(e!==null){var n=rr();Kr(e,t,134217728,n)}Qp(t,134217728)}};fv=function(t){if(t.tag===13){var e=cs(t),n=Pi(t,e);if(n!==null){var r=rr();Kr(n,t,e,r)}Qp(t,e)}};hv=function(){return Mt};dv=function(t,e){var n=Mt;try{return Mt=t,e()}finally{Mt=n}};Ed=function(t,e,n){switch(e){case"input":if(_d(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Gu(r);if(!i)throw Error(be(90));Hy(r),_d(r,i)}}}break;case"textarea":Qy(t,n);break;case"select":e=n.value,e!=null&&Qo(t,!!n.multiple,e,!1)}};ev=jp;tv=Ks;var tC={usingClientEntryPoint:!1,Events:[sA,Mo,Gu,Gy,Jy,jp]},Ya={findFiberByHostInstance:Ds,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nC={bundleType:Ya.bundleType,version:Ya.version,rendererPackageName:Ya.rendererPackageName,rendererConfig:Ya.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ni.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=iv(t),t===null?null:t.stateNode},findFiberByHostInstance:Ya.findFiberByHostInstance||J4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zA=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zA.isDisabled&&zA.supportsFiber)try{Yu=zA.inject(nC),Ai=zA}catch{}}wr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tC;wr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Kp(e))throw Error(be(200));return G4(t,e,null,n)};wr.createRoot=function(t,e){if(!Kp(t))throw Error(be(299));var n=!1,r="",i=B3;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Xp(t,1,!1,null,null,n,!1,r,i),t[ki]=e.current,Ll(t.nodeType===8?t.parentNode:t),new Yp(e)};wr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(be(188)):(t=Object.keys(t).join(","),Error(be(268,t)));return t=iv(e),t=t===null?null:t.stateNode,t};wr.flushSync=function(t){return Ks(t)};wr.hydrate=function(t,e,n){if(!lf(e))throw Error(be(200));return Af(null,t,e,!0,n)};wr.hydrateRoot=function(t,e,n){if(!Kp(t))throw Error(be(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=B3;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=D3(e,null,t,1,n??null,i,!1,s,o),t[ki]=e.current,Ll(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new af(e)};wr.render=function(t,e,n){if(!lf(e))throw Error(be(200));return Af(null,t,e,!1,n)};wr.unmountComponentAtNode=function(t){if(!lf(t))throw Error(be(40));return t._reactRootContainer?(Ks(function(){Af(null,null,t,!1,function(){t._reactRootContainer=null,t[ki]=null})}),!0):!1};wr.unstable_batchedUpdates=jp;wr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!lf(n))throw Error(be(200));if(t==null||t._reactInternals===void 0)throw Error(be(38));return Af(t,e,n,!1,r)};wr.version="18.3.1-next-f1338f8080-20240426";function F3(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(F3)}catch(t){console.error(t)}}F3(),Fy.exports=wr;var qp=Fy.exports,L3,M2=qp;L3=M2.createRoot,M2.hydrateRoot;function Jc(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const Zp=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),N2=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);N2&&parseFloat(N2[1]);const VA=globalThis,yo=globalThis.process||{},rC=globalThis.navigator||{};function U3(t){var r,i;if(typeof window<"u"&&((r=window.process)==null?void 0:r.type)==="renderer"||typeof process<"u"&&((i=process.versions)!=null&&i.electron))return!0;const n=typeof navigator<"u"&&navigator.userAgent;return!!(n&&n.indexOf("Electron")>=0)}function so(){return!(typeof process=="object"&&String(process)==="[object process]"&&!(process!=null&&process.browser))||U3()}function iC(t){return so()?U3()?"Electron":(rC.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown":"Node"}const z3="4.1.0";function sC(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class oC{constructor(e,n,r="sessionStorage"){this.storage=sC(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function aC(t){let e;return t<10?e=`${t.toFixed(2)}ms`:t<100?e=`${t.toFixed(1)}ms`:t<1e3?e=`${t.toFixed(0)}ms`:e=`${(t/1e3).toFixed(2)}s`,e}function lC(t,e=8){const n=Math.max(e-t.length,0);return`${" ".repeat(n)}${t}`}var eu;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(eu||(eu={}));const AC=10;function O2(t){return typeof t!="string"?t:(t=t.toUpperCase(),eu[t]||eu.WHITE)}function cC(t,e,n){return!so&&typeof t=="string"&&(e&&(t=`\x1B[${O2(e)}m${t}\x1B[39m`),n&&(t=`\x1B[${O2(n)+AC}m${t}\x1B[49m`)),t}function uC(t,e=["constructor"]){const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),i=t;for(const s of r){const o=i[s];typeof o=="function"&&(e.find(a=>s===a)||(i[s]=o.bind(t)))}}function Gp(t,e){if(!t)throw new Error("Assertion failed")}function vo(){var e,n,r;let t;if(so()&&VA.performance)t=(n=(e=VA==null?void 0:VA.performance)==null?void 0:e.now)==null?void 0:n.call(e);else if("hrtime"in yo){const i=(r=yo==null?void 0:yo.hrtime)==null?void 0:r.call(yo);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const wo={debug:so()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},fC={enabled:!0,level:0};function bo(){}const D2={},B2={once:!0};class aA{constructor({id:e}={id:""}){this.VERSION=z3,this._startTs=vo(),this._deltaTs=vo(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new oC(`__probe-${this.id}__`,fC),this.timeStamp(`${this.id} started`),uC(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((vo()-this._startTs).toPrecision(10))}getDelta(){return Number((vo()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){if(!e)throw new Error(n||"Assertion failed")}warn(e){return this._getLogFunction(0,e,wo.warn,arguments,B2)}error(e){return this._getLogFunction(0,e,wo.error,arguments)}deprecated(e,n){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${n}\` instead`)}removed(e,n){return this.error(`\`${e}\` has been removed. Use \`${n}\` instead`)}probe(e,n){return this._getLogFunction(e,n,wo.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,wo.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,wo.debug||wo.info,arguments,B2)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||bo,r&&[r],{tag:dC(n)}):bo}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||bo)}group(e,n,r={collapsed:!1}){const i=F2({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n,r={}){return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||bo)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=V3(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=F2({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,Gp(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=vo();const o=s.tag||s.message;if(s.once&&o)if(!D2[o])D2[o]=vo();else return bo;return n=hC(this.id,s.message,s),r.bind(console,n,...s.args)}return bo}}aA.VERSION=z3;function V3(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Gp(Number.isFinite(e)&&e>=0),e}function F2(t){const{logLevel:e,message:n}=t;t.logLevel=V3(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return Gp(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function hC(t,e,n){if(typeof e=="string"){const r=n.time?lC(aC(n.total)):"";e=n.time?`${t}: ${r}  ${e}`:`${t}: ${e}`,e=cC(e,n.color,n.background)}return e}function dC(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const Th="4.3.2",pC=Th[0]>="0"&&Th[0]<="9"?`v${Th}`:"";function gC(){const t=new aA({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=t,globalThis.loaders.version=pC,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=t,t}const mC=gC();function _C(t,e){return j3(t||{},e)}function j3(t,e,n=0){if(n>3)return e;const r={...t};for(const[i,s]of Object.entries(e))s&&typeof s=="object"&&!Array.isArray(s)?r[i]=j3(r[i]||{},e[i],n+1):r[i]=e[i];return r}const yC="latest";function vC(){var t;return(t=globalThis._loadersgl_)!=null&&t.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.2"),globalThis._loadersgl_.version}const wC=vC();function ms(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Vs=typeof process!="object"||String(process)!=="[object process]"||process.browser,bC=typeof window<"u"&&typeof window.orientation<"u",L2=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);L2&&parseFloat(L2[1]);class xC{constructor(e,n){M(this,"name");M(this,"workerThread");M(this,"isRunning",!0);M(this,"result");M(this,"_resolve",()=>{});M(this,"_reject",()=>{});this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){ms(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){ms(this.isRunning),this.isRunning=!1,this._reject(e)}}class Eh{terminate(){}}const Sh=new Map;function TC(t){ms(t.source&&!t.url||!t.source&&t.url);let e=Sh.get(t.source||t.url);return e||(t.url&&(e=EC(t.url),Sh.set(t.url,e)),t.source&&(e=W3(t.source),Sh.set(t.source,e))),ms(e),e}function EC(t){if(!t.startsWith("http"))return t;const e=SC(t);return W3(e)}function W3(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function SC(t){return`try {
  importScripts('${t}');
} catch (error) {
  console.error(error);
  throw error;
}`}function $3(t,e=!0,n){const r=n||new Set;if(t){if(U2(t))r.add(t);else if(U2(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)$3(t[i],e,r)}}return n===void 0?Array.from(r):[]}function U2(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const Ch=()=>{};class i0{constructor(e){M(this,"name");M(this,"source");M(this,"url");M(this,"terminated",!1);M(this,"worker");M(this,"onMessage");M(this,"onError");M(this,"_loadableURL","");const{name:n,source:r,url:i}=e;ms(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=Ch,this.onError=s=>console.log(s),this.worker=Vs?this._createBrowserWorker():this._createNodeWorker()}static isSupported(){return typeof Worker<"u"&&Vs||typeof Eh<"u"&&!Vs}destroy(){this.onMessage=Ch,this.onError=Ch,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||$3(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+=`worker ${this.name} from ${this.url}. `,e.message&&(n+=`${e.message} in `),e.lineno&&(n+=`:${e.lineno}:${e.colno}`),new Error(n)}_createBrowserWorker(){this._loadableURL=TC({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new Eh(r,{eval:!1})}else if(this.source)e=new Eh(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class CC{constructor(e){M(this,"name","unnamed");M(this,"source");M(this,"url");M(this,"maxConcurrency",1);M(this,"maxMobileConcurrency",1);M(this,"onDebug",()=>{});M(this,"reuseWorkers",!0);M(this,"props",{});M(this,"jobQueue",[]);M(this,"idleQueue",[]);M(this,"count",0);M(this,"isDestroyed",!1);this.source=e.source,this.url=e.url,this.setProps(e)}static isSupported(){return i0.isSupported()}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,n=(i,s,o)=>i.done(o),r=(i,s)=>i.error(s)){const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new xC(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}catch(i){console.error(`Worker exception: ${i}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!Vs||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new i0({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return bC?this.maxMobileConcurrency:this.maxConcurrency}}const kC={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}},Yi=class Yi{constructor(e){M(this,"props");M(this,"workerPools",new Map);this.props={...kC},this.setProps(e),this.workerPools=new Map}static isSupported(){return i0.isSupported()}static getWorkerFarm(e={}){return Yi._workerFarm=Yi._workerFarm||new Yi({}),Yi._workerFarm.setProps(e),Yi._workerFarm}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let s=this.workerPools.get(n);return s||(s=new CC({name:n,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}};M(Yi,"_workerFarm");let tu=Yi;function PC(t,e={}){const n=e[t.id]||{},r=Vs?`${t.id}-worker.js`:`${t.id}-worker-node.js`;let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(Vs?i=`modules/${t.module}/dist/${r}`:i=`modules/${t.module}/src/workers/${t.id}-worker-node.ts`),!i){let s=t.version;s==="latest"&&(s=yC);const o=s?`@${s}`:"";i=`https://unpkg.com/@loaders.gl/${t.module}${o}/dist/${r}`}return ms(i),i}function RC(t,e=wC){ms(t,"no worker provided");const n=t.version;return!(!e||!n)}function IC(t,e){return!tu.isSupported()||!Vs&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function MC(t,e,n,r,i){const s=t.id,o=PC(t,n),f=tu.getWorkerFarm(n).getWorkerPool({name:s,url:o});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const p=await f.startJob("process-on-worker",NC.bind(null,i));return p.postMessage("process",{input:e,options:n,context:r}),await(await p.result).result}async function NC(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:o}=r;try{const a=await t(s,o);e.postMessage("done",{id:i,result:a})}catch(a){const f=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:i,error:f})}break;default:console.warn(`parse-with-worker unknown message ${n}`)}}function OC(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function DC(...t){return BC(t)}function BC(t){const e=t.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),n=e.reduce((s,o)=>s+o.byteLength,0),r=new Uint8Array(n);let i=0;for(const s of e)r.set(s,i),i+=s.byteLength;return r.buffer}async function FC(t){const e=[];for await(const n of t)e.push(n);return DC(...e)}function z2(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class V2{constructor(e,n){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=z2(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(z2()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class cf{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,n="count"){return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const n of Object.values(this.stats))e(n)}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(n=>this._getOrCreate(n))}_getOrCreate(e){const{name:n,type:r}=e;let i=this.stats[n];return i||(e instanceof V2?i=e:i=new V2(n,r),this.stats[n]=i),i}}let LC="";const j2={};function UC(t){for(const e in j2)if(t.startsWith(e)){const n=j2[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t=`${LC}${t}`),t}function zC(t){return t&&typeof t=="object"&&t.isBuffer}function H3(t){if(zC(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function X3(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function VC(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const jC=t=>typeof t=="boolean",vl=t=>typeof t=="function",lA=t=>t!==null&&typeof t=="object",W2=t=>lA(t)&&t.constructor==={}.constructor,WC=t=>!!t&&typeof t[Symbol.iterator]=="function",$C=t=>t&&typeof t[Symbol.asyncIterator]=="function",oo=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,ao=t=>typeof Blob<"u"&&t instanceof Blob,HC=t=>t&&typeof t=="object"&&t.isBuffer,XC=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||lA(t)&&vl(t.tee)&&vl(t.cancel)&&vl(t.getReader),QC=t=>lA(t)&&vl(t.read)&&vl(t.pipe)&&jC(t.readable),Q3=t=>XC(t)||QC(t);class YC extends Error{constructor(n,r){super(n);M(this,"reason");M(this,"url");M(this,"response");this.reason=r.reason,this.url=r.url,this.response=r.response}}const KC=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,qC=/^([-\w.]+\/[-\w.+]+)/;function $2(t,e){return t.toLowerCase()===e.toLowerCase()}function ZC(t){const e=qC.exec(t);return e?e[1]:t}function H2(t){const e=KC.exec(t);return e?e[1]:""}const Y3=/\?.*/;function GC(t){const e=t.match(Y3);return e&&e[0]}function Jp(t){return t.replace(Y3,"")}function JC(t){if(t.length<50)return t;const e=t.slice(t.length-15);return`${t.substr(0,32)}...${e}`}function uf(t){return oo(t)?t.url:ao(t)?t.name||"":typeof t=="string"?t:""}function eg(t){if(oo(t)){const e=t,n=e.headers.get("content-type")||"",r=Jp(e.url);return ZC(n)||H2(r)}return ao(t)?t.type||"":typeof t=="string"?H2(t):""}function ek(t){return oo(t)?t.headers["content-length"]||-1:ao(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function K3(t){if(oo(t))return t;const e={},n=ek(t);n>=0&&(e["content-length"]=String(n));const r=uf(t),i=eg(t);i&&(e["content-type"]=i);const s=await rk(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const o=new Response(t,{headers:e});return Object.defineProperty(o,"url",{value:r}),o}async function tk(t){if(!t.ok)throw await nk(t)}async function nk(t){const e=JC(t.url);let n=`Failed to fetch resource (${t.status}) ${t.statusText}: ${e}`;n=n.length>100?`${n.slice(0,100)}...`:n;const r={reason:t.statusText,url:t.url,response:t};try{const i=t.headers.get("Content-Type");r.reason=!t.bodyUsed&&(i!=null&&i.includes("application/json"))?await t.json():await t.text()}catch{}return new YC(n,r)}async function rk(t){if(typeof t=="string")return`data:,${t.slice(0,5)}`;if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=s=>{var o;return r((o=s==null?void 0:s.target)==null?void 0:o.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5);return`data:base64,${ik(n)}`}return null}function ik(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}function sk(t){return!ok(t)&&!ak(t)}function ok(t){return t.startsWith("http:")||t.startsWith("https:")}function ak(t){return t.startsWith("data:")}async function X2(t,e){var n,r;if(typeof t=="string"){const i=UC(t);return sk(i)&&(n=globalThis.loaders)!=null&&n.fetchNode?(r=globalThis.loaders)==null?void 0:r.fetchNode(i,e):await fetch(i,e)}return await K3(t)}const Q2=new aA({id:"loaders.gl"});class lk{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class Ak{constructor(){M(this,"console");this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const q3={fetch:null,mimeType:void 0,nothrow:!1,log:new Ak,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:Zp,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},ck={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function Z3(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state||(t._state={}),t._state}function G3(){const t=Z3();return t.globalOptions=t.globalOptions||{...q3},t.globalOptions}function uk(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],fk(t,n),dk(e,t,r)}function fk(t,e){Y2(t,null,q3,ck,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};Y2(r,n.id,i,s,e)}}function Y2(t,e,n,r,i){const s=e||"Top level",o=e?`${e}.`:"";for(const a in t){const f=!e&&lA(t[a]),p=a==="baseUri"&&!e,m=a==="workerUrl"&&e;if(!(a in n)&&!p&&!m){if(a in r)Q2.warn(`${s} loader option '${o}${a}' no longer supported, use '${r[a]}'`)();else if(!f){const v=hk(a,i);Q2.warn(`${s} loader option '${o}${a}' not recognized. ${v}`)()}}}}function hk(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(t===s)return`Did you mean '${i.id}.${s}'?`;const o=s.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(r=r||`Did you mean '${i.id}.${s}'?`)}return r}function dk(t,e,n){const i={...t.options||{}};return pk(i,n),i.log===null&&(i.log=new lk),K2(i,G3()),K2(i,e),i}function K2(t,e){for(const n in e)if(n in e){const r=e[n];W2(r)&&W2(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function pk(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function tg(t){return t?(Array.isArray(t)&&(t=t[0]),Array.isArray(t==null?void 0:t.extensions)):!1}function ng(t){Jc(t,"null loader"),Jc(tg(t),"invalid loader");let e;return Array.isArray(t)&&(e=t[1],t=t[0],t={...t,options:{...t.options,...e}}),(t!=null&&t.parseTextSync||t!=null&&t.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const J3=()=>{const t=Z3();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function gk(t){const e=J3();t=Array.isArray(t)?t:[t];for(const n of t){const r=ng(n);e.find(i=>r===i)||e.unshift(r)}}function mk(){return J3()}const _k=/\.([^.]+)$/;async function yk(t,e=[],n,r){if(!ew(t))return null;let i=q2(t,e,{...n,nothrow:!0},r);if(i)return i;if(ao(t)&&(t=await t.slice(0,10).arrayBuffer(),i=q2(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(tw(t));return i}function q2(t,e=[],n,r){if(!ew(t))return null;if(e&&!Array.isArray(e))return ng(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...mk()),wk(i);const s=vk(t,i,n,r);if(!s&&!(n!=null&&n.nothrow))throw new Error(tw(t));return s}function vk(t,e,n,r){const i=uf(t),s=eg(t),o=Jp(i)||(r==null?void 0:r.url);let a=null,f="";return n!=null&&n.mimeType&&(a=kh(e,n==null?void 0:n.mimeType),f=`match forced by supplied MIME type ${n==null?void 0:n.mimeType}`),a=a||bk(e,o),f=f||(a?`matched url ${o}`:""),a=a||kh(e,s),f=f||(a?`matched MIME type ${s}`:""),a=a||Tk(e,t),f=f||(a?`matched initial data ${nw(t)}`:""),n!=null&&n.fallbackMimeType&&(a=a||kh(e,n==null?void 0:n.fallbackMimeType),f=f||(a?`matched fallback MIME type ${s}`:"")),f&&mC.log(1,`selectLoader selected ${a==null?void 0:a.name}: ${f}.`),a}function ew(t){return!(t instanceof Response&&t.status===204)}function tw(t){const e=uf(t),n=eg(t);let r="No valid loader found (";r+=e?`${X3(e)}, `:"no url provided, ",r+=`MIME type: ${n?`"${n}"`:"not provided"}, `;const i=t?nw(t):"";return r+=i?` first bytes: "${i}"`:"first bytes: not available",r+=")",r}function wk(t){for(const e of t)ng(e)}function bk(t,e){const n=e&&_k.exec(e),r=n&&n[1];return r?xk(t,r):null}function xk(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function kh(t,e){var n;for(const r of t)if((n=r.mimeTypes)!=null&&n.some(i=>$2(e,i))||$2(e,`application/x.${r.id}`))return r;return null}function Tk(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(Ek(e,n))return n}else if(ArrayBuffer.isView(e)){if(Z2(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&Z2(e,0,n))return n;return null}function Ek(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function Z2(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>Sk(t,e,n,i))}function Sk(t,e,n,r){if(r instanceof ArrayBuffer)return OC(r,t,r.byteLength);switch(typeof r){case"function":return r(t);case"string":const i=s0(t,e,r.length);return r===i;default:return!1}}function nw(t,e=5){return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?s0(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?s0(t,0,e):""}function s0(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}const Ck=256*1024;function*kk(t,e){const n=(e==null?void 0:e.chunkSize)||Ck;let r=0;const i=new TextEncoder;for(;r<t.length;){const s=Math.min(t.length-r,n),o=t.slice(r,r+s);r+=s,yield i.encode(o)}}const Pk=256*1024;function*Rk(t,e={}){const{chunkSize:n=Pk}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),s=new ArrayBuffer(i),o=new Uint8Array(t,r,i);new Uint8Array(s).set(o),r+=i,yield s}}const Ik=1024*1024;async function*Mk(t,e){const n=(e==null?void 0:e.chunkSize)||Ik;let r=0;for(;r<t.size;){const i=r+n,s=await t.slice(r,i).arrayBuffer();r=i,yield s}}function G2(t,e){return Zp?Nk(t,e):Ok(t)}async function*Nk(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:s,value:o}=await i;if(s)return;yield H3(o)}}catch{n.releaseLock()}}async function*Ok(t,e){for await(const n of t)yield H3(n)}function Dk(t,e){if(typeof t=="string")return kk(t,e);if(t instanceof ArrayBuffer)return Rk(t,e);if(ao(t))return Mk(t,e);if(Q3(t))return G2(t,e);if(oo(t))return G2(t.body,e);throw new Error("makeIterator")}const rw="Cannot convert supplied data type";function Bk(t,e,n){if(e.text&&typeof t=="string")return t;if(HC(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(rw)}async function Fk(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return Bk(t,e);if(ao(t)&&(t=await K3(t)),oo(t)){const i=t;return await tk(i),e.binary?await i.arrayBuffer():await i.text()}if(Q3(t)&&(t=Dk(t,n)),WC(t)||$C(t))return FC(t);throw new Error(rw)}function iw(t,e){const n=G3(),r=t||n;return typeof r.fetch=="function"?r.fetch:lA(r.fetch)?i=>X2(i,r.fetch):e!=null&&e.fetch?e==null?void 0:e.fetch:X2}function Lk(t,e,n){if(n)return n;const r={fetch:iw(e,t),...t};if(r.url){const i=Jp(r.url);r.baseUrl=i,r.queryString=GC(r.url),r.filename=X3(i),r.baseUrl=VC(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function Uk(t,e){if(t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:void 0}async function nu(t,e,n,r){e&&!Array.isArray(e)&&!tg(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const i=uf(t),o=Uk(e,r),a=await yk(t,o,n);return a?(n=uk(n,a,o,i),r=Lk({url:i,_parse:nu,loaders:o},n,r||null),await zk(a,t,n,r)):null}async function zk(t,e,n,r){if(RC(t),n=_C(t.options,n),oo(e)){const s=e,{ok:o,redirected:a,status:f,statusText:p,type:m,url:v}=s,w=Object.fromEntries(s.headers.entries());r.response={headers:w,ok:o,redirected:a,status:f,statusText:p,type:m,url:v}}e=await Fk(e,t,n);const i=t;if(i.parseTextSync&&typeof e=="string")return i.parseTextSync(e,n,r);if(IC(t,n))return await MC(t,e,n,r,nu);if(i.parseText&&typeof e=="string")return await i.parseText(e,n,r);if(i.parse)return await i.parse(e,n,r);throw ms(!i.parseSync),new Error(`${t.id} loader - no parser found and worker is disabled`)}async function ru(t,e,n,r){let i,s;!Array.isArray(e)&&!tg(e)?(i=[],s=e):(i=e,s=n);const o=iw(s);let a=t;return typeof t=="string"&&(a=await o(t)),ao(t)&&(a=await o(t)),Array.isArray(i)?await nu(a,i,s):await nu(a,i,s)}const Vk="4.3.2";var Ey;const jk=(Ey=globalThis.loaders)==null?void 0:Ey.parseImageNode,o0=typeof Image<"u",a0=typeof ImageBitmap<"u",Wk=!!jk,l0=Zp?!0:Wk;function $k(t){switch(t){case"auto":return a0||o0||l0;case"imagebitmap":return a0;case"image":return o0;case"data":return l0;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}function Hk(){if(a0)return"imagebitmap";if(o0)return"image";if(l0)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function Xk(t){const e=Yk(t);if(!e)throw new Error("Not an image");return e}function Qk(t){switch(Xk(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function Yk(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const Kk=/^data:image\/svg\+xml/,qk=/\.svg((\?|#).*)?$/;function rg(t){return t&&(Kk.test(t)||qk.test(t))}function Zk(t,e){if(rg(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return`data:image/svg+xml;base64,${btoa(r)}`}return sw(t,e)}function sw(t,e){if(rg(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function ow(t,e,n){const r=Zk(t,n),i=self.URL||self.webkitURL,s=typeof r!="string"&&i.createObjectURL(r);try{return await Gk(s||r,e)}finally{s&&i.revokeObjectURL(s)}}async function Gk(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=s=>{const o=s instanceof Error?s.message:"error";i(new Error(o))}}catch(s){i(s)}})}const Jk={};let J2=!0;async function eP(t,e,n){let r;rg(n)?r=await ow(t,e,n):r=sw(t,n);const i=e&&e.imagebitmap;return await tP(r,i)}async function tP(t,e=null){if((nP(e)||!J2)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),J2=!1}return await createImageBitmap(t)}function nP(t){for(const e in t||Jk)return!1;return!0}function rP(t){return!aP(t,"ftyp",4)||!(t[8]&96)?null:iP(t)}function iP(t){switch(sP(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function sP(t,e,n){return String.fromCharCode(...t.slice(e,n))}function oP(t){return[...t].map(e=>e.charCodeAt(0))}function aP(t,e,n=0){const r=oP(e);for(let i=0;i<r.length;++i)if(r[i]!==t[i+n])return!1;return!0}const oi=!1,wl=!0;function aw(t){const e=AA(t);return AP(e)||fP(e)||cP(e)||uP(e)||lP(e)}function lP(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=rP(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function AP(t){const e=AA(t);return e.byteLength>=24&&e.getUint32(0,oi)===2303741511?{mimeType:"image/png",width:e.getUint32(16,oi),height:e.getUint32(20,oi)}:null}function cP(t){const e=AA(t);return e.byteLength>=10&&e.getUint32(0,oi)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,wl),height:e.getUint16(8,wl)}:null}function uP(t){const e=AA(t);return e.byteLength>=14&&e.getUint16(0,oi)===16973&&e.getUint32(2,wl)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,wl),height:e.getUint32(22,wl)}:null}function fP(t){const e=AA(t);if(!(e.byteLength>=3&&e.getUint16(0,oi)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=hP();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,oi);if(i.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,oi),width:e.getUint16(s+7,oi)};if(!r.has(o))return null;s+=2,s+=e.getUint16(s,oi)}return null}function hP(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function AA(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function dP(t,e){var i;const{mimeType:n}=aw(t)||{},r=(i=globalThis.loaders)==null?void 0:i.parseImageNode;return Jc(r),await r(t,n)}async function pP(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=n||{},o=gP(i);let a;switch(o){case"imagebitmap":a=await eP(t,e,s);break;case"image":a=await ow(t,e,s);break;case"data":a=await dP(t);break;default:Jc(!1)}return i==="data"&&(a=Qk(a)),a}function gP(t){switch(t){case"auto":case"data":return Hk();default:return $k(t),t}}const mP=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],_P=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],yP={image:{type:"auto",decode:!0}},vP={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:Vk,mimeTypes:_P,extensions:mP,parse:pP,tests:[t=>!!aw(new DataView(t))],options:yP},ut=new aA({id:"deck"});let A0={};function wP(t){A0=t}function qn(t,e,n,r){ut.level>0&&A0[t]&&A0[t].call(null,e,n,r)}function bP(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const xP={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:bP,parseTextSync:JSON.parse};function TP(){const t="9.1.5",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error(`deck.gl - multiple versions detected: ${e} vs ${t}`);return e||(ut.log(1,`deck.gl ${t}`)(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:ut,_registerLoggers:wP},gk([xP,[vP,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const EP=TP();function ig(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const Ph={number:{type:"number",validate(t,e){return Number.isFinite(t)&&typeof e=="object"&&(e.max===void 0||t<=e.max)&&(e.min===void 0||t>=e.min)}},array:{type:"array",validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function SP(t){const e={};for(const[n,r]of Object.entries(t))e[n]=CP(r);return e}function CP(t){let e=e_(t);if(e!=="object")return{value:t,...Ph[e],type:e};if(typeof t=="object")return t?t.type!==void 0?{...t,...Ph[t.type],type:t.type}:t.value===void 0?{type:"object",value:t}:(e=e_(t.value),{...t,...Ph[e],type:e}):{type:"object",value:null};throw new Error("props")}function e_(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const kP=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,PP=`#ifdef MODULE_MATERIAL
  fragColor = material_filterColor(fragColor);
#endif

#ifdef MODULE_LIGHTING
  fragColor = lighting_filterColor(fragColor);
#endif

#ifdef MODULE_FOG
  fragColor = fog_filterColor(fragColor);
#endif

#ifdef MODULE_PICKING
  fragColor = picking_filterHighlightColor(fragColor);
  fragColor = picking_filterPickingColor(fragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,RP={vertex:kP,fragment:PP},t_=/void\s+main\s*\([^)]*\)\s*\{\n?/,n_=/}\n?[^{}]*$/,Rh=[],yc="__LUMA_INJECT_DECLARATIONS__";function IP(t){const e={vertex:{},fragment:{}};for(const n in t){let r=t[n];const i=MP(n);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function MP(t){const e=t.slice(0,2);switch(e){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(e)}}function iu(t,e,n,r=!1){const i=e==="vertex";for(const s in n){const o=n[s];o.sort((f,p)=>f.order-p.order),Rh.length=o.length;for(let f=0,p=o.length;f<p;++f)Rh[f]=o[f].injection;const a=`${Rh.join(`
`)}
`;switch(s){case"vs:#decl":i&&(t=t.replace(yc,a));break;case"vs:#main-start":i&&(t=t.replace(t_,f=>f+a));break;case"vs:#main-end":i&&(t=t.replace(n_,f=>a+f));break;case"fs:#decl":i||(t=t.replace(yc,a));break;case"fs:#main-start":i||(t=t.replace(t_,f=>f+a));break;case"fs:#main-end":i||(t=t.replace(n_,f=>a+f));break;default:t=t.replace(s,f=>f+a)}}return t=t.replace(yc,""),r&&(t=t.replace(/\}\s*$/,s=>s+RP[e])),t}function su(t){t.map(e=>NP(e))}function NP(t){if(t.instance)return;su(t.dependencies||[]);const{propTypes:e={},deprecations:n=[],inject:r={}}=t,i={normalizedInjections:IP(r),parsedDeprecations:OP(n)};e&&(i.propValidators=SP(e)),t.instance=i;let s={};e&&(s=Object.entries(e).reduce((o,[a,f])=>{const p=f==null?void 0:f.value;return p&&(o[a]=p),o},{})),t.defaultUniforms={...t.defaultUniforms,...s}}function lw(t,e,n){var r;(r=t.deprecations)==null||r.forEach(i=>{var s;(s=i.regex)!=null&&s.test(e)&&(i.deprecated?n.deprecated(i.old,i.new)():n.removed(i.old,i.new)())})}function OP(t){return t.forEach(e=>{switch(e.type){case"function":e.regex=new RegExp(`\\b${e.old}\\(`);break;default:e.regex=new RegExp(`${e.type} ${e.old};`)}}),t}function sg(t){su(t);const e={},n={};Aw({modules:t,level:0,moduleMap:e,moduleDepth:n});const r=Object.keys(n).sort((i,s)=>n[s]-n[i]).map(i=>e[i]);return su(r),r}function Aw(t){const{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&Aw({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function DP(t){switch(t==null?void 0:t.gpu.toLowerCase()){case"apple":return`#define APPLE_GPU
// Apple optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Headless Chrome's software shader 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// If the GPU doesn't have full 32 bits precision, will causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function BP(t,e){var r;if(Number(((r=t.match(/^#version[ \t]+(\d+)/m))==null?void 0:r[1])||100)!==300)throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(e){case"vertex":return t=r_(t,FP),t;case"fragment":return t=r_(t,LP),t;default:throw new Error(e)}}const cw=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],FP=[...cw,[c0("attribute"),"in $1"],[c0("varying"),"out $1"]],LP=[...cw,[c0("varying"),"in $1"]];function r_(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function c0(t){return new RegExp(`\\b${t}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function uw(t,e){let n="";for(const r in t){const i=t[r];if(n+=`void ${i.signature} {
`,i.header&&(n+=`  ${i.header}`),e[r]){const s=e[r];s.sort((o,a)=>o.order-a.order);for(const o of s)n+=`  ${o.injection}
`}i.footer&&(n+=`  ${i.footer}`),n+=`}
`}return n}function fw(t){const e={vertex:{},fragment:{}};for(const n of t){let r,i;typeof n!="string"?(r=n,i=r.hook):(r={},i=n),i=i.trim();const[s,o]=i.split(":"),a=i.replace(/\(.+/,""),f=Object.assign(r,{signature:o});switch(s){case"vs":e.vertex[a]=f;break;case"fs":e.fragment[a]=f;break;default:throw new Error(s)}}return e}function UP(t,e){return{name:zP(t,e),language:"glsl",version:VP(t)}}function zP(t,e="unnamed"){const r=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(t);return r?r[1]:e}function VP(t){let e=100;const n=t.match(/[^\s]+/g);if(n&&n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}if(e!==100&&e!==300)throw new Error(`Invalid GLSL version ${e}`);return e}const hw=`

${yc}
`,jP=`precision highp float;
`;function WP(t){const e=sg(t.modules||[]);return{source:HP(t.platformInfo,{...t,source:t.source,stage:"vertex",modules:e}),getUniforms:dw(e)}}function $P(t){const{vs:e,fs:n}=t,r=sg(t.modules||[]);return{vs:i_(t.platformInfo,{...t,source:e,stage:"vertex",modules:r}),fs:i_(t.platformInfo,{...t,source:n,stage:"fragment",modules:r}),getUniforms:dw(r)}}function HP(t,e){var N;const{source:n,stage:r,modules:i,hookFunctions:s=[],inject:o={},log:a}=e;ig(typeof n=="string","shader source must be a string");const f=n;let p="";const m=fw(s),v={},w={},T={};for(const j in o){const I=typeof o[j]=="string"?{injection:o[j],order:0}:o[j],R=/^(v|f)s:(#)?([\w-]+)$/.exec(j);if(R){const k=R[2],B=R[3];k?B==="decl"?w[j]=[I]:T[j]=[I]:v[j]=[I]}else T[j]=[I]}const E=i;for(const j of E){a&&lw(j,f,a);const I=pw(j,"wgsl");p+=I;const R=((N=j.injections)==null?void 0:N[r])||{};for(const k in R){const B=/^(v|f)s:#([\w-]+)$/.exec(k);if(B){const G=B[2]==="decl"?w:T;G[k]=G[k]||[],G[k].push(R[k])}else v[k]=v[k]||[],v[k].push(R[k])}}return p+=hw,p=iu(p,r,w),p+=uw(m[r],v),p+=f,p=iu(p,r,T),p}function i_(t,e){var ce;const{id:n,source:r,stage:i,language:s="glsl",modules:o,defines:a={},hookFunctions:f=[],inject:p={},prologue:m=!0,log:v}=e;ig(typeof r=="string","shader source must be a string");const w=s==="glsl"?UP(r).version:-1,T=t.shaderLanguageVersion,E=w===100?"#version 100":"#version 300 es",j=r.split(`
`).slice(1).join(`
`),I={};o.forEach(U=>{Object.assign(I,U.defines)}),Object.assign(I,a);let R="";switch(s){case"wgsl":break;case"glsl":R=m?`${E}

// ----- PROLOGUE -------------------------
${XP({id:n,source:r,stage:i})}
${`#define SHADER_TYPE_${i.toUpperCase()}`}

${DP(t)}
${i==="fragment"?jP:""}

// ----- APPLICATION DEFINES -------------------------

${QP(I)}

`:`${E}
`;break}const k=fw(f),B={},Y={},G={};for(const U in p){const $=typeof p[U]=="string"?{injection:p[U],order:0}:p[U],K=/^(v|f)s:(#)?([\w-]+)$/.exec(U);if(K){const ue=K[2],ge=K[3];ue?ge==="decl"?Y[U]=[$]:G[U]=[$]:B[U]=[$]}else G[U]=[$]}for(const U of o){v&&lw(U,j,v);const $=pw(U,i);R+=$;const K=((ce=U.instance)==null?void 0:ce.normalizedInjections[i])||{};for(const ue in K){const ge=/^(v|f)s:#([\w-]+)$/.exec(ue);if(ge){const he=ge[2]==="decl"?Y:G;he[ue]=he[ue]||[],he[ue].push(K[ue])}else B[ue]=B[ue]||[],B[ue].push(K[ue])}}return R+="// ----- MAIN SHADER SOURCE -------------------------",R+=hw,R=iu(R,i,Y),R+=uw(k[i],B),R+=j,R=iu(R,i,G),s==="glsl"&&w!==T&&(R=BP(R,i)),R.trim()}function dw(t){return function(n){var i;const r={};for(const s of t){const o=(i=s.getUniforms)==null?void 0:i.call(s,n,r);Object.assign(r,o)}return r}}function XP(t){const{id:e,source:n,stage:r}=t;return e&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME ${e}_${r}`:""}function QP(t={}){let e="";for(const n in t){const r=t[n];(r||Number.isFinite(r))&&(e+=`#define ${n.toUpperCase()} ${t[n]}
`)}return e}function pw(t,e){let n;switch(e){case"vertex":n=t.vs||"";break;case"fragment":n=t.fs||"";break;case"wgsl":n=t.source||"";break;default:ig(!1)}if(!t.name)throw new Error("Shader module must have a name");const r=t.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");let i=`// ----- MODULE ${t.name} ---------------

`;return e!=="wgsl"&&(i+=`#define MODULE_${r}
`),i+=`${n}
`,i}const YP=/^\s*\#\s*ifdef\s*([a-zA-Z_]+)\s*$/,KP=/^\s*\#\s*endif\s*$/;function qP(t,e){var o;const n=t.split(`
`),r=[];let i=!0,s=null;for(const a of n){const f=a.match(YP),p=a.match(KP);f?(s=f[1],i=!!((o=e==null?void 0:e.defines)!=null&&o[s])):p?i=!0:i&&r.push(a)}return r.join(`
`)}const Os=class Os{constructor(){M(this,"_hookFunctions",[]);M(this,"_defaultModules",[])}static getDefaultShaderAssembler(){return Os.defaultShaderAssembler=Os.defaultShaderAssembler||new Os,Os.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(n=>n.name===(typeof e=="string"?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n)}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e)}assembleWGSLShader(e){const n=this._getModuleList(e.modules),r=this._hookFunctions,{source:i,getUniforms:s}=WP({...e,source:e.source,modules:n,hookFunctions:r});return{source:e.platformInfo.shaderLanguage==="wgsl"?qP(i):i,getUniforms:s,modules:n}}assembleGLSLShaderPair(e){const n=this._getModuleList(e.modules),r=this._hookFunctions;return{...$P({...e,vs:e.vs,fs:e.fs,modules:n,hookFunctions:r}),modules:n}}_getModuleList(e=[]){const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],f=a.name;n[i++]=a,r[f]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],f=a.name;r[f]||(n[i++]=a,r[f]=!0)}return n.length=i,su(n),n}};M(Os,"defaultShaderAssembler");let ou=Os;const ZP=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,GP=`#version 300 es
${ZP}`;function JP(t){const{input:e,inputChannels:n,output:r}={};if(!e)return GP;if(!n)throw new Error("inputChannels");const i=eR(n),s=tR(e,n);return`#version 300 es
in ${i} ${e};
out vec4 ${r};
void main() {
  ${r} = ${s};
}`}function eR(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${t}`)}}function tR(t,e){switch(e){case 1:return`vec4(${t}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${t}, 0.0, 1.0)`;case 3:return`vec4(${t}, 1.0)`;case 4:return t;default:throw new Error(`invalid channels: ${e}`)}}class nR{constructor(){M(this,"stats",new Map)}getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new cf({id:e})),this.stats.get(e)}}const gw=new nR,xe=new aA({id:"luma.gl"}),Ih={};function ff(t="id"){Ih[t]=Ih[t]||1;const e=Ih[t]++;return`${t}-${e}`}var ud;let Ot=(ud=class{constructor(e,n,r){M(this,"id");M(this,"props");M(this,"userData",{});M(this,"_device");M(this,"destroyed",!1);M(this,"allocatedBytes",0);M(this,"_attachedResources",new Set);if(!e)throw new Error("no device");this._device=e,this.props=rR(n,r);const i=this.props.id!=="undefined"?this.props.id:ff(this[Symbol.toStringTag]);this.props.id=i,this.id=i,this.userData=this.props.userData||{},this.addStats()}toString(){return`${this[Symbol.toStringTag]||this.constructor.name}:"${this.id}"`}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),n=this[Symbol.toStringTag];e.get(`${n}s Active`).decrementCount()}trackAllocatedMemory(e,n=this[Symbol.toStringTag]){const r=this._device.statsManager.getStats("Resource Counts");r.get("GPU Memory").addCount(e),r.get(`${n} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e=this[Symbol.toStringTag]){const n=this._device.statsManager.getStats("Resource Counts");n.get("GPU Memory").subtractCount(this.allocatedBytes),n.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),n=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${n}s Created`).incrementCount(),e.get(`${n}s Active`).incrementCount()}},M(ud,"defaultProps",{id:"undefined",handle:void 0,userData:void 0}),ud);function rR(t,e){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}const In=class In extends Ot{constructor(n,r){const i={...r};(r.usage||0)&In.INDEX&&!r.indexType&&(r.data instanceof Uint32Array?i.indexType="uint32":r.data instanceof Uint16Array&&(i.indexType="uint16")),delete i.data;super(n,i,In.defaultProps);M(this,"usage");M(this,"indexType");M(this,"updateTimestamp");M(this,"debugData",new ArrayBuffer(0));this.usage=i.usage||0,this.indexType=i.indexType,this.updateTimestamp=n.incrementTimestamp()}get[Symbol.toStringTag](){return"Buffer"}clone(n){return this.device.createBuffer({...this.props,...n})}readSyncWebGL(n,r){throw new Error("not implemented")}_setDebugData(n,r,i){const s=ArrayBuffer.isView(n)?n.buffer:n,o=Math.min(n?n.byteLength:i,In.DEBUG_DATA_MAX_LENGTH);s===null?this.debugData=new ArrayBuffer(o):r===0&&i===s.byteLength?this.debugData=s.slice(0,o):this.debugData=s.slice(r,r+o)}};M(In,"defaultProps",{...Ot.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1}),M(In,"MAP_READ",1),M(In,"MAP_WRITE",2),M(In,"COPY_SRC",4),M(In,"COPY_DST",8),M(In,"INDEX",16),M(In,"VERTEX",32),M(In,"UNIFORM",64),M(In,"STORAGE",128),M(In,"INDIRECT",256),M(In,"QUERY_RESOLVE",512),M(In,"DEBUG_DATA_MAX_LENGTH",32);let Yt=In;function mw(t){const e=s_[t],n=iR(e),r=t.includes("norm"),i=!r&&!t.startsWith("float"),s=t.startsWith("s");return{dataType:s_[t],byteLength:n,integer:i,signed:s,normalized:r}}function iR(t){return sR[t]}const s_={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},sR={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4},Xn="texture-compression-bc",Nt="texture-compression-astc",ti="texture-compression-etc2",oR="texture-compression-etc1-webgl",jA="texture-compression-pvrtc-webgl",Mh="texture-compression-atc-webgl",WA="float32-renderable-webgl",Nh="float16-renderable-webgl",aR="rgb9e5ufloat-renderable-webgl",Oh="snorm8-renderable-webgl",Ka="norm16-renderable-webgl",Dh="snorm16-renderable-webgl",$A="float32-filterable",o_="float16-filterable-webgl";function _w(t){const e=lR[t];if(!e)throw new Error(`Unsupported texture format ${t}`);return e}const lR={r8unorm:{},r8snorm:{render:Oh},r8uint:{},r8sint:{},rg8unorm:{},rg8snorm:{render:Oh},rg8uint:{},rg8sint:{},r16uint:{},r16sint:{},r16float:{render:Nh,filter:"float16-filterable-webgl"},"r16unorm-webgl":{f:Ka},"r16snorm-webgl":{f:Dh},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},"rgb8unorm-webgl":{},"rgb8snorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},rgba8snorm:{render:Oh},rgba8uint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{},rg16sint:{},rg16float:{render:Nh,filter:o_},"rg16unorm-webgl":{render:Ka},"rg16snorm-webgl":{render:Dh},r32uint:{},r32sint:{},r32float:{render:WA,filter:$A},rgb9e5ufloat:{channels:"rgb",packed:!0,render:aR},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:WA},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},"rgb10a2uint-webgl":{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1,wgpu:!1},"rgb16unorm-webgl":{f:Ka},"rgb16snorm-webgl":{f:Ka},rg32uint:{},rg32sint:{},rg32float:{render:!1,filter:$A},rgba16uint:{},rgba16sint:{},rgba16float:{render:Nh,filter:o_},"rgba16unorm-webgl":{render:Ka},"rgba16snorm-webgl":{render:Dh},"rgb32float-webgl":{render:WA,filter:$A},rgba32uint:{},rgba32sint:{},rgba32float:{render:WA,filter:$A},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0},"bc1-rgb-unorm-webgl":{f:Xn},"bc1-rgb-unorm-srgb-webgl":{f:Xn},"bc1-rgba-unorm":{f:Xn},"bc1-rgba-unorm-srgb":{f:Xn},"bc2-rgba-unorm":{f:Xn},"bc2-rgba-unorm-srgb":{f:Xn},"bc3-rgba-unorm":{f:Xn},"bc3-rgba-unorm-srgb":{f:Xn},"bc4-r-unorm":{f:Xn},"bc4-r-snorm":{f:Xn},"bc5-rg-unorm":{f:Xn},"bc5-rg-snorm":{f:Xn},"bc6h-rgb-ufloat":{f:Xn},"bc6h-rgb-float":{f:Xn},"bc7-rgba-unorm":{f:Xn},"bc7-rgba-unorm-srgb":{f:Xn},"etc2-rgb8unorm":{f:ti},"etc2-rgb8unorm-srgb":{f:ti},"etc2-rgb8a1unorm":{f:ti},"etc2-rgb8a1unorm-srgb":{f:ti},"etc2-rgba8unorm":{f:ti},"etc2-rgba8unorm-srgb":{f:ti},"eac-r11unorm":{f:ti},"eac-r11snorm":{f:ti},"eac-rg11unorm":{f:ti},"eac-rg11snorm":{f:ti},"astc-4x4-unorm":{f:Nt},"astc-4x4-unorm-srgb":{f:Nt},"astc-5x4-unorm":{f:Nt},"astc-5x4-unorm-srgb":{f:Nt},"astc-5x5-unorm":{f:Nt},"astc-5x5-unorm-srgb":{f:Nt},"astc-6x5-unorm":{f:Nt},"astc-6x5-unorm-srgb":{f:Nt},"astc-6x6-unorm":{f:Nt},"astc-6x6-unorm-srgb":{f:Nt},"astc-8x5-unorm":{f:Nt},"astc-8x5-unorm-srgb":{f:Nt},"astc-8x6-unorm":{f:Nt},"astc-8x6-unorm-srgb":{f:Nt},"astc-8x8-unorm":{f:Nt},"astc-8x8-unorm-srgb":{f:Nt},"astc-10x5-unorm":{f:Nt},"astc-10x5-unorm-srgb":{f:Nt},"astc-10x6-unorm":{f:Nt},"astc-10x6-unorm-srgb":{f:Nt},"astc-10x8-unorm":{f:Nt},"astc-10x8-unorm-srgb":{f:Nt},"astc-10x10-unorm":{f:Nt},"astc-10x10-unorm-srgb":{f:Nt},"astc-12x10-unorm":{f:Nt},"astc-12x10-unorm-srgb":{f:Nt},"astc-12x12-unorm":{f:Nt},"astc-12x12-unorm-srgb":{f:Nt},"pvrtc-rgb4unorm-webgl":{f:jA},"pvrtc-rgba4unorm-webgl":{f:jA},"pvrtc-rbg2unorm-webgl":{f:jA},"pvrtc-rgba2unorm-webgl":{f:jA},"etc1-rbg-unorm-webgl":{f:oR},"atc-rgb-unorm-webgl":{f:Mh},"atc-rgba-unorm-webgl":{f:Mh},"atc-rgbai-unorm-webgl":{f:Mh}},AR=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],cR=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/;function yw(t){return AR.some(e=>t.startsWith(e))}function og(t){let e=uR(t);if(yw(t)){e.channels="rgb",e.components=3,e.bytesPerPixel=1,e.srgb=!1,e.compressed=!0;const r=fR(t);r&&(e.blockWidth=r.blockWidth,e.blockHeight=r.blockHeight)}const n=cR.exec(t);if(n){const[,r,i,s,o,a]=n,f=`${s}${i}`,p=mw(f),m=p.byteLength*8,v=r.length,w=[m,v>=2?m:0,v>=3?m:0,v>=4?m:0];e={format:t,attachment:e.attachment,dataType:p.dataType,components:v,channels:r,integer:p.integer,signed:p.signed,normalized:p.normalized,bitsPerChannel:w,bytesPerPixel:p.byteLength*r.length,packed:e.packed,srgb:e.srgb},a==="-webgl"&&(e.webgl=!0),o==="-srgb"&&(e.srgb=!0)}return t.endsWith("-webgl")&&(e.webgl=!0),t.endsWith("-srgb")&&(e.srgb=!0),e}function uR(t){var s;const e=_w(t),n=e.bytesPerPixel||1,r=e.bitsPerChannel||[8,8,8,8];return delete e.bitsPerChannel,delete e.bytesPerPixel,delete e.f,delete e.render,delete e.filter,delete e.blend,delete e.store,{...e,format:t,attachment:e.attachment||"color",channels:e.channels||"r",components:e.components||((s=e.channels)==null?void 0:s.length)||1,bytesPerPixel:n,bitsPerChannel:r,dataType:e.dataType||"uint8",srgb:e.srgb??!1,packed:e.packed??!1,webgl:e.webgl??!1,integer:e.integer??!1,signed:e.signed??!1,normalized:e.normalized??!1,compressed:e.compressed??!1}}function fR(t){const n=/.*-(\d+)x(\d+)-.*/.exec(t);if(n){const[,r,i]=n;return{blockWidth:Number(r),blockHeight:Number(i)}}return null}function hR(t){const e=_w(t),n={format:t,create:e.f??!0,render:e.render??!0,filter:e.filter??!0,blend:e.blend??!0,store:e.store??!0},r=og(t),i=t.startsWith("depth")||t.startsWith("stencil"),s=r==null?void 0:r.signed,o=r==null?void 0:r.integer,a=r==null?void 0:r.webgl;return n.render&&(n.render=!s),n.filter&&(n.filter=!i&&!s&&!o&&!a),n}class dR{}class pR{constructor(e=[],n){M(this,"features");M(this,"disabledFeatures");this.features=new Set(e),this.disabledFeatures=n||{}}*[Symbol.iterator](){yield*this.features}has(e){var n;return!((n=this.disabledFeatures)!=null&&n[e])&&this.features.has(e)}}const Mu=class Mu{constructor(e){M(this,"id");M(this,"props");M(this,"userData",{});M(this,"statsManager",gw);M(this,"timestamp",0);M(this,"_reused",!1);M(this,"_lumaData",{});this.props={...Mu.defaultProps,...e},this.id=this.props.id||ff(this[Symbol.toStringTag].toLowerCase())}get[Symbol.toStringTag](){return"Device"}getTextureFormatCapabilities(e){const n=hR(e),r=o=>(typeof o=="string"?this.features.has(o):o)??!0,i=r(n.create),s={format:e,create:i,render:i&&r(n.render),filter:i&&r(n.filter),blend:i&&r(n.blend),store:i&&r(n.store)};return this._getDeviceSpecificTextureFormatCapabilities(s)}isTextureFormatSupported(e,n){return this.getTextureFormatCapabilities(e).create}isTextureFormatFilterable(e){return this.getTextureFormatCapabilities(e).filter}isTextureFormatRenderable(e){return this.getTextureFormatCapabilities(e).render}isTextureFormatCompressed(e){return yw(e)}loseDevice(){return!1}reportError(e){this.props.onError(e)}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}createCommandEncoder(e={}){throw new Error("not implemented")}incrementTimestamp(){return this.timestamp++}onError(e){this.props.onError(e)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(e,n){throw new Error("not implemented")}readPixelsToBufferWebGL(e,n){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,n){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}static _getCanvasContextProps(e){return e.createCanvasContext===!0?{}:e.createCanvasContext}_normalizeBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const n={...e};return(e.usage||0)&Yt.INDEX&&!e.indexType&&(e.data instanceof Uint32Array?n.indexType="uint32":e.data instanceof Uint16Array?n.indexType="uint16":xe.warn("indices buffer content must be of integer type")()),n}};M(Mu,"defaultProps",{id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,onError:e=>xe.error(e.message)(),_reuseDevices:!1,_requestMaxLimits:!0,_factoryDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_resourceDefaults:{},webgl:{},debug:xe.get("debug")||void 0,debugShaders:xe.get("debug-shaders")||void 0,debugFramebuffers:!!xe.get("debug-framebuffers"),debugWebGL:!!xe.get("debug-webgl"),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_handle:void 0});let fs=Mu;const gR=so()&&typeof document<"u",mR=()=>gR&&document.readyState==="complete",_R="set luma.log.level=1 (or higher) to trace rendering",a_="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.",Ki=class Ki{constructor(){M(this,"stats",gw);M(this,"log",xe);M(this,"VERSION","9.1.5");M(this,"spector");M(this,"preregisteredAdapters",new Map);if(globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw xe.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),xe.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");xe.error("This version of luma.gl has already been initialized")()}xe.log(1,`${this.VERSION} - ${_R}`)(),globalThis.luma=this}registerAdapters(e){for(const n of e)this.preregisteredAdapters.set(n.type,n)}getSupportedAdapters(e=[]){const n=this.getAdapterMap(e);return Array.from(n).map(([,r])=>r).filter(r=>{var i;return(i=r.isSupported)==null?void 0:i.call(r)}).map(r=>r.type)}getBestAvailableAdapter(e=[]){var r,i,s,o;const n=this.getAdapterMap(e);return(i=(r=n.get("webgpu"))==null?void 0:r.isSupported)!=null&&i.call(r)?"webgpu":(o=(s=n.get("webgl"))==null?void 0:s.isSupported)!=null&&o.call(s)?"webgl":null}setDefaultDeviceProps(e){Object.assign(Ki.defaultProps,e)}async createDevice(e={}){var a;e={...Ki.defaultProps,...e},e.waitForPageLoad&&await Ki.pageLoaded;const n=this.getAdapterMap(e.adapters);let r=e.type||"";r==="best-available"&&(r=this.getBestAvailableAdapter(e.adapters)||r);const s=(this.getAdapterMap(e.adapters)||n).get(r),o=await((a=s==null?void 0:s.create)==null?void 0:a.call(s,e));if(o)return o;throw new Error(a_)}async attachDevice(e){var o;const n=this.getAdapterMap(e.adapters);let r="";e.handle instanceof WebGL2RenderingContext&&(r="webgl"),e.createCanvasContext&&await Ki.pageLoaded,e.handle===null&&(r="unknown");const i=n.get(r),s=await((o=i==null?void 0:i.attach)==null?void 0:o.call(i,null));if(s)return s;throw new Error(a_)}enforceWebGL2(e=!0,n=[]){var s;const i=this.getAdapterMap(n).get("webgl");i||xe.warn("enforceWebGL2: webgl adapter not found")(),(s=i==null?void 0:i.enforceWebGL2)==null||s.call(i,e)}getAdapterMap(e=[]){const n=new Map(this.preregisteredAdapters);for(const r of e)n.set(r.type,r);return n}registerDevices(e){xe.warn("luma.registerDevices() is deprecated, use luma.registerAdapters() instead");for(const n of e){const r=n.adapter;r&&this.preregisteredAdapters.set(r.type,r)}}};M(Ki,"defaultProps",{...fs.defaultProps,type:"best-available",adapters:void 0,waitForPageLoad:!0}),M(Ki,"pageLoaded",yR().then(()=>{xe.probe(2,"DOM is loaded")()}));let u0=Ki;const f0=new u0;function yR(){return mR()||typeof window>"u"?Promise.resolve():new Promise(t=>{window.addEventListener("load",()=>t())})}class vR{}const Nu=class Nu{constructor(e){M(this,"id");M(this,"props");M(this,"canvas");M(this,"htmlCanvas");M(this,"offscreenCanvas");M(this,"type");M(this,"width",1);M(this,"height",1);M(this,"resizeObserver");M(this,"_canvasSizeInfo",{clientWidth:0,clientHeight:0,devicePixelRatio:1});if(this.props={...Nu.defaultProps,...e},e=this.props,!so()){this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,this.canvas=null;return}if(e.canvas)typeof e.canvas=="string"?this.canvas=bR(e.canvas):this.canvas=e.canvas;else{const n=xR(e),r=wR((e==null?void 0:e.container)||null);r.insertBefore(n,r.firstChild),this.canvas=n,e!=null&&e.visible||(this.canvas.style.visibility="hidden")}this.canvas instanceof HTMLCanvasElement?(this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):(this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas),this.canvas instanceof HTMLCanvasElement&&e.autoResize&&(this.resizeObserver=new ResizeObserver(n=>{for(const r of n)r.target===this.canvas&&this.update()}),this.resizeObserver.observe(this.canvas))}toString(){return`${this[Symbol.toStringTag]}(${this.id})`}getDevicePixelRatio(e){return typeof OffscreenCanvas<"u"&&this.canvas instanceof OffscreenCanvas||(e=e===void 0?this.props.useDevicePixels:e,!e||e<=0)?1:e===!0?typeof window<"u"&&window.devicePixelRatio||1:e}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":const e=this.getDevicePixelRatio(),n=this.canvas;return n.parentElement?[n.clientWidth*e,n.clientHeight*e]:[this.canvas.width,this.canvas.height];default:throw new Error(this.type)}}getAspect(){const[e,n]=this.getPixelSize();return e/n}cssToDeviceRatio(){var e;try{const[n]=this.getDrawingBufferSize(),r=this._canvasSizeInfo.clientWidth||((e=this.htmlCanvas)==null?void 0:e.clientWidth);return r?n/r:1}catch{return 1}}cssToDevicePixels(e,n=!0){const r=this.cssToDeviceRatio(),[i,s]=this.getDrawingBufferSize();return TR(e,r,i,s,n)}setDevicePixelRatio(e,n={}){if(!this.htmlCanvas)return;let r="width"in n?n.width:this.htmlCanvas.clientWidth,i="height"in n?n.height:this.htmlCanvas.clientHeight;(!r||!i)&&(xe.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=this.htmlCanvas.width||1,i=this.htmlCanvas.height||1);const s=this._canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let o=e;const a=Math.floor(r*o),f=Math.floor(i*o);if(this.htmlCanvas.width=a,this.htmlCanvas.height=f,this.device.gl){const[m,v]=this.getDrawingBufferSize();(m!==a||v!==f)&&(o=Math.min(m/r,v/i),this.htmlCanvas.width=Math.floor(r*o),this.htmlCanvas.height=Math.floor(i*o),xe.warn("Device pixel ratio clamped")()),this._canvasSizeInfo.clientWidth=r,this._canvasSizeInfo.clientHeight=i,this._canvasSizeInfo.devicePixelRatio=e}}}getDrawingBufferSize(){const e=this.device.gl;return e?[e.drawingBufferWidth,e.drawingBufferHeight]:this.getPixelSize()}_setAutoCreatedCanvasId(e){var n;((n=this.htmlCanvas)==null?void 0:n.id)==="lumagl-auto-created-canvas"&&(this.htmlCanvas.id=e)}};M(Nu,"defaultProps",{canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb"});let h0=Nu;function wR(t){if(typeof t=="string"){const e=document.getElementById(t);if(!e)throw new Error(`${t} is not an HTML element`);return e}else if(t)return t;return document.body}function bR(t){const e=document.getElementById(t);if(!(e instanceof HTMLCanvasElement))throw new Error("Object is not a canvas element");return e}function xR(t){const{width:e,height:n}=t,r=document.createElement("canvas");return r.id=ff("lumagl-auto-created-canvas"),r.width=e||1,r.height=n||1,r.style.width=Number.isFinite(e)?`${e}px`:"100%",r.style.height=Number.isFinite(n)?`${n}px`:"100%",r}function TR(t,e,n,r,i){const s=t,o=l_(s[0],e,n);let a=A_(s[1],e,r,i),f=l_(s[0]+1,e,n);const p=f===n-1?f:f-1;f=A_(s[1]+1,e,r,i);let m;return i?(f=f===0?f:f+1,m=a,a=f):m=f===r-1?f:f-1,{x:o,y:a,width:Math.max(p-o+1,1),height:Math.max(m-a+1,1)}}function l_(t,e,n){return Math.min(Math.round(t*e),n-1)}function A_(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const Mn=class Mn extends Ot{constructor(n,r){r=Mn.normalizeProps(n,r);super(n,r,Mn.defaultProps);M(this,"dimension");M(this,"format");M(this,"width");M(this,"height");M(this,"depth");M(this,"mipLevels");M(this,"updateTimestamp");if(this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.props.width===void 0||this.props.height===void 0){const i=Mn.getTextureDataSize(this.props.data);this.width=(i==null?void 0:i.width)||1,this.height=(i==null?void 0:i.height)||1}this.props.mipmaps&&this.props.mipLevels===void 0&&(this.props.mipLevels="pyramid"),this.mipLevels=this.props.mipLevels==="pyramid"?Mn.getMipLevelCount(this.width,this.height):this.props.mipLevels||1,this.updateTimestamp=n.incrementTimestamp()}get[Symbol.toStringTag](){return"Texture"}toString(){return`Texture(${this.id},${this.format},${this.width}x${this.height})`}clone(n){return this.device.createTexture({...this.props,...n})}static isExternalImage(n){return typeof ImageData<"u"&&n instanceof ImageData||typeof ImageBitmap<"u"&&n instanceof ImageBitmap||typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement||typeof VideoFrame<"u"&&n instanceof VideoFrame||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}static getExternalImageSize(n){if(typeof ImageData<"u"&&n instanceof ImageData||typeof ImageBitmap<"u"&&n instanceof ImageBitmap||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height};if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)return{width:n.naturalWidth,height:n.naturalHeight};if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)return{width:n.videoWidth,height:n.videoHeight};if(typeof VideoFrame<"u"&&n instanceof VideoFrame)return{width:n.displayWidth,height:n.displayHeight};throw new Error("Unknown image type")}static isTextureLevelData(n){const r=n==null?void 0:n.data;return ArrayBuffer.isView(r)}static getTextureDataSize(n){if(!n||ArrayBuffer.isView(n))return null;if(Array.isArray(n))return Mn.getTextureDataSize(n[0]);if(Mn.isExternalImage(n))return Mn.getExternalImageSize(n);if(n&&typeof n=="object"&&n.constructor===Object){const i=Object.values(n)[0];return{width:i.width,height:i.height}}throw new Error("texture size deduction failed")}static normalizeTextureData(n,r){let i;return ArrayBuffer.isView(n)?i=[{data:n,width:r.width,height:r.height}]:Array.isArray(n)?i=n:i=[n],i}static getMipLevelCount(n,r){return Math.floor(Math.log2(Math.max(n,r)))+1}static getCubeFaceDepth(n){switch(n){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw new Error(n)}}static normalizeProps(n,r){var f,p;const i={...r},s=((p=(f=n==null?void 0:n.props)==null?void 0:f._resourceDefaults)==null?void 0:p.texture)||{};Object.assign(i,s);const{width:o,height:a}=i;return typeof o=="number"&&(i.width=Math.max(1,Math.ceil(o))),typeof a=="number"&&(i.height=Math.max(1,Math.ceil(a))),i}};M(Mn,"COPY_SRC",1),M(Mn,"COPY_DST",2),M(Mn,"TEXTURE",4),M(Mn,"STORAGE",8),M(Mn,"RENDER_ATTACHMENT",16),M(Mn,"CubeFaces",["+X","-X","+Y","-Y","+Z","-Z"]),M(Mn,"defaultProps",{...Ot.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!1,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,sampler:{},view:void 0,flipY:void 0}),M(Mn,"defaultCopyExternalImageOptions",{image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1});let an=Mn;const Ou=class Ou extends Ot{get[Symbol.toStringTag](){return"TextureView"}constructor(e,n){super(e,n,Ou.defaultProps)}};M(Ou,"defaultProps",{...Ot.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0});let au=Ou;function ER(t,e,n){let r="";const i=e.split(/\r?\n/),s=t.slice().sort((o,a)=>o.lineNum-a.lineNum);switch((n==null?void 0:n.showSourceCode)||"no"){case"all":let o=0;for(let a=1;a<=i.length;a++)for(r+=vw(i[a-1],a,n);s.length>o&&s[o].lineNum===a;){const f=s[o++];r+=c_(f,i,f.lineNum,{...n,inlineSource:!1})}return r;case"issues":case"no":for(const a of t)r+=c_(a,i,a.lineNum,{inlineSource:(n==null?void 0:n.showSourceCode)!=="no"});return r}}function c_(t,e,n,r){if(r!=null&&r.inlineSource){const s=SR(e,n),o=t.linePos>0?`${" ".repeat(t.linePos+5)}^^^
`:"";return`
${s}${o}${t.type.toUpperCase()}: ${t.message}

`}const i=t.type==="error"?"red":"#8B4000";return r!=null&&r.html?`<div class='luma-compiler-log-error' style="color:${i};"><b> ${t.type.toUpperCase()}: ${t.message}</b></div>`:`${t.type.toUpperCase()}: ${t.message}`}function SR(t,e,n){let r="";for(let i=e-2;i<=e;i++){const s=t[i-1];s!==void 0&&(r+=vw(s,e,n))}return r}function vw(t,e,n){const r=n!=null&&n.html?kR(t):t;return`${CR(String(e),4)}: ${r}${n!=null&&n.html?"<br/>":`
`}`}function CR(t,e){let n="";for(let r=t.length;r<e;++r)n+=" ";return n+t}function kR(t){return t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}const Du=class Du extends Ot{constructor(n,r){r={...r,debugShaders:r.debugShaders||n.props.debugShaders||"errors"};super(n,{id:PR(r),...r},Du.defaultProps);M(this,"stage");M(this,"source");M(this,"compilationStatus","pending");this.stage=this.props.stage,this.source=this.props.source}get[Symbol.toStringTag](){return"Shader"}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){const n=this.props.debugShaders;switch(n){case"never":return;case"errors":if(this.compilationStatus==="success")return;break}const r=await this.getCompilationInfo();n==="warnings"&&(r==null?void 0:r.length)===0||this._displayShaderLog(r)}_displayShaderLog(n){var p;if(typeof document>"u"||!(document!=null&&document.createElement))return;const r=ww(this.source),i=`${this.stage} ${r}`;let s=ER(n,this.source,{showSourceCode:"all",html:!0});const o=this.getTranslatedSource();o&&(s+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${o}</pre></code>`);const a=document.createElement("Button");a.innerHTML=`
<h1>Shader Compilation Error in ${i}</h1><br /><br />
<code style="user-select:text;"><pre>
${s}
</pre></code>`,a.style.top="10px",a.style.left="10px",a.style.position="absolute",a.style.zIndex="9999",a.style.width="100%",a.style.textAlign="left",document.body.appendChild(a),(p=document.getElementsByClassName("luma-compiler-log-error")[0])==null||p.scrollIntoView(),a.onclick=()=>{const m=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(m)}}};M(Du,"defaultProps",{...Ot.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0});let lu=Du;function PR(t){return ww(t.source)||t.id||ff(`unnamed ${t.stage}-shader`)}function ww(t,e="unnamed"){const r=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(t);return r?r[1]:e}const kl=class kl extends Ot{get[Symbol.toStringTag](){return"Sampler"}constructor(e,n){n=kl.normalizeProps(e,n),super(e,n,kl.defaultProps)}static normalizeProps(e,n){var s,o;const r=((o=(s=e==null?void 0:e.props)==null?void 0:s._resourceDefaults)==null?void 0:o.sampler)||{};return{...n,...r}}};M(kl,"defaultProps",{...Ot.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1});let Au=kl;const Bu=class Bu extends Ot{constructor(n,r={}){super(n,r,Bu.defaultProps);M(this,"width");M(this,"height");this.width=this.props.width,this.height=this.props.height}get[Symbol.toStringTag](){return"Framebuffer"}clone(n){const r=this.colorAttachments.map(s=>s.texture.clone(n)),i=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(n);return this.device.createFramebuffer({...this.props,colorAttachments:r,depthStencilAttachment:i})}resize(n){let r=!n;if(n){const[i,s]=Array.isArray(n)?n:[n.width,n.height];r=r||s!==this.height||i!==this.width,this.width=i,this.height=s}r&&(xe.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map((r,i)=>{if(typeof r=="string"){const s=this.createColorTexture(r,i);return this.attachResource(s),s.view}return r instanceof an?r.view:r});const n=this.props.depthStencilAttachment;if(n)if(typeof n=="string"){const r=this.createDepthStencilTexture(n);this.attachResource(r),this.depthStencilAttachment=r.view}else n instanceof an?this.depthStencilAttachment=n.view:this.depthStencilAttachment=n}createColorTexture(n,r){return this.device.createTexture({id:`${this.id}-color-attachment-${r}`,usage:an.RENDER_ATTACHMENT,format:n,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})}createDepthStencilTexture(n){return this.device.createTexture({id:`${this.id}-depth-stencil-attachment`,usage:an.RENDER_ATTACHMENT,format:n,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments(n,r){for(let i=0;i<this.colorAttachments.length;++i)if(this.colorAttachments[i]){const s=this.colorAttachments[i].texture.clone({width:n,height:r});this.destroyAttachedResource(this.colorAttachments[i]),this.colorAttachments[i]=s.view,this.attachResource(s.view)}if(this.depthStencilAttachment){const i=this.depthStencilAttachment.texture.clone({width:n,height:r});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=i.view,this.attachResource(i)}this.updateAttachments()}};M(Bu,"defaultProps",{...Ot.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null});let cu=Bu;const Fu=class Fu extends Ot{constructor(n,r){super(n,r,Fu.defaultProps);M(this,"shaderLayout");M(this,"bufferLayout");M(this,"linkStatus","pending");M(this,"hash","");this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}get[Symbol.toStringTag](){return"RenderPipeline"}setUniformsWebGL(n){throw new Error("Use uniform blocks")}};M(Fu,"defaultProps",{...Ot.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}});let ca=Fu;const Vr=class Vr extends Ot{get[Symbol.toStringTag](){return"RenderPass"}constructor(e,n){n=Vr.normalizeProps(e,n),super(e,n,Vr.defaultProps)}static normalizeProps(e,n){var s;return{...(s=e.props._resourceDefaults)==null?void 0:s.renderPass,...n}}};M(Vr,"defaultClearColor",[0,0,0,1]),M(Vr,"defaultClearDepth",1),M(Vr,"defaultClearStencil",0),M(Vr,"defaultProps",{...Ot.defaultProps,framebuffer:null,parameters:void 0,clearColor:Vr.defaultClearColor,clearColors:void 0,clearDepth:Vr.defaultClearDepth,clearStencil:Vr.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0});let d0=Vr;const Lu=class Lu extends Ot{constructor(n,r){super(n,r,Lu.defaultProps);M(this,"hash","");M(this,"shaderLayout");this.shaderLayout=r.shaderLayout}get[Symbol.toStringTag](){return"ComputePipeline"}};M(Lu,"defaultProps",{...Ot.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0});let uu=Lu;const Uu=class Uu extends Ot{get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,n){super(e,n,Uu.defaultProps)}};M(Uu,"defaultProps",{...Ot.defaultProps,measureExecutionTime:void 0});let p0=Uu;const zu=class zu extends Ot{get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,n){super(e,n,zu.defaultProps)}};M(zu,"defaultProps",{...Ot.defaultProps});let g0=zu;function RR(t){const[e,n]=MR[t],r=e==="i32"||e==="u32",i=e!=="u32",s=NR[e]*n,o=IR(e,n);return{dataType:e,components:n,defaultVertexFormat:o,byteLength:s,integer:r,signed:i}}function IR(t,e){let n;switch(t){case"f32":n="float32";break;case"i32":n="sint32";break;case"u32":n="uint32";break;case"f16":return e<=2?"float16x2":"float16x4"}return e===1?n:`${n}x${e}`}const MR={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},NR={f32:4,f16:2,i32:4,u32:4};function bw(t){let e;t.endsWith("-webgl")&&(t.replace("-webgl",""),e=!0);const[n,r]=t.split("x"),i=n,s=r?parseInt(r):1,o=mw(i),a={type:i,components:s,byteLength:o.byteLength*s,integer:o.integer,signed:o.signed,normalized:o.normalized};return e&&(a.webglOnly=!0),a}function xw(t,e){const n={};for(const r of t.attributes){const i=DR(t,e,r.name);i&&(n[r.name]=i)}return n}function OR(t,e,n=16){const r=xw(t,e),i=new Array(n).fill(null);for(const s of Object.values(r))i[s.location]=s;return i}function DR(t,e,n){const r=BR(t,n),i=FR(e,n);if(!r)return null;const s=RR(r.type),o=(i==null?void 0:i.vertexFormat)||s.defaultVertexFormat,a=bw(o);return{attributeName:(i==null?void 0:i.attributeName)||r.name,bufferName:(i==null?void 0:i.bufferName)||r.name,location:r.location,shaderType:r.type,shaderDataType:s.dataType,shaderComponents:s.components,vertexFormat:o,bufferDataType:a.type,bufferComponents:a.components,normalized:a.normalized,integer:s.integer,stepMode:(i==null?void 0:i.stepMode)||r.stepMode||"vertex",byteOffset:(i==null?void 0:i.byteOffset)||0,byteStride:(i==null?void 0:i.byteStride)||0}}function BR(t,e){const n=t.attributes.find(r=>r.name===e);return n||xe.warn(`shader layout attribute "${e}" not present in shader`),n||null}function FR(t,e){LR(t);let n=UR(t,e);return n||(n=zR(t,e),n)?n:(xe.warn(`layout for attribute "${e}" not present in buffer layout`),null)}function LR(t){for(const e of t)(e.attributes&&e.format||!e.attributes&&!e.format)&&xe.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function UR(t,e){for(const n of t)if(n.format&&n.name===e)return{attributeName:n.name,bufferName:e,stepMode:n.stepMode,vertexFormat:n.format,byteOffset:0,byteStride:n.byteStride||0};return null}function zR(t,e){var n;for(const r of t){let i=r.byteStride;if(typeof r.byteStride!="number")for(const o of r.attributes||[]){const a=bw(o.format);i+=a.byteLength}const s=(n=r.attributes)==null?void 0:n.find(o=>o.attribute===e);if(s)return{attributeName:s.attribute,bufferName:r.name,stepMode:r.stepMode,vertexFormat:s.format,byteOffset:s.byteOffset,byteStride:i}}return null}const Vu=class Vu extends Ot{constructor(n,r){super(n,r,Vu.defaultProps);M(this,"maxVertexAttributes");M(this,"attributeInfos");M(this,"indexBuffer",null);M(this,"attributes");this.maxVertexAttributes=n.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null);const{shaderLayout:i,bufferLayout:s}=r.renderPipeline||{};if(!i||!s)throw new Error("VertexArray");this.attributeInfos=OR(i,s,this.maxVertexAttributes)}get[Symbol.toStringTag](){return"VertexArray"}setConstantWebGL(n,r){this.device.reportError(new Error("constant attributes not supported"))}};M(Vu,"defaultProps",{...Ot.defaultProps,renderPipeline:null});let m0=Vu;const ju=class ju extends Ot{get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,n){super(e,n,ju.defaultProps)}};M(ju,"defaultProps",{...Ot.defaultProps,layout:void 0,buffers:{}});let _0=ju;const Wu=class Wu extends Ot{get[Symbol.toStringTag](){return"QuerySet"}constructor(e,n){super(e,n,Wu.defaultProps)}};M(Wu,"defaultProps",{...Ot.defaultProps,type:void 0,count:void 0});let y0=Wu;const VR={f32:{type:"f32",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16}};function jR(t){return VR[t]}function WR(t,e){switch(e){case 1:return t;case 2:return t+t%2;default:return t+(4-t%4)%4}}let HA;function Tw(t){return(!HA||HA.byteLength<t)&&(HA=new ArrayBuffer(t)),HA}function $R(t,e){const n=Tw(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function HR(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function fu(t){return Array.isArray(t)?t.length===0||typeof t[0]=="number":HR(t)}const u_=1024;class XR{constructor(e){M(this,"layout",{});M(this,"byteLength");let n=0;for(const[i,s]of Object.entries(e)){const o=jR(s),{type:a,components:f}=o;n=WR(n,f);const p=n;n+=f,this.layout[i]={type:a,size:f,offset:p}}n+=(4-n%4)%4;const r=n*4;this.byteLength=Math.max(r,u_)}getData(e){const n=Math.max(this.byteLength,u_),r=Tw(n),i={i32:new Int32Array(r),u32:new Uint32Array(r),f32:new Float32Array(r),f16:new Uint16Array(r)};for(const[s,o]of Object.entries(e)){const a=this.layout[s];if(!a){xe.warn(`Supplied uniform value ${s} not present in uniform block layout`)();continue}const{type:f,size:p,offset:m}=a,v=i[f];if(p===1){if(typeof o!="number"&&typeof o!="boolean"){xe.warn(`Supplied value for single component uniform ${s} is not a number: ${o}`)();continue}v[m]=Number(o)}else{if(!fu(o)){xe.warn(`Supplied value for multi component / array uniform ${s} is not a numeric array: ${o}`)();continue}v.set(o,m)}}return new Uint8Array(r)}has(e){return!!this.layout[e]}get(e){return this.layout[e]}}function QR(t,e,n=16){if(t!==e)return!1;const r=t,i=e;if(!fu(r))return!1;if(fu(i)&&r.length===i.length){for(let s=0;s<r.length;++s)if(i[s]!==r[s])return!1}return!0}function YR(t){return fu(t)?t.slice():t}class KR{constructor(e){M(this,"name");M(this,"uniforms",{});M(this,"modifiedUniforms",{});M(this,"modified",!0);M(this,"bindingLayout",{});M(this,"needsRedraw","initialized");var n;if(this.name=(e==null?void 0:e.name)||"unnamed",e!=null&&e.name&&(e!=null&&e.shaderLayout)){const r=(n=e==null?void 0:e.shaderLayout.bindings)==null?void 0:n.find(s=>s.type==="uniform"&&s.name===(e==null?void 0:e.name));if(!r)throw new Error(e==null?void 0:e.name);const i=r;for(const s of i.uniforms||[])this.bindingLayout[s.name]=s}}setUniforms(e){for(const[n,r]of Object.entries(e))this._setUniform(n,r),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${n}=${r}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,n){QR(this.uniforms[e],n)||(this.uniforms[e]=YR(n),this.modifiedUniforms[e]=!0,this.modified=!0)}}class qR{constructor(e){M(this,"uniformBlocks",new Map);M(this,"uniformBufferLayouts",new Map);M(this,"uniformBuffers",new Map);for(const[n,r]of Object.entries(e)){const i=n,s=new XR(r.uniformTypes||{});this.uniformBufferLayouts.set(i,s);const o=new KR({name:n});o.setUniforms(r.defaultUniforms||{}),this.uniformBlocks.set(i,o)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){var n;for(const[r,i]of Object.entries(e))(n=this.uniformBlocks.get(r))==null||n.setUniforms(i);this.updateUniformBuffers()}getUniformBufferByteLength(e){var n;return((n=this.uniformBufferLayouts.get(e))==null?void 0:n.byteLength)||0}getUniformBufferData(e){var r,i;const n=((r=this.uniformBlocks.get(e))==null?void 0:r.getAllUniforms())||{};return(i=this.uniformBufferLayouts.get(e))==null?void 0:i.getData(n)}createUniformBuffer(e,n,r){r&&this.setUniforms(r);const i=this.getUniformBufferByteLength(n),s=e.createBuffer({usage:Yt.UNIFORM|Yt.COPY_DST,byteLength:i}),o=this.getUniformBufferData(n);return s.write(o),s}getManagedUniformBuffer(e,n){if(!this.uniformBuffers.get(n)){const r=this.getUniformBufferByteLength(n),i=e.createBuffer({usage:Yt.UNIFORM|Yt.COPY_DST,byteLength:r});this.uniformBuffers.set(n,i)}return this.uniformBuffers.get(n)}updateUniformBuffers(){let e=!1;for(const n of this.uniformBlocks.keys()){const r=this.updateUniformBuffer(n);e||(e=r)}return e&&xe.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){var s;const n=this.uniformBlocks.get(e);let r=this.uniformBuffers.get(e),i=!1;if(r&&(n!=null&&n.needsRedraw)){i||(i=n.needsRedraw);const o=this.getUniformBufferData(e);r=this.uniformBuffers.get(e),r==null||r.write(o);const a=(s=this.uniformBlocks.get(e))==null?void 0:s.getAllUniforms();xe.log(4,`Writing to uniform buffer ${String(e)}`,o,a)()}return i}}function Ew(t){const e=ArrayBuffer.isView(t)?t.constructor:t;switch(e){case Float32Array:return"float32";case Uint16Array:return"uint16";case Uint32Array:return"uint32";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int8Array:return"sint8";case Int16Array:return"sint16";case Int32Array:return"sint32";default:throw new Error(e.constructor.name)}}function Sw(t){switch(t){case"float32":return Float32Array;case"uint32":return Uint32Array;case"sint32":return Int32Array;case"uint16":case"unorm16":return Uint16Array;case"sint16":case"snorm16":return Int16Array;case"uint8":case"unorm8":return Uint8Array;case"sint8":case"snorm8":return Int8Array;default:throw new Error(t)}}function ZR(t,e,n){if(!e||e>4)throw new Error(`size ${e}`);const r=e;let i=Ew(t);if(i==="uint8"&&n&&r===1)return"unorm8-webgl";if(i==="uint8"&&n&&r===3)return"unorm8x3-webgl";if(i==="uint8"||i==="sint8"){if(r===1||r===3)throw new Error(`size: ${e}`);return n&&(i=i.replace("int","norm")),`${i}x${r}`}if(i==="uint16"||i==="sint16"){if(r===1||r===3)throw new Error(`size: ${e}`);return n&&(i=i.replace("int","norm")),`${i}x${r}`}return r===1?i:`${i}x${r}`}class Bh{constructor(e){M(this,"bufferLayouts");this.bufferLayouts=e}getBufferLayout(e){return this.bufferLayouts.find(n=>n.name===e)||null}getAttributeNamesForBuffer(e){var n;return e.attributes?(n=e.attributes)==null?void 0:n.map(r=>r.attribute):[e.name]}mergeBufferLayouts(e,n){const r=[...e];for(const i of n){const s=r.findIndex(o=>o.name===i.name);s<0?r.push(i):r[s]=i}return r}}class Rr{constructor(e,n){this.name=e,this.attributes=n,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}getTypeName(){return this.name}}class f_{constructor(e,n,r){this.name=e,this.type=n,this.attributes=r,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class es extends Rr{constructor(e,n){super(e,n),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class hs extends Rr{constructor(e,n){super(e,n),this.count=0,this.stride=0}get isArray(){return!0}}class qs extends Rr{constructor(e,n,r,i){super(e,r),this.format=n,this.access=i}get isTemplate(){return!0}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}var Qi;(t=>{t[t.Uniform=0]="Uniform",t[t.Storage=1]="Storage",t[t.Texture=2]="Texture",t[t.Sampler=3]="Sampler",t[t.StorageTexture=4]="StorageTexture"})(Qi||(Qi={}));class XA{constructor(e,n,r,i,s,o,a){this.name=e,this.type=n,this.group=r,this.binding=i,this.attributes=s,this.resourceType=o,this.access=a}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class GR{constructor(e,n){this.name=e,this.type=n}}class JR{constructor(e,n,r,i){this.name=e,this.type=n,this.locationType=r,this.location=i,this.interpolation=null}}class h_{constructor(e,n,r,i){this.name=e,this.type=n,this.locationType=r,this.location=i}}class eI{constructor(e,n,r,i){this.name=e,this.type=n,this.attributes=r,this.id=i}}class tI{constructor(e,n,r){this.name=e,this.type=n,this.attributes=r}}class nI{constructor(e,n=null,r){this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=n,this.attributes=r}}class rI{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}const Cw=new Float32Array(1),iI=new Int32Array(Cw.buffer),Qn=new Uint16Array(1);function sI(t){Cw[0]=t;const e=iI[0],n=e>>31&1;let r=e>>23&255,i=8388607&e;if(r===255)return Qn[0]=n<<15|31744|(i!==0?512:0),Qn[0];if(r===0){if(i===0)return Qn[0]=n<<15,Qn[0];i|=8388608;let s=113;for(;!(8388608&i);)i<<=1,s--;return r=127-s,i&=8388607,r>0?(i=(i>>126-r)+(i>>127-r&1),Qn[0]=n<<15|r<<10|i>>13,Qn[0]):(Qn[0]=n<<15,Qn[0])}return r=r-127+15,r>=31?(Qn[0]=n<<15|31744,Qn[0]):r<=0?r<-10?(Qn[0]=n<<15,Qn[0]):(i=(8388608|i)>>1-r,Qn[0]=n<<15|i>>13,Qn[0]):(i>>=13,Qn[0]=n<<15|r<<10|i,Qn[0])}const ag=new Uint32Array(1),kw=new Float32Array(ag.buffer,0,1);function d_(t){const e=112+(t>>6&31)<<23|(63&t)<<17;return ag[0]=e,kw[0]}function oI(t,e,n,r,i,s,o,a,f){const p=r*(o>>=i)*(s>>=i)+n*o+e*a;switch(f){case"r8unorm":return[St(t,p,"8unorm",1)[0]];case"r8snorm":return[St(t,p,"8snorm",1)[0]];case"r8uint":return[St(t,p,"8uint",1)[0]];case"r8sint":return[St(t,p,"8sint",1)[0]];case"rg8unorm":{const m=St(t,p,"8unorm",2);return[m[0],m[1]]}case"rg8snorm":{const m=St(t,p,"8snorm",2);return[m[0],m[1]]}case"rg8uint":{const m=St(t,p,"8uint",2);return[m[0],m[1]]}case"rg8sint":{const m=St(t,p,"8sint",2);return[m[0],m[1]]}case"rgba8unorm-srgb":case"rgba8unorm":{const m=St(t,p,"8unorm",4);return[m[0],m[1],m[2],m[3]]}case"rgba8snorm":{const m=St(t,p,"8snorm",4);return[m[0],m[1],m[2],m[3]]}case"rgba8uint":{const m=St(t,p,"8uint",4);return[m[0],m[1],m[2],m[3]]}case"rgba8sint":{const m=St(t,p,"8sint",4);return[m[0],m[1],m[2],m[3]]}case"bgra8unorm-srgb":case"bgra8unorm":{const m=St(t,p,"8unorm",4);return[m[2],m[1],m[0],m[3]]}case"r16uint":return[St(t,p,"16uint",1)[0]];case"r16sint":return[St(t,p,"16sint",1)[0]];case"r16float":return[St(t,p,"16float",1)[0]];case"rg16uint":{const m=St(t,p,"16uint",2);return[m[0],m[1]]}case"rg16sint":{const m=St(t,p,"16sint",2);return[m[0],m[1]]}case"rg16float":{const m=St(t,p,"16float",2);return[m[0],m[1]]}case"rgba16uint":{const m=St(t,p,"16uint",4);return[m[0],m[1],m[2],m[3]]}case"rgba16sint":{const m=St(t,p,"16sint",4);return[m[0],m[1],m[2],m[3]]}case"rgba16float":{const m=St(t,p,"16float",4);return[m[0],m[1],m[2],m[3]]}case"r32uint":return[St(t,p,"32uint",1)[0]];case"r32sint":return[St(t,p,"32sint",1)[0]];case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return[St(t,p,"32float",1)[0]];case"rg32uint":{const m=St(t,p,"32uint",2);return[m[0],m[1]]}case"rg32sint":{const m=St(t,p,"32sint",2);return[m[0],m[1]]}case"rg32float":{const m=St(t,p,"32float",2);return[m[0],m[1]]}case"rgba32uint":{const m=St(t,p,"32uint",4);return[m[0],m[1],m[2],m[3]]}case"rgba32sint":{const m=St(t,p,"32sint",4);return[m[0],m[1],m[2],m[3]]}case"rgba32float":{const m=St(t,p,"32float",4);return[m[0],m[1],m[2],m[3]]}case"rg11b10ufloat":{const m=new Uint32Array(t.buffer,p,1)[0],v=(4192256&m)>>11,w=(4290772992&m)>>22;return[d_(2047&m),d_(v),function(T){const E=112+(T>>5&31)<<23|(31&T)<<18;return ag[0]=E,kw[0]}(w),1]}}return null}function St(t,e,n,r){const i=[0,0,0,0];for(let p=0;p<r;++p)switch(n){case"8unorm":i[p]=t[e]/255,e++;break;case"8snorm":i[p]=t[e]/255*2-1,e++;break;case"8uint":i[p]=t[e],e++;break;case"8sint":i[p]=t[e]-127,e++;break;case"16uint":i[p]=t[e]|t[e+1]<<8,e+=2;break;case"16sint":i[p]=(t[e]|t[e+1]<<8)-32768,e+=2;break;case"16float":i[p]=(s=t[e]|t[e+1]<<8,o=void 0,a=void 0,f=void 0,o=(32768&s)>>15,f=1023&s,(a=(31744&s)>>10)==0?(o?-1:1)*Math.pow(2,-14)*(f/Math.pow(2,10)):a==31?f?NaN:1/0*(o?-1:1):(o?-1:1)*Math.pow(2,a-15)*(1+f/Math.pow(2,10))),e+=2;break;case"32uint":case"32sint":i[p]=t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24,e+=4;break;case"32float":i[p]=new Float32Array(t.buffer,e,1)[0],e+=4}var s,o,a,f;return i}function Pt(t,e,n,r,i){for(let s=0;s<r;++s)switch(n){case"8unorm":t[e]=255*i[s],e++;break;case"8snorm":t[e]=.5*(i[s]+1)*255,e++;break;case"8uint":t[e]=i[s],e++;break;case"8sint":t[e]=i[s]+127,e++;break;case"16uint":new Uint16Array(t.buffer,e,1)[0]=i[s],e+=2;break;case"16sint":new Int16Array(t.buffer,e,1)[0]=i[s],e+=2;break;case"16float":{const o=sI(i[s]);new Uint16Array(t.buffer,e,1)[0]=o,e+=2;break}case"32uint":new Uint32Array(t.buffer,e,1)[0]=i[s],e+=4;break;case"32sint":new Int32Array(t.buffer,e,1)[0]=i[s],e+=4;break;case"32float":new Float32Array(t.buffer,e,1)[0]=i[s],e+=4}return i}const Fh={r8unorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8snorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8uint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8sint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg8unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8snorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"rgba8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8snorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},bgra8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bgra8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r16uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16float:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg16uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba16uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r32uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg32uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba32uint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32sint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32float:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rg11b10ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},stencil8:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!1,hasStencil:!0,channels:1},depth16unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},depth24plus:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,depthOnlyFormat:"depth32float",channels:1},"depth24plus-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,depthOnlyFormat:"depth32float",channels:1},depth32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},"depth32float-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,stencilOnlyFormat:"depth32float",channels:1},rgb9e5ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bc1-rgba-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc1-rgba-unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc4-r-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc4-r-snorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc5-rg-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc5-rg-snorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc6h-rgb-ufloat":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc6h-rgb-float":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"eac-r11unorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-r11snorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-rg11unorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"eac-rg11snorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"astc-4x4-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-4x4-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x5-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-5x5-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x6-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-6x6-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-8x5-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x5-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x6-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x6-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x8-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-8x8-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-10x5-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x5-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x6-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x6-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x8-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x8-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x10-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-10x10-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x12-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4},"astc-12x12-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4}};class Br{constructor(){this.id=Br._id++,this.line=0}get isAstNode(){return!0}get astNodeType(){return""}search(e){e(this)}searchBlock(e,n){if(e){n(hu.instance);for(const r of e)r instanceof Array?this.searchBlock(r,n):r.search(n);n(du.instance)}}constEvaluate(e,n){throw new Error("Cannot evaluate node")}constEvaluateString(e){return this.constEvaluate(e).toString()}}Br._id=0;class hu extends Br{}hu.instance=new hu;class du extends Br{}du.instance=new du;const Pw=new Set(["all","all","any","select","arrayLength","abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","clamp","cos","cosh","countLeadingZeros","countOneBits","countTrailingZeros","cross","degrees","determinant","distance","dot","dot4U8Packed","dot4I8Packed","exp","exp2","extractBits","faceForward","firstLeadingBit","firstTrailingBit","floor","fma","fract","frexp","insertBits","inverseSqrt","ldexp","length","log","log2","max","min","mix","modf","normalize","pow","quantizeToF16","radians","reflect","refract","reverseBits","round","saturate","sign","sin","sinh","smoothStep","sqrt","step","tan","tanh","transpose","trunc","dpdx","dpdxCoarse","dpdxFine","dpdy","dpdyCoarse","dpdyFine","fwidth","fwidthCoarse","fwidthFine","textureDimensions","textureGather","textureGatherCompare","textureLoad","textureNumLayers","textureNumLevels","textureNumSamples","textureSample","textureSampleBias","textureSampleCompare","textureSampleCompareLevel","textureSampleGrad","textureSampleLevel","textureSampleBaseClampToEdge","textureStore","atomicLoad","atomicStore","atomicAdd","atomicSub","atomicMax","atomicMin","atomicAnd","atomicOr","atomicXor","atomicExchange","atomicCompareExchangeWeak","pack4x8snorm","pack4x8unorm","pack4xI8","pack4xU8","pack4x8Clamp","pack4xU8Clamp","pack2x16snorm","pack2x16unorm","pack2x16float","unpack4x8snorm","unpack4x8unorm","unpack4xI8","unpack4xU8","unpack2x16snorm","unpack2x16unorm","unpack2x16float","storageBarrier","textureBarrier","workgroupBarrier","workgroupUniformLoad","subgroupAdd","subgroupExclusiveAdd","subgroupInclusiveAdd","subgroupAll","subgroupAnd","subgroupAny","subgroupBallot","subgroupBroadcast","subgroupBroadcastFirst","subgroupElect","subgroupMax","subgroupMin","subgroupMul","subgroupExclusiveMul","subgroupInclusiveMul","subgroupOr","subgroupShuffle","subgroupShuffleDown","subgroupShuffleUp","subgroupShuffleXor","subgroupXor","quadBroadcast","quadSwapDiagonal","quadSwapX","quadSwapY"]);class Gt extends Br{constructor(){super()}}class Ql extends Gt{constructor(e,n,r,i,s,o){super(),this.calls=new Set,this.name=e,this.args=n,this.returnType=r,this.body=i,this.startLine=s,this.endLine=o}get astNodeType(){return"function"}search(e){if(this.attributes)for(const n of this.attributes)e(n);e(this);for(const n of this.args)e(n);this.searchBlock(this.body,e)}}class aI extends Gt{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}}class Rw extends Gt{constructor(e,n){super(),this.condition=e,this.body=n}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class v0 extends Gt{constructor(e,n){super(),this.body=e,this.loopId=n}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}class Iw extends Gt{constructor(e,n,r,i){super(),this.init=e,this.condition=n,this.increment=r,this.body=i}get astNodeType(){return"for"}search(e){var n,r,i;(n=this.init)===null||n===void 0||n.search(e),(r=this.condition)===null||r===void 0||r.search(e),(i=this.increment)===null||i===void 0||i.search(e),this.searchBlock(this.body,e)}}class bi extends Gt{constructor(e,n,r,i,s){super(),this.attributes=null,this.name=e,this.type=n,this.storage=r,this.access=i,this.value=s}get astNodeType(){return"var"}search(e){var n;e(this),(n=this.value)===null||n===void 0||n.search(e)}}class lg extends Gt{constructor(e,n,r){super(),this.attributes=null,this.name=e,this.type=n,this.value=r}get astNodeType(){return"override"}search(e){var n;(n=this.value)===null||n===void 0||n.search(e)}}class bl extends Gt{constructor(e,n,r,i,s){super(),this.attributes=null,this.name=e,this.type=n,this.storage=r,this.access=i,this.value=s}get astNodeType(){return"let"}search(e){var n;e(this),(n=this.value)===null||n===void 0||n.search(e)}}class vc extends Gt{constructor(e,n,r,i,s){super(),this.attributes=null,this.name=e,this.type=n,this.storage=r,this.access=i,this.value=s}get astNodeType(){return"const"}constEvaluate(e,n){return this.value.constEvaluate(e,n)}search(e){var n;e(this),(n=this.value)===null||n===void 0||n.search(e)}}var Uo,sl,se,J;(t=>{t.increment="++",t.decrement="--"})(Uo||(Uo={})),(t=>{t.parse=function(e){const n=e;if(n=="parse")throw new Error("Invalid value for IncrementOperator");return t[n]}})(Uo||(Uo={}));class Mw extends Gt{constructor(e,n){super(),this.operator=e,this.variable=n}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}(t=>{t.assign="=",t.addAssign="+=",t.subtractAssin="-=",t.multiplyAssign="*=",t.divideAssign="/=",t.moduloAssign="%=",t.andAssign="&=",t.orAssign="|=",t.xorAssign="^=",t.shiftLeftAssign="<<=",t.shiftRightAssign=">>="})(sl||(sl={})),(t=>{t.parse=function(e){const n=e;if(n=="parse")throw new Error("Invalid value for AssignOperator");return n}})(sl||(sl={}));class Nw extends Gt{constructor(e,n,r){super(),this.operator=e,this.variable=n,this.value=r}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}class Ag extends Gt{constructor(e,n){super(),this.name=e,this.args=n}get astNodeType(){return"call"}isBuiltin(){return Pw.has(this.name)}search(e){for(const n of this.args)n.search(e);e(this)}}class Ow extends Gt{constructor(e,n){super(),this.body=e,this.continuing=n}get astNodeType(){return"loop"}}class Dw extends Gt{constructor(e,n){super(),this.condition=e,this.cases=n}get astNodeType(){return"switch"}}class Bw extends Gt{constructor(e,n,r,i){super(),this.condition=e,this.body=n,this.elseif=r,this.else=i}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class Fw extends Gt{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var n;(n=this.value)===null||n===void 0||n.search(e)}}class lI extends Gt{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class AI extends Gt{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class Lw extends Gt{constructor(e,n){super(),this.severity=e,this.rule=n}get astNodeType(){return"diagnostic"}}class cg extends Gt{constructor(e,n){super(),this.name=e,this.type=n}get astNodeType(){return"alias"}}class cI extends Gt{constructor(){super()}get astNodeType(){return"discard"}}class Uw extends Gt{constructor(){super(),this.condition=null,this.loopId=-1}get astNodeType(){return"break"}}class zw extends Gt{constructor(){super(),this.loopId=-1}get astNodeType(){return"continue"}}class _e extends Gt{constructor(e){super(),this.attributes=null,this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}static maxFormatType(e){let n=e[0];if(n.name==="f32")return n;for(let r=1;r<e.length;++r){const i=_e._priority.get(n.name);_e._priority.get(e[r].name)<i&&(n=e[r])}return n.name==="x32"?_e.i32:n}getTypeName(){return this.name}}_e.x32=new _e("x32"),_e.f32=new _e("f32"),_e.i32=new _e("i32"),_e.u32=new _e("u32"),_e.f16=new _e("f16"),_e.bool=new _e("bool"),_e.void=new _e("void"),_e._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class p_ extends _e{constructor(e){super(e)}}class vi extends _e{constructor(e,n,r,i){super(e),this.members=n,this.startLine=r,this.endLine=i}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let n=0;n<this.members.length;n++)if(this.members[n].name==e)return n;return-1}search(e){for(const n of this.members)e(n)}}class re extends _e{constructor(e,n,r){super(e),this.format=n,this.access=r}get astNodeType(){return"template"}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}re.vec2f=new re("vec2",_e.f32,null),re.vec3f=new re("vec3",_e.f32,null),re.vec4f=new re("vec4",_e.f32,null),re.vec2i=new re("vec2",_e.i32,null),re.vec3i=new re("vec3",_e.i32,null),re.vec4i=new re("vec4",_e.i32,null),re.vec2u=new re("vec2",_e.u32,null),re.vec3u=new re("vec3",_e.u32,null),re.vec4u=new re("vec4",_e.u32,null),re.vec2h=new re("vec2",_e.f16,null),re.vec3h=new re("vec3",_e.f16,null),re.vec4h=new re("vec4",_e.f16,null),re.vec2b=new re("vec2",_e.bool,null),re.vec3b=new re("vec3",_e.bool,null),re.vec4b=new re("vec4",_e.bool,null),re.mat2x2f=new re("mat2x2",_e.f32,null),re.mat2x3f=new re("mat2x3",_e.f32,null),re.mat2x4f=new re("mat2x4",_e.f32,null),re.mat3x2f=new re("mat3x2",_e.f32,null),re.mat3x3f=new re("mat3x3",_e.f32,null),re.mat3x4f=new re("mat3x4",_e.f32,null),re.mat4x2f=new re("mat4x2",_e.f32,null),re.mat4x3f=new re("mat4x3",_e.f32,null),re.mat4x4f=new re("mat4x4",_e.f32,null),re.mat2x2h=new re("mat2x2",_e.f16,null),re.mat2x3h=new re("mat2x3",_e.f16,null),re.mat2x4h=new re("mat2x4",_e.f16,null),re.mat3x2h=new re("mat3x2",_e.f16,null),re.mat3x3h=new re("mat3x3",_e.f16,null),re.mat3x4h=new re("mat3x4",_e.f16,null),re.mat4x2h=new re("mat4x2",_e.f16,null),re.mat4x3h=new re("mat4x3",_e.f16,null),re.mat4x4h=new re("mat4x4",_e.f16,null),re.mat2x2i=new re("mat2x2",_e.i32,null),re.mat2x3i=new re("mat2x3",_e.i32,null),re.mat2x4i=new re("mat2x4",_e.i32,null),re.mat3x2i=new re("mat3x2",_e.i32,null),re.mat3x3i=new re("mat3x3",_e.i32,null),re.mat3x4i=new re("mat3x4",_e.i32,null),re.mat4x2i=new re("mat4x2",_e.i32,null),re.mat4x3i=new re("mat4x3",_e.i32,null),re.mat4x4i=new re("mat4x4",_e.i32,null),re.mat2x2u=new re("mat2x2",_e.u32,null),re.mat2x3u=new re("mat2x3",_e.u32,null),re.mat2x4u=new re("mat2x4",_e.u32,null),re.mat3x2u=new re("mat3x2",_e.u32,null),re.mat3x3u=new re("mat3x3",_e.u32,null),re.mat3x4u=new re("mat3x4",_e.u32,null),re.mat4x2u=new re("mat4x2",_e.u32,null),re.mat4x3u=new re("mat4x3",_e.u32,null),re.mat4x4u=new re("mat4x4",_e.u32,null);class Lh extends _e{constructor(e,n,r,i){super(e),this.storage=n,this.type=r,this.access=i}get astNodeType(){return"pointer"}}class xl extends _e{constructor(e,n,r,i){super(e),this.attributes=n,this.format=r,this.count=i}get astNodeType(){return"array"}get isArray(){return!0}}class ol extends _e{constructor(e,n,r){super(e),this.format=n,this.access=r}get astNodeType(){return"sampler"}}class hi extends Br{constructor(){super(),this.postfix=null}}class Zs extends hi{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}constEvaluateString(){return this.value}}class ii extends hi{constructor(e,n){super(),this.type=e,this.args=n}get astNodeType(){return"createExpr"}search(e){if(e(this),this.args)for(const n of this.args)n.search(e)}constEvaluate(e,n){return n&&(n[0]=this.type),e.evalExpression(this,e.context)}}class ug extends hi{constructor(e,n){super(),this.cachedReturnValue=null,this.name=e,this.args=n}get astNodeType(){return"callExpr"}setCachedReturnValue(e){this.cachedReturnValue=e}get isBuiltin(){return Pw.has(this.name)}constEvaluate(e,n){return e.evalExpression(this,e.context)}search(e){for(const n of this.args)n.search(e);e(this)}}class gr extends hi{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}constEvaluate(e,n){return e.evalExpression(this,e.context)}}class Vw extends hi{constructor(e,n){super(),this.name=e,this.initializer=n}get astNodeType(){return"constExpr"}constEvaluate(e,n){if(this.initializer){const r=e.evalExpression(this.initializer,e.context);return r!==null&&this.postfix?r.getSubData(e,this.postfix,e.context):r}return null}search(e){this.initializer.search(e)}}class _n extends hi{constructor(e,n){super(),this.value=e,this.type=n}get astNodeType(){return"literalExpr"}constEvaluate(e,n){return n!==void 0&&(n[0]=this.type),this.value}get isScalar(){return this.value instanceof Z}get isVector(){return this.value instanceof W||this.value instanceof Ye}get scalarValue(){return this.value instanceof Z?this.value.value:(console.error("Value is not scalar."),0)}get vectorValue(){return this.value instanceof W||this.value instanceof Ye?this.value.data:(console.error("Value is not a vector or matrix."),new Float32Array(0))}}class jw extends hi{constructor(e,n){super(),this.type=e,this.value=n}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}}class ua extends hi{constructor(e){super(),this.index=e}search(e){this.index.search(e)}}class Ww extends hi{constructor(){super()}}class pn extends Ww{constructor(e,n){super(),this.operator=e,this.right=n}get astNodeType(){return"unaryOp"}constEvaluate(e,n){return e.evalExpression(this,e.context)}search(e){this.right.search(e)}}class zr extends Ww{constructor(e,n,r){super(),this.operator=e,this.left=n,this.right=r}get astNodeType(){return"binaryOp"}_getPromotedType(e,n){return e.name===n.name?e:e.name==="f32"||n.name==="f32"?_e.f32:e.name==="u32"||n.name==="u32"?_e.u32:_e.i32}constEvaluate(e,n){return e.evalExpression(this,e.context)}search(e){this.left.search(e),this.right.search(e)}}class $w extends Br{constructor(e){super(),this.body=e}}class wc extends hi{constructor(){super()}get astNodeType(){return"default"}}class Hw extends $w{constructor(e,n){super(n),this.selectors=e}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}}class Xw extends $w{constructor(e){super(e)}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class g_ extends Br{constructor(e,n,r){super(),this.name=e,this.type=n,this.attributes=r}get astNodeType(){return"argument"}}class uI extends Br{constructor(e,n){super(),this.condition=e,this.body=n}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class m_ extends Br{constructor(e,n,r){super(),this.name=e,this.type=n,this.attributes=r}get astNodeType(){return"member"}}class Qw extends Br{constructor(e,n){super(),this.name=e,this.value=n}get astNodeType(){return"attribute"}}class Dr{constructor(e,n){this.parent=null,this.typeInfo=e,this.parent=n,this.id=Dr._id++}clone(){throw`Clone: Not implemented for ${this.constructor.name}`}setDataValue(e,n,r,i){console.error(`SetDataValue: Not implemented for ${this.constructor.name}`)}getSubData(e,n,r){return console.error(`GetDataValue: Not implemented for ${this.constructor.name}`),null}toString(){return`<${this.typeInfo.name}>`}}Dr._id=0;class w0 extends Dr{constructor(){super(new Rr("void",null),null)}toString(){return"void"}}w0.void=new w0;class xo extends Dr{constructor(e){super(new Rr("pointer",null),null),this.reference=e}clone(){return this}setDataValue(e,n,r,i){this.reference.setDataValue(e,n,r,i)}getSubData(e,n,r){return n?this.reference.getSubData(e,n,r):this}}class Z extends Dr{constructor(e,n,r=null){super(n,r),e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array?this.data=e:this.typeInfo.name==="x32"?e-Math.floor(e)!=0?this.data=new Float32Array([e]):this.data=e>=0?new Uint32Array([e]):new Int32Array([e]):this.typeInfo.name==="i32"||this.typeInfo.name==="bool"?this.data=new Int32Array([e]):this.typeInfo.name==="u32"?this.data=new Uint32Array([e]):this.typeInfo.name==="f32"||this.typeInfo.name==="f16"?this.data=new Float32Array([e]):console.error("ScalarData2: Invalid type",n)}clone(){if(this.data instanceof Float32Array)return new Z(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new Z(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new Z(new Uint32Array(this.data),this.typeInfo,null);throw"ScalarData: Invalid data type"}get value(){return this.data[0]}set value(e){this.data[0]=e}setDataValue(e,n,r,i){if(r)return void console.error("SetDataValue: Scalar data does not support postfix",r);if(!(n instanceof Z))return void console.error("SetDataValue: Invalid value",n);let s=n.data[0];this.typeInfo.name==="i32"||this.typeInfo.name==="u32"?s=Math.floor(s):this.typeInfo.name==="bool"&&(s=s?1:0),this.data[0]=s}getSubData(e,n,r){return n?(console.error("getSubData: Scalar data does not support postfix",n),null):this}toString(){return`${this.value}`}}function fI(t,e,n){const r=e.length;return r===2?n==="f32"?new W(new Float32Array(e),t.getTypeInfo("vec2f")):n==="i32"||n==="bool"?new W(new Int32Array(e),t.getTypeInfo("vec2i")):n==="u32"?new W(new Uint32Array(e),t.getTypeInfo("vec2u")):n==="f16"?new W(new Float32Array(e),t.getTypeInfo("vec2h")):(console.error(`getSubData: Unknown format ${n}`),null):r===3?n==="f32"?new W(new Float32Array(e),t.getTypeInfo("vec3f")):n==="i32"||n==="bool"?new W(new Int32Array(e),t.getTypeInfo("vec3i")):n==="u32"?new W(new Uint32Array(e),t.getTypeInfo("vec3u")):n==="f16"?new W(new Float32Array(e),t.getTypeInfo("vec3h")):(console.error(`getSubData: Unknown format ${n}`),null):r===4?n==="f32"?new W(new Float32Array(e),t.getTypeInfo("vec4f")):n==="i32"||n==="bool"?new W(new Int32Array(e),t.getTypeInfo("vec4i")):n==="u32"?new W(new Uint32Array(e),t.getTypeInfo("vec4u")):n==="f16"?new W(new Float32Array(e),t.getTypeInfo("vec4h")):(console.error(`getSubData: Unknown format ${n}`),null):(console.error(`getSubData: Invalid vector size ${e.length}`),null)}class W extends Dr{constructor(e,n,r=null){if(super(n,r),e instanceof Float32Array||e instanceof Uint32Array||e instanceof Int32Array)this.data=e;else{const i=this.typeInfo.name;i==="vec2f"||i==="vec3f"||i==="vec4f"?this.data=new Float32Array(e):i==="vec2i"||i==="vec3i"||i==="vec4i"?this.data=new Int32Array(e):i==="vec2u"||i==="vec3u"||i==="vec4u"?this.data=new Uint32Array(e):i==="vec2h"||i==="vec3h"||i==="vec4h"?this.data=new Float32Array(e):i==="vec2b"||i==="vec3b"||i==="vec4b"?this.data=new Int32Array(e):i==="vec2"||i==="vec3"||i==="vec4"?this.data=new Float32Array(e):console.error(`VectorData: Invalid type ${i}`)}}clone(){if(this.data instanceof Float32Array)return new W(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new W(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new W(new Uint32Array(this.data),this.typeInfo,null);throw"VectorData: Invalid data type"}setDataValue(e,n,r,i){r instanceof Zs?console.error("TODO: Set vector postfix"):n instanceof W?this.data=n.data:console.error("SetDataValue: Invalid value",n)}getSubData(e,n,r){if(n===null)return this;let i=e.getTypeInfo("f32");if(this.typeInfo instanceof qs)i=this.typeInfo.format||i;else{const o=this.typeInfo.name;o==="vec2f"||o==="vec3f"||o==="vec4f"?i=e.getTypeInfo("f32"):o==="vec2i"||o==="vec3i"||o==="vec4i"?i=e.getTypeInfo("i32"):o==="vec2b"||o==="vec3b"||o==="vec4b"?i=e.getTypeInfo("bool"):o==="vec2u"||o==="vec3u"||o==="vec4u"?i=e.getTypeInfo("u32"):o==="vec2h"||o==="vec3h"||o==="vec4h"?i=e.getTypeInfo("f16"):console.error(`GetSubData: Unknown type ${o}`)}let s=this;for(;n!==null&&s!==null;){if(n instanceof ua){const o=n.index;let a=-1;if(o instanceof _n){if(!(o.value instanceof Z))return console.error(`GetSubData: Invalid array index ${o.value}`),null;a=o.value.value}else{const f=e.evalExpression(o,r);if(!(f instanceof Z))return console.error("GetSubData: Unknown index type",o),null;a=f.value}if(a<0||a>=s.data.length)return console.error("GetSubData: Index out of range",a),null;if(s.data instanceof Float32Array){const f=new Float32Array(s.data.buffer,s.data.byteOffset+4*a,1);return new Z(f,i)}if(s.data instanceof Int32Array){const f=new Int32Array(s.data.buffer,s.data.byteOffset+4*a,1);return new Z(f,i)}if(s.data instanceof Uint32Array){const f=new Uint32Array(s.data.buffer,s.data.byteOffset+4*a,1);return new Z(f,i)}throw"GetSubData: Invalid data type"}if(!(n instanceof Zs))return console.error("GetSubData: Unknown postfix",n),null;{const o=n.value.toLowerCase();if(o.length===1){let f=0;if(o==="x"||o==="r")f=0;else if(o==="y"||o==="g")f=1;else if(o==="z"||o==="b")f=2;else{if(o!=="w"&&o!=="a")return console.error(`GetSubData: Unknown member ${o}`),null;f=3}if(this.data instanceof Float32Array){let p=new Float32Array(this.data.buffer,this.data.byteOffset+4*f,1);return new Z(p,i,this)}if(this.data instanceof Int32Array){let p=new Int32Array(this.data.buffer,this.data.byteOffset+4*f,1);return new Z(p,i,this)}if(this.data instanceof Uint32Array){let p=new Uint32Array(this.data.buffer,this.data.byteOffset+4*f,1);return new Z(p,i,this)}}const a=[];for(const f of o)f==="x"||f==="r"?a.push(this.data[0]):f==="y"||f==="g"?a.push(this.data[1]):f==="z"||f==="b"?a.push(this.data[2]):f==="w"||f==="a"?a.push(this.data[3]):console.error(`GetDataValue: Unknown member ${f}`);s=fI(e,a,i.name)}n=n.postfix}return s}toString(){let e=`${this.data[0]}`;for(let n=1;n<this.data.length;++n)e+=`, ${this.data[n]}`;return e}}class Ye extends Dr{constructor(e,n,r=null){super(n,r),e instanceof Float32Array?this.data=e:this.data=new Float32Array(e)}clone(){return new Ye(new Float32Array(this.data),this.typeInfo,null)}setDataValue(e,n,r,i){r instanceof Zs?console.error("TODO: Set matrix postfix"):n instanceof Ye?this.data=n.data:console.error("SetDataValue: Invalid value",n)}getSubData(e,n,r){if(n===null)return this;const i=this.typeInfo.name;if(e.getTypeInfo("f32"),this.typeInfo instanceof qs)this.typeInfo.format;else if(i.endsWith("f"))e.getTypeInfo("f32");else if(i.endsWith("i"))e.getTypeInfo("i32");else if(i.endsWith("u"))e.getTypeInfo("u32");else{if(!i.endsWith("h"))return console.error(`GetDataValue: Unknown type ${i}`),null;e.getTypeInfo("f16")}if(n instanceof ua){const s=n.index;let o=-1;if(s instanceof _n){if(!(s.value instanceof Z))return console.error(`GetDataValue: Invalid array index ${s.value}`),null;o=s.value.value}else{const p=e.evalExpression(s,r);if(!(p instanceof Z))return console.error("GetDataValue: Unknown index type",s),null;o=p.value}if(o<0||o>=this.data.length)return console.error("GetDataValue: Index out of range",o),null;const a=i.endsWith("h")?"h":"f";let f;if(i==="mat2x2"||i==="mat2x2f"||i==="mat2x2h"||i==="mat3x2"||i==="mat3x2f"||i==="mat3x2h"||i==="mat4x2"||i==="mat4x2f"||i==="mat4x2h")f=new W(new Float32Array(this.data.buffer,this.data.byteOffset+2*o*4,2),e.getTypeInfo(`vec2${a}`));else if(i==="mat2x3"||i==="mat2x3f"||i==="mat2x3h"||i==="mat3x3"||i==="mat3x3f"||i==="mat3x3h"||i==="mat4x3"||i==="mat4x3f"||i==="mat4x3h")f=new W(new Float32Array(this.data.buffer,this.data.byteOffset+3*o*4,3),e.getTypeInfo(`vec3${a}`));else{if(i!=="mat2x4"&&i!=="mat2x4f"&&i!=="mat2x4h"&&i!=="mat3x4"&&i!=="mat3x4f"&&i!=="mat3x4h"&&i!=="mat4x4"&&i!=="mat4x4f"&&i!=="mat4x4h")return console.error(`GetDataValue: Unknown type ${i}`),null;f=new W(new Float32Array(this.data.buffer,this.data.byteOffset+4*o*4,4),e.getTypeInfo(`vec4${a}`))}return n.postfix?f.getSubData(e,n.postfix,r):f}return console.error("GetDataValue: Invalid postfix",n),null}toString(){let e=`${this.data[0]}`;for(let n=1;n<this.data.length;++n)e+=`, ${this.data[n]}`;return e}}class ln extends Dr{constructor(e,n,r=0,i=null){super(n,i),this.buffer=e instanceof ArrayBuffer?e:e.buffer,this.offset=r}clone(){const e=new Uint8Array(new Uint8Array(this.buffer,this.offset,this.typeInfo.size));return new ln(e.buffer,this.typeInfo,0,null)}setDataValue(e,n,r,i){if(n===null)return void console.log("setDataValue: NULL data.");let s=this.offset,o=this.typeInfo;for(;r;){if(r instanceof ua)if(o instanceof hs){const a=r.index;if(a instanceof _n){if(!(a.value instanceof Z))return void console.error(`SetDataValue: Invalid index type ${a.value}`);s+=a.value.value*o.stride}else{const f=e.evalExpression(a,i);if(!(f instanceof Z))return void console.error("SetDataValue: Unknown index type",a);s+=f.value*o.stride}o=o.format}else console.error(`SetDataValue: Type ${o.getTypeName()} is not an array`);else{if(!(r instanceof Zs))return void console.error("SetDataValue: Unknown postfix type",r);{const a=r.value;if(o instanceof es){let f=!1;for(const p of o.members)if(p.name===a){s+=p.offset,o=p.type,f=!0;break}if(!f)return void console.error(`SetDataValue: Member ${a} not found`)}else if(o instanceof Rr){const f=o.getTypeName();let p=0;if(a==="x"||a==="r")p=0;else if(a==="y"||a==="g")p=1;else if(a==="z"||a==="b")p=2;else{if(a!=="w"&&a!=="a")return void console.error(`SetDataValue: Unknown member ${a}`);p=3}if(!(n instanceof Z))return void console.error("SetDataValue: Invalid value",n);const m=n.value;return f==="vec2f"?void(new Float32Array(this.buffer,s,2)[p]=m):f==="vec3f"?void(new Float32Array(this.buffer,s,3)[p]=m):f==="vec4f"?void(new Float32Array(this.buffer,s,4)[p]=m):f==="vec2i"?void(new Int32Array(this.buffer,s,2)[p]=m):f==="vec3i"?void(new Int32Array(this.buffer,s,3)[p]=m):f==="vec4i"?void(new Int32Array(this.buffer,s,4)[p]=m):f==="vec2u"?void(new Uint32Array(this.buffer,s,2)[p]=m):f==="vec3u"?void(new Uint32Array(this.buffer,s,3)[p]=m):f==="vec4u"?void(new Uint32Array(this.buffer,s,4)[p]=m):void console.error(`SetDataValue: Type ${f} is not a struct`)}}}r=r.postfix}this.setData(e,n,o,s,i)}setData(e,n,r,i,s){const o=r.getTypeName();if(o!=="f32"&&o!=="f16")if(o!=="i32"&&o!=="atomic<i32>"&&o!=="x32")if(o!=="u32"&&o!=="atomic<u32>")if(o!=="bool")if(o!=="vec2f"&&o!=="vec2h")if(o!=="vec3f"&&o!=="vec3h")if(o!=="vec4f"&&o!=="vec4h")if(o!=="vec2i")if(o!=="vec3i")if(o!=="vec4i")if(o!=="vec2u")if(o!=="vec3u")if(o!=="vec4u")if(o!=="vec2b")if(o!=="vec3b")if(o!=="vec4b")if(o!=="mat2x2f"&&o!=="mat2x2h")if(o!=="mat2x3f"&&o!=="mat2x3h")if(o!=="mat2x4f"&&o!=="mat2x4h")if(o!=="mat3x2f"&&o!=="mat3x2h")if(o!=="mat3x3f"&&o!=="mat3x3h")if(o!=="mat3x4f"&&o!=="mat3x4h")if(o!=="mat4x2f"&&o!=="mat4x2h")if(o!=="mat4x3f"&&o!=="mat4x3h")if(o!=="mat4x4f"&&o!=="mat4x4h")if(n instanceof ln){if(r===n.typeInfo)return void new Uint8Array(this.buffer,i,n.buffer.byteLength).set(new Uint8Array(n.buffer));console.error("SetDataValue: Type mismatch",o,n.typeInfo.getTypeName())}else console.error(`SetData: Unknown type ${o}`);else{const a=new Float32Array(this.buffer,i,16);n instanceof Ye?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3],a[4]=n.data[4],a[5]=n.data[5],a[6]=n.data[6],a[7]=n.data[7],a[8]=n.data[8],a[9]=n.data[9],a[10]=n.data[10],a[11]=n.data[11],a[12]=n.data[12],a[13]=n.data[13],a[14]=n.data[14],a[15]=n.data[15]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15])}else{const a=new Float32Array(this.buffer,i,12);n instanceof Ye?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3],a[4]=n.data[4],a[5]=n.data[5],a[6]=n.data[6],a[7]=n.data[7],a[8]=n.data[8],a[9]=n.data[9],a[10]=n.data[10],a[11]=n.data[11]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11])}else{const a=new Float32Array(this.buffer,i,8);n instanceof Ye?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3],a[4]=n.data[4],a[5]=n.data[5],a[6]=n.data[6],a[7]=n.data[7]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7])}else{const a=new Float32Array(this.buffer,i,12);n instanceof Ye?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3],a[4]=n.data[4],a[5]=n.data[5],a[6]=n.data[6],a[7]=n.data[7],a[8]=n.data[8],a[9]=n.data[9],a[10]=n.data[10],a[11]=n.data[11]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11])}else{const a=new Float32Array(this.buffer,i,9);n instanceof Ye?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3],a[4]=n.data[4],a[5]=n.data[5],a[6]=n.data[6],a[7]=n.data[7],a[8]=n.data[8]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[8]=n[8])}else{const a=new Float32Array(this.buffer,i,6);n instanceof Ye?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3],a[4]=n.data[4],a[5]=n.data[5]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5])}else{const a=new Float32Array(this.buffer,i,8);n instanceof Ye?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3],a[4]=n.data[4],a[5]=n.data[5],a[6]=n.data[6],a[7]=n.data[7]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7])}else{const a=new Float32Array(this.buffer,i,6);n instanceof Ye?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3],a[4]=n.data[4],a[5]=n.data[5]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5])}else{const a=new Float32Array(this.buffer,i,4);n instanceof Ye?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3])}else{const a=new Uint32Array(this.buffer,i,4);n instanceof W?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3])}else{const a=new Uint32Array(this.buffer,i,3);n instanceof W?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2]):(a[0]=n[0],a[1]=n[1],a[2]=n[2])}else{const a=new Uint32Array(this.buffer,i,2);n instanceof W?(a[0]=n.data[0],a[1]=n.data[1]):(a[0]=n[0],a[1]=n[1])}else{const a=new Uint32Array(this.buffer,i,4);n instanceof W?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3])}else{const a=new Uint32Array(this.buffer,i,3);n instanceof W?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2]):(a[0]=n[0],a[1]=n[1],a[2]=n[2])}else{const a=new Uint32Array(this.buffer,i,2);n instanceof W?(a[0]=n.data[0],a[1]=n.data[1]):(a[0]=n[0],a[1]=n[1])}else{const a=new Int32Array(this.buffer,i,4);n instanceof W?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3])}else{const a=new Int32Array(this.buffer,i,3);n instanceof W?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2]):(a[0]=n[0],a[1]=n[1],a[2]=n[2])}else{const a=new Int32Array(this.buffer,i,2);n instanceof W?(a[0]=n.data[0],a[1]=n.data[1]):(a[0]=n[0],a[1]=n[1])}else{const a=new Float32Array(this.buffer,i,4);n instanceof W?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3])}else{const a=new Float32Array(this.buffer,i,3);n instanceof W?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2]):(a[0]=n[0],a[1]=n[1],a[2]=n[2])}else{const a=new Float32Array(this.buffer,i,2);n instanceof W?(a[0]=n.data[0],a[1]=n.data[1]):(a[0]=n[0],a[1]=n[1])}else n instanceof Z&&(new Int32Array(this.buffer,i,1)[0]=n.value);else n instanceof Z&&(new Uint32Array(this.buffer,i,1)[0]=n.value);else n instanceof Z&&(new Int32Array(this.buffer,i,1)[0]=n.value);else n instanceof Z&&(new Float32Array(this.buffer,i,1)[0]=n.value)}getSubData(e,n,r){var i,s,o;if(n===null)return this;let a=this.offset,f=this.typeInfo;for(;n;){if(n instanceof ua){const m=n.index,v=e.evalExpression(m,r);let w=0;if(v instanceof Z?w=v.value:console.error("GetDataValue: Invalid index type",m),f instanceof hs)a+=w*f.stride,f=f.format;else{const T=f.getTypeName();T==="mat4x4"||T==="mat4x4f"||T==="mat4x4h"?(a+=16*w,f=e.getTypeInfo("vec4f")):console.error(`getDataValue: Type ${f.getTypeName()} is not an array`)}}else{if(!(n instanceof Zs))return console.error("GetDataValue: Unknown postfix type",n),null;{const m=n.value;if(f instanceof es){let v=!1;for(const w of f.members)if(w.name===m){a+=w.offset,f=w.type,v=!0;break}if(!v)return console.error(`GetDataValue: Member ${m} not found`),null}else if(f instanceof Rr){const v=f.getTypeName();if(v==="vec2f"||v==="vec3f"||v==="vec4f"||v==="vec2i"||v==="vec3i"||v==="vec4i"||v==="vec2u"||v==="vec3u"||v==="vec4u"||v==="vec2b"||v==="vec3b"||v==="vec4b"||v==="vec2h"||v==="vec3h"||v==="vec4h"||v==="vec2"||v==="vec3"||v==="vec4"){if(m.length>0&&m.length<5){let w="f";const T=[];for(let E=0;E<m.length;++E){const N=m[E].toLowerCase();let j=0;if(N==="x"||N==="r")j=0;else if(N==="y"||N==="g")j=1;else if(N==="z"||N==="b")j=2;else{if(N!=="w"&&N!=="a")return console.error(`Unknown member ${m}`),null;j=3}if(m.length===1){if(v.endsWith("f"))return this.buffer.byteLength<a+4*j+4?(console.log("Insufficient buffer data"),null):new Z(new Float32Array(this.buffer,a+4*j,1),e.getTypeInfo("f32"),this);if(v.endsWith("h"))return new Z(new Float32Array(this.buffer,a+4*j,1),e.getTypeInfo("f16"),this);if(v.endsWith("i"))return new Z(new Int32Array(this.buffer,a+4*j,1),e.getTypeInfo("i32"),this);if(v.endsWith("b"))return new Z(new Int32Array(this.buffer,a+4*j,1),e.getTypeInfo("bool"),this);if(v.endsWith("u"))return new Z(new Uint32Array(this.buffer,a+4*j,1),e.getTypeInfo("i32"),this)}if(v==="vec2f")T.push(new Float32Array(this.buffer,a,2)[j]);else if(v==="vec3f"){if(a+12>=this.buffer.byteLength)return console.log("Insufficient buffer data"),null;const I=new Float32Array(this.buffer,a,3);T.push(I[j])}else if(v==="vec4f")T.push(new Float32Array(this.buffer,a,4)[j]);else if(v==="vec2i")w="i",T.push(new Int32Array(this.buffer,a,2)[j]);else if(v==="vec3i")w="i",T.push(new Int32Array(this.buffer,a,3)[j]);else if(v==="vec4i")w="i",T.push(new Int32Array(this.buffer,a,4)[j]);else if(v==="vec2u"){w="u";const I=new Uint32Array(this.buffer,a,2);T.push(I[j])}else v==="vec3u"?(w="u",T.push(new Uint32Array(this.buffer,a,3)[j])):v==="vec4u"&&(w="u",T.push(new Uint32Array(this.buffer,a,4)[j]))}return T.length===2?f=e.getTypeInfo(`vec2${w}`):T.length===3?f=e.getTypeInfo(`vec3${w}`):T.length===4?f=e.getTypeInfo(`vec4${w}`):console.error(`GetDataValue: Invalid vector length ${T.length}`),new W(T,f,null)}return console.error(`GetDataValue: Unknown member ${m}`),null}return console.error(`GetDataValue: Type ${v} is not a struct`),null}}}n=n.postfix}const p=f.getTypeName();return p==="f32"?new Z(new Float32Array(this.buffer,a,1),f,this):p==="i32"?new Z(new Int32Array(this.buffer,a,1),f,this):p==="u32"?new Z(new Uint32Array(this.buffer,a,1),f,this):p==="vec2f"?new W(new Float32Array(this.buffer,a,2),f,this):p==="vec3f"?new W(new Float32Array(this.buffer,a,3),f,this):p==="vec4f"?new W(new Float32Array(this.buffer,a,4),f,this):p==="vec2i"?new W(new Int32Array(this.buffer,a,2),f,this):p==="vec3i"?new W(new Int32Array(this.buffer,a,3),f,this):p==="vec4i"?new W(new Int32Array(this.buffer,a,4),f,this):p==="vec2u"?new W(new Uint32Array(this.buffer,a,2),f,this):p==="vec3u"?new W(new Uint32Array(this.buffer,a,3),f,this):p==="vec4u"?new W(new Uint32Array(this.buffer,a,4),f,this):f instanceof qs&&f.name==="atomic"?((i=f.format)===null||i===void 0?void 0:i.name)==="u32"?new Z(new Uint32Array(this.buffer,a,1)[0],f.format,this):((s=f.format)===null||s===void 0?void 0:s.name)==="i32"?new Z(new Int32Array(this.buffer,a,1)[0],f.format,this):(console.error(`GetDataValue: Invalid atomic format ${(o=f.format)===null||o===void 0?void 0:o.name}`),null):new ln(this.buffer,f,a,this)}toString(){let e="";if(this.typeInfo instanceof hs)if(this.typeInfo.format.name==="f32"){const n=new Float32Array(this.buffer,this.offset);e=`[${n[0]}`;for(let r=1;r<n.length;++r)e+=`, ${n[r]}`}else if(this.typeInfo.format.name==="i32"){const n=new Int32Array(this.buffer,this.offset);e=`[${n[0]}`;for(let r=1;r<n.length;++r)e+=`, ${n[r]}`}else if(this.typeInfo.format.name==="u32"){const n=new Uint32Array(this.buffer,this.offset);e=`[${n[0]}`;for(let r=1;r<n.length;++r)e+=`, ${n[r]}`}else if(this.typeInfo.format.name==="vec2f"){const n=new Float32Array(this.buffer,this.offset);e=`[${n[0]}, ${n[1]}]`;for(let r=1;r<n.length/2;++r)e+=`, [${n[2*r]}, ${n[2*r+1]}]`}else if(this.typeInfo.format.name==="vec3f"){const n=new Float32Array(this.buffer,this.offset);e=`[${n[0]}, ${n[1]}, ${n[2]}]`;for(let r=4;r<n.length;r+=4)e+=`, [${n[r]}, ${n[r+1]}, ${n[r+2]}]`}else if(this.typeInfo.format.name==="vec4f"){const n=new Float32Array(this.buffer,this.offset);e=`[${n[0]}, ${n[1]}, ${n[2]}, ${n[3]}]`;for(let r=4;r<n.length;r+=4)e+=`, [${n[r]}, ${n[r+1]}, ${n[r+2]}, ${n[r+3]}]`}else e="[...]";else this.typeInfo instanceof es?e+="{...}":e="[...]";return e}}class wi extends Dr{constructor(e,n,r,i){super(n,null),this.data=e,this.descriptor=r,this.view=i}clone(){return new wi(this.data,this.typeInfo,this.descriptor,this.view)}get width(){var e,n;const r=this.descriptor.size;return r instanceof Array&&r.length>0?(e=r[0])!==null&&e!==void 0?e:0:r instanceof Object&&(n=r.width)!==null&&n!==void 0?n:0}get height(){var e,n;const r=this.descriptor.size;return r instanceof Array&&r.length>1?(e=r[1])!==null&&e!==void 0?e:0:r instanceof Object&&(n=r.height)!==null&&n!==void 0?n:0}get depthOrArrayLayers(){var e,n;const r=this.descriptor.size;return r instanceof Array&&r.length>2?(e=r[2])!==null&&e!==void 0?e:0:r instanceof Object&&(n=r.depthOrArrayLayers)!==null&&n!==void 0?n:0}get format(){var e;return this.descriptor&&(e=this.descriptor.format)!==null&&e!==void 0?e:"rgba8unorm"}get sampleCount(){var e;return this.descriptor&&(e=this.descriptor.sampleCount)!==null&&e!==void 0?e:1}get mipLevelCount(){var e;return this.descriptor&&(e=this.descriptor.mipLevelCount)!==null&&e!==void 0?e:1}get dimension(){var e;return this.descriptor&&(e=this.descriptor.dimension)!==null&&e!==void 0?e:"2d"}getMipLevelSize(e){if(e>=this.mipLevelCount)return[0,0,0];const n=[this.width,this.height,this.depthOrArrayLayers];for(let r=0;r<n.length;++r)n[r]=Math.max(1,n[r]>>e);return n}get texelByteSize(){const e=this.format,n=Fh[e];return n?n.isDepthStencil?4:n.bytesPerBlock:0}get bytesPerRow(){return this.width*this.texelByteSize}get isDepthStencil(){const e=this.format,n=Fh[e];return!!n&&n.isDepthStencil}getGpuSize(){const e=this.format,n=Fh[e],r=this.width;if(!e||r<=0||!n)return-1;const i=this.height,s=this.depthOrArrayLayers,o=this.dimension;return r/n.blockWidth*(o==="1d"?1:i/n.blockHeight)*n.bytesPerBlock*s}getPixel(e,n,r=0,i=0){const s=this.texelByteSize,o=this.bytesPerRow,a=this.height,f=this.data[i];return oI(new Uint8Array(f),e,n,r,i,a,o,s,this.format)}setPixel(e,n,r,i,s){const o=this.texelByteSize,a=this.bytesPerRow,f=this.height,p=this.data[i];(function(m,v,w,T,E,N,j,I,R,k){const B=T*(j>>=E)*(N>>=E)+w*j+v*I;switch(R){case"r8unorm":return void Pt(m,B,"8unorm",1,k);case"r8snorm":return void Pt(m,B,"8snorm",1,k);case"r8uint":return void Pt(m,B,"8uint",1,k);case"r8sint":return void Pt(m,B,"8sint",1,k);case"rg8unorm":return void Pt(m,B,"8unorm",2,k);case"rg8snorm":return void Pt(m,B,"8snorm",2,k);case"rg8uint":return void Pt(m,B,"8uint",2,k);case"rg8sint":return void Pt(m,B,"8sint",2,k);case"rgba8unorm-srgb":case"rgba8unorm":case"bgra8unorm-srgb":case"bgra8unorm":return void Pt(m,B,"8unorm",4,k);case"rgba8snorm":return void Pt(m,B,"8snorm",4,k);case"rgba8uint":return void Pt(m,B,"8uint",4,k);case"rgba8sint":return void Pt(m,B,"8sint",4,k);case"r16uint":return void Pt(m,B,"16uint",1,k);case"r16sint":return void Pt(m,B,"16sint",1,k);case"r16float":return void Pt(m,B,"16float",1,k);case"rg16uint":return void Pt(m,B,"16uint",2,k);case"rg16sint":return void Pt(m,B,"16sint",2,k);case"rg16float":return void Pt(m,B,"16float",2,k);case"rgba16uint":return void Pt(m,B,"16uint",4,k);case"rgba16sint":return void Pt(m,B,"16sint",4,k);case"rgba16float":return void Pt(m,B,"16float",4,k);case"r32uint":return void Pt(m,B,"32uint",1,k);case"r32sint":return void Pt(m,B,"32sint",1,k);case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return void Pt(m,B,"32float",1,k);case"rg32uint":return void Pt(m,B,"32uint",2,k);case"rg32sint":return void Pt(m,B,"32sint",2,k);case"rg32float":return void Pt(m,B,"32float",2,k);case"rgba32uint":return void Pt(m,B,"32uint",4,k);case"rgba32sint":return void Pt(m,B,"32sint",4,k);case"rgba32float":return void Pt(m,B,"32float",4,k);case"rg11b10ufloat":console.error("TODO: rg11b10ufloat not supported for writing")}})(new Uint8Array(p),e,n,r,i,f,a,o,this.format,s)}}(t=>{t[t.token=0]="token",t[t.keyword=1]="keyword",t[t.reserved=2]="reserved"})(J||(J={}));class ee{constructor(e,n,r){this.name=e,this.type=n,this.rule=r}toString(){return this.name}}class L{}se=L,L.none=new ee("",J.reserved,""),L.eof=new ee("EOF",J.token,""),L.reserved={asm:new ee("asm",J.reserved,"asm"),bf16:new ee("bf16",J.reserved,"bf16"),do:new ee("do",J.reserved,"do"),enum:new ee("enum",J.reserved,"enum"),f16:new ee("f16",J.reserved,"f16"),f64:new ee("f64",J.reserved,"f64"),handle:new ee("handle",J.reserved,"handle"),i8:new ee("i8",J.reserved,"i8"),i16:new ee("i16",J.reserved,"i16"),i64:new ee("i64",J.reserved,"i64"),mat:new ee("mat",J.reserved,"mat"),premerge:new ee("premerge",J.reserved,"premerge"),regardless:new ee("regardless",J.reserved,"regardless"),typedef:new ee("typedef",J.reserved,"typedef"),u8:new ee("u8",J.reserved,"u8"),u16:new ee("u16",J.reserved,"u16"),u64:new ee("u64",J.reserved,"u64"),unless:new ee("unless",J.reserved,"unless"),using:new ee("using",J.reserved,"using"),vec:new ee("vec",J.reserved,"vec"),void:new ee("void",J.reserved,"void")},L.keywords={array:new ee("array",J.keyword,"array"),atomic:new ee("atomic",J.keyword,"atomic"),bool:new ee("bool",J.keyword,"bool"),f32:new ee("f32",J.keyword,"f32"),i32:new ee("i32",J.keyword,"i32"),mat2x2:new ee("mat2x2",J.keyword,"mat2x2"),mat2x3:new ee("mat2x3",J.keyword,"mat2x3"),mat2x4:new ee("mat2x4",J.keyword,"mat2x4"),mat3x2:new ee("mat3x2",J.keyword,"mat3x2"),mat3x3:new ee("mat3x3",J.keyword,"mat3x3"),mat3x4:new ee("mat3x4",J.keyword,"mat3x4"),mat4x2:new ee("mat4x2",J.keyword,"mat4x2"),mat4x3:new ee("mat4x3",J.keyword,"mat4x3"),mat4x4:new ee("mat4x4",J.keyword,"mat4x4"),ptr:new ee("ptr",J.keyword,"ptr"),sampler:new ee("sampler",J.keyword,"sampler"),sampler_comparison:new ee("sampler_comparison",J.keyword,"sampler_comparison"),struct:new ee("struct",J.keyword,"struct"),texture_1d:new ee("texture_1d",J.keyword,"texture_1d"),texture_2d:new ee("texture_2d",J.keyword,"texture_2d"),texture_2d_array:new ee("texture_2d_array",J.keyword,"texture_2d_array"),texture_3d:new ee("texture_3d",J.keyword,"texture_3d"),texture_cube:new ee("texture_cube",J.keyword,"texture_cube"),texture_cube_array:new ee("texture_cube_array",J.keyword,"texture_cube_array"),texture_multisampled_2d:new ee("texture_multisampled_2d",J.keyword,"texture_multisampled_2d"),texture_storage_1d:new ee("texture_storage_1d",J.keyword,"texture_storage_1d"),texture_storage_2d:new ee("texture_storage_2d",J.keyword,"texture_storage_2d"),texture_storage_2d_array:new ee("texture_storage_2d_array",J.keyword,"texture_storage_2d_array"),texture_storage_3d:new ee("texture_storage_3d",J.keyword,"texture_storage_3d"),texture_depth_2d:new ee("texture_depth_2d",J.keyword,"texture_depth_2d"),texture_depth_2d_array:new ee("texture_depth_2d_array",J.keyword,"texture_depth_2d_array"),texture_depth_cube:new ee("texture_depth_cube",J.keyword,"texture_depth_cube"),texture_depth_cube_array:new ee("texture_depth_cube_array",J.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new ee("texture_depth_multisampled_2d",J.keyword,"texture_depth_multisampled_2d"),texture_external:new ee("texture_external",J.keyword,"texture_external"),u32:new ee("u32",J.keyword,"u32"),vec2:new ee("vec2",J.keyword,"vec2"),vec3:new ee("vec3",J.keyword,"vec3"),vec4:new ee("vec4",J.keyword,"vec4"),bitcast:new ee("bitcast",J.keyword,"bitcast"),block:new ee("block",J.keyword,"block"),break:new ee("break",J.keyword,"break"),case:new ee("case",J.keyword,"case"),continue:new ee("continue",J.keyword,"continue"),continuing:new ee("continuing",J.keyword,"continuing"),default:new ee("default",J.keyword,"default"),diagnostic:new ee("diagnostic",J.keyword,"diagnostic"),discard:new ee("discard",J.keyword,"discard"),else:new ee("else",J.keyword,"else"),enable:new ee("enable",J.keyword,"enable"),fallthrough:new ee("fallthrough",J.keyword,"fallthrough"),false:new ee("false",J.keyword,"false"),fn:new ee("fn",J.keyword,"fn"),for:new ee("for",J.keyword,"for"),function:new ee("function",J.keyword,"function"),if:new ee("if",J.keyword,"if"),let:new ee("let",J.keyword,"let"),const:new ee("const",J.keyword,"const"),loop:new ee("loop",J.keyword,"loop"),while:new ee("while",J.keyword,"while"),private:new ee("private",J.keyword,"private"),read:new ee("read",J.keyword,"read"),read_write:new ee("read_write",J.keyword,"read_write"),return:new ee("return",J.keyword,"return"),requires:new ee("requires",J.keyword,"requires"),storage:new ee("storage",J.keyword,"storage"),switch:new ee("switch",J.keyword,"switch"),true:new ee("true",J.keyword,"true"),alias:new ee("alias",J.keyword,"alias"),type:new ee("type",J.keyword,"type"),uniform:new ee("uniform",J.keyword,"uniform"),var:new ee("var",J.keyword,"var"),override:new ee("override",J.keyword,"override"),workgroup:new ee("workgroup",J.keyword,"workgroup"),write:new ee("write",J.keyword,"write"),r8unorm:new ee("r8unorm",J.keyword,"r8unorm"),r8snorm:new ee("r8snorm",J.keyword,"r8snorm"),r8uint:new ee("r8uint",J.keyword,"r8uint"),r8sint:new ee("r8sint",J.keyword,"r8sint"),r16uint:new ee("r16uint",J.keyword,"r16uint"),r16sint:new ee("r16sint",J.keyword,"r16sint"),r16float:new ee("r16float",J.keyword,"r16float"),rg8unorm:new ee("rg8unorm",J.keyword,"rg8unorm"),rg8snorm:new ee("rg8snorm",J.keyword,"rg8snorm"),rg8uint:new ee("rg8uint",J.keyword,"rg8uint"),rg8sint:new ee("rg8sint",J.keyword,"rg8sint"),r32uint:new ee("r32uint",J.keyword,"r32uint"),r32sint:new ee("r32sint",J.keyword,"r32sint"),r32float:new ee("r32float",J.keyword,"r32float"),rg16uint:new ee("rg16uint",J.keyword,"rg16uint"),rg16sint:new ee("rg16sint",J.keyword,"rg16sint"),rg16float:new ee("rg16float",J.keyword,"rg16float"),rgba8unorm:new ee("rgba8unorm",J.keyword,"rgba8unorm"),rgba8unorm_srgb:new ee("rgba8unorm_srgb",J.keyword,"rgba8unorm_srgb"),rgba8snorm:new ee("rgba8snorm",J.keyword,"rgba8snorm"),rgba8uint:new ee("rgba8uint",J.keyword,"rgba8uint"),rgba8sint:new ee("rgba8sint",J.keyword,"rgba8sint"),bgra8unorm:new ee("bgra8unorm",J.keyword,"bgra8unorm"),bgra8unorm_srgb:new ee("bgra8unorm_srgb",J.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new ee("rgb10a2unorm",J.keyword,"rgb10a2unorm"),rg11b10float:new ee("rg11b10float",J.keyword,"rg11b10float"),rg32uint:new ee("rg32uint",J.keyword,"rg32uint"),rg32sint:new ee("rg32sint",J.keyword,"rg32sint"),rg32float:new ee("rg32float",J.keyword,"rg32float"),rgba16uint:new ee("rgba16uint",J.keyword,"rgba16uint"),rgba16sint:new ee("rgba16sint",J.keyword,"rgba16sint"),rgba16float:new ee("rgba16float",J.keyword,"rgba16float"),rgba32uint:new ee("rgba32uint",J.keyword,"rgba32uint"),rgba32sint:new ee("rgba32sint",J.keyword,"rgba32sint"),rgba32float:new ee("rgba32float",J.keyword,"rgba32float"),static_assert:new ee("static_assert",J.keyword,"static_assert")},L.tokens={decimal_float_literal:new ee("decimal_float_literal",J.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?[fh]?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+[fh]?)|(-?[0-9]+[fh])/),hex_float_literal:new ee("hex_float_literal",J.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+[fh]?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+[fh]?))/),int_literal:new ee("int_literal",J.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new ee("uint_literal",J.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),name:new ee("name",J.token,/([_\p{XID_Start}][\p{XID_Continue}]+)|([\p{XID_Start}])/u),ident:new ee("ident",J.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new ee("and",J.token,"&"),and_and:new ee("and_and",J.token,"&&"),arrow:new ee("arrow ",J.token,"->"),attr:new ee("attr",J.token,"@"),forward_slash:new ee("forward_slash",J.token,"/"),bang:new ee("bang",J.token,"!"),bracket_left:new ee("bracket_left",J.token,"["),bracket_right:new ee("bracket_right",J.token,"]"),brace_left:new ee("brace_left",J.token,"{"),brace_right:new ee("brace_right",J.token,"}"),colon:new ee("colon",J.token,":"),comma:new ee("comma",J.token,","),equal:new ee("equal",J.token,"="),equal_equal:new ee("equal_equal",J.token,"=="),not_equal:new ee("not_equal",J.token,"!="),greater_than:new ee("greater_than",J.token,">"),greater_than_equal:new ee("greater_than_equal",J.token,">="),shift_right:new ee("shift_right",J.token,">>"),less_than:new ee("less_than",J.token,"<"),less_than_equal:new ee("less_than_equal",J.token,"<="),shift_left:new ee("shift_left",J.token,"<<"),modulo:new ee("modulo",J.token,"%"),minus:new ee("minus",J.token,"-"),minus_minus:new ee("minus_minus",J.token,"--"),period:new ee("period",J.token,"."),plus:new ee("plus",J.token,"+"),plus_plus:new ee("plus_plus",J.token,"++"),or:new ee("or",J.token,"|"),or_or:new ee("or_or",J.token,"||"),paren_left:new ee("paren_left",J.token,"("),paren_right:new ee("paren_right",J.token,")"),semicolon:new ee("semicolon",J.token,";"),star:new ee("star",J.token,"*"),tilde:new ee("tilde",J.token,"~"),underscore:new ee("underscore",J.token,"_"),xor:new ee("xor",J.token,"^"),plus_equal:new ee("plus_equal",J.token,"+="),minus_equal:new ee("minus_equal",J.token,"-="),times_equal:new ee("times_equal",J.token,"*="),division_equal:new ee("division_equal",J.token,"/="),modulo_equal:new ee("modulo_equal",J.token,"%="),and_equal:new ee("and_equal",J.token,"&="),or_equal:new ee("or_equal",J.token,"|="),xor_equal:new ee("xor_equal",J.token,"^="),shift_right_equal:new ee("shift_right_equal",J.token,">>="),shift_left_equal:new ee("shift_left_equal",J.token,"<<=")},L.simpleTokens={"@":se.tokens.attr,"{":se.tokens.brace_left,"}":se.tokens.brace_right,":":se.tokens.colon,",":se.tokens.comma,"(":se.tokens.paren_left,")":se.tokens.paren_right,";":se.tokens.semicolon},L.literalTokens={"&":se.tokens.and,"&&":se.tokens.and_and,"->":se.tokens.arrow,"/":se.tokens.forward_slash,"!":se.tokens.bang,"[":se.tokens.bracket_left,"]":se.tokens.bracket_right,"=":se.tokens.equal,"==":se.tokens.equal_equal,"!=":se.tokens.not_equal,">":se.tokens.greater_than,">=":se.tokens.greater_than_equal,">>":se.tokens.shift_right,"<":se.tokens.less_than,"<=":se.tokens.less_than_equal,"<<":se.tokens.shift_left,"%":se.tokens.modulo,"-":se.tokens.minus,"--":se.tokens.minus_minus,".":se.tokens.period,"+":se.tokens.plus,"++":se.tokens.plus_plus,"|":se.tokens.or,"||":se.tokens.or_or,"*":se.tokens.star,"~":se.tokens.tilde,_:se.tokens.underscore,"^":se.tokens.xor,"+=":se.tokens.plus_equal,"-=":se.tokens.minus_equal,"*=":se.tokens.times_equal,"/=":se.tokens.division_equal,"%=":se.tokens.modulo_equal,"&=":se.tokens.and_equal,"|=":se.tokens.or_equal,"^=":se.tokens.xor_equal,">>=":se.tokens.shift_right_equal,"<<=":se.tokens.shift_left_equal},L.regexTokens={decimal_float_literal:se.tokens.decimal_float_literal,hex_float_literal:se.tokens.hex_float_literal,int_literal:se.tokens.int_literal,uint_literal:se.tokens.uint_literal,ident:se.tokens.ident},L.storage_class=[se.keywords.function,se.keywords.private,se.keywords.workgroup,se.keywords.uniform,se.keywords.storage],L.access_mode=[se.keywords.read,se.keywords.write,se.keywords.read_write],L.sampler_type=[se.keywords.sampler,se.keywords.sampler_comparison],L.sampled_texture_type=[se.keywords.texture_1d,se.keywords.texture_2d,se.keywords.texture_2d_array,se.keywords.texture_3d,se.keywords.texture_cube,se.keywords.texture_cube_array],L.multisampled_texture_type=[se.keywords.texture_multisampled_2d],L.storage_texture_type=[se.keywords.texture_storage_1d,se.keywords.texture_storage_2d,se.keywords.texture_storage_2d_array,se.keywords.texture_storage_3d],L.depth_texture_type=[se.keywords.texture_depth_2d,se.keywords.texture_depth_2d_array,se.keywords.texture_depth_cube,se.keywords.texture_depth_cube_array,se.keywords.texture_depth_multisampled_2d],L.texture_external_type=[se.keywords.texture_external],L.any_texture_type=[...se.sampled_texture_type,...se.multisampled_texture_type,...se.storage_texture_type,...se.depth_texture_type,...se.texture_external_type],L.texel_format=[se.keywords.r8unorm,se.keywords.r8snorm,se.keywords.r8uint,se.keywords.r8sint,se.keywords.r16uint,se.keywords.r16sint,se.keywords.r16float,se.keywords.rg8unorm,se.keywords.rg8snorm,se.keywords.rg8uint,se.keywords.rg8sint,se.keywords.r32uint,se.keywords.r32sint,se.keywords.r32float,se.keywords.rg16uint,se.keywords.rg16sint,se.keywords.rg16float,se.keywords.rgba8unorm,se.keywords.rgba8unorm_srgb,se.keywords.rgba8snorm,se.keywords.rgba8uint,se.keywords.rgba8sint,se.keywords.bgra8unorm,se.keywords.bgra8unorm_srgb,se.keywords.rgb10a2unorm,se.keywords.rg11b10float,se.keywords.rg32uint,se.keywords.rg32sint,se.keywords.rg32float,se.keywords.rgba16uint,se.keywords.rgba16sint,se.keywords.rgba16float,se.keywords.rgba32uint,se.keywords.rgba32sint,se.keywords.rgba32float],L.const_literal=[se.tokens.int_literal,se.tokens.uint_literal,se.tokens.decimal_float_literal,se.tokens.hex_float_literal,se.keywords.true,se.keywords.false],L.literal_or_ident=[se.tokens.ident,se.tokens.int_literal,se.tokens.uint_literal,se.tokens.decimal_float_literal,se.tokens.hex_float_literal,se.tokens.name],L.element_count_expression=[se.tokens.int_literal,se.tokens.uint_literal,se.tokens.ident],L.template_types=[se.keywords.vec2,se.keywords.vec3,se.keywords.vec4,se.keywords.mat2x2,se.keywords.mat2x3,se.keywords.mat2x4,se.keywords.mat3x2,se.keywords.mat3x3,se.keywords.mat3x4,se.keywords.mat4x2,se.keywords.mat4x3,se.keywords.mat4x4,se.keywords.atomic,se.keywords.bitcast,...se.any_texture_type],L.attribute_name=[se.tokens.ident,se.keywords.block,se.keywords.diagnostic],L.assignment_operators=[se.tokens.equal,se.tokens.plus_equal,se.tokens.minus_equal,se.tokens.times_equal,se.tokens.division_equal,se.tokens.modulo_equal,se.tokens.and_equal,se.tokens.or_equal,se.tokens.xor_equal,se.tokens.shift_right_equal,se.tokens.shift_left_equal],L.increment_operators=[se.tokens.plus_plus,se.tokens.minus_minus];class __{constructor(e,n,r,i,s){this.type=e,this.lexeme=n,this.line=r,this.start=i,this.end=s}toString(){return this.lexeme}isTemplateType(){return L.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==L.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class hI{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=e??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new __(L.eof,"",this._line,this._current,this._current)),this._tokens}scanToken(){let e=this._advance();if(e==`
`)return this._line++,!0;if(this._isWhitespace(e))return!0;if(e=="/"){if(this._peekAhead()=="/"){for(;e!=`
`;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if(this._peekAhead()=="*"){this._advance();let o=1;for(;o>0;){if(this._isAtEnd())return!0;if(e=this._advance(),e==`
`)this._line++;else if(e=="*"){if(this._peekAhead()=="/"&&(this._advance(),o--,o==0))return!0}else e=="/"&&this._peekAhead()=="*"&&(this._advance(),o++)}return!0}}const n=L.simpleTokens[e];if(n)return this._addToken(n),!0;let r=L.none;const i=this._isAlpha(e),s=e==="_";if(this._isAlphaNumeric(e)){let o=this._peekAhead();for(;this._isAlphaNumeric(o);)e+=this._advance(),o=this._peekAhead()}if(i){const o=L.keywords[e];if(o)return this._addToken(o),!0}if(i||s)return this._addToken(L.tokens.ident),!0;for(;;){let o=this._findType(e);const a=this._peekAhead();if(e=="-"&&this._tokens.length>0){if(a=="=")return this._current++,e+=a,this._addToken(L.tokens.minus_equal),!0;if(a=="-")return this._current++,e+=a,this._addToken(L.tokens.minus_minus),!0;const f=this._tokens.length-1;if((L.literal_or_ident.indexOf(this._tokens[f].type)!=-1||this._tokens[f].type==L.tokens.paren_right)&&a!=">")return this._addToken(o),!0}if(e==">"&&(a==">"||a=="=")){let f=!1,p=this._tokens.length-1;for(let m=0;m<5&&p>=0&&L.assignment_operators.indexOf(this._tokens[p].type)===-1;++m,--p)if(this._tokens[p].type===L.tokens.less_than){p>0&&this._tokens[p-1].isArrayOrTemplateType()&&(f=!0);break}if(f)return this._addToken(o),!0}if(o===L.none){let f=e,p=0;const m=2;for(let v=0;v<m;++v)if(f+=this._peekAhead(v),o=this._findType(f),o!==L.none){p=v;break}if(o===L.none)return r!==L.none&&(this._current--,this._addToken(r),!0);e=f,this._current+=p+1}if(r=o,this._isAtEnd())break;e+=this._advance()}return r!==L.none&&(this._addToken(r),!0)}_findType(e){for(const r in L.regexTokens){const i=L.regexTokens[r];if(this._match(e,i.rule))return i}return L.literalTokens[e]||L.none}_match(e,n){const r=n.exec(e);return r&&r.index==0&&r[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return!this._isNumeric(e)&&!this._isWhitespace(e)&&e!=="_"&&e!=="."&&e!=="("&&e!==")"&&e!=="["&&e!=="]"&&e!=="{"&&e!=="}"&&e!==","&&e!==";"&&e!==":"&&e!=="="&&e!=="!"&&e!=="<"&&e!==">"&&e!=="+"&&e!=="-"&&e!=="*"&&e!=="/"&&e!=="%"&&e!=="&"&&e!=="|"&&e!=="^"&&e!=="~"&&e!=="@"&&e!=="#"&&e!=="?"&&e!=="'"&&e!=="`"&&e!=='"'&&e!=="\\"&&e!==`
`&&e!=="\r"&&e!=="	"&&e!=="\0"}_isNumeric(e){return e>="0"&&e<="9"}_isAlphaNumeric(e){return this._isAlpha(e)||this._isNumeric(e)||e==="_"}_isWhitespace(e){return e==" "||e=="	"||e=="\r"}_advance(e=0){let n=this._source[this._current];return e=e||0,e++,this._current+=e,n}_peekAhead(e=0){return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const n=this._source.substring(this._start,this._current);this._tokens.push(new __(e,n,this._line,this._start,this._current))}}function Ie(t){return Array.isArray(t)||(t==null?void 0:t.buffer)instanceof ArrayBuffer}const pu=new Float32Array(1),dI=new Uint32Array(pu.buffer),pI=new Uint32Array(pu.buffer),gu=new Int32Array(1),gI=new Float32Array(gu.buffer),mI=new Uint32Array(gu.buffer),mu=new Uint32Array(1),_I=new Float32Array(mu.buffer),yI=new Int32Array(mu.buffer);function y_(t,e,n){if(e===n)return t;if(e==="f32"){if(n==="i32"||n==="x32")return pu[0]=t,dI[0];if(n==="u32")return pu[0]=t,pI[0]}else if(e==="i32"||e==="x32"){if(n==="f32")return gu[0]=t,gI[0];if(n==="u32")return gu[0]=t,mI[0]}else if(e==="u32"){if(n==="f32")return mu[0]=t,_I[0];if(n==="i32"||n==="x32")return mu[0]=t,yI[0]}return console.error(`Unsupported cast from ${e} to ${n}`),t}class vI{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class QA{constructor(e,n){this.align=e,this.size=n}}class ai{constructor(){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new rI,this.functions=[],this._types=new Map,this._functions=new Map}_isStorageTexture(e){return e.name=="texture_storage_1d"||e.name=="texture_storage_2d"||e.name=="texture_storage_2d_array"||e.name=="texture_storage_3d"}updateAST(e){for(const n of e)n instanceof Ql&&this._functions.set(n.name,new vI(n));for(const n of e)if(n instanceof vi){const r=this.getTypeInfo(n,null);r instanceof es&&this.structs.push(r)}for(const n of e)if(n instanceof cg)this.aliases.push(this._getAliasInfo(n));else if(n instanceof lg){const r=n,i=this._getAttributeNum(r.attributes,"id",0),s=r.type!=null?this.getTypeInfo(r.type,r.attributes):null;this.overrides.push(new eI(r.name,s,r.attributes,i))}else if(this._isUniformVar(n)){const r=n,i=this._getAttributeNum(r.attributes,"group",0),s=this._getAttributeNum(r.attributes,"binding",0),o=this.getTypeInfo(r.type,r.attributes),a=new XA(r.name,o,i,s,r.attributes,Qi.Uniform,r.access);a.access||(a.access="read"),this.uniforms.push(a)}else if(this._isStorageVar(n)){const r=n,i=this._getAttributeNum(r.attributes,"group",0),s=this._getAttributeNum(r.attributes,"binding",0),o=this.getTypeInfo(r.type,r.attributes),a=this._isStorageTexture(o),f=new XA(r.name,o,i,s,r.attributes,a?Qi.StorageTexture:Qi.Storage,r.access);f.access||(f.access="read"),this.storage.push(f)}else if(this._isTextureVar(n)){const r=n,i=this._getAttributeNum(r.attributes,"group",0),s=this._getAttributeNum(r.attributes,"binding",0),o=this.getTypeInfo(r.type,r.attributes),a=this._isStorageTexture(o),f=new XA(r.name,o,i,s,r.attributes,a?Qi.StorageTexture:Qi.Texture,r.access);f.access||(f.access="read"),a?this.storage.push(f):this.textures.push(f)}else if(this._isSamplerVar(n)){const r=n,i=this._getAttributeNum(r.attributes,"group",0),s=this._getAttributeNum(r.attributes,"binding",0),o=this.getTypeInfo(r.type,r.attributes),a=new XA(r.name,o,i,s,r.attributes,Qi.Sampler,r.access);this.samplers.push(a)}else if(n instanceof Ql){const r=this._getAttribute(n,"vertex"),i=this._getAttribute(n,"fragment"),s=this._getAttribute(n,"compute"),o=r||i||s,a=new nI(n.name,o==null?void 0:o.name,n.attributes);a.attributes=n.attributes,a.startLine=n.startLine,a.endLine=n.endLine,this.functions.push(a),this._functions.get(n.name).info=a,o&&(this._functions.get(n.name).inUse=!0,a.inUse=!0,a.resources=this._findResources(n,!!o),a.inputs=this._getInputs(n.args),a.outputs=this._getOutputs(n.returnType),this.entry[o.name].push(a)),a.arguments=n.args.map(f=>new tI(f.name,this.getTypeInfo(f.type,f.attributes),f.attributes)),a.returnType=n.returnType?this.getTypeInfo(n.returnType,n.attributes):null}for(const n of this._functions.values())n.info&&(n.info.inUse=n.inUse,this._addCalls(n.node,n.info.calls));for(const n of this._functions.values())n.node.search(r=>{var i,s,o;if(r instanceof Qw){if(r.value)if(Ie(r.value))for(const a of r.value)for(const f of this.overrides)a===f.name&&((i=n.info)===null||i===void 0||i.overrides.push(f));else for(const a of this.overrides)r.value===a.name&&((s=n.info)===null||s===void 0||s.overrides.push(a))}else if(r instanceof gr)for(const a of this.overrides)r.name===a.name&&((o=n.info)===null||o===void 0||o.overrides.push(a))});for(const n of this.uniforms)this._markStructsInUse(n.type);for(const n of this.storage)this._markStructsInUse(n.type)}getStructInfo(e){for(const n of this.structs)if(n.name==e)return n;return null}getOverrideInfo(e){for(const n of this.overrides)if(n.name==e)return n;return null}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(const n of e.members)this._markStructsInUse(n.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{const n=this._getAlias(e.name);n&&this._markStructsInUse(n)}}_addCalls(e,n){var r;for(const i of e.calls){const s=(r=this._functions.get(i.name))===null||r===void 0?void 0:r.info;s&&n.add(s)}}findResource(e,n,r){if(r){for(const i of this.entry.compute)if(i.name===r){for(const s of i.resources)if(s.group==e&&s.binding==n)return s}for(const i of this.entry.vertex)if(i.name===r){for(const s of i.resources)if(s.group==e&&s.binding==n)return s}for(const i of this.entry.fragment)if(i.name===r){for(const s of i.resources)if(s.group==e&&s.binding==n)return s}}for(const i of this.uniforms)if(i.group==e&&i.binding==n)return i;for(const i of this.storage)if(i.group==e&&i.binding==n)return i;for(const i of this.textures)if(i.group==e&&i.binding==n)return i;for(const i of this.samplers)if(i.group==e&&i.binding==n)return i;return null}_findResource(e){for(const n of this.uniforms)if(n.name==e)return n;for(const n of this.storage)if(n.name==e)return n;for(const n of this.textures)if(n.name==e)return n;for(const n of this.samplers)if(n.name==e)return n;return null}_markStructsFromAST(e){const n=this.getTypeInfo(e,null);this._markStructsInUse(n)}_findResources(e,n){const r=[],i=this,s=[];return e.search(o=>{if(o instanceof hu)s.push({});else if(o instanceof du)s.pop();else if(o instanceof bi){const a=o;n&&a.type!==null&&this._markStructsFromAST(a.type),s.length>0&&(s[s.length-1][a.name]=a)}else if(o instanceof ii){const a=o;n&&a.type!==null&&this._markStructsFromAST(a.type)}else if(o instanceof bl){const a=o;n&&a.type!==null&&this._markStructsFromAST(a.type),s.length>0&&(s[s.length-1][a.name]=a)}else if(o instanceof gr){const a=o;if(s.length>0&&s[s.length-1][a.name])return;const f=i._findResource(a.name);f&&r.push(f)}else if(o instanceof ug){const a=o,f=i._functions.get(a.name);f&&(n&&(f.inUse=!0),e.calls.add(f.node),f.resources===null&&(f.resources=i._findResources(f.node,n)),r.push(...f.resources))}else if(o instanceof Ag){const a=o,f=i._functions.get(a.name);f&&(n&&(f.inUse=!0),e.calls.add(f.node),f.resources===null&&(f.resources=i._findResources(f.node,n)),r.push(...f.resources))}}),[...new Map(r.map(o=>[o.name,o])).values()]}getBindGroups(){const e=[];function n(r,i){r>=e.length&&(e.length=r+1),e[r]===void 0&&(e[r]=[]),i>=e[r].length&&(e[r].length=i+1)}for(const r of this.uniforms)n(r.group,r.binding),e[r.group][r.binding]=r;for(const r of this.storage)n(r.group,r.binding),e[r.group][r.binding]=r;for(const r of this.textures)n(r.group,r.binding),e[r.group][r.binding]=r;for(const r of this.samplers)n(r.group,r.binding),e[r.group][r.binding]=r;return e}_getOutputs(e,n=void 0){if(n===void 0&&(n=[]),e instanceof vi)this._getStructOutputs(e,n);else{const r=this._getOutputInfo(e);r!==null&&n.push(r)}return n}_getStructOutputs(e,n){for(const r of e.members)if(r.type instanceof vi)this._getStructOutputs(r.type,n);else{const i=this._getAttribute(r,"location")||this._getAttribute(r,"builtin");if(i!==null){const s=this.getTypeInfo(r.type,r.type.attributes),o=this._parseInt(i.value),a=new h_(r.name,s,i.name,o);n.push(a)}}}_getOutputInfo(e){const n=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(n!==null){const r=this.getTypeInfo(e,e.attributes),i=this._parseInt(n.value);return new h_("",r,n.name,i)}return null}_getInputs(e,n=void 0){n===void 0&&(n=[]);for(const r of e)if(r.type instanceof vi)this._getStructInputs(r.type,n);else{const i=this._getInputInfo(r);i!==null&&n.push(i)}return n}_getStructInputs(e,n){for(const r of e.members)if(r.type instanceof vi)this._getStructInputs(r.type,n);else{const i=this._getInputInfo(r);i!==null&&n.push(i)}}_getInputInfo(e){const n=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(n!==null){const r=this._getAttribute(e,"interpolation"),i=this.getTypeInfo(e.type,e.attributes),s=this._parseInt(n.value),o=new JR(e.name,i,n.name,s);return r!==null&&(o.interpolation=this._parseString(r.value)),o}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const n=parseInt(e);return isNaN(n)?e:n}_getAlias(e){for(const n of this.aliases)if(n.name==e)return n.type;return null}_getAliasInfo(e){return new GR(e.name,this.getTypeInfo(e.type,null))}getTypeInfoByName(e){for(const n of this.structs)if(n.name==e)return n;for(const n of this.aliases)if(n.name==e)return n.type;return null}getTypeInfo(e,n=null){if(this._types.has(e))return this._types.get(e);if(e instanceof xl){const i=e,s=i.format?this.getTypeInfo(i.format,i.attributes):null,o=new hs(i.name,n);return o.format=s,o.count=i.count,this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof vi){const i=e,s=new es(i.name,n);s.startLine=i.startLine,s.endLine=i.endLine;for(const o of i.members){const a=this.getTypeInfo(o.type,o.attributes);s.members.push(new f_(o.name,a,o.attributes))}return this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof ol){const i=e,s=i.format instanceof _e,o=i.format?s?this.getTypeInfo(i.format,null):new Rr(i.format,null):null,a=new qs(i.name,o,n,i.access);return this._types.set(e,a),this._updateTypeInfo(a),a}if(e instanceof re){const i=e,s=i.format?this.getTypeInfo(i.format,null):null,o=new qs(i.name,s,n,i.access);return this._types.set(e,o),this._updateTypeInfo(o),o}const r=new Rr(e.name,n);return this._types.set(e,r),this._updateTypeInfo(r),r}_updateTypeInfo(e){var n,r,i;const s=this._getTypeSize(e);if(e.size=(n=s==null?void 0:s.size)!==null&&n!==void 0?n:0,e instanceof hs&&e.format){const o=this._getTypeSize(e.format);e.stride=Math.max((r=o==null?void 0:o.size)!==null&&r!==void 0?r:0,(i=o==null?void 0:o.align)!==null&&i!==void 0?i:0),this._updateTypeInfo(e.format)}e instanceof es&&this._updateStructInfo(e)}_updateStructInfo(e){var n;let r=0,i=0,s=0,o=0;for(let a=0,f=e.members.length;a<f;++a){const p=e.members[a],m=this._getTypeSize(p);if(!m)continue;(n=this._getAlias(p.type.name))!==null&&n!==void 0||p.type;const v=m.align,w=m.size;r=this._roundUp(v,r+i),i=w,s=r,o=Math.max(o,v),p.offset=r,p.size=w,this._updateTypeInfo(p.type)}e.size=this._roundUp(o,s+i),e.align=o}_getTypeSize(e){var n,r;if(e==null)return null;const i=this._getAttributeNum(e.attributes,"size",0),s=this._getAttributeNum(e.attributes,"align",0);if(e instanceof f_&&(e=e.type),e instanceof Rr){const o=this._getAlias(e.name);o!==null&&(e=o)}{const o=ai._typeInfo[e.name];if(o!==void 0){const a=((n=e.format)===null||n===void 0?void 0:n.name)==="f16"?2:1;return new QA(Math.max(s,o.align/a),Math.max(i,o.size/a))}}{const o=ai._typeInfo[e.name.substring(0,e.name.length-1)];if(o){const a=e.name[e.name.length-1]==="h"?2:1;return new QA(Math.max(s,o.align/a),Math.max(i,o.size/a))}}if(e instanceof hs){let o=e,a=8,f=8;const p=this._getTypeSize(o.format);return p!==null&&(f=p.size,a=p.align),f=o.count*this._getAttributeNum((r=e==null?void 0:e.attributes)!==null&&r!==void 0?r:null,"stride",this._roundUp(a,f)),i&&(f=i),new QA(Math.max(s,a),Math.max(i,f))}if(e instanceof es){let o=0,a=0,f=0,p=0,m=0;for(const v of e.members){const w=this._getTypeSize(v.type);w!==null&&(o=Math.max(w.align,o),f=this._roundUp(w.align,f+p),p=w.size,m=f)}return a=this._roundUp(o,m+p),new QA(Math.max(s,o),Math.max(i,a))}return null}_isUniformVar(e){return e instanceof bi&&e.storage=="uniform"}_isStorageVar(e){return e instanceof bi&&e.storage=="storage"}_isTextureVar(e){return e instanceof bi&&e.type!==null&&ai._textureTypes.indexOf(e.type.name)!=-1}_isSamplerVar(e){return e instanceof bi&&e.type!==null&&ai._samplerTypes.indexOf(e.type.name)!=-1}_getAttribute(e,n){const r=e;if(!r||!r.attributes)return null;const i=r.attributes;for(let s of i)if(s.name==n)return s;return null}_getAttributeNum(e,n,r){if(e===null)return r;for(let i of e)if(i.name==n){let s=i!==null&&i.value!==null?i.value:r;return s instanceof Array&&(s=s[0]),typeof s=="number"?s:typeof s=="string"?parseInt(s):r}return r}_roundUp(e,n){return Math.ceil(n/e)*e}}ai._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},ai._textureTypes=L.any_texture_type.map(t=>t.name),ai._samplerTypes=L.sampler_type.map(t=>t.name);class fg{constructor(e,n,r){this.name=e,this.value=n,this.node=r}clone(){return new fg(this.name,this.value,this.node)}}class hg{constructor(e){this.name=e.name,this.node=e}clone(){return new hg(this.node)}}class dg{constructor(e){this.parent=null,this.variables=new Map,this.functions=new Map,this.currentFunctionName="",e&&(this.parent=e,this.currentFunctionName=e.currentFunctionName)}getVariable(e){var n;return this.variables.has(e)?(n=this.variables.get(e))!==null&&n!==void 0?n:null:this.parent?this.parent.getVariable(e):null}getFunction(e){var n;return this.functions.has(e)?(n=this.functions.get(e))!==null&&n!==void 0?n:null:this.parent?this.parent.getFunction(e):null}createVariable(e,n,r){this.variables.set(e,new fg(e,n,r??null))}setVariable(e,n,r){const i=this.getVariable(e);i!==null?i.value=n:this.createVariable(e,n,r)}getVariableValue(e){var n;const r=this.getVariable(e);return(n=r==null?void 0:r.value)!==null&&n!==void 0?n:null}clone(){return new dg(this)}}class wI{evalExpression(e,n){return null}getTypeInfo(e){return null}getVariableName(e,n){return""}}class bI{constructor(e){this.exec=e}getTypeInfo(e){return this.exec.getTypeInfo(e)}All(e,n){const r=this.exec.evalExpression(e.args[0],n);let i=!0;if(r instanceof W)return r.data.forEach(s=>{s||(i=!1)}),new Z(i?1:0,this.getTypeInfo("bool"));throw new Error(`All() expects a vector argument. Line ${e.line}`)}Any(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W){const i=r.data.some(s=>s);return new Z(i?1:0,this.getTypeInfo("bool"))}throw new Error(`Any() expects a vector argument. Line ${e.line}`)}Select(e,n){const r=this.exec.evalExpression(e.args[2],n);if(!(r instanceof Z))throw new Error(`Select() expects a bool condition. Line ${e.line}`);return r.value?this.exec.evalExpression(e.args[1],n):this.exec.evalExpression(e.args[0],n)}ArrayLength(e,n){let r=e.args[0];r instanceof pn&&(r=r.right);const i=this.exec.evalExpression(r,n);if(i instanceof ln&&i.typeInfo.size===0){const s=i.typeInfo,o=i.buffer.byteLength/s.stride;return new Z(o,this.getTypeInfo("u32"))}return new Z(i.typeInfo.size,this.getTypeInfo("u32"))}Abs(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.abs(s)),r.typeInfo);const i=r;return new Z(Math.abs(i.value),i.typeInfo)}Acos(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.acos(s)),r.typeInfo);const i=r;return new Z(Math.acos(i.value),r.typeInfo)}Acosh(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.acosh(s)),r.typeInfo);const i=r;return new Z(Math.acosh(i.value),r.typeInfo)}Asin(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.asin(s)),r.typeInfo);const i=r;return new Z(Math.asin(i.value),r.typeInfo)}Asinh(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.asinh(s)),r.typeInfo);const i=r;return new Z(Math.asinh(i.value),r.typeInfo)}Atan(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.atan(s)),r.typeInfo);const i=r;return new Z(Math.atan(i.value),r.typeInfo)}Atanh(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.atanh(s)),r.typeInfo);const i=r;return new Z(Math.atanh(i.value),r.typeInfo)}Atan2(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof W&&i instanceof W)return new W(r.data.map((a,f)=>Math.atan2(a,i.data[f])),r.typeInfo);const s=r,o=i;return new Z(Math.atan2(s.value,o.value),r.typeInfo)}Ceil(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.ceil(s)),r.typeInfo);const i=r;return new Z(Math.ceil(i.value),r.typeInfo)}_clamp(e,n,r){return Math.min(Math.max(e,n),r)}Clamp(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),s=this.exec.evalExpression(e.args[2],n);if(r instanceof W&&i instanceof W&&s instanceof W)return new W(r.data.map((p,m)=>this._clamp(p,i.data[m],s.data[m])),r.typeInfo);const o=r,a=i,f=s;return new Z(this._clamp(o.value,a.value,f.value),r.typeInfo)}Cos(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.cos(s)),r.typeInfo);const i=r;return new Z(Math.cos(i.value),r.typeInfo)}Cosh(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.cosh(s)),r.typeInfo);const i=r;return new Z(Math.cos(i.value),r.typeInfo)}CountLeadingZeros(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.clz32(s)),r.typeInfo);const i=r;return new Z(Math.clz32(i.value),r.typeInfo)}_countOneBits(e){let n=0;for(;e!==0;)1&e&&n++,e>>=1;return n}CountOneBits(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>this._countOneBits(s)),r.typeInfo);const i=r;return new Z(this._countOneBits(i.value),r.typeInfo)}_countTrailingZeros(e){if(e===0)return 32;let n=0;for(;!(1&e);)e>>=1,n++;return n}CountTrailingZeros(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>this._countTrailingZeros(s)),r.typeInfo);const i=r;return new Z(this._countTrailingZeros(i.value),r.typeInfo)}Cross(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof W&&i instanceof W){if(r.data.length!==3||i.data.length!==3)return console.error(`Cross() expects 3D vectors. Line ${e.line}`),null;const s=r.data,o=i.data;return new W([s[1]*o[2]-o[1]*s[2],s[2]*o[0]-o[2]*s[0],s[0]*o[1]-o[0]*s[1]],r.typeInfo)}return console.error(`Cross() expects vector arguments. Line ${e.line}`),null}Degrees(e,n){const r=this.exec.evalExpression(e.args[0],n),i=180/Math.PI;return r instanceof W?new W(r.data.map(s=>s*i),r.typeInfo):new Z(r.value*i,this.getTypeInfo("f32"))}Determinant(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ye){const i=r.data,s=r.typeInfo.getTypeName(),o=s.endsWith("h")?this.getTypeInfo("f16"):this.getTypeInfo("f32");if(s==="mat2x2"||s==="mat2x2f"||s==="mat2x2h")return new Z(i[0]*i[3]-i[1]*i[2],o);if(s==="mat2x3"||s==="mat2x3f"||s==="mat2x3h")return new Z(i[0]*(i[4]*i[8]-i[5]*i[7])-i[1]*(i[3]*i[8]-i[5]*i[6])+i[2]*(i[3]*i[7]-i[4]*i[6]),o);if(s==="mat2x4"||s==="mat2x4f"||s==="mat2x4h")console.error(`TODO: Determinant for ${s}`);else if(s==="mat3x2"||s==="mat3x2f"||s==="mat3x2h")console.error(`TODO: Determinant for ${s}`);else{if(s==="mat3x3"||s==="mat3x3f"||s==="mat3x3h")return new Z(i[0]*(i[4]*i[8]-i[5]*i[7])-i[1]*(i[3]*i[8]-i[5]*i[6])+i[2]*(i[3]*i[7]-i[4]*i[6]),o);s==="mat3x4"||s==="mat3x4f"||s==="mat3x4h"||s==="mat4x2"||s==="mat4x2f"||s==="mat4x2h"||s==="mat4x3"||s==="mat4x3f"||s==="mat4x3h"?console.error(`TODO: Determinant for ${s}`):s!=="mat4x4"&&s!=="mat4x4f"&&s!=="mat4x4h"||console.error(`TODO: Determinant for ${s}`)}}return console.error(`Determinant expects a matrix argument. Line ${e.line}`),null}Distance(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof W&&i instanceof W){let a=0;for(let f=0;f<r.data.length;++f)a+=(r.data[f]-i.data[f])*(r.data[f]-i.data[f]);return new Z(Math.sqrt(a),this.getTypeInfo("f32"))}const s=r,o=i;return new Z(Math.abs(s.value-o.value),r.typeInfo)}_dot(e,n){let r=0;for(let i=0;i<e.length;++i)r+=n[i]*e[i];return r}Dot(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);return r instanceof W&&i instanceof W?new Z(this._dot(r.data,i.data),this.getTypeInfo("f32")):(console.error(`Dot() expects vector arguments. Line ${e.line}`),null)}Dot4U8Packed(e,n){return console.error(`TODO: dot4U8Packed. Line ${e.line}`),null}Dot4I8Packed(e,n){return console.error(`TODO: dot4I8Packed. Line ${e.line}`),null}Exp(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.exp(s)),r.typeInfo);const i=r;return new Z(Math.exp(i.value),r.typeInfo)}Exp2(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.pow(2,s)),r.typeInfo);const i=r;return new Z(Math.pow(2,i.value),r.typeInfo)}ExtractBits(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),s=this.exec.evalExpression(e.args[2],n);if(i.typeInfo.name!=="u32"&&i.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 offset argument. Line ${e.line}`),null;if(s.typeInfo.name!=="u32"&&s.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 count argument. Line ${e.line}`),null;const o=i.value,a=s.value;if(r instanceof W)return new W(r.data.map(p=>p>>o&(1<<a)-1),r.typeInfo);if(r.typeInfo.name!=="i32"&&r.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 argument. Line ${e.line}`),null;const f=r.value;return new Z(f>>o&(1<<a)-1,this.getTypeInfo("i32"))}FaceForward(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),s=this.exec.evalExpression(e.args[2],n);if(r instanceof W&&i instanceof W&&s instanceof W){const o=this._dot(i.data,s.data);return new W(o<0?Array.from(r.data):r.data.map(a=>-a),r.typeInfo)}return console.error(`FaceForward() expects vector arguments. Line ${e.line}`),null}_firstLeadingBit(e){return e===0?-1:31-Math.clz32(e)}FirstLeadingBit(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>this._firstLeadingBit(s)),r.typeInfo);const i=r;return new Z(this._firstLeadingBit(i.value),r.typeInfo)}_firstTrailingBit(e){return e===0?-1:Math.log2(e&-e)}FirstTrailingBit(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>this._firstTrailingBit(s)),r.typeInfo);const i=r;return new Z(this._firstTrailingBit(i.value),r.typeInfo)}Floor(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.floor(s)),r.typeInfo);const i=r;return new Z(Math.floor(i.value),r.typeInfo)}Fma(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),s=this.exec.evalExpression(e.args[2],n);if(r instanceof W&&i instanceof W&&s instanceof W)return r.data.length!==i.data.length||r.data.length!==s.data.length?(console.error(`Fma() expects vectors of the same length. Line ${e.line}`),null):new W(r.data.map((p,m)=>p*i.data[m]+s.data[m]),r.typeInfo);const o=r,a=i,f=s;return new Z(o.value*a.value+f.value,o.typeInfo)}Fract(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>s-Math.floor(s)),r.typeInfo);const i=r;return new Z(i.value-Math.floor(i.value),r.typeInfo)}Frexp(e,n){return console.error(`TODO: frexp. Line ${e.line}`),null}InsertBits(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),s=this.exec.evalExpression(e.args[2],n),o=this.exec.evalExpression(e.args[3],n);if(s.typeInfo.name!=="u32"&&s.typeInfo.name!=="x32")return console.error(`InsertBits() expects an i32 offset argument. Line ${e.line}`),null;const a=s.value,f=(1<<o.value)-1<<a,p=~f;if(r instanceof W&&i instanceof W)return new W(r.data.map((w,T)=>w&p|i.data[T]<<a&f),r.typeInfo);const m=r.value,v=i.value;return new Z(m&p|v<<a&f,r.typeInfo)}InverseSqrt(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>1/Math.sqrt(s)),r.typeInfo);const i=r;return new Z(1/Math.sqrt(i.value),r.typeInfo)}Ldexp(e,n){return console.error(`TODO: ldexp. Line ${e.line}`),null}Length(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W){let s=0;return r.data.forEach(o=>{s+=o*o}),new Z(Math.sqrt(s),this.getTypeInfo("f32"))}const i=r;return new Z(Math.abs(i.value),r.typeInfo)}Log(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.log(s)),r.typeInfo);const i=r;return new Z(Math.log(i.value),r.typeInfo)}Log2(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.log2(s)),r.typeInfo);const i=r;return new Z(Math.log2(i.value),r.typeInfo)}Max(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof W&&i instanceof W)return new W(r.data.map((a,f)=>Math.max(a,i.data[f])),r.typeInfo);const s=r,o=i;return new Z(Math.max(s.value,o.value),r.typeInfo)}Min(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof W&&i instanceof W)return new W(r.data.map((a,f)=>Math.min(a,i.data[f])),r.typeInfo);const s=r,o=i;return new Z(Math.min(s.value,o.value),r.typeInfo)}Mix(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),s=this.exec.evalExpression(e.args[2],n);if(r instanceof W&&i instanceof W&&s instanceof W)return new W(r.data.map((f,p)=>r.data[p]*(1-s.data[p])+i.data[p]*s.data[p]),r.typeInfo);const o=i,a=s;return new Z(r.value*(1-a.value)+o.value*a.value,r.typeInfo)}Modf(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof W&&i instanceof W)return new W(r.data.map((o,a)=>o%i.data[a]),r.typeInfo);const s=i;return new Z(r.value%s.value,r.typeInfo)}Normalize(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W){const i=this.Length(e,n).value;return new W(r.data.map(s=>s/i),r.typeInfo)}return console.error(`Normalize() expects a vector argument. Line ${e.line}`),null}Pow(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof W&&i instanceof W)return new W(r.data.map((a,f)=>Math.pow(a,i.data[f])),r.typeInfo);const s=r,o=i;return new Z(Math.pow(s.value,o.value),r.typeInfo)}QuantizeToF16(e,n){const r=this.exec.evalExpression(e.args[0],n);return r instanceof W?new W(r.data.map(i=>i),r.typeInfo):new Z(r.value,r.typeInfo)}Radians(e,n){const r=this.exec.evalExpression(e.args[0],n);return r instanceof W?new W(r.data.map(i=>i*Math.PI/180),r.typeInfo):new Z(r.value*Math.PI/180,this.getTypeInfo("f32"))}Reflect(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof W&&i instanceof W){const s=this._dot(r.data,i.data);return new W(r.data.map((o,a)=>o-2*s*i.data[a]),r.typeInfo)}return console.error(`Reflect() expects vector arguments. Line ${e.line}`),null}Refract(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),s=this.exec.evalExpression(e.args[2],n);if(r instanceof W&&i instanceof W&&s instanceof Z){const o=this._dot(i.data,r.data);return new W(r.data.map((a,f)=>{const p=1-s.value*s.value*(1-o*o);if(p<0)return 0;const m=Math.sqrt(p);return s.value*a-(s.value*o+m)*i.data[f]}),r.typeInfo)}return console.error(`Refract() expects vector arguments and a scalar argument. Line ${e.line}`),null}ReverseBits(e,n){return console.error(`TODO: reverseBits. Line ${e.line}`),null}Round(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.round(s)),r.typeInfo);const i=r;return new Z(Math.round(i.value),r.typeInfo)}Saturate(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.min(Math.max(s,0),1)),r.typeInfo);const i=r;return new Z(Math.min(Math.max(i.value,0),1),r.typeInfo)}Sign(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.sign(s)),r.typeInfo);const i=r;return new Z(Math.sign(i.value),r.typeInfo)}Sin(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.sin(s)),r.typeInfo);const i=r;return new Z(Math.sin(i.value),r.typeInfo)}Sinh(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.sinh(s)),r.typeInfo);const i=r;return new Z(Math.sinh(i.value),r.typeInfo)}_smoothstep(e,n,r){const i=Math.min(Math.max((r-e)/(n-e),0),1);return i*i*(3-2*i)}SmoothStep(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),s=this.exec.evalExpression(e.args[2],n);if(s instanceof W&&r instanceof W&&i instanceof W)return new W(s.data.map((p,m)=>this._smoothstep(r.data[m],i.data[m],p)),s.typeInfo);const o=r,a=i,f=s;return new Z(this._smoothstep(o.value,a.value,f.value),s.typeInfo)}Sqrt(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.sqrt(s)),r.typeInfo);const i=r;return new Z(Math.sqrt(i.value),r.typeInfo)}Step(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(i instanceof W&&r instanceof W)return new W(i.data.map((o,a)=>o<r.data[a]?0:1),i.typeInfo);const s=r;return new Z(i.value<s.value?0:1,s.typeInfo)}Tan(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.tan(s)),r.typeInfo);const i=r;return new Z(Math.tan(i.value),r.typeInfo)}Tanh(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.tanh(s)),r.typeInfo);const i=r;return new Z(Math.tanh(i.value),r.typeInfo)}_getTransposeType(e){const n=e.getTypeName();return n==="mat2x2f"||n==="mat2x2h"?e:n==="mat2x3f"?this.getTypeInfo("mat3x2f"):n==="mat2x3h"?this.getTypeInfo("mat3x2h"):n==="mat2x4f"?this.getTypeInfo("mat4x2f"):n==="mat2x4h"?this.getTypeInfo("mat4x2h"):n==="mat3x2f"?this.getTypeInfo("mat2x3f"):n==="mat3x2h"?this.getTypeInfo("mat2x3h"):n==="mat3x3f"||n==="mat3x3h"?e:n==="mat3x4f"?this.getTypeInfo("mat4x3f"):n==="mat3x4h"?this.getTypeInfo("mat4x3h"):n==="mat4x2f"?this.getTypeInfo("mat2x4f"):n==="mat4x2h"?this.getTypeInfo("mat2x4h"):n==="mat4x3f"?this.getTypeInfo("mat3x4f"):n==="mat4x3h"?this.getTypeInfo("mat3x4h"):(n==="mat4x4f"||n==="mat4x4h"||console.error(`Invalid matrix type ${n}`),e)}Transpose(e,n){const r=this.exec.evalExpression(e.args[0],n);if(!(r instanceof Ye))return console.error(`Transpose() expects a matrix argument. Line ${e.line}`),null;const i=this._getTransposeType(r.typeInfo);if(r.typeInfo.name==="mat2x2"||r.typeInfo.name==="mat2x2f"||r.typeInfo.name==="mat2x2h"){const s=r.data;return new Ye([s[0],s[2],s[1],s[3]],i)}if(r.typeInfo.name==="mat2x3"||r.typeInfo.name==="mat2x3f"||r.typeInfo.name==="mat2x3h"){const s=r.data;return new Ye([s[0],s[3],s[6],s[1],s[4],s[7]],i)}if(r.typeInfo.name==="mat2x4"||r.typeInfo.name==="mat2x4f"||r.typeInfo.name==="mat2x4h"){const s=r.data;return new Ye([s[0],s[4],s[8],s[12],s[1],s[5],s[9],s[13]],i)}if(r.typeInfo.name==="mat3x2"||r.typeInfo.name==="mat3x2f"||r.typeInfo.name==="mat3x2h"){const s=r.data;return new Ye([s[0],s[3],s[1],s[4],s[2],s[5]],i)}if(r.typeInfo.name==="mat3x3"||r.typeInfo.name==="mat3x3f"||r.typeInfo.name==="mat3x3h"){const s=r.data;return new Ye([s[0],s[3],s[6],s[1],s[4],s[7],s[2],s[5],s[8]],i)}if(r.typeInfo.name==="mat3x4"||r.typeInfo.name==="mat3x4f"||r.typeInfo.name==="mat3x4h"){const s=r.data;return new Ye([s[0],s[4],s[8],s[12],s[1],s[5],s[9],s[13],s[2],s[6],s[10],s[14]],i)}if(r.typeInfo.name==="mat4x2"||r.typeInfo.name==="mat4x2f"||r.typeInfo.name==="mat4x2h"){const s=r.data;return new Ye([s[0],s[4],s[1],s[5],s[2],s[6]],i)}if(r.typeInfo.name==="mat4x3"||r.typeInfo.name==="mat4x3f"||r.typeInfo.name==="mat4x3h"){const s=r.data;return new Ye([s[0],s[4],s[8],s[1],s[5],s[9],s[2],s[6],s[10]],i)}if(r.typeInfo.name==="mat4x4"||r.typeInfo.name==="mat4x4f"||r.typeInfo.name==="mat4x4h"){const s=r.data;return new Ye([s[0],s[4],s[8],s[12],s[1],s[5],s[9],s[13],s[2],s[6],s[10],s[14],s[3],s[7],s[11],s[15]],i)}return console.error(`Invalid matrix type ${r.typeInfo.name}`),null}Trunc(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof W)return new W(r.data.map(s=>Math.trunc(s)),r.typeInfo);const i=r;return new Z(Math.trunc(i.value),r.typeInfo)}Dpdx(e,n){return console.error(`TODO: dpdx. Line ${e.line}`),null}DpdxCoarse(e,n){return console.error(`TODO: dpdxCoarse. Line ${e.line}`),null}DpdxFine(e,n){return console.error("TODO: dpdxFine"),null}Dpdy(e,n){return console.error("TODO: dpdy"),null}DpdyCoarse(e,n){return console.error("TODO: dpdyCoarse"),null}DpdyFine(e,n){return console.error("TODO: dpdyFine"),null}Fwidth(e,n){return console.error("TODO: fwidth"),null}FwidthCoarse(e,n){return console.error("TODO: fwidthCoarse"),null}FwidthFine(e,n){return console.error("TODO: fwidthFine"),null}TextureDimensions(e,n){const r=e.args[0],i=e.args.length>1?this.exec.evalExpression(e.args[1],n).value:0;if(r instanceof gr){const s=r.name,o=n.getVariableValue(s);if(o instanceof wi){if(i<0||i>=o.mipLevelCount)return console.error(`Invalid mip level for textureDimensions. Line ${e.line}`),null;const a=o.getMipLevelSize(i),f=o.dimension;return f==="1d"?new Z(a[0],this.getTypeInfo("u32")):f==="3d"?new W(a,this.getTypeInfo("vec3u")):f==="2d"?new W(a.slice(0,2),this.getTypeInfo("vec2u")):(console.error(`Invalid texture dimension ${f} not found. Line ${e.line}`),null)}return console.error(`Texture ${s} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureDimensions. Line ${e.line}`),null}TextureGather(e,n){return console.error("TODO: textureGather"),null}TextureGatherCompare(e,n){return console.error("TODO: textureGatherCompare"),null}TextureLoad(e,n){const r=e.args[0],i=this.exec.evalExpression(e.args[1],n),s=e.args.length>2?this.exec.evalExpression(e.args[2],n).value:0;if(!(i instanceof W)||i.data.length!==2)return console.error(`Invalid UV argument for textureLoad. Line ${e.line}`),null;if(r instanceof gr){const o=r.name,a=n.getVariableValue(o);if(a instanceof wi){const f=Math.floor(i.data[0]),p=Math.floor(i.data[1]);if(f<0||f>=a.width||p<0||p>=a.height)return console.error(`Texture ${o} out of bounds. Line ${e.line}`),null;const m=a.getPixel(f,p,0,s);return m===null?(console.error(`Invalid texture format for textureLoad. Line ${e.line}`),null):new W(m,this.getTypeInfo("vec4f"))}return console.error(`Texture ${o} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureLoad. Line ${e.line}`),null}TextureNumLayers(e,n){const r=e.args[0];if(r instanceof gr){const i=r.name,s=n.getVariableValue(i);return s instanceof wi?new Z(s.depthOrArrayLayers,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLayers. Line ${e.line}`),null}TextureNumLevels(e,n){const r=e.args[0];if(r instanceof gr){const i=r.name,s=n.getVariableValue(i);return s instanceof wi?new Z(s.mipLevelCount,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLevels. Line ${e.line}`),null}TextureNumSamples(e,n){const r=e.args[0];if(r instanceof gr){const i=r.name,s=n.getVariableValue(i);return s instanceof wi?new Z(s.sampleCount,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumSamples. Line ${e.line}`),null}TextureSample(e,n){return console.error("TODO: textureSample"),null}TextureSampleBias(e,n){return console.error("TODO: textureSampleBias"),null}TextureSampleCompare(e,n){return console.error("TODO: textureSampleCompare"),null}TextureSampleCompareLevel(e,n){return console.error("TODO: textureSampleCompareLevel"),null}TextureSampleGrad(e,n){return console.error("TODO: textureSampleGrad"),null}TextureSampleLevel(e,n){return console.error("TODO: textureSampleLevel"),null}TextureSampleBaseClampToEdge(e,n){return console.error("TODO: textureSampleBaseClampToEdge"),null}TextureStore(e,n){const r=e.args[0],i=this.exec.evalExpression(e.args[1],n),s=e.args.length===4?this.exec.evalExpression(e.args[2],n).value:0,o=e.args.length===4?this.exec.evalExpression(e.args[3],n).data:this.exec.evalExpression(e.args[2],n).data;if(o.length!==4)return console.error(`Invalid value argument for textureStore. Line ${e.line}`),null;if(!(i instanceof W)||i.data.length!==2)return console.error(`Invalid UV argument for textureStore. Line ${e.line}`),null;if(r instanceof gr){const a=r.name,f=n.getVariableValue(a);if(f instanceof wi){const p=f.getMipLevelSize(0),m=Math.floor(i.data[0]),v=Math.floor(i.data[1]);return m<0||m>=p[0]||v<0||v>=p[1]?(console.error(`Texture ${a} out of bounds. Line ${e.line}`),null):(f.setPixel(m,v,0,s,Array.from(o)),null)}return console.error(`Texture ${a} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureStore. Line ${e.line}`),null}AtomicLoad(e,n){let r=e.args[0];r instanceof pn&&(r=r.right);const i=this.exec.getVariableName(r,n);return n.getVariable(i).value.getSubData(this.exec,r.postfix,n)}AtomicStore(e,n){let r=e.args[0];r instanceof pn&&(r=r.right);const i=this.exec.getVariableName(r,n),s=n.getVariable(i);let o=e.args[1];const a=this.exec.evalExpression(o,n),f=s.value.getSubData(this.exec,r.postfix,n);return f instanceof Z&&a instanceof Z&&(f.value=a.value),s.value instanceof ln&&s.value.setDataValue(this.exec,f,r.postfix,n),null}AtomicAdd(e,n){let r=e.args[0];r instanceof pn&&(r=r.right);const i=this.exec.getVariableName(r,n),s=n.getVariable(i);let o=e.args[1];const a=this.exec.evalExpression(o,n),f=s.value.getSubData(this.exec,r.postfix,n),p=new Z(f.value,f.typeInfo);return f instanceof Z&&a instanceof Z&&(f.value+=a.value),s.value instanceof ln&&s.value.setDataValue(this.exec,f,r.postfix,n),p}AtomicSub(e,n){let r=e.args[0];r instanceof pn&&(r=r.right);const i=this.exec.getVariableName(r,n),s=n.getVariable(i);let o=e.args[1];const a=this.exec.evalExpression(o,n),f=s.value.getSubData(this.exec,r.postfix,n),p=new Z(f.value,f.typeInfo);return f instanceof Z&&a instanceof Z&&(f.value-=a.value),s.value instanceof ln&&s.value.setDataValue(this.exec,f,r.postfix,n),p}AtomicMax(e,n){let r=e.args[0];r instanceof pn&&(r=r.right);const i=this.exec.getVariableName(r,n),s=n.getVariable(i);let o=e.args[1];const a=this.exec.evalExpression(o,n),f=s.value.getSubData(this.exec,r.postfix,n),p=new Z(f.value,f.typeInfo);return f instanceof Z&&a instanceof Z&&(f.value=Math.max(f.value,a.value)),s.value instanceof ln&&s.value.setDataValue(this.exec,f,r.postfix,n),p}AtomicMin(e,n){let r=e.args[0];r instanceof pn&&(r=r.right);const i=this.exec.getVariableName(r,n),s=n.getVariable(i);let o=e.args[1];const a=this.exec.evalExpression(o,n),f=s.value.getSubData(this.exec,r.postfix,n),p=new Z(f.value,f.typeInfo);return f instanceof Z&&a instanceof Z&&(f.value=Math.min(f.value,a.value)),s.value instanceof ln&&s.value.setDataValue(this.exec,f,r.postfix,n),p}AtomicAnd(e,n){let r=e.args[0];r instanceof pn&&(r=r.right);const i=this.exec.getVariableName(r,n),s=n.getVariable(i);let o=e.args[1];const a=this.exec.evalExpression(o,n),f=s.value.getSubData(this.exec,r.postfix,n),p=new Z(f.value,f.typeInfo);return f instanceof Z&&a instanceof Z&&(f.value=f.value&a.value),s.value instanceof ln&&s.value.setDataValue(this.exec,f,r.postfix,n),p}AtomicOr(e,n){let r=e.args[0];r instanceof pn&&(r=r.right);const i=this.exec.getVariableName(r,n),s=n.getVariable(i);let o=e.args[1];const a=this.exec.evalExpression(o,n),f=s.value.getSubData(this.exec,r.postfix,n),p=new Z(f.value,f.typeInfo);return f instanceof Z&&a instanceof Z&&(f.value=f.value|a.value),s.value instanceof ln&&s.value.setDataValue(this.exec,f,r.postfix,n),p}AtomicXor(e,n){let r=e.args[0];r instanceof pn&&(r=r.right);const i=this.exec.getVariableName(r,n),s=n.getVariable(i);let o=e.args[1];const a=this.exec.evalExpression(o,n),f=s.value.getSubData(this.exec,r.postfix,n),p=new Z(f.value,f.typeInfo);return f instanceof Z&&a instanceof Z&&(f.value=f.value^a.value),s.value instanceof ln&&s.value.setDataValue(this.exec,f,r.postfix,n),p}AtomicExchange(e,n){let r=e.args[0];r instanceof pn&&(r=r.right);const i=this.exec.getVariableName(r,n),s=n.getVariable(i);let o=e.args[1];const a=this.exec.evalExpression(o,n),f=s.value.getSubData(this.exec,r.postfix,n),p=new Z(f.value,f.typeInfo);return f instanceof Z&&a instanceof Z&&(f.value=a.value),s.value instanceof ln&&s.value.setDataValue(this.exec,f,r.postfix,n),p}AtomicCompareExchangeWeak(e,n){return console.error("TODO: atomicCompareExchangeWeak"),null}Pack4x8snorm(e,n){return console.error("TODO: pack4x8snorm"),null}Pack4x8unorm(e,n){return console.error("TODO: pack4x8unorm"),null}Pack4xI8(e,n){return console.error("TODO: pack4xI8"),null}Pack4xU8(e,n){return console.error("TODO: pack4xU8"),null}Pack4x8Clamp(e,n){return console.error("TODO: pack4x8Clamp"),null}Pack4xU8Clamp(e,n){return console.error("TODO: pack4xU8Clamp"),null}Pack2x16snorm(e,n){return console.error("TODO: pack2x16snorm"),null}Pack2x16unorm(e,n){return console.error("TODO: pack2x16unorm"),null}Pack2x16float(e,n){return console.error("TODO: pack2x16float"),null}Unpack4x8snorm(e,n){return console.error("TODO: unpack4x8snorm"),null}Unpack4x8unorm(e,n){return console.error("TODO: unpack4x8unorm"),null}Unpack4xI8(e,n){return console.error("TODO: unpack4xI8"),null}Unpack4xU8(e,n){return console.error("TODO: unpack4xU8"),null}Unpack2x16snorm(e,n){return console.error("TODO: unpack2x16snorm"),null}Unpack2x16unorm(e,n){return console.error("TODO: unpack2x16unorm"),null}Unpack2x16float(e,n){return console.error("TODO: unpack2x16float"),null}StorageBarrier(e,n){return null}TextureBarrier(e,n){return null}WorkgroupBarrier(e,n){return null}WorkgroupUniformLoad(e,n){return null}SubgroupAdd(e,n){return console.error("TODO: subgroupAdd"),null}SubgroupExclusiveAdd(e,n){return console.error("TODO: subgroupExclusiveAdd"),null}SubgroupInclusiveAdd(e,n){return console.error("TODO: subgroupInclusiveAdd"),null}SubgroupAll(e,n){return console.error("TODO: subgroupAll"),null}SubgroupAnd(e,n){return console.error("TODO: subgroupAnd"),null}SubgroupAny(e,n){return console.error("TODO: subgroupAny"),null}SubgroupBallot(e,n){return console.error("TODO: subgroupBallot"),null}SubgroupBroadcast(e,n){return console.error("TODO: subgroupBroadcast"),null}SubgroupBroadcastFirst(e,n){return console.error("TODO: subgroupBroadcastFirst"),null}SubgroupElect(e,n){return console.error("TODO: subgroupElect"),null}SubgroupMax(e,n){return console.error("TODO: subgroupMax"),null}SubgroupMin(e,n){return console.error("TODO: subgroupMin"),null}SubgroupMul(e,n){return console.error("TODO: subgroupMul"),null}SubgroupExclusiveMul(e,n){return console.error("TODO: subgroupExclusiveMul"),null}SubgroupInclusiveMul(e,n){return console.error("TODO: subgroupInclusiveMul"),null}SubgroupOr(e,n){return console.error("TODO: subgroupOr"),null}SubgroupShuffle(e,n){return console.error("TODO: subgroupShuffle"),null}SubgroupShuffleDown(e,n){return console.error("TODO: subgroupShuffleDown"),null}SubgroupShuffleUp(e,n){return console.error("TODO: subgroupShuffleUp"),null}SubgroupShuffleXor(e,n){return console.error("TODO: subgroupShuffleXor"),null}SubgroupXor(e,n){return console.error("TODO: subgroupXor"),null}QuadBroadcast(e,n){return console.error("TODO: quadBroadcast"),null}QuadSwapDiagonal(e,n){return console.error("TODO: quadSwapDiagonal"),null}QuadSwapX(e,n){return console.error("TODO: quadSwapX"),null}QuadSwapY(e,n){return console.error("TODO: quadSwapY"),null}}const Uh={vec2:2,vec2f:2,vec2i:2,vec2u:2,vec2b:2,vec2h:2,vec3:3,vec3f:3,vec3i:3,vec3u:3,vec3b:3,vec3h:3,vec4:4,vec4f:4,vec4i:4,vec4u:4,vec4b:4,vec4h:4},tr={mat2x2:[2,2,4],mat2x2f:[2,2,4],mat2x2h:[2,2,4],mat2x3:[2,3,6],mat2x3f:[2,3,6],mat2x3h:[2,3,6],mat2x4:[2,4,8],mat2x4f:[2,4,8],mat2x4h:[2,4,8],mat3x2:[3,2,6],mat3x2f:[3,2,6],mat3x2h:[3,2,6],mat3x3:[3,3,9],mat3x3f:[3,3,9],mat3x3h:[3,3,9],mat3x4:[3,4,12],mat3x4f:[3,4,12],mat3x4h:[3,4,12],mat4x2:[4,2,8],mat4x2f:[4,2,8],mat4x2h:[4,2,8],mat4x3:[4,3,12],mat4x3f:[4,3,12],mat4x3h:[4,3,12],mat4x4:[4,4,16],mat4x4f:[4,4,16],mat4x4h:[4,4,16]};class Kn extends wI{constructor(e,n){var r;super(),this.ast=e??[],this.reflection=new ai,this.reflection.updateAST(this.ast),this.context=(r=n==null?void 0:n.clone())!==null&&r!==void 0?r:new dg,this.builtins=new bI(this),this.typeInfo={bool:this.getTypeInfo(_e.bool),i32:this.getTypeInfo(_e.i32),u32:this.getTypeInfo(_e.u32),f32:this.getTypeInfo(_e.f32),f16:this.getTypeInfo(_e.f16),vec2f:this.getTypeInfo(re.vec2f),vec2u:this.getTypeInfo(re.vec2u),vec2i:this.getTypeInfo(re.vec2i),vec2h:this.getTypeInfo(re.vec2h),vec3f:this.getTypeInfo(re.vec3f),vec3u:this.getTypeInfo(re.vec3u),vec3i:this.getTypeInfo(re.vec3i),vec3h:this.getTypeInfo(re.vec3h),vec4f:this.getTypeInfo(re.vec4f),vec4u:this.getTypeInfo(re.vec4u),vec4i:this.getTypeInfo(re.vec4i),vec4h:this.getTypeInfo(re.vec4h),mat2x2f:this.getTypeInfo(re.mat2x2f),mat2x3f:this.getTypeInfo(re.mat2x3f),mat2x4f:this.getTypeInfo(re.mat2x4f),mat3x2f:this.getTypeInfo(re.mat3x2f),mat3x3f:this.getTypeInfo(re.mat3x3f),mat3x4f:this.getTypeInfo(re.mat3x4f),mat4x2f:this.getTypeInfo(re.mat4x2f),mat4x3f:this.getTypeInfo(re.mat4x3f),mat4x4f:this.getTypeInfo(re.mat4x4f)}}getVariableValue(e){var n,r;const i=(r=(n=this.context.getVariable(e))===null||n===void 0?void 0:n.value)!==null&&r!==void 0?r:null;if(i===null)return null;if(i instanceof Z)return i.value;if(i instanceof W||i instanceof Ye)return Array.from(i.data);if(i instanceof ln&&i.typeInfo instanceof hs){if(i.typeInfo.format.name==="u32")return Array.from(new Uint32Array(i.buffer,i.offset,i.typeInfo.count));if(i.typeInfo.format.name==="i32")return Array.from(new Int32Array(i.buffer,i.offset,i.typeInfo.count));if(i.typeInfo.format.name==="f32")return Array.from(new Float32Array(i.buffer,i.offset,i.typeInfo.count))}return console.error(`Unsupported return variable type ${i.typeInfo.name}`),null}execute(e){(e=e??{}).constants&&this._setOverrides(e.constants,this.context),this._execStatements(this.ast,this.context)}dispatchWorkgroups(e,n,r,i){const s=this.context.clone();(i=i??{}).constants&&this._setOverrides(i.constants,s),this._execStatements(this.ast,s);const o=s.getFunction(e);if(!o)return void console.error(`Function ${e} not found`);if(typeof n=="number")n=[n,1,1];else{if(n.length===0)return void console.error("Invalid dispatch count");n.length===1?n=[n[0],1,1]:n.length===2?n=[n[0],n[1],1]:n.length>3&&(n=[n[0],n[1],n[2]])}const a=n[0],f=n[1],p=n[2],m=this.getTypeInfo("vec3u");s.setVariable("@num_workgroups",new W(n,m));for(const v in r)for(const w in r[v]){const T=r[v][w];s.variables.forEach(E=>{var N;const j=E.node;if(j!=null&&j.attributes){let I=null,R=null;for(const k of j.attributes)k.name==="binding"?I=k.value:k.name==="group"&&(R=k.value);if(w==I&&v==R)if(T.texture!==void 0&&T.descriptor!==void 0){const k=new wi(T.texture,this.getTypeInfo(j.type),T.descriptor,(N=T.texture.view)!==null&&N!==void 0?N:null);E.value=k}else T.uniform!==void 0?E.value=new ln(T.uniform,this.getTypeInfo(j.type)):E.value=new ln(T,this.getTypeInfo(j.type))}})}for(let v=0;v<p;++v)for(let w=0;w<f;++w)for(let T=0;T<a;++T)s.setVariable("@workgroup_id",new W([T,w,v],this.getTypeInfo("vec3u"))),this._dispatchWorkgroup(o,[T,w,v],s)}execStatement(e,n){if(e instanceof Fw)return this.evalExpression(e.value,n);if(e instanceof Uw){if(e.condition){const r=this.evalExpression(e.condition,n);if(!(r instanceof Z))throw new Error("Invalid break-if condition");if(!r.value)return null}return Kn._breakObj}if(e instanceof zw)return Kn._continueObj;if(e instanceof bl)this._let(e,n);else if(e instanceof bi)this._var(e,n);else if(e instanceof vc)this._const(e,n);else if(e instanceof Ql)this._function(e,n);else{if(e instanceof Bw)return this._if(e,n);if(e instanceof Dw)return this._switch(e,n);if(e instanceof Iw)return this._for(e,n);if(e instanceof Rw)return this._while(e,n);if(e instanceof Ow)return this._loop(e,n);if(e instanceof v0){const r=n.clone();return r.currentFunctionName=n.currentFunctionName,this._execStatements(e.body,r)}if(e instanceof Nw)this._assign(e,n);else if(e instanceof Mw)this._increment(e,n);else{if(e instanceof vi)return null;if(e instanceof lg){const r=e.name;n.getVariable(r)===null&&n.setVariable(r,new Z(0,this.getTypeInfo("u32")))}else if(e instanceof Ag)this._call(e,n);else{if(e instanceof Lw||e instanceof cg)return null;console.error("Invalid statement type.",e,`Line ${e.line}`)}}}return null}evalExpression(e,n){return e instanceof zr?this._evalBinaryOp(e,n):e instanceof _n?this._evalLiteral(e,n):e instanceof gr?this._evalVariable(e,n):e instanceof ug?this._evalCall(e,n):e instanceof ii?this._evalCreate(e,n):e instanceof Vw?this._evalConst(e,n):e instanceof jw?this._evalBitcast(e,n):e instanceof pn?this._evalUnaryOp(e,n):(console.error("Invalid expression type",e,`Line ${e.line}`),null)}getTypeInfo(e){var n;if(e instanceof _e){const i=this.reflection.getTypeInfo(e);if(i!==null)return i}let r=(n=this.typeInfo[e])!==null&&n!==void 0?n:null;return r!==null||(r=this.reflection.getTypeInfoByName(e)),r}_setOverrides(e,n){for(const r in e){const i=e[r],s=this.reflection.getOverrideInfo(r);s!==null?(s.type===null&&(s.type=this.getTypeInfo("u32")),s.type.name==="u32"||s.type.name==="i32"||s.type.name==="f32"||s.type.name==="f16"?n.setVariable(r,new Z(i,s.type)):s.type.name==="bool"?n.setVariable(r,new Z(i?1:0,s.type)):s.type.name==="vec2"||s.type.name==="vec3"||s.type.name==="vec4"||s.type.name==="vec2f"||s.type.name==="vec3f"||s.type.name==="vec4f"||s.type.name==="vec2i"||s.type.name==="vec3i"||s.type.name==="vec4i"||s.type.name==="vec2u"||s.type.name==="vec3u"||s.type.name==="vec4u"||s.type.name==="vec2h"||s.type.name==="vec3h"||s.type.name==="vec4h"?n.setVariable(r,new W(i,s.type)):console.error(`Invalid constant type for ${r}`)):console.error(`Override ${r} does not exist in the shader.`)}}_dispatchWorkgroup(e,n,r){const i=[1,1,1];for(const m of e.node.attributes)if(m.name==="workgroup_size"){if(m.value.length>0){const v=r.getVariableValue(m.value[0]);i[0]=v instanceof Z?v.value:parseInt(m.value[0])}if(m.value.length>1){const v=r.getVariableValue(m.value[1]);i[1]=v instanceof Z?v.value:parseInt(m.value[1])}if(m.value.length>2){const v=r.getVariableValue(m.value[2]);i[2]=v instanceof Z?v.value:parseInt(m.value[2])}}const s=this.getTypeInfo("vec3u"),o=this.getTypeInfo("u32");r.setVariable("@workgroup_size",new W(i,s));const a=i[0],f=i[1],p=i[2];for(let m=0,v=0;m<p;++m)for(let w=0;w<f;++w)for(let T=0;T<a;++T,++v){const E=[T,w,m],N=[T+n[0]*i[0],w+n[1]*i[1],m+n[2]*i[2]];r.setVariable("@local_invocation_id",new W(E,s)),r.setVariable("@global_invocation_id",new W(N,s)),r.setVariable("@local_invocation_index",new Z(v,o)),this._dispatchExec(e,r)}}_dispatchExec(e,n){for(const r of e.node.args)for(const i of r.attributes)if(i.name==="builtin"){const s=`@${i.value}`,o=n.getVariable(s);o!==void 0&&n.variables.set(r.name,o)}this._execStatements(e.node.body,n)}getVariableName(e,n){for(;e instanceof pn;)e=e.right;return e instanceof gr?e.name:(console.error("Unknown variable type",e,"Line",e.line),null)}_execStatements(e,n){for(const r of e){if(r instanceof Array){const s=n.clone(),o=this._execStatements(r,s);if(o)return o;continue}const i=this.execStatement(r,n);if(i)return i}return null}_call(e,n){const r=n.clone();r.currentFunctionName=e.name;const i=n.getFunction(e.name);if(i){for(let s=0;s<i.node.args.length;++s){const o=i.node.args[s],a=this.evalExpression(e.args[s],r);r.setVariable(o.name,a,o)}this._execStatements(i.node.body,r)}else e.isBuiltin?this._callBuiltinFunction(e,r):this.getTypeInfo(e.name)&&this._evalCreate(e,n)}_increment(e,n){const r=this.getVariableName(e.variable,n),i=n.getVariable(r);i?e.operator==="++"?i.value instanceof Z?i.value.value++:console.error(`Variable ${r} is not a scalar. Line ${e.line}`):e.operator==="--"?i.value instanceof Z?i.value.value--:console.error(`Variable ${r} is not a scalar. Line ${e.line}`):console.error(`Unknown increment operator ${e.operator}. Line ${e.line}`):console.error(`Variable ${r} not found. Line ${e.line}`)}_getVariableData(e,n){if(e instanceof gr){const r=this.getVariableName(e,n),i=n.getVariable(r);return i===null?(console.error(`Variable ${r} not found. Line ${e.line}`),null):i.value.getSubData(this,e.postfix,n)}if(e instanceof pn){if(e.operator==="*"){const r=this._getVariableData(e.right,n);return r instanceof xo?r.reference.getSubData(this,e.postfix,n):(console.error(`Variable ${e.right} is not a pointer. Line ${e.line}`),null)}if(e.operator==="&"){const r=this._getVariableData(e.right,n);return new xo(r)}}return null}_assign(e,n){let r=null,i="<var>",s=null;if(e.variable instanceof pn){const f=this._getVariableData(e.variable,n),p=this.evalExpression(e.value,n),m=e.operator;if(m==="="){if(f instanceof Z||f instanceof W||f instanceof Ye){if(p instanceof Z||p instanceof W||p instanceof Ye&&f.data.length===p.data.length)return void f.data.set(p.data);console.error(`Invalid assignment. Line ${e.line}`)}else if(f instanceof ln&&p instanceof ln&&f.buffer.byteLength-f.offset>=p.buffer.byteLength-p.offset)return void(f.buffer.byteLength%4==0?new Uint32Array(f.buffer,f.offset,f.typeInfo.size/4).set(new Uint32Array(p.buffer,p.offset,p.typeInfo.size/4)):new Uint8Array(f.buffer,f.offset,f.typeInfo.size).set(new Uint8Array(p.buffer,p.offset,p.typeInfo.size)));return console.error(`Invalid assignment. Line ${e.line}`),null}if(m==="+=")return f instanceof Z||f instanceof W||f instanceof Ye?p instanceof Z||p instanceof W||p instanceof Ye?void f.data.set(p.data.map((v,w)=>f.data[w]+v)):void console.error(`Invalid assignment . Line ${e.line}`):void console.error(`Invalid assignment. Line ${e.line}`);if(m==="-=")return(f instanceof Z||f instanceof W||f instanceof Ye)&&(p instanceof Z||p instanceof W||p instanceof Ye)?void f.data.set(p.data.map((v,w)=>f.data[w]-v)):void console.error(`Invalid assignment. Line ${e.line}`)}if(e.variable instanceof pn){if(e.variable.operator==="*"){i=this.getVariableName(e.variable.right,n);const f=n.getVariable(i);if(!(f&&f.value instanceof xo))return void console.error(`Variable ${i} is not a pointer. Line ${e.line}`);r=f.value.reference;let p=e.variable.postfix;if(!p){let m=e.variable.right;for(;m instanceof pn;){if(m.postfix){p=m.postfix;break}m=m.right}}p&&(r=r.getSubData(this,p,n))}}else{s=e.variable.postfix,i=this.getVariableName(e.variable,n);const f=n.getVariable(i);if(f===null)return void console.error(`Variable ${i} not found. Line ${e.line}`);r=f.value}if(r instanceof xo&&(r=r.reference),r===null)return void console.error(`Variable ${i} not found. Line ${e.line}`);const o=this.evalExpression(e.value,n),a=e.operator;if(a==="=")if(r instanceof ln)r.setDataValue(this,o,s,n);else if(s){if(!(r instanceof W||r instanceof Ye))return void console.error(`Variable ${i} is not a vector or matrix. Line ${e.line}`);if(s instanceof ua){const f=this.evalExpression(s.index,n).value;if(r instanceof W){if(!(o instanceof Z))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[f]=o.value}else{if(!(r instanceof Ye))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);{const p=this.evalExpression(s.index,n).value;if(p<0)return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(!(o instanceof W))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);{const m=r.typeInfo.getTypeName();if(m==="mat2x2"||m==="mat2x2f"||m==="mat2x2h"){if(!(p<2&&o.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[2*p]=o.data[0],r.data[2*p+1]=o.data[1]}else if(m==="mat2x3"||m==="mat2x3f"||m==="mat2x3h"){if(!(p<2&&o.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[3*p]=o.data[0],r.data[3*p+1]=o.data[1],r.data[3*p+2]=o.data[2]}else if(m==="mat2x4"||m==="mat2x4f"||m==="mat2x4h"){if(!(p<2&&o.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[4*p]=o.data[0],r.data[4*p+1]=o.data[1],r.data[4*p+2]=o.data[2],r.data[4*p+3]=o.data[3]}else if(m==="mat3x2"||m==="mat3x2f"||m==="mat3x2h"){if(!(p<3&&o.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[2*p]=o.data[0],r.data[2*p+1]=o.data[1]}else if(m==="mat3x3"||m==="mat3x3f"||m==="mat3x3h"){if(!(p<3&&o.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[3*p]=o.data[0],r.data[3*p+1]=o.data[1],r.data[3*p+2]=o.data[2]}else if(m==="mat3x4"||m==="mat3x4f"||m==="mat3x4h"){if(!(p<3&&o.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[4*p]=o.data[0],r.data[4*p+1]=o.data[1],r.data[4*p+2]=o.data[2],r.data[4*p+3]=o.data[3]}else if(m==="mat4x2"||m==="mat4x2f"||m==="mat4x2h"){if(!(p<4&&o.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[2*p]=o.data[0],r.data[2*p+1]=o.data[1]}else if(m==="mat4x3"||m==="mat4x3f"||m==="mat4x3h"){if(!(p<4&&o.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[3*p]=o.data[0],r.data[3*p+1]=o.data[1],r.data[3*p+2]=o.data[2]}else{if(m!=="mat4x4"&&m!=="mat4x4f"&&m!=="mat4x4h")return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(!(p<4&&o.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[4*p]=o.data[0],r.data[4*p+1]=o.data[1],r.data[4*p+2]=o.data[2],r.data[4*p+3]=o.data[3]}}}}}else if(s instanceof Zs){const f=s.value;if(!(r instanceof W))return void console.error(`Invalid assignment to ${f}. Variable ${i} is not a vector. Line ${e.line}`);if(o instanceof Z){if(f.length>1)return void console.error(`Invalid assignment to ${f} for variable ${i}. Line ${e.line}`);if(f==="x")r.data[0]=o.value;else if(f==="y"){if(r.data.length<2)return void console.error(`Invalid assignment to ${f} for variable ${i}. Line ${e.line}`);r.data[1]=o.value}else if(f==="z"){if(r.data.length<3)return void console.error(`Invalid assignment to ${f} for variable ${i}. Line ${e.line}`);r.data[2]=o.value}else if(f==="w"){if(r.data.length<4)return void console.error(`Invalid assignment to ${f} for variable ${i}. Line ${e.line}`);r.data[3]=o.value}}else{if(!(o instanceof W))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(f.length!==o.data.length)return void console.error(`Invalid assignment to ${f} for variable ${i}. Line ${e.line}`);for(let p=0;p<f.length;++p){const m=f[p];if(m==="x"||m==="r")r.data[0]=o.data[p];else if(m==="y"||m==="g"){if(o.data.length<2)return void console.error(`Invalid assignment to ${m} for variable ${i}. Line ${e.line}`);r.data[1]=o.data[p]}else if(m==="z"||m==="b"){if(o.data.length<3)return void console.error(`Invalid assignment to ${m} for variable ${i}. Line ${e.line}`);r.data[2]=o.data[p]}else{if(m!=="w"&&m!=="a")return void console.error(`Invalid assignment to ${m} for variable ${i}. Line ${e.line}`);if(o.data.length<4)return void console.error(`Invalid assignment to ${m} for variable ${i}. Line ${e.line}`);r.data[3]=o.data[p]}}}}}else r instanceof Z&&o instanceof Z?r.value=o.value:r instanceof W&&o instanceof W||r instanceof Ye&&o instanceof Ye?r.data.set(o.data):console.error(`Invalid assignment to ${i}. Line ${e.line}`);else{const f=r.getSubData(this,s,n);if(f instanceof W&&o instanceof Z){const p=f.data,m=o.value;if(a==="+=")for(let v=0;v<p.length;++v)p[v]+=m;else if(a==="-=")for(let v=0;v<p.length;++v)p[v]-=m;else if(a==="*=")for(let v=0;v<p.length;++v)p[v]*=m;else if(a==="/=")for(let v=0;v<p.length;++v)p[v]/=m;else if(a==="%=")for(let v=0;v<p.length;++v)p[v]%=m;else if(a==="&=")for(let v=0;v<p.length;++v)p[v]&=m;else if(a==="|=")for(let v=0;v<p.length;++v)p[v]|=m;else if(a==="^=")for(let v=0;v<p.length;++v)p[v]^=m;else if(a==="<<=")for(let v=0;v<p.length;++v)p[v]<<=m;else if(a===">>=")for(let v=0;v<p.length;++v)p[v]>>=m;else console.error(`Invalid operator ${a}. Line ${e.line}`)}else if(f instanceof W&&o instanceof W){const p=f.data,m=o.data;if(p.length!==m.length)return void console.error(`Vector length mismatch. Line ${e.line}`);if(a==="+=")for(let v=0;v<p.length;++v)p[v]+=m[v];else if(a==="-=")for(let v=0;v<p.length;++v)p[v]-=m[v];else if(a==="*=")for(let v=0;v<p.length;++v)p[v]*=m[v];else if(a==="/=")for(let v=0;v<p.length;++v)p[v]/=m[v];else if(a==="%=")for(let v=0;v<p.length;++v)p[v]%=m[v];else if(a==="&=")for(let v=0;v<p.length;++v)p[v]&=m[v];else if(a==="|=")for(let v=0;v<p.length;++v)p[v]|=m[v];else if(a==="^=")for(let v=0;v<p.length;++v)p[v]^=m[v];else if(a==="<<=")for(let v=0;v<p.length;++v)p[v]<<=m[v];else if(a===">>=")for(let v=0;v<p.length;++v)p[v]>>=m[v];else console.error(`Invalid operator ${a}. Line ${e.line}`)}else{if(!(f instanceof Z&&o instanceof Z))return void console.error(`Invalid type for ${e.operator} operator. Line ${e.line}`);a==="+="?f.value+=o.value:a==="-="?f.value-=o.value:a==="*="?f.value*=o.value:a==="/="?f.value/=o.value:a==="%="?f.value%=o.value:a==="&="?f.value&=o.value:a==="|="?f.value|=o.value:a==="^="?f.value^=o.value:a==="<<="?f.value<<=o.value:a===">>="?f.value>>=o.value:console.error(`Invalid operator ${a}. Line ${e.line}`)}r instanceof ln&&r.setDataValue(this,f,s,n)}}_function(e,n){const r=new hg(e);n.functions.set(e.name,r)}_const(e,n){let r=null;e.value!==null&&(r=this.evalExpression(e.value,n)),n.createVariable(e.name,r,e)}_let(e,n){let r=null;if(e.value!==null){if(r=this.evalExpression(e.value,n),r===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof pn||(r=r.clone())}else{const i=e.type.name;if(i==="f32"||i==="i32"||i==="u32"||i==="bool"||i==="f16"||i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2b"||i==="vec3b"||i==="vec4b"||i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"||i==="array"){const s=new ii(e.type,[]);r=this._evalCreate(s,n)}}n.createVariable(e.name,r,e)}_var(e,n){let r=null;if(e.value!==null){if(r=this.evalExpression(e.value,n),r===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof pn||(r=r.clone())}else{if(e.type===null)return void console.error(`Variable ${e.name} has no type. Line ${e.line}`);const i=e.type.name;if(i==="f32"||i==="i32"||i==="u32"||i==="bool"||i==="f16"||i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2b"||i==="vec3b"||i==="vec4b"||i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"||e.type instanceof xl||e.type instanceof vi||e.type instanceof re){const s=new ii(e.type,[]);r=this._evalCreate(s,n)}}n.createVariable(e.name,r,e)}_switch(e,n){n=n.clone();const r=this.evalExpression(e.condition,n);if(!(r instanceof Z))return console.error(`Invalid if condition. Line ${e.line}`),null;let i=null;for(const s of e.cases)if(s instanceof Hw)for(const o of s.selectors){if(o instanceof wc){i=s;continue}const a=this.evalExpression(o,n);if(!(a instanceof Z))return console.error(`Invalid case selector. Line ${e.line}`),null;if(a.value===r.value)return this._execStatements(s.body,n)}else s instanceof Xw&&(i=s);return i?this._execStatements(i.body,n):null}_if(e,n){n=n.clone();const r=this.evalExpression(e.condition,n);if(!(r instanceof Z))return console.error(`Invalid if condition. Line ${e.line}`),null;if(r.value)return this._execStatements(e.body,n);for(const i of e.elseif){const s=this.evalExpression(i.condition,n);if(!(s instanceof Z))return console.error(`Invalid if condition. Line ${e.line}`),null;if(s.value)return this._execStatements(i.body,n)}return e.else?this._execStatements(e.else,n):null}_getScalarValue(e){return e instanceof Z?e.value:(console.error("Expected scalar value.",e),0)}_for(e,n){for(n=n.clone(),this.execStatement(e.init,n);this._getScalarValue(this.evalExpression(e.condition,n));){const r=this._execStatements(e.body,n);if(r===Kn._breakObj)break;if(r!==null&&r!==Kn._continueObj)return r;this.execStatement(e.increment,n)}return null}_loop(e,n){for(n=n.clone();;){const r=this._execStatements(e.body,n);if(r===Kn._breakObj)break;if(r===Kn._continueObj){if(e.continuing&&this._execStatements(e.continuing.body,n)===Kn._breakObj)break}else if(r!==null)return r}return null}_while(e,n){for(n=n.clone();this._getScalarValue(this.evalExpression(e.condition,n));){const r=this._execStatements(e.body,n);if(r===Kn._breakObj)break;if(r!==Kn._continueObj&&r!==null)return r}return null}_evalBitcast(e,n){const r=this.evalExpression(e.value,n),i=e.type;if(r instanceof Z){const s=y_(r.value,r.typeInfo.name,i.name);return new Z(s,this.getTypeInfo(i))}if(r instanceof W){const s=r.typeInfo.getTypeName();let o="";if(s.endsWith("f"))o="f32";else if(s.endsWith("i"))o="i32";else if(s.endsWith("u"))o="u32";else if(s.endsWith("b"))o="bool";else{if(!s.endsWith("h"))return console.error(`Unknown vector type ${s}. Line ${e.line}`),null;o="f16"}const a=i.getTypeName();let f="";if(a.endsWith("f"))f="f32";else if(a.endsWith("i"))f="i32";else if(a.endsWith("u"))f="u32";else if(a.endsWith("b"))f="bool";else{if(!a.endsWith("h"))return console.error(`Unknown vector type ${f}. Line ${e.line}`),null;f="f16"}const p=function(m,v,w){if(v===w)return m;const T=new Array(m.length);for(let E=0;E<m.length;E++)T[E]=y_(m[E],v,w);return T}(Array.from(r.data),o,f);return new W(p,this.getTypeInfo(i))}return console.error(`TODO: bitcast for ${r.typeInfo.name}. Line ${e.line}`),null}_evalConst(e,n){return n.getVariableValue(e.name).clone().getSubData(this,e.postfix,n)}_evalCreate(e,n){var r;if(e instanceof ii){if(e.type===null)return w0.void;switch(e.type.getTypeName()){case"bool":case"i32":case"u32":case"f32":case"f16":return this._callConstructorValue(e,n);case"vec2":case"vec3":case"vec4":case"vec2f":case"vec3f":case"vec4f":case"vec2h":case"vec3h":case"vec4h":case"vec2i":case"vec3i":case"vec4i":case"vec2u":case"vec3u":case"vec4u":case"vec2b":case"vec3b":case"vec4b":return this._callConstructorVec(e,n);case"mat2x2":case"mat2x2f":case"mat2x2h":case"mat2x3":case"mat2x3f":case"mat2x3h":case"mat2x4":case"mat2x4f":case"mat2x4h":case"mat3x2":case"mat3x2f":case"mat3x2h":case"mat3x3":case"mat3x3f":case"mat3x3h":case"mat3x4":case"mat3x4f":case"mat3x4h":case"mat4x2":case"mat4x2f":case"mat4x2h":case"mat4x3":case"mat4x3f":case"mat4x3h":case"mat4x4":case"mat4x4f":case"mat4x4h":return this._callConstructorMatrix(e,n)}}const i=e instanceof ii?e.type.name:e.name,s=e instanceof ii?this.getTypeInfo(e.type):this.getTypeInfo(e.name);if(s===null)return console.error(`Unknown type ${i}. Line ${e.line}`),null;if(s.size===0)return null;const o=new ln(new ArrayBuffer(s.size),s,0);if(s instanceof es){if(e.args)for(let a=0;a<e.args.length;++a){const f=s.members[a],p=e.args[a],m=this.evalExpression(p,n);o.setData(this,m,f.type,f.offset,n)}}else if(s instanceof hs){let a=0;if(e.args)for(let f=0;f<e.args.length;++f){const p=e.args[f],m=this.evalExpression(p,n);s.format===null&&(((r=m.typeInfo)===null||r===void 0?void 0:r.name)==="x32"?s.format=this.getTypeInfo("i32"):s.format=m.typeInfo),o.setData(this,m,s.format,a,n),a+=s.stride}}else console.error(`Unknown type "${i}". Line ${e.line}`);return e instanceof ii?o.getSubData(this,e.postfix,n):o}_evalLiteral(e,n){const r=this.getTypeInfo(e.type),i=r.name;return i==="x32"||i==="u32"||i==="f32"||i==="f16"||i==="i32"||i==="bool"?new Z(e.scalarValue,r):i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"?this._callConstructorVec(e,n):i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"?this._callConstructorMatrix(e,n):e.value}_evalVariable(e,n){const r=n.getVariableValue(e.name);return r===null?r:r.getSubData(this,e.postfix,n)}_maxFormatTypeInfo(e){let n=e[0];if(n.name==="f32")return n;for(let r=1;r<e.length;++r){const i=Kn._priority.get(n.name);Kn._priority.get(e[r].name)<i&&(n=e[r])}return n.name==="x32"?this.getTypeInfo("i32"):n}_evalUnaryOp(e,n){const r=this.evalExpression(e.right,n);if(e.operator==="&")return new xo(r);if(e.operator==="*")return r instanceof xo?r.reference.getSubData(this,e.postfix,n):(console.error(`Invalid dereference. Line ${e.line}`),null);const i=r instanceof Z?r.value:r instanceof W?Array.from(r.data):null;switch(e.operator){case"+":{if(Ie(i)){const a=i.map((f,p)=>+f);return new W(a,r.typeInfo)}const s=i,o=this._maxFormatTypeInfo([r.typeInfo,r.typeInfo]);return new Z(+s,o)}case"-":{if(Ie(i)){const a=i.map((f,p)=>-f);return new W(a,r.typeInfo)}const s=i,o=this._maxFormatTypeInfo([r.typeInfo,r.typeInfo]);return new Z(-s,o)}case"!":{if(Ie(i)){const a=i.map((f,p)=>f?0:1);return new W(a,r.typeInfo)}const s=i,o=this._maxFormatTypeInfo([r.typeInfo,r.typeInfo]);return new Z(s?0:1,o)}case"~":{if(Ie(i)){const a=i.map((f,p)=>~f);return new W(a,r.typeInfo)}const s=i,o=this._maxFormatTypeInfo([r.typeInfo,r.typeInfo]);return new Z(~s,o)}}return console.error(`Invalid unary operator ${e.operator}. Line ${e.line}`),null}_evalBinaryOp(e,n){const r=this.evalExpression(e.left,n),i=this.evalExpression(e.right,n),s=r instanceof Z?r.value:r instanceof W||r instanceof Ye?Array.from(r.data):null,o=i instanceof Z?i.value:i instanceof W||i instanceof Ye?Array.from(i.data):null;switch(e.operator){case"+":{if(Ie(s)&&Ie(o)){const m=s,v=o;if(m.length!==v.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const w=m.map((T,E)=>T+v[E]);return new W(w,r.typeInfo)}if(Ie(s)){const m=o,v=s.map((w,T)=>w+m);return new W(v,r.typeInfo)}if(Ie(o)){const m=s,v=o.map((w,T)=>m+w);return new W(v,i.typeInfo)}const a=s,f=o,p=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new Z(a+f,p)}case"-":{if(Ie(s)&&Ie(o)){const m=s,v=o;if(m.length!==v.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const w=m.map((T,E)=>T-v[E]);return new W(w,r.typeInfo)}if(Ie(s)){const m=o,v=s.map((w,T)=>w-m);return new W(v,r.typeInfo)}if(Ie(o)){const m=s,v=o.map((w,T)=>m-w);return new W(v,i.typeInfo)}const a=s,f=o,p=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new Z(a-f,p)}case"*":{if(Ie(s)&&Ie(o)){const m=s,v=o;if(r instanceof Ye&&i instanceof Ye){const w=function(j,I,R,k){if(tr[I.name]===void 0||tr[k.name]===void 0)return null;const B=tr[I.name][0],Y=tr[I.name][1],G=tr[k.name][0];if(B!==tr[k.name][1])return null;const ce=new Array(G*Y);for(let U=0;U<Y;U++)for(let $=0;$<G;$++){let K=0;for(let ue=0;ue<B;ue++)K+=j[ue*Y+U]*R[$*B+ue];ce[U*G+$]=K}return ce}(m,r.typeInfo,v,i.typeInfo);if(w===null)return console.error(`Matrix multiplication failed. Line ${e.line}.`),null;const T=tr[i.typeInfo.name][0],E=tr[r.typeInfo.name][1],N=this.getTypeInfo(`mat${T}x${E}f`);return new Ye(w,N)}if(r instanceof Ye&&i instanceof W){const w=function(T,E,N,j){if(tr[E.name]===void 0||Uh[j.name]===void 0)return null;const I=tr[E.name][0],R=tr[E.name][1];if(I!==N.length)return null;const k=new Array(R);for(let B=0;B<R;B++){let Y=0;for(let G=0;G<I;G++)Y+=T[G*R+B]*N[G];k[B]=Y}return k}(m,r.typeInfo,v,i.typeInfo);return w===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new W(w,i.typeInfo)}if(r instanceof W&&i instanceof Ye){const w=function(T,E,N,j){if(Uh[E.name]===void 0||tr[j.name]===void 0)return null;const I=tr[j.name][0],R=tr[j.name][1];if(R!==T.length)return null;const k=[];for(let B=0;B<I;B++){let Y=0;for(let G=0;G<R;G++)Y+=T[G]*N[G*I+B];k[B]=Y}return k}(m,r.typeInfo,v,i.typeInfo);return w===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new W(w,r.typeInfo)}{if(m.length!==v.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const w=m.map((T,E)=>T*v[E]);return new W(w,r.typeInfo)}}if(Ie(s)){const m=o,v=s.map((w,T)=>w*m);return r instanceof Ye?new Ye(v,r.typeInfo):new W(v,r.typeInfo)}if(Ie(o)){const m=s,v=o.map((w,T)=>m*w);return i instanceof Ye?new Ye(v,i.typeInfo):new W(v,i.typeInfo)}const a=s,f=o,p=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new Z(a*f,p)}case"%":{if(Ie(s)&&Ie(o)){const m=s,v=o;if(m.length!==v.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const w=m.map((T,E)=>T%v[E]);return new W(w,r.typeInfo)}if(Ie(s)){const m=o,v=s.map((w,T)=>w%m);return new W(v,r.typeInfo)}if(Ie(o)){const m=s,v=o.map((w,T)=>m%w);return new W(v,i.typeInfo)}const a=s,f=o,p=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new Z(a%f,p)}case"/":{if(Ie(s)&&Ie(o)){const m=s,v=o;if(m.length!==v.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const w=m.map((T,E)=>T/v[E]);return new W(w,r.typeInfo)}if(Ie(s)){const m=o,v=s.map((w,T)=>w/m);return new W(v,r.typeInfo)}if(Ie(o)){const m=s,v=o.map((w,T)=>m/w);return new W(v,i.typeInfo)}const a=s,f=o,p=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new Z(a/f,p)}case"&":{if(Ie(s)&&Ie(o)){const m=s,v=o;if(m.length!==v.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const w=m.map((T,E)=>T&v[E]);return new W(w,r.typeInfo)}if(Ie(s)){const m=o,v=s.map((w,T)=>w&m);return new W(v,r.typeInfo)}if(Ie(o)){const m=s,v=o.map((w,T)=>m&w);return new W(v,i.typeInfo)}const a=s,f=o,p=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new Z(a&f,p)}case"|":{if(Ie(s)&&Ie(o)){const m=s,v=o;if(m.length!==v.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const w=m.map((T,E)=>T|v[E]);return new W(w,r.typeInfo)}if(Ie(s)){const m=o,v=s.map((w,T)=>w|m);return new W(v,r.typeInfo)}if(Ie(o)){const m=s,v=o.map((w,T)=>m|w);return new W(v,i.typeInfo)}const a=s,f=o,p=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new Z(a|f,p)}case"^":{if(Ie(s)&&Ie(o)){const m=s,v=o;if(m.length!==v.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const w=m.map((T,E)=>T^v[E]);return new W(w,r.typeInfo)}if(Ie(s)){const m=o,v=s.map((w,T)=>w^m);return new W(v,r.typeInfo)}if(Ie(o)){const m=s,v=o.map((w,T)=>m^w);return new W(v,i.typeInfo)}const a=s,f=o,p=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new Z(a^f,p)}case"<<":{if(Ie(s)&&Ie(o)){const m=s,v=o;if(m.length!==v.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const w=m.map((T,E)=>T<<v[E]);return new W(w,r.typeInfo)}if(Ie(s)){const m=o,v=s.map((w,T)=>w<<m);return new W(v,r.typeInfo)}if(Ie(o)){const m=s,v=o.map((w,T)=>m<<w);return new W(v,i.typeInfo)}const a=s,f=o,p=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new Z(a<<f,p)}case">>":{if(Ie(s)&&Ie(o)){const m=s,v=o;if(m.length!==v.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const w=m.map((T,E)=>T>>v[E]);return new W(w,r.typeInfo)}if(Ie(s)){const m=o,v=s.map((w,T)=>w>>m);return new W(v,r.typeInfo)}if(Ie(o)){const m=s,v=o.map((w,T)=>m>>w);return new W(v,i.typeInfo)}const a=s,f=o,p=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new Z(a>>f,p)}case">":if(Ie(s)&&Ie(o)){const a=s,f=o;if(a.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const p=a.map((m,v)=>m>f[v]?1:0);return new W(p,r.typeInfo)}if(Ie(s)){const a=o,f=s.map((p,m)=>p>a?1:0);return new W(f,r.typeInfo)}if(Ie(o)){const a=s,f=o.map((p,m)=>a>p?1:0);return new W(f,i.typeInfo)}return new Z(s>o?1:0,this.getTypeInfo("bool"));case"<":if(Ie(s)&&Ie(o)){const a=s,f=o;if(a.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const p=a.map((m,v)=>m<f[v]?1:0);return new W(p,r.typeInfo)}if(Ie(s)){const a=o,f=s.map((p,m)=>p<a?1:0);return new W(f,r.typeInfo)}if(Ie(o)){const a=s,f=o.map((p,m)=>a<p?1:0);return new W(f,i.typeInfo)}return new Z(s<o?1:0,this.getTypeInfo("bool"));case"==":if(Ie(s)&&Ie(o)){const a=s,f=o;if(a.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const p=a.map((m,v)=>m===f[v]?1:0);return new W(p,r.typeInfo)}if(Ie(s)){const a=o,f=s.map((p,m)=>p==a?1:0);return new W(f,r.typeInfo)}if(Ie(o)){const a=s,f=o.map((p,m)=>a==p?1:0);return new W(f,i.typeInfo)}return new Z(s===o?1:0,this.getTypeInfo("bool"));case"!=":if(Ie(s)&&Ie(o)){const a=s,f=o;if(a.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const p=a.map((m,v)=>m!==f[v]?1:0);return new W(p,r.typeInfo)}if(Ie(s)){const a=o,f=s.map((p,m)=>p!==a?1:0);return new W(f,r.typeInfo)}if(Ie(o)){const a=s,f=o.map((p,m)=>a!==p?1:0);return new W(f,i.typeInfo)}return new Z(s!==o?1:0,this.getTypeInfo("bool"));case">=":if(Ie(s)&&Ie(o)){const a=s,f=o;if(a.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const p=a.map((m,v)=>m>=f[v]?1:0);return new W(p,r.typeInfo)}if(Ie(s)){const a=o,f=s.map((p,m)=>p>=a?1:0);return new W(f,r.typeInfo)}if(Ie(o)){const a=s,f=o.map((p,m)=>a>=p?1:0);return new W(f,i.typeInfo)}return new Z(s>=o?1:0,this.getTypeInfo("bool"));case"<=":if(Ie(s)&&Ie(o)){const a=s,f=o;if(a.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const p=a.map((m,v)=>m<=f[v]?1:0);return new W(p,r.typeInfo)}if(Ie(s)){const a=o,f=s.map((p,m)=>p<=a?1:0);return new W(f,r.typeInfo)}if(Ie(o)){const a=s,f=o.map((p,m)=>a<=p?1:0);return new W(f,i.typeInfo)}return new Z(s<=o?1:0,this.getTypeInfo("bool"));case"&&":if(Ie(s)&&Ie(o)){const a=s,f=o;if(a.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const p=a.map((m,v)=>m&&f[v]?1:0);return new W(p,r.typeInfo)}if(Ie(s)){const a=o,f=s.map((p,m)=>p&&a?1:0);return new W(f,r.typeInfo)}if(Ie(o)){const a=s,f=o.map((p,m)=>a&&p?1:0);return new W(f,i.typeInfo)}return new Z(s&&o?1:0,this.getTypeInfo("bool"));case"||":if(Ie(s)&&Ie(o)){const a=s,f=o;if(a.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const p=a.map((m,v)=>m||f[v]?1:0);return new W(p,r.typeInfo)}if(Ie(s)){const a=o,f=s.map((p,m)=>p||a?1:0);return new W(f,r.typeInfo)}if(Ie(o)){const a=s,f=o.map((p,m)=>a||p?1:0);return new W(f,i.typeInfo)}return new Z(s||o?1:0,this.getTypeInfo("bool"))}return console.error(`Unknown operator ${e.operator}. Line ${e.line}`),null}_evalCall(e,n){if(e.cachedReturnValue!==null)return e.cachedReturnValue;const r=n.clone();r.currentFunctionName=e.name;const i=n.getFunction(e.name);if(!i)return e.isBuiltin?this._callBuiltinFunction(e,r):this.getTypeInfo(e.name)?this._evalCreate(e,n):(console.error(`Unknown function "${e.name}". Line ${e.line}`),null);for(let s=0;s<i.node.args.length;++s){const o=i.node.args[s],a=this.evalExpression(e.args[s],r);r.createVariable(o.name,a,o)}return this._execStatements(i.node.body,r)}_callBuiltinFunction(e,n){switch(e.name){case"all":return this.builtins.All(e,n);case"any":return this.builtins.Any(e,n);case"select":return this.builtins.Select(e,n);case"arrayLength":return this.builtins.ArrayLength(e,n);case"abs":return this.builtins.Abs(e,n);case"acos":return this.builtins.Acos(e,n);case"acosh":return this.builtins.Acosh(e,n);case"asin":return this.builtins.Asin(e,n);case"asinh":return this.builtins.Asinh(e,n);case"atan":return this.builtins.Atan(e,n);case"atanh":return this.builtins.Atanh(e,n);case"atan2":return this.builtins.Atan2(e,n);case"ceil":return this.builtins.Ceil(e,n);case"clamp":return this.builtins.Clamp(e,n);case"cos":return this.builtins.Cos(e,n);case"cosh":return this.builtins.Cosh(e,n);case"countLeadingZeros":return this.builtins.CountLeadingZeros(e,n);case"countOneBits":return this.builtins.CountOneBits(e,n);case"countTrailingZeros":return this.builtins.CountTrailingZeros(e,n);case"cross":return this.builtins.Cross(e,n);case"degrees":return this.builtins.Degrees(e,n);case"determinant":return this.builtins.Determinant(e,n);case"distance":return this.builtins.Distance(e,n);case"dot":return this.builtins.Dot(e,n);case"dot4U8Packed":return this.builtins.Dot4U8Packed(e,n);case"dot4I8Packed":return this.builtins.Dot4I8Packed(e,n);case"exp":return this.builtins.Exp(e,n);case"exp2":return this.builtins.Exp2(e,n);case"extractBits":return this.builtins.ExtractBits(e,n);case"faceForward":return this.builtins.FaceForward(e,n);case"firstLeadingBit":return this.builtins.FirstLeadingBit(e,n);case"firstTrailingBit":return this.builtins.FirstTrailingBit(e,n);case"floor":return this.builtins.Floor(e,n);case"fma":return this.builtins.Fma(e,n);case"fract":return this.builtins.Fract(e,n);case"frexp":return this.builtins.Frexp(e,n);case"insertBits":return this.builtins.InsertBits(e,n);case"inverseSqrt":return this.builtins.InverseSqrt(e,n);case"ldexp":return this.builtins.Ldexp(e,n);case"length":return this.builtins.Length(e,n);case"log":return this.builtins.Log(e,n);case"log2":return this.builtins.Log2(e,n);case"max":return this.builtins.Max(e,n);case"min":return this.builtins.Min(e,n);case"mix":return this.builtins.Mix(e,n);case"modf":return this.builtins.Modf(e,n);case"normalize":return this.builtins.Normalize(e,n);case"pow":return this.builtins.Pow(e,n);case"quantizeToF16":return this.builtins.QuantizeToF16(e,n);case"radians":return this.builtins.Radians(e,n);case"reflect":return this.builtins.Reflect(e,n);case"refract":return this.builtins.Refract(e,n);case"reverseBits":return this.builtins.ReverseBits(e,n);case"round":return this.builtins.Round(e,n);case"saturate":return this.builtins.Saturate(e,n);case"sign":return this.builtins.Sign(e,n);case"sin":return this.builtins.Sin(e,n);case"sinh":return this.builtins.Sinh(e,n);case"smoothStep":return this.builtins.SmoothStep(e,n);case"sqrt":return this.builtins.Sqrt(e,n);case"step":return this.builtins.Step(e,n);case"tan":return this.builtins.Tan(e,n);case"tanh":return this.builtins.Tanh(e,n);case"transpose":return this.builtins.Transpose(e,n);case"trunc":return this.builtins.Trunc(e,n);case"dpdx":return this.builtins.Dpdx(e,n);case"dpdxCoarse":return this.builtins.DpdxCoarse(e,n);case"dpdxFine":return this.builtins.DpdxFine(e,n);case"dpdy":return this.builtins.Dpdy(e,n);case"dpdyCoarse":return this.builtins.DpdyCoarse(e,n);case"dpdyFine":return this.builtins.DpdyFine(e,n);case"fwidth":return this.builtins.Fwidth(e,n);case"fwidthCoarse":return this.builtins.FwidthCoarse(e,n);case"fwidthFine":return this.builtins.FwidthFine(e,n);case"textureDimensions":return this.builtins.TextureDimensions(e,n);case"textureGather":return this.builtins.TextureGather(e,n);case"textureGatherCompare":return this.builtins.TextureGatherCompare(e,n);case"textureLoad":return this.builtins.TextureLoad(e,n);case"textureNumLayers":return this.builtins.TextureNumLayers(e,n);case"textureNumLevels":return this.builtins.TextureNumLevels(e,n);case"textureNumSamples":return this.builtins.TextureNumSamples(e,n);case"textureSample":return this.builtins.TextureSample(e,n);case"textureSampleBias":return this.builtins.TextureSampleBias(e,n);case"textureSampleCompare":return this.builtins.TextureSampleCompare(e,n);case"textureSampleCompareLevel":return this.builtins.TextureSampleCompareLevel(e,n);case"textureSampleGrad":return this.builtins.TextureSampleGrad(e,n);case"textureSampleLevel":return this.builtins.TextureSampleLevel(e,n);case"textureSampleBaseClampToEdge":return this.builtins.TextureSampleBaseClampToEdge(e,n);case"textureStore":return this.builtins.TextureStore(e,n);case"atomicLoad":return this.builtins.AtomicLoad(e,n);case"atomicStore":return this.builtins.AtomicStore(e,n);case"atomicAdd":return this.builtins.AtomicAdd(e,n);case"atomicSub":return this.builtins.AtomicSub(e,n);case"atomicMax":return this.builtins.AtomicMax(e,n);case"atomicMin":return this.builtins.AtomicMin(e,n);case"atomicAnd":return this.builtins.AtomicAnd(e,n);case"atomicOr":return this.builtins.AtomicOr(e,n);case"atomicXor":return this.builtins.AtomicXor(e,n);case"atomicExchange":return this.builtins.AtomicExchange(e,n);case"atomicCompareExchangeWeak":return this.builtins.AtomicCompareExchangeWeak(e,n);case"pack4x8snorm":return this.builtins.Pack4x8snorm(e,n);case"pack4x8unorm":return this.builtins.Pack4x8unorm(e,n);case"pack4xI8":return this.builtins.Pack4xI8(e,n);case"pack4xU8":return this.builtins.Pack4xU8(e,n);case"pack4x8Clamp":return this.builtins.Pack4x8Clamp(e,n);case"pack4xU8Clamp":return this.builtins.Pack4xU8Clamp(e,n);case"pack2x16snorm":return this.builtins.Pack2x16snorm(e,n);case"pack2x16unorm":return this.builtins.Pack2x16unorm(e,n);case"pack2x16float":return this.builtins.Pack2x16float(e,n);case"unpack4x8snorm":return this.builtins.Unpack4x8snorm(e,n);case"unpack4x8unorm":return this.builtins.Unpack4x8unorm(e,n);case"unpack4xI8":return this.builtins.Unpack4xI8(e,n);case"unpack4xU8":return this.builtins.Unpack4xU8(e,n);case"unpack2x16snorm":return this.builtins.Unpack2x16snorm(e,n);case"unpack2x16unorm":return this.builtins.Unpack2x16unorm(e,n);case"unpack2x16float":return this.builtins.Unpack2x16float(e,n);case"storageBarrier":return this.builtins.StorageBarrier(e,n);case"textureBarrier":return this.builtins.TextureBarrier(e,n);case"workgroupBarrier":return this.builtins.WorkgroupBarrier(e,n);case"workgroupUniformLoad":return this.builtins.WorkgroupUniformLoad(e,n);case"subgroupAdd":return this.builtins.SubgroupAdd(e,n);case"subgroupExclusiveAdd":return this.builtins.SubgroupExclusiveAdd(e,n);case"subgroupInclusiveAdd":return this.builtins.SubgroupInclusiveAdd(e,n);case"subgroupAll":return this.builtins.SubgroupAll(e,n);case"subgroupAnd":return this.builtins.SubgroupAnd(e,n);case"subgroupAny":return this.builtins.SubgroupAny(e,n);case"subgroupBallot":return this.builtins.SubgroupBallot(e,n);case"subgroupBroadcast":return this.builtins.SubgroupBroadcast(e,n);case"subgroupBroadcastFirst":return this.builtins.SubgroupBroadcastFirst(e,n);case"subgroupElect":return this.builtins.SubgroupElect(e,n);case"subgroupMax":return this.builtins.SubgroupMax(e,n);case"subgroupMin":return this.builtins.SubgroupMin(e,n);case"subgroupMul":return this.builtins.SubgroupMul(e,n);case"subgroupExclusiveMul":return this.builtins.SubgroupExclusiveMul(e,n);case"subgroupInclusiveMul":return this.builtins.SubgroupInclusiveMul(e,n);case"subgroupOr":return this.builtins.SubgroupOr(e,n);case"subgroupShuffle":return this.builtins.SubgroupShuffle(e,n);case"subgroupShuffleDown":return this.builtins.SubgroupShuffleDown(e,n);case"subgroupShuffleUp":return this.builtins.SubgroupShuffleUp(e,n);case"subgroupShuffleXor":return this.builtins.SubgroupShuffleXor(e,n);case"subgroupXor":return this.builtins.SubgroupXor(e,n);case"quadBroadcast":return this.builtins.QuadBroadcast(e,n);case"quadSwapDiagonal":return this.builtins.QuadSwapDiagonal(e,n);case"quadSwapX":return this.builtins.QuadSwapX(e,n);case"quadSwapY":return this.builtins.QuadSwapY(e,n)}const r=n.getFunction(e.name);if(r){const i=n.clone();for(let s=0;s<r.node.args.length;++s){const o=r.node.args[s],a=this.evalExpression(e.args[s],i);i.setVariable(o.name,a,o)}return this._execStatements(r.node.body,i)}return null}_callConstructorValue(e,n){if(!e.args||e.args.length===0)return new Z(0,this.getTypeInfo(e.type));const r=this.evalExpression(e.args[0],n);return r.typeInfo=this.getTypeInfo(e.type),r.getSubData(this,e.postfix,n).clone()}_callConstructorVec(e,n){const r=this.getTypeInfo(e.type),i=e.type.getTypeName(),s=Uh[i];if(s===void 0)return console.error(`Invalid vec constructor ${i}. Line ${e.line}`),null;const o=[];if(e instanceof _n)if(e.isVector){const a=e.vectorValue;for(const f of a)o.push(f)}else o.push(e.scalarValue);else if(e.args)for(const a of e.args){const f=this.evalExpression(a,n);if(f instanceof W){const p=f.data;for(let m=0;m<p.length;++m){let v=p[m];o.push(v)}}else if(f instanceof Z){let p=f.value;o.push(p)}}if(e.type instanceof re&&e.type.format===null&&(e.type.format=re.f32),o.length===0){const a=new Array(s).fill(0);return new W(a,r).getSubData(this,e.postfix,n)}if(o.length===1)for(;o.length<s;)o.push(o[0]);return o.length<s?(console.error(`Invalid vec constructor. Line ${e.line}`),null):new W(o.length>s?o.slice(0,s):o,r).getSubData(this,e.postfix,n)}_callConstructorMatrix(e,n){const r=this.getTypeInfo(e.type),i=e.type.getTypeName(),s=tr[i];if(s===void 0)return console.error(`Invalid matrix constructor ${i}. Line ${e.line}`),null;const o=[];if(e instanceof _n)if(e.isVector){const a=e.vectorValue;for(const f of a)o.push(f)}else o.push(e.scalarValue);else if(e.args)for(const a of e.args){const f=this.evalExpression(a,n);f instanceof W?o.push(...f.data):f instanceof Z?o.push(f.value):f instanceof Ye&&o.push(...f.data)}if(r instanceof qs&&r.format===null&&(r.format=this.getTypeInfo("f32")),o.length===0){const a=new Array(s[2]).fill(0);return new Ye(a,r).getSubData(this,e.postfix,n)}return o.length!==s[2]?(console.error(`Invalid matrix constructor. Line ${e.line}`),null):new Ye(o,r).getSubData(this,e.postfix,n)}}Kn._breakObj=new Dr(new Rr("BREAK",null),null),Kn._continueObj=new Dr(new Rr("CONTINUE",null),null),Kn._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class xI{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class TI{constructor(){this._tokens=[],this._current=0,this._currentLine=1,this._deferArrayCountEval=[],this._currentLoop=[],this._context=new xI,this._exec=new Kn,this._forwardTypeCount=0}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const n=[];for(;!this._isAtEnd();){const r=this._global_decl_or_directive();if(!r)break;n.push(r)}if(this._deferArrayCountEval.length>0){for(const r of this._deferArrayCountEval){const i=r.arrayType,s=r.countNode;if(s instanceof gr){const o=s.name,a=this._context.constants.get(o);if(a)try{const f=a.constEvaluate(this._exec);i.count=f}catch{}}}this._deferArrayCountEval.length=0}if(this._forwardTypeCount>0)for(const r of n)r.search(i=>{i instanceof m_||i instanceof Lh?i.type=this._forwardType(i.type):i instanceof xl?i.format=this._forwardType(i.format):i instanceof bi||i instanceof bl||i instanceof vc?i.type=this._forwardType(i.type):i instanceof Ql?i.returnType=this._forwardType(i.returnType):i instanceof g_&&(i.type=this._forwardType(i.type))});return n}_forwardType(e){if(e instanceof p_){const n=this._getType(e.name);if(n)return n}else e instanceof Lh?e.type=this._forwardType(e.type):e instanceof xl&&(e.format=this._forwardType(e.format));return e}_initialize(e){if(e)if(typeof e=="string"){const n=new hI(e);this._tokens=n.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_updateNode(e,n){return e.line=n??this._currentLine,e}_error(e,n){return{token:e,message:n,toString:()=>`${n}`}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==L.eof}_match(e){if(e instanceof ee)return!!this._check(e)&&(this._advance(),!0);for(let n=0,r=e.length;n<r;++n){const i=e[n];if(this._check(i))return this._advance(),!0}return!1}_consume(e,n){if(this._check(e))return this._advance();throw this._error(this._peek(),`${n}. Line:${this._currentLine}`)}_check(e){if(this._isAtEnd())return!1;const n=this._peek();if(e instanceof Array){const r=n.type;let i=!1;for(const s of e){if(r===s)return!0;s===L.tokens.name&&(i=!0)}if(i){const s=L.tokens.name.rule.exec(n.lexeme);if(s&&s.index==0&&s[0]==n.lexeme)return!0}return!1}if(n.type===e)return!0;if(e===L.tokens.name){const r=L.tokens.name.rule.exec(n.lexeme);return r&&r.index==0&&r[0]==n.lexeme}return!1}_advance(){var e,n;return this._currentLine=(n=(e=this._peek())===null||e===void 0?void 0:e.line)!==null&&n!==void 0?n:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(L.tokens.semicolon)&&!this._isAtEnd(););if(this._match(L.keywords.alias)){const n=this._type_alias();return this._consume(L.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([n]),n}if(this._match(L.keywords.diagnostic)){const n=this._diagnostic();return this._consume(L.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([n]),n}if(this._match(L.keywords.requires)){const n=this._requires_directive();return this._consume(L.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([n]),n}if(this._match(L.keywords.enable)){const n=this._enable_directive();return this._consume(L.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([n]),n}const e=this._attribute();if(this._check(L.keywords.var)){const n=this._global_variable_decl();return n!=null&&(n.attributes=e),this._consume(L.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([n]),n}if(this._check(L.keywords.override)){const n=this._override_variable_decl();return n!=null&&(n.attributes=e),this._consume(L.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([n]),n}if(this._check(L.keywords.let)){const n=this._global_let_decl();return n!=null&&(n.attributes=e),this._consume(L.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([n]),n}if(this._check(L.keywords.const)){const n=this._global_const_decl();return n!=null&&(n.attributes=e),this._consume(L.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([n]),n}if(this._check(L.keywords.struct)){const n=this._struct_decl();return n!=null&&(n.attributes=e),this._exec.reflection.updateAST([n]),n}if(this._check(L.keywords.fn)){const n=this._function_decl();return n!=null&&(n.attributes=e),this._exec.reflection.updateAST([n]),n}return null}_function_decl(){if(!this._match(L.keywords.fn))return null;const e=this._currentLine,n=this._consume(L.tokens.ident,"Expected function name.").toString();this._consume(L.tokens.paren_left,"Expected '(' for function arguments.");const r=[];if(!this._check(L.tokens.paren_right))do{if(this._check(L.tokens.paren_right))break;const a=this._attribute(),f=this._consume(L.tokens.name,"Expected argument name.").toString();this._consume(L.tokens.colon,"Expected ':' for argument type.");const p=this._attribute(),m=this._type_decl();m!=null&&(m.attributes=p,r.push(this._updateNode(new g_(f,m,a))))}while(this._match(L.tokens.comma));this._consume(L.tokens.paren_right,"Expected ')' after function arguments.");let i=null;if(this._match(L.tokens.arrow)){const a=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=a)}const s=this._compound_statement(),o=this._currentLine;return this._updateNode(new Ql(n,r,i,s,e,o),e)}_compound_statement(){const e=[];for(this._consume(L.tokens.brace_left,"Expected '{' for block.");!this._check(L.tokens.brace_right);){const n=this._statement();n!==null&&e.push(n)}return this._consume(L.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(L.tokens.semicolon)&&!this._isAtEnd(););if(this._check(L.tokens.attr)&&this._attribute(),this._check(L.keywords.if))return this._if_statement();if(this._check(L.keywords.switch))return this._switch_statement();if(this._check(L.keywords.loop))return this._loop_statement();if(this._check(L.keywords.for))return this._for_statement();if(this._check(L.keywords.while))return this._while_statement();if(this._check(L.keywords.continuing))return this._continuing_statement();if(this._check(L.keywords.static_assert))return this._static_assert_statement();if(this._check(L.tokens.brace_left))return this._compound_statement();let e=null;if(this._check(L.keywords.return))e=this._return_statement();else if(this._check([L.keywords.var,L.keywords.let,L.keywords.const]))e=this._variable_statement();else if(this._match(L.keywords.discard))e=this._updateNode(new cI);else if(this._match(L.keywords.break)){const n=this._updateNode(new Uw);if(this._currentLoop.length>0){const r=this._currentLoop[this._currentLoop.length-1];n.loopId=r.id}e=n,this._check(L.keywords.if)&&(this._advance(),n.condition=this._optional_paren_expression())}else if(this._match(L.keywords.continue)){const n=this._updateNode(new zw);if(!(this._currentLoop.length>0))throw this._error(this._peek(),`Continue statement must be inside a loop. Line: ${n.line}`);{const r=this._currentLoop[this._currentLoop.length-1];n.loopId=r.id}e=n}else e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement();return e!=null&&this._consume(L.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(L.keywords.static_assert))return null;const e=this._currentLine,n=this._optional_paren_expression();return this._updateNode(new aI(n),e)}_while_statement(){if(!this._match(L.keywords.while))return null;const e=this._updateNode(new Rw(null,null));return this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(L.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_continuing_statement(){const e=this._currentLoop.length>0?this._currentLoop[this._currentLoop.length-1].id:-1;if(!this._match(L.keywords.continuing))return null;const n=this._currentLine,r=this._compound_statement();return this._updateNode(new v0(r,e),n)}_for_statement(){if(!this._match(L.keywords.for))return null;this._consume(L.tokens.paren_left,"Expected '('.");const e=this._updateNode(new Iw(null,null,null,null));return this._currentLoop.push(e),e.init=this._check(L.tokens.semicolon)?null:this._for_init(),this._consume(L.tokens.semicolon,"Expected ';'."),e.condition=this._check(L.tokens.semicolon)?null:this._short_circuit_or_expression(),this._consume(L.tokens.semicolon,"Expected ';'."),e.increment=this._check(L.tokens.paren_right)?null:this._for_increment(),this._consume(L.tokens.paren_right,"Expected ')'."),this._check(L.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(L.keywords.var)){const e=this._variable_decl();if(e===null)throw this._error(this._peek(),"Variable declaration expected.");let n=null;return this._match(L.tokens.equal)&&(n=this._short_circuit_or_expression()),this._updateNode(new bi(e.name,e.type,e.storage,e.access,n),e.line)}if(this._match(L.keywords.let)){const e=this._currentLine,n=this._consume(L.tokens.name,"Expected name for let.").toString();let r=null;if(this._match(L.tokens.colon)){const s=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=s)}this._consume(L.tokens.equal,"Expected '=' for let.");const i=this._short_circuit_or_expression();return this._updateNode(new bl(n,r,null,null,i),e)}if(this._match(L.keywords.const)){const e=this._currentLine,n=this._consume(L.tokens.name,"Expected name for const.").toString();let r=null;if(this._match(L.tokens.colon)){const s=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=s)}this._consume(L.tokens.equal,"Expected '=' for const.");const i=this._short_circuit_or_expression();return r===null&&i instanceof _n&&(r=i.type),this._updateNode(new vc(n,r,null,null,i),e)}return null}_increment_decrement_statement(){const e=this._current,n=this._unary_expression();if(n==null)return null;if(!this._check(L.increment_operators))return this._current=e,null;const r=this._consume(L.increment_operators,"Expected increment operator");return this._updateNode(new Mw(r.type===L.tokens.plus_plus?Uo.increment:Uo.decrement,n))}_assignment_statement(){let e=null;const n=this._currentLine;if(this._check(L.tokens.brace_right))return null;let r=this._match(L.tokens.underscore);if(r||(e=this._unary_expression()),!r&&e==null)return null;const i=this._consume(L.assignment_operators,"Expected assignment operator."),s=this._short_circuit_or_expression();return this._updateNode(new Nw(sl.parse(i.lexeme),e,s),n)}_func_call_statement(){if(!this._check(L.tokens.ident))return null;const e=this._currentLine,n=this._current,r=this._consume(L.tokens.ident,"Expected function name."),i=this._argument_expression_list();return i===null?(this._current=n,null):this._updateNode(new Ag(r.lexeme,i),e)}_loop_statement(){if(!this._match(L.keywords.loop))return null;this._check(L.tokens.attr)&&this._attribute(),this._consume(L.tokens.brace_left,"Expected '{' for loop.");const e=this._updateNode(new Ow([],null));this._currentLoop.push(e);let n=this._statement();for(;n!==null;){if(Array.isArray(n))for(let r of n)e.body.push(r);else e.body.push(n);if(n instanceof v0){e.continuing=n;break}n=this._statement()}return this._currentLoop.pop(),this._consume(L.tokens.brace_right,"Expected '}' for loop."),e}_switch_statement(){if(!this._match(L.keywords.switch))return null;const e=this._updateNode(new Dw(null,[]));if(this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(L.tokens.attr)&&this._attribute(),this._consume(L.tokens.brace_left,"Expected '{' for switch."),e.cases=this._switch_body(),e.cases==null||e.cases.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(L.tokens.brace_right,"Expected '}' for switch."),this._currentLoop.pop(),e}_switch_body(){const e=[];let n=!1;for(;this._check([L.keywords.default,L.keywords.case]);){if(this._match(L.keywords.case)){const r=this._case_selectors();for(const s of r)if(s instanceof wc){if(n)throw this._error(this._previous(),"Multiple default cases in switch statement.");n=!0;break}this._match(L.tokens.colon),this._check(L.tokens.attr)&&this._attribute(),this._consume(L.tokens.brace_left,"Exected '{' for switch case.");const i=this._case_body();this._consume(L.tokens.brace_right,"Exected '}' for switch case."),e.push(this._updateNode(new Hw(r,i)))}if(this._match(L.keywords.default)){if(n)throw this._error(this._previous(),"Multiple default cases in switch statement.");this._match(L.tokens.colon),this._check(L.tokens.attr)&&this._attribute(),this._consume(L.tokens.brace_left,"Exected '{' for switch default.");const r=this._case_body();this._consume(L.tokens.brace_right,"Exected '}' for switch default."),e.push(this._updateNode(new Xw(r)))}}return e}_case_selectors(){const e=[];for(this._match(L.keywords.default)?e.push(this._updateNode(new wc)):e.push(this._shift_expression());this._match(L.tokens.comma);)this._match(L.keywords.default)?e.push(this._updateNode(new wc)):e.push(this._shift_expression());return e}_case_body(){if(this._match(L.keywords.fallthrough))return this._consume(L.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(e==null)return[];e instanceof Array||(e=[e]);const n=this._case_body();return n.length==0?e:[...e,n[0]]}_if_statement(){if(!this._match(L.keywords.if))return null;const e=this._currentLine,n=this._optional_paren_expression();this._check(L.tokens.attr)&&this._attribute();const r=this._compound_statement();let i=[];this._match_elseif()&&(this._check(L.tokens.attr)&&this._attribute(),i=this._elseif_statement(i));let s=null;return this._match(L.keywords.else)&&(this._check(L.tokens.attr)&&this._attribute(),s=this._compound_statement()),this._updateNode(new Bw(n,r,i,s),e)}_match_elseif(){return this._tokens[this._current].type===L.keywords.else&&this._tokens[this._current+1].type===L.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(e=[]){const n=this._optional_paren_expression(),r=this._compound_statement();return e.push(this._updateNode(new uI(n,r))),this._match_elseif()&&(this._check(L.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(L.keywords.return))return null;const e=this._short_circuit_or_expression();return this._updateNode(new Fw(e))}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(L.tokens.or_or);)e=this._updateNode(new zr(this._previous().toString(),e,this._short_circuit_and_expr()));return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(L.tokens.and_and);)e=this._updateNode(new zr(this._previous().toString(),e,this._inclusive_or_expression()));return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(L.tokens.or);)e=this._updateNode(new zr(this._previous().toString(),e,this._exclusive_or_expression()));return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(L.tokens.xor);)e=this._updateNode(new zr(this._previous().toString(),e,this._and_expression()));return e}_and_expression(){let e=this._equality_expression();for(;this._match(L.tokens.and);)e=this._updateNode(new zr(this._previous().toString(),e,this._equality_expression()));return e}_equality_expression(){const e=this._relational_expression();return this._match([L.tokens.equal_equal,L.tokens.not_equal])?this._updateNode(new zr(this._previous().toString(),e,this._relational_expression())):e}_relational_expression(){let e=this._shift_expression();for(;this._match([L.tokens.less_than,L.tokens.greater_than,L.tokens.less_than_equal,L.tokens.greater_than_equal]);)e=this._updateNode(new zr(this._previous().toString(),e,this._shift_expression()));return e}_shift_expression(){let e=this._additive_expression();for(;this._match([L.tokens.shift_left,L.tokens.shift_right]);)e=this._updateNode(new zr(this._previous().toString(),e,this._additive_expression()));return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([L.tokens.plus,L.tokens.minus]);)e=this._updateNode(new zr(this._previous().toString(),e,this._multiplicative_expression()));return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([L.tokens.star,L.tokens.forward_slash,L.tokens.modulo]);)e=this._updateNode(new zr(this._previous().toString(),e,this._unary_expression()));return e}_unary_expression(){return this._match([L.tokens.minus,L.tokens.bang,L.tokens.tilde,L.tokens.star,L.tokens.and])?this._updateNode(new pn(this._previous().toString(),this._unary_expression())):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),n=this._postfix_expression();return n&&(e.postfix=n),e}_postfix_expression(){if(this._match(L.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(L.tokens.bracket_right,"Expected ']'.");const n=this._updateNode(new ua(e)),r=this._postfix_expression();return r&&(n.postfix=r),n}if(this._match(L.tokens.period)){const e=this._consume(L.tokens.name,"Expected member name."),n=this._postfix_expression(),r=this._updateNode(new Zs(e.lexeme));return n&&(r.postfix=n),r}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_getType(e){const n=this._getStruct(e);if(n!==null)return n;switch(e){case"void":return _e.void;case"bool":return _e.bool;case"i32":return _e.i32;case"u32":return _e.u32;case"f32":return _e.f32;case"f16":return _e.f16;case"vec2f":return re.vec2f;case"vec3f":return re.vec3f;case"vec4f":return re.vec4f;case"vec2i":return re.vec2i;case"vec3i":return re.vec3i;case"vec4i":return re.vec4i;case"vec2u":return re.vec2u;case"vec3u":return re.vec3u;case"vec4u":return re.vec4u;case"vec2h":return re.vec2h;case"vec3h":return re.vec3h;case"vec4h":return re.vec4h;case"mat2x2f":return re.mat2x2f;case"mat2x3f":return re.mat2x3f;case"mat2x4f":return re.mat2x4f;case"mat3x2f":return re.mat3x2f;case"mat3x3f":return re.mat3x3f;case"mat3x4f":return re.mat3x4f;case"mat4x2f":return re.mat4x2f;case"mat4x3f":return re.mat4x3f;case"mat4x4f":return re.mat4x4f;case"mat2x2h":return re.mat2x2h;case"mat2x3h":return re.mat2x3h;case"mat2x4h":return re.mat2x4h;case"mat3x2h":return re.mat3x2h;case"mat3x3h":return re.mat3x3h;case"mat3x4h":return re.mat3x4h;case"mat4x2h":return re.mat4x2h;case"mat4x3h":return re.mat4x3h;case"mat4x4h":return re.mat4x4h;case"mat2x2i":return re.mat2x2i;case"mat2x3i":return re.mat2x3i;case"mat2x4i":return re.mat2x4i;case"mat3x2i":return re.mat3x2i;case"mat3x3i":return re.mat3x3i;case"mat3x4i":return re.mat3x4i;case"mat4x2i":return re.mat4x2i;case"mat4x3i":return re.mat4x3i;case"mat4x4i":return re.mat4x4i;case"mat2x2u":return re.mat2x2u;case"mat2x3u":return re.mat2x3u;case"mat2x4u":return re.mat2x4u;case"mat3x2u":return re.mat3x2u;case"mat3x3u":return re.mat3x3u;case"mat3x4u":return re.mat3x4u;case"mat4x2u":return re.mat4x2u;case"mat4x3u":return re.mat4x3u;case"mat4x4u":return re.mat4x4u}return null}_validateTypeRange(e,n){if(n.name==="i32"){if(e<-2147483648||e>2147483647)throw this._error(this._previous(),`Value out of range for i32: ${e}. Line: ${this._currentLine}.`)}else if(n.name==="u32"&&(e<0||e>4294967295))throw this._error(this._previous(),`Value out of range for u32: ${e}. Line: ${this._currentLine}.`)}_primary_expression(){if(this._match(L.tokens.ident)){const r=this._previous().toString();if(this._check(L.tokens.paren_left)){const i=this._argument_expression_list(),s=this._getType(r);return s!==null?this._updateNode(new ii(s,i)):this._updateNode(new ug(r,i))}if(this._context.constants.has(r)){const i=this._context.constants.get(r);return this._updateNode(new Vw(r,i.value))}return this._updateNode(new gr(r))}if(this._match(L.tokens.int_literal)){const r=this._previous().toString();let i=r.endsWith("i")||r.endsWith("i")?_e.i32:r.endsWith("u")||r.endsWith("U")?_e.u32:_e.x32;const s=parseInt(r);return this._validateTypeRange(s,i),this._updateNode(new _n(new Z(s,this._exec.getTypeInfo(i)),i))}if(this._match(L.tokens.uint_literal)){const r=parseInt(this._previous().toString());return this._validateTypeRange(r,_e.u32),this._updateNode(new _n(new Z(r,this._exec.getTypeInfo(_e.u32)),_e.u32))}if(this._match([L.tokens.decimal_float_literal,L.tokens.hex_float_literal])){let r=this._previous().toString(),i=r.endsWith("h");i&&(r=r.substring(0,r.length-1));const s=parseFloat(r);this._validateTypeRange(s,i?_e.f16:_e.f32);const o=i?_e.f16:_e.f32;return this._updateNode(new _n(new Z(s,this._exec.getTypeInfo(o)),o))}if(this._match([L.keywords.true,L.keywords.false])){let r=this._previous().toString()===L.keywords.true.rule;return this._updateNode(new _n(new Z(r?1:0,this._exec.getTypeInfo(_e.bool)),_e.bool))}if(this._check(L.tokens.paren_left))return this._paren_expression();if(this._match(L.keywords.bitcast)){this._consume(L.tokens.less_than,"Expected '<'.");const r=this._type_decl();this._consume(L.tokens.greater_than,"Expected '>'.");const i=this._paren_expression();return this._updateNode(new jw(r,i))}const e=this._type_decl(),n=this._argument_expression_list();return this._updateNode(new ii(e,n))}_argument_expression_list(){if(!this._match(L.tokens.paren_left))return null;const e=[];do{if(this._check(L.tokens.paren_right))break;const n=this._short_circuit_or_expression();e.push(n)}while(this._match(L.tokens.comma));return this._consume(L.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(L.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(L.tokens.paren_right),e}_paren_expression(){this._consume(L.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(L.tokens.paren_right,"Expected ')'."),e}_struct_decl(){if(!this._match(L.keywords.struct))return null;const e=this._currentLine,n=this._consume(L.tokens.ident,"Expected name for struct.").toString();this._consume(L.tokens.brace_left,"Expected '{' for struct body.");const r=[];for(;!this._check(L.tokens.brace_right);){const o=this._attribute(),a=this._consume(L.tokens.name,"Expected variable name.").toString();this._consume(L.tokens.colon,"Expected ':' for struct member type.");const f=this._attribute(),p=this._type_decl();p!=null&&(p.attributes=f),this._check(L.tokens.brace_right)?this._match(L.tokens.comma):this._consume(L.tokens.comma,"Expected ',' for struct member."),r.push(this._updateNode(new m_(a,p,o)))}this._consume(L.tokens.brace_right,"Expected '}' after struct body.");const i=this._currentLine,s=this._updateNode(new vi(n,r,e,i),e);return this._context.structs.set(n,s),s}_global_variable_decl(){const e=this._variable_decl();if(!e)return null;if(this._match(L.tokens.equal)){const n=this._const_expression();e.value=n}if(e.type!==null&&e.value instanceof _n){if(e.value.type.name!=="x32"&&e.type.getTypeName()!==e.value.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${e.value.type.name} to ${e.type.name}. Line:${this._currentLine}`);e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type),e.value.type=e.type}else e.type===null&&e.value instanceof _n&&(e.type=e.value.type.name==="x32"?_e.i32:e.value.type,e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type));return e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(L.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){var e;if(!this._match(L.keywords.const))return null;const n=this._consume(L.tokens.name,"Expected variable name"),r=this._currentLine;let i=null;if(this._match(L.tokens.colon)){const f=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=f)}let s=null;this._consume(L.tokens.equal,"const declarations require an assignment");const o=this._short_circuit_or_expression();try{let f=[_e.f32],p=o.constEvaluate(this._exec,f);p instanceof Z&&this._validateTypeRange(p.value,f[0]),f[0]instanceof re&&f[0].format===null&&p.typeInfo instanceof qs&&p.typeInfo.format!==null&&(p.typeInfo.format.name==="f16"?f[0].format=_e.f16:p.typeInfo.format.name==="f32"?f[0].format=_e.f32:p.typeInfo.format.name==="i32"?f[0].format=_e.i32:p.typeInfo.format.name==="u32"?f[0].format=_e.u32:p.typeInfo.format.name==="bool"?f[0].format=_e.bool:console.error(`TODO: impelement template format type ${p.typeInfo.format.name}`)),s=this._updateNode(new _n(p,f[0])),this._exec.context.setVariable(n.toString(),p)}catch{s=o}if(i!==null&&s instanceof _n){if(s.type.name!=="x32"&&i.getTypeName()!==s.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${s.type.name} to ${i.name}. Line:${this._currentLine}`);s.type=i,s.isScalar&&this._validateTypeRange(s.scalarValue,s.type)}else i===null&&s instanceof _n&&(i=(e=s==null?void 0:s.type)!==null&&e!==void 0?e:_e.f32,i===_e.x32&&(i=_e.i32));const a=this._updateNode(new vc(n.toString(),i,"","",s),r);return this._context.constants.set(a.name,a),a}_global_let_decl(){if(!this._match(L.keywords.let))return null;const e=this._currentLine,n=this._consume(L.tokens.name,"Expected variable name");let r=null;if(this._match(L.tokens.colon)){const s=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=s)}let i=null;if(this._match(L.tokens.equal)&&(i=this._const_expression()),r!==null&&i instanceof _n){if(i.type.name!=="x32"&&r.getTypeName()!==i.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${i.type.name} to ${r.name}. Line:${this._currentLine}`);i.type=r}else r===null&&i instanceof _n&&(r=i.type.name==="x32"?_e.i32:i.type);return i instanceof _n&&i.isScalar&&this._validateTypeRange(i.scalarValue,r),this._updateNode(new bl(n.toString(),r,"","",i),e)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(L.keywords.var))return null;const e=this._currentLine;let n="",r="";this._match(L.tokens.less_than)&&(n=this._consume(L.storage_class,"Expected storage_class.").toString(),this._match(L.tokens.comma)&&(r=this._consume(L.access_mode,"Expected access_mode.").toString()),this._consume(L.tokens.greater_than,"Expected '>'."));const i=this._consume(L.tokens.name,"Expected variable name");let s=null;if(this._match(L.tokens.colon)){const o=this._attribute();s=this._type_decl(),s!=null&&(s.attributes=o)}return this._updateNode(new bi(i.toString(),s,n,r,null),e)}_override_decl(){if(!this._match(L.keywords.override))return null;const e=this._consume(L.tokens.name,"Expected variable name");let n=null;if(this._match(L.tokens.colon)){const r=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=r)}return this._updateNode(new lg(e.toString(),n,null))}_diagnostic(){this._consume(L.tokens.paren_left,"Expected '('");const e=this._consume(L.tokens.ident,"Expected severity control name.");this._consume(L.tokens.comma,"Expected ','");let n=this._consume(L.tokens.ident,"Expected diagnostic rule name.").toString();return this._match(L.tokens.period)&&(n+=`.${this._consume(L.tokens.ident,"Expected diagnostic message.").toString()}`),this._consume(L.tokens.paren_right,"Expected ')'"),this._updateNode(new Lw(e.toString(),n))}_enable_directive(){const e=this._consume(L.tokens.ident,"identity expected.");return this._updateNode(new lI(e.toString()))}_requires_directive(){const e=[this._consume(L.tokens.ident,"identity expected.").toString()];for(;this._match(L.tokens.comma);){const n=this._consume(L.tokens.ident,"identity expected.");e.push(n.toString())}return this._updateNode(new AI(e))}_type_alias(){const e=this._consume(L.tokens.ident,"identity expected.");this._consume(L.tokens.equal,"Expected '=' for type alias.");let n=this._type_decl();if(n===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(n.name)&&(n=this._context.aliases.get(n.name).type);const r=this._updateNode(new cg(e.toString(),n));return this._context.aliases.set(r.name,r),r}_type_decl(){if(this._check([L.tokens.ident,...L.texel_format,L.keywords.bool,L.keywords.f32,L.keywords.i32,L.keywords.u32])){const r=this._advance().toString();if(this._context.structs.has(r))return this._context.structs.get(r);if(this._context.aliases.has(r))return this._context.aliases.get(r).type;if(!this._getType(r)){const i=this._updateNode(new p_(r));return this._forwardTypeCount++,i}return this._updateNode(new _e(r))}let e=this._texture_sampler_types();if(e)return e;if(this._check(L.template_types)){let r=this._advance().toString(),i=null,s=null;return this._match(L.tokens.less_than)&&(i=this._type_decl(),s=null,this._match(L.tokens.comma)&&(s=this._consume(L.access_mode,"Expected access_mode for pointer").toString()),this._consume(L.tokens.greater_than,"Expected '>' for type.")),this._updateNode(new re(r,i,s))}if(this._match(L.keywords.ptr)){let r=this._previous().toString();this._consume(L.tokens.less_than,"Expected '<' for pointer.");const i=this._consume(L.storage_class,"Expected storage_class for pointer");this._consume(L.tokens.comma,"Expected ',' for pointer.");const s=this._type_decl();let o=null;return this._match(L.tokens.comma)&&(o=this._consume(L.access_mode,"Expected access_mode for pointer").toString()),this._consume(L.tokens.greater_than,"Expected '>' for pointer."),this._updateNode(new Lh(r,i.toString(),s,o))}const n=this._attribute();if(this._match(L.keywords.array)){let r=null,i=-1;const s=this._previous();let o=null;if(this._match(L.tokens.less_than)){r=this._type_decl(),this._context.aliases.has(r.name)&&(r=this._context.aliases.get(r.name).type);let f="";if(this._match(L.tokens.comma)){o=this._shift_expression();try{f=o.constEvaluate(this._exec).toString(),o=null}catch{f="1"}}this._consume(L.tokens.greater_than,"Expected '>' for array."),i=f?parseInt(f):0}const a=this._updateNode(new xl(s.toString(),n,r,i));return o&&this._deferArrayCountEval.push({arrayType:a,countNode:o}),a}return null}_texture_sampler_types(){if(this._match(L.sampler_type))return this._updateNode(new ol(this._previous().toString(),null,null));if(this._match(L.depth_texture_type))return this._updateNode(new ol(this._previous().toString(),null,null));if(this._match(L.sampled_texture_type)||this._match(L.multisampled_texture_type)){const e=this._previous();this._consume(L.tokens.less_than,"Expected '<' for sampler type.");const n=this._type_decl();return this._consume(L.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new ol(e.toString(),n,null))}if(this._match(L.storage_texture_type)){const e=this._previous();this._consume(L.tokens.less_than,"Expected '<' for sampler type.");const n=this._consume(L.texel_format,"Invalid texel format.").toString();this._consume(L.tokens.comma,"Expected ',' after texel format.");const r=this._consume(L.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(L.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new ol(e.toString(),n,r))}return null}_attribute(){let e=[];for(;this._match(L.tokens.attr);){const n=this._consume(L.attribute_name,"Expected attribute name"),r=this._updateNode(new Qw(n.toString(),null));if(this._match(L.tokens.paren_left)){if(r.value=this._consume(L.literal_or_ident,"Expected attribute value").toString(),this._check(L.tokens.comma)){this._advance();do{const i=this._consume(L.literal_or_ident,"Expected attribute value").toString();r.value instanceof Array||(r.value=[r.value]),r.value.push(i)}while(this._match(L.tokens.comma))}this._consume(L.tokens.paren_right,"Expected ')'")}e.push(r)}return e.length==0?null:e}}class EI extends ai{constructor(e){super(),e&&this.update(e)}update(e){const n=new TI().parse(e);this.updateAST(n)}}function SI(t){var s;const e={attributes:[],bindings:[]};let n;try{n=CI(t)}catch(o){return xe.error(o.message)(),e}for(const o of n.uniforms){const a=[];for(const f of((s=o.type)==null?void 0:s.members)||[])a.push({name:f.name,type:v_(f.type)});e.bindings.push({type:"uniform",name:o.name,group:o.group,location:o.binding,members:a})}for(const o of n.textures)e.bindings.push({type:"texture",name:o.name,group:o.group,location:o.binding});for(const o of n.samplers)e.bindings.push({type:"sampler",name:o.name,group:o.group,location:o.binding});const r=n.entry.vertex[0],i=(r==null?void 0:r.inputs.length)||0;for(let o=0;o<i;o++){const a=r.inputs[o];if(a.locationType==="location"){const f=v_(a.type);e.attributes.push({name:a.name,location:Number(a.location),type:f})}}return e}function v_(t){return t.format?`${t.name}<${t.format.name}>`:t.name}function CI(t){try{return new EI(t)}catch(e){if(e instanceof Error)throw e;let n="WGSL parse error";throw typeof e=="object"&&(e!=null&&e.message)&&(n+=`: ${e.message} `),typeof e=="object"&&(e!=null&&e.token)&&(n+=e.token.line||""),new Error(n,{cause:e})}}const kI={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...kI}};const Ir=globalThis.mathgl.config;function PI(t,{precision:e=Ir.precision}={}){return t=RI(t),`${parseFloat(t.toPrecision(e))}`}function fa(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function ts(t,e,n){return MI(t,r=>Math.max(e,Math.min(n,r)))}function ha(t,e,n){return fa(t)?t.map((r,i)=>ha(r,e[i],n)):n*e+(1-n)*t}function Yl(t,e,n){const r=Ir.EPSILON;try{if(t===e)return!0;if(fa(t)&&fa(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!Yl(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=Ir.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{Ir.EPSILON=r}}function RI(t){return Math.round(t/Ir.EPSILON)*Ir.EPSILON}function II(t){return t.clone?t.clone():new Array(t.length)}function MI(t,e,n){if(fa(t)){const r=t;n=n||II(r);for(let i=0;i<n.length&&i<r.length;++i){const s=typeof t=="number"?t:t[i];n[i]=e(s,i,n)}return n}return e(t)}class Yw extends Array{clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:fa(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Ir)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+PI(this[r],e);return`${e.printTypes?this.constructor.name:""}[${n}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Yl(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const s=e[i],o=typeof n=="number"?n:n[i];this[i]=s+r*(o-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(Ir.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function NI(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function pr(t){if(!Number.isFinite(t))throw new Error(`Invalid number ${JSON.stringify(t)}`);return t}function zh(t,e,n=""){if(Ir.debug&&!NI(t,e))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return t}function w_(t,e){if(!t)throw new Error(`math.gl assertion ${e}`)}class OI extends Yw{get x(){return this[0]}set x(e){this[0]=pr(e)}get y(){return this[1]}set y(e){this[1]=pr(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return pr(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return pr(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return w_(e>=0&&e<this.ELEMENTS,"index is out of range"),pr(this[e])}setComponent(e,n){return w_(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}const bc=1e-6;let da=typeof Float32Array<"u"?Float32Array:Array;function DI(){const t=new da(2);return da!=Float32Array&&(t[0]=0,t[1]=0),t}function b_(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function BI(t,e){return t[0]=-e[0],t[1]=-e[1],t}function Kw(t,e,n,r){const i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function FI(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}(function(){const t=DI();return function(e,n,r,i,s,o){let a,f;for(n||(n=2),r||(r=0),i?f=Math.min(i*n+r,e.length):f=e.length,a=r;a<f;a+=n)t[0]=e[a],t[1]=e[a+1],s(t,t,o),e[a]=t[0],e[a+1]=t[1];return e}})();function LI(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function qw(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/o,t[1]=(n[1]*r+n[5]*i+n[9]*s)/o,t[2]=(n[2]*r+n[6]*i+n[10]*s)/o,t}function UI(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function zI(){const t=new da(3);return da!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function VI(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function jI(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function WI(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function $I(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],f=n[2];return t[0]=i*f-s*a,t[1]=s*o-r*f,t[2]=r*a-i*o,t}function Zw(t,e,n){const r=e[0],i=e[1],s=e[2];let o=n[3]*r+n[7]*i+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/o,t}function HI(t,e,n){const r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function XI(t,e,n){const r=n[0],i=n[1],s=n[2],o=n[3],a=e[0],f=e[1],p=e[2];let m=i*p-s*f,v=s*a-r*p,w=r*f-i*a,T=i*w-s*v,E=s*m-r*w,N=r*v-i*m;const j=o*2;return m*=j,v*=j,w*=j,T*=2,E*=2,N*=2,t[0]=a+m+T,t[1]=f+v+E,t[2]=p+w+N,t}function QI(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function YI(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function KI(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function qI(t,e){const n=t[0],r=t[1],i=t[2],s=e[0],o=e[1],a=e[2],f=Math.sqrt((n*n+r*r+i*i)*(s*s+o*o+a*a)),p=f&&WI(t,e)/f;return Math.acos(Math.min(Math.max(p,-1),1))}const ZI=VI;(function(){const t=zI();return function(e,n,r,i,s,o){let a,f;for(n||(n=3),r||(r=0),i?f=Math.min(i*n+r,e.length):f=e.length,a=r;a<f;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const Vh=[0,0,0];let YA;class ui extends OI{static get ZERO(){return YA||(YA=new ui(0,0,0),Object.freeze(YA)),YA}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&fa(e)?this.copy(e):(Ir.debug&&(pr(e),pr(n),pr(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Ir.debug&&(pr(e.x),pr(e.y),pr(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=pr(e)}angle(e){return qI(this,e)}cross(e){return $I(this,this,e),this.check()}rotateX({radians:e,origin:n=Vh}){return QI(this,this,n,e),this.check()}rotateY({radians:e,origin:n=Vh}){return YI(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=Vh}){return KI(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Zw(this,this,e),this.check()}transformAsVector(e){return qw(this,this,e),this.check()}transformByMatrix3(e){return HI(this,this,e),this.check()}transformByMatrix2(e){return UI(this,this,e),this.check()}transformByQuaternion(e){return XI(this,this,e),this.check()}}class GI extends Yw{toString(){let e="[";if(Ir.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=` ${this[r*this.RANK+n]}`}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=` ${this[n]}`}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=pr(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function JI(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function eM(t,e){if(t===e){const n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function b0(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],f=e[6],p=e[7],m=e[8],v=e[9],w=e[10],T=e[11],E=e[12],N=e[13],j=e[14],I=e[15],R=n*a-r*o,k=n*f-i*o,B=n*p-s*o,Y=r*f-i*a,G=r*p-s*a,ce=i*p-s*f,U=m*N-v*E,$=m*j-w*E,K=m*I-T*E,ue=v*j-w*N,ge=v*I-T*N,le=w*I-T*j;let he=R*le-k*ge+B*ue+Y*K-G*$+ce*U;return he?(he=1/he,t[0]=(a*le-f*ge+p*ue)*he,t[1]=(i*ge-r*le-s*ue)*he,t[2]=(N*ce-j*G+I*Y)*he,t[3]=(w*G-v*ce-T*Y)*he,t[4]=(f*K-o*le-p*$)*he,t[5]=(n*le-i*K+s*$)*he,t[6]=(j*B-E*ce-I*k)*he,t[7]=(m*ce-w*B+T*k)*he,t[8]=(o*ge-a*K+p*U)*he,t[9]=(r*K-n*ge-s*U)*he,t[10]=(E*G-N*B+I*R)*he,t[11]=(v*B-m*G-T*R)*he,t[12]=(a*$-o*ue-f*U)*he,t[13]=(n*ue-r*$+i*U)*he,t[14]=(N*k-E*Y-j*R)*he,t[15]=(m*Y-v*k+w*R)*he,t):null}function tM(t){const e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],f=t[7],p=t[8],m=t[9],v=t[10],w=t[11],T=t[12],E=t[13],N=t[14],j=t[15],I=e*o-n*s,R=e*a-r*s,k=n*a-r*o,B=p*E-m*T,Y=p*N-v*T,G=m*N-v*E,ce=e*G-n*Y+r*B,U=s*G-o*Y+a*B,$=p*k-m*R+v*I,K=T*k-E*R+N*I;return f*ce-i*U+j*$-w*K}function js(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],f=e[5],p=e[6],m=e[7],v=e[8],w=e[9],T=e[10],E=e[11],N=e[12],j=e[13],I=e[14],R=e[15];let k=n[0],B=n[1],Y=n[2],G=n[3];return t[0]=k*r+B*a+Y*v+G*N,t[1]=k*i+B*f+Y*w+G*j,t[2]=k*s+B*p+Y*T+G*I,t[3]=k*o+B*m+Y*E+G*R,k=n[4],B=n[5],Y=n[6],G=n[7],t[4]=k*r+B*a+Y*v+G*N,t[5]=k*i+B*f+Y*w+G*j,t[6]=k*s+B*p+Y*T+G*I,t[7]=k*o+B*m+Y*E+G*R,k=n[8],B=n[9],Y=n[10],G=n[11],t[8]=k*r+B*a+Y*v+G*N,t[9]=k*i+B*f+Y*w+G*j,t[10]=k*s+B*p+Y*T+G*I,t[11]=k*o+B*m+Y*E+G*R,k=n[12],B=n[13],Y=n[14],G=n[15],t[12]=k*r+B*a+Y*v+G*N,t[13]=k*i+B*f+Y*w+G*j,t[14]=k*s+B*p+Y*T+G*I,t[15]=k*o+B*m+Y*E+G*R,t}function _u(t,e,n){const r=n[0],i=n[1],s=n[2];let o,a,f,p,m,v,w,T,E,N,j,I;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(o=e[0],a=e[1],f=e[2],p=e[3],m=e[4],v=e[5],w=e[6],T=e[7],E=e[8],N=e[9],j=e[10],I=e[11],t[0]=o,t[1]=a,t[2]=f,t[3]=p,t[4]=m,t[5]=v,t[6]=w,t[7]=T,t[8]=E,t[9]=N,t[10]=j,t[11]=I,t[12]=o*r+m*i+E*s+e[12],t[13]=a*r+v*i+N*s+e[13],t[14]=f*r+w*i+j*s+e[14],t[15]=p*r+T*i+I*s+e[15]),t}function pg(t,e,n){const r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function nM(t,e,n,r){let i=r[0],s=r[1],o=r[2],a=Math.sqrt(i*i+s*s+o*o),f,p,m,v,w,T,E,N,j,I,R,k,B,Y,G,ce,U,$,K,ue,ge,le,he,Ue;return a<bc?null:(a=1/a,i*=a,s*=a,o*=a,p=Math.sin(n),f=Math.cos(n),m=1-f,v=e[0],w=e[1],T=e[2],E=e[3],N=e[4],j=e[5],I=e[6],R=e[7],k=e[8],B=e[9],Y=e[10],G=e[11],ce=i*i*m+f,U=s*i*m+o*p,$=o*i*m-s*p,K=i*s*m-o*p,ue=s*s*m+f,ge=o*s*m+i*p,le=i*o*m+s*p,he=s*o*m-i*p,Ue=o*o*m+f,t[0]=v*ce+N*U+k*$,t[1]=w*ce+j*U+B*$,t[2]=T*ce+I*U+Y*$,t[3]=E*ce+R*U+G*$,t[4]=v*K+N*ue+k*ge,t[5]=w*K+j*ue+B*ge,t[6]=T*K+I*ue+Y*ge,t[7]=E*K+R*ue+G*ge,t[8]=v*le+N*he+k*Ue,t[9]=w*le+j*he+B*Ue,t[10]=T*le+I*he+Y*Ue,t[11]=E*le+R*he+G*Ue,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Gw(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[4],o=e[5],a=e[6],f=e[7],p=e[8],m=e[9],v=e[10],w=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+p*r,t[5]=o*i+m*r,t[6]=a*i+v*r,t[7]=f*i+w*r,t[8]=p*i-s*r,t[9]=m*i-o*r,t[10]=v*i-a*r,t[11]=w*i-f*r,t}function rM(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],f=e[3],p=e[8],m=e[9],v=e[10],w=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-p*r,t[1]=o*i-m*r,t[2]=a*i-v*r,t[3]=f*i-w*r,t[8]=s*r+p*i,t[9]=o*r+m*i,t[10]=a*r+v*i,t[11]=f*r+w*i,t}function Jw(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],f=e[3],p=e[4],m=e[5],v=e[6],w=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+p*r,t[1]=o*i+m*r,t[2]=a*i+v*r,t[3]=f*i+w*r,t[4]=p*i-s*r,t[5]=m*i-o*r,t[6]=v*i-a*r,t[7]=w*i-f*r,t}function iM(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,f=i+i,p=n*o,m=r*o,v=r*a,w=i*o,T=i*a,E=i*f,N=s*o,j=s*a,I=s*f;return t[0]=1-v-E,t[1]=m+I,t[2]=w-j,t[3]=0,t[4]=m-I,t[5]=1-p-E,t[6]=T+N,t[7]=0,t[8]=w+j,t[9]=T-N,t[10]=1-p-v,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function sM(t,e,n,r,i,s,o){const a=1/(n-e),f=1/(i-r),p=1/(s-o);return t[0]=s*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*f,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*f,t[10]=(o+s)*p,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*p,t[15]=0,t}function oM(t,e,n,r,i){const s=1/Math.tan(e/2);if(t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0){const o=1/(r-i);t[10]=(i+r)*o,t[14]=2*i*r*o}else t[10]=-1,t[14]=-2*r;return t}const aM=oM;function lM(t,e,n,r,i,s,o){const a=1/(e-n),f=1/(r-i),p=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*f,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*p,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*f,t[14]=(o+s)*p,t[15]=1,t}const AM=lM;function cM(t,e,n,r){let i,s,o,a,f,p,m,v,w,T;const E=e[0],N=e[1],j=e[2],I=r[0],R=r[1],k=r[2],B=n[0],Y=n[1],G=n[2];return Math.abs(E-B)<bc&&Math.abs(N-Y)<bc&&Math.abs(j-G)<bc?JI(t):(v=E-B,w=N-Y,T=j-G,i=1/Math.sqrt(v*v+w*w+T*T),v*=i,w*=i,T*=i,s=R*T-k*w,o=k*v-I*T,a=I*w-R*v,i=Math.sqrt(s*s+o*o+a*a),i?(i=1/i,s*=i,o*=i,a*=i):(s=0,o=0,a=0),f=w*a-T*o,p=T*s-v*a,m=v*o-w*s,i=Math.sqrt(f*f+p*p+m*m),i?(i=1/i,f*=i,p*=i,m*=i):(f=0,p=0,m=0),t[0]=s,t[1]=f,t[2]=v,t[3]=0,t[4]=o,t[5]=p,t[6]=w,t[7]=0,t[8]=a,t[9]=m,t[10]=T,t[11]=0,t[12]=-(s*E+o*N+a*j),t[13]=-(f*E+p*N+m*j),t[14]=-(v*E+w*N+T*j),t[15]=1,t)}function uM(){const t=new da(4);return da!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function fM(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function cA(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,t}(function(){const t=uM();return function(e,n,r,i,s,o){let a,f;for(n||(n=4),r||(r=0),i?f=Math.min(i*n+r,e.length):f=e.length,a=r;a<f;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var x0;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(x0||(x0={}));const hM=45*Math.PI/180,dM=1,jh=.1,Wh=500,pM=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class fi extends GI{static get IDENTITY(){return mM()}static get ZERO(){return gM()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return x0}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,s,o,a,f,p,m,v,w,T,E,N,j){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=o,this[6]=a,this[7]=f,this[8]=p,this[9]=m,this[10]=v,this[11]=w,this[12]=T,this[13]=E,this[14]=N,this[15]=j,this.check()}setRowMajor(e,n,r,i,s,o,a,f,p,m,v,w,T,E,N,j){return this[0]=e,this[1]=s,this[2]=p,this[3]=T,this[4]=n,this[5]=o,this[6]=m,this[7]=E,this[8]=r,this[9]=a,this[10]=v,this[11]=N,this[12]=i,this[13]=f,this[14]=w,this[15]=j,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(pM)}fromObject(e){return this.check()}fromQuaternion(e){return iM(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:s,near:o=jh,far:a=Wh}=e;return a===1/0?_M(this,n,r,i,s,o):sM(this,n,r,i,s,o,a),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return cM(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:s,near:o=jh,far:a=Wh}=e;return AM(this,n,r,i,s,o,a),this.check()}orthographic(e){const{fovy:n=hM,aspect:r=dM,focalDistance:i=1,near:s=jh,far:o=Wh}=e;x_(n);const a=n/2,f=i*Math.tan(a),p=f*r;return this.ortho({left:-p,right:p,bottom:-f,top:f,near:s,far:o})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return x_(n),aM(this,n,r,i,s),this.check()}determinant(){return tM(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return eM(this,this),this.check()}invert(){return b0(this,this),this.check()}multiplyLeft(e){return js(this,e,this),this.check()}multiplyRight(e){return js(this,this,e),this.check()}rotateX(e){return Gw(this,this,e),this.check()}rotateY(e){return rM(this,this,e),this.check()}rotateZ(e){return Jw(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return nM(this,this,e,n),this.check()}scale(e){return pg(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return _u(this,this,e),this.check()}transform(e,n){return e.length===4?(n=cA(n||[-0,-0,-0,-0],e,this),zh(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=FI(n||[-0,-0],e,this);break;case 3:i=Zw(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return zh(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=LI(n||[-0,-0],e,this);break;case 3:r=qw(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return zh(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let KA,qA;function gM(){return KA||(KA=new fi([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(KA)),KA}function mM(){return qA||(qA=new fi,Object.freeze(qA)),qA}function x_(t){if(t>Math.PI*2)throw Error("expected radians")}function _M(t,e,n,r,i,s){const o=2*s/(n-e),a=2*s/(i-r),f=(n+e)/(n-e),p=(i+r)/(i-r),m=-1,v=-1,w=-2*s;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=f,t[9]=p,t[10]=m,t[11]=v,t[12]=0,t[13]=0,t[14]=w,t[15]=0,t}function eb(t,e=[],n=0){const r=Math.fround(t),i=t-r;return e[n]=r,e[n+1]=i,e}function yM(t){return t-Math.fround(t)}function vM(t){const e=new Float32Array(32);for(let n=0;n<4;++n)for(let r=0;r<4;++r){const i=n*4+r;eb(t[r*4+n],e,i*2)}return e}const wM=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND

// All these functions are for substituting tan() function from Intel GPU only
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }

    // 2pi range reduction
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,bM={name:"fp32",vs:wM},xM=`
uniform fp64arithmeticUniforms {
  uniform float ONE;
} fp64;

/*
About LUMA_FP64_CODE_ELIMINATION_WORKAROUND

The purpose of this workaround is to prevent shader compilers from
optimizing away necessary arithmetic operations by swapping their sequences
or transform the equation to some 'equivalent' form.

The method is to multiply an artifical variable, ONE, which will be known to
the compiler to be 1 only at runtime. The whole expression is then represented
as a polynomial with respective to ONE. In the coefficients of all terms, only one a
and one b should appear

err = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE
*/

// Divide float number to high and low floats to extend fraction bits
vec2 split(float a) {
  const float SPLIT = 4097.0;
  float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float a_hi = t * fp64.ONE - (t - a);
  float a_lo = a * fp64.ONE - a_hi;
#else
  float a_hi = t - (t - a);
  float a_lo = a - a_hi;
#endif
  return vec2(a_hi, a_lo);
}

// Divide float number again when high float uses too many fraction bits
vec2 split2(vec2 a) {
  vec2 b = split(a.x);
  b.y += a.y;
  return b;
}

// Special sum operation when a > b
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float sum = (a + b) * fp64.ONE;
  float err = b - (sum - a) * fp64.ONE;
#else
  float sum = a + b;
  float err = b - (sum - a);
#endif
  return vec2(sum, err);
}

// General sum operation
vec2 twoSum(float a, float b) {
  float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE + (b - v);
#else
  float v = s - a;
  float err = (a - (s - v)) + (b - v);
#endif
  return vec2(s, err);
}

vec2 twoSub(float a, float b) {
  float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE - (b + v);
#else
  float v = s - a;
  float err = (a - (s - v)) - (b + v);
#endif
  return vec2(s, err);
}

vec2 twoSqr(float a) {
  float prod = a * a;
  vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float err = ((a_fp64.x * a_fp64.x - prod) * fp64.ONE + 2.0 * a_fp64.x *
    a_fp64.y * fp64.ONE * fp64.ONE) + a_fp64.y * a_fp64.y * fp64.ONE * fp64.ONE * fp64.ONE;
#else
  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
  return vec2(prod, err);
}

vec2 twoProd(float a, float b) {
  float prod = a * b;
  vec2 a_fp64 = split(a);
  vec2 b_fp64 = split(b);
  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
  return vec2(prod, err);
}

vec2 sum_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSum(a.x, b.x);
  t = twoSum(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 sub_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSub(a.x, b.x);
  t = twoSub(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 mul_fp64(vec2 a, vec2 b) {
  vec2 prod = twoProd(a.x, b.x);
  // y component is for the error
  prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  return prod;
}

vec2 div_fp64(vec2 a, vec2 b) {
  float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
  vec2 yn = a * xn;
#endif
  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
  vec2 prod = twoProd(xn, diff);
  return sum_fp64(yn, prod);
}

vec2 sqrt_fp64(vec2 a) {
  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);

  float x = 1.0 / sqrt(a.x);
  float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  vec2 yn_sqr = twoSqr(yn) * fp64.ONE;
#else
  vec2 yn_sqr = twoSqr(yn);
#endif
  float diff = sub_fp64(a, yn_sqr).x;
  vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  return sum_fp64(split(yn), prod);
#else
  return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`,TM={ONE:1},EM={name:"fp64arithmetic",vs:xM,defaultUniforms:TM,uniformTypes:{ONE:"f32"},fp64ify:eb,fp64LowPart:yM,fp64ifyMatrix4:vM},SM=[0,1,1,1],CM=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

out vec4 picking_vRGBcolor_Avalid;

// Normalize unsigned byte color to 0-1 range
vec3 picking_normalizeColor(vec3 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

// Normalize unsigned byte color to 0-1 range
vec4 picking_normalizeColor(vec4 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

bool picking_isColorZero(vec3 color) {
  return dot(color, vec3(1.0)) < 0.00001;
}

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.00001;
}

// Check if this vertex is highlighted 
bool isVertexHighlighted(vec3 vertexColor) {
  vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);
  return
    bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));
}

// Set the current picking color
void picking_setPickingColor(vec3 pickingColor) {
  pickingColor = picking_normalizeColor(pickingColor);

  if (bool(picking.isActive)) {
    // Use alpha as the validity flag. If pickingColor is [0, 0, 0] fragment is non-pickable
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!bool(picking.isAttribute)) {
      // Stores the picking color so that the fragment shader can render it during picking
      picking_vRGBcolor_Avalid.rgb = pickingColor;
    }
  } else {
    // Do the comparison with selected item color in vertex shader as it should mean fewer compares
    picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.r = value;
  }
}

void picking_setPickingAttribute(vec2 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}

void picking_setPickingAttribute(vec3 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,kM=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

in vec4 picking_vRGBcolor_Avalid;

/*
 * Returns highlight color if this item is selected.
 */
vec4 picking_filterHighlightColor(vec4 color) {
  // If we are still picking, we don't highlight
  if (picking.isActive > 0.5) {
    return color;
  }

  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    // Blend in highlight color based on its alpha value
    float highLightAlpha = picking.highlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 picking_filterPickingColor(vec4 color) {
  if (bool(picking.isActive)) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 picking_filterColor(vec4 color) {
  vec4 highlightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highlightColor);
}
`,T_={props:{},uniforms:{},name:"picking",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:SM},vs:CM,fs:kM,getUniforms:PM};function PM(t={},e){const n={};if(t.highlightedObjectColor!==void 0)if(t.highlightedObjectColor===null)n.isHighlightActive=!1;else{n.isHighlightActive=!0;const r=t.highlightedObjectColor.slice(0,3);n.highlightedObjectColor=r}if(t.highlightColor){const r=Array.from(t.highlightColor,i=>i/255);Number.isFinite(r[3])||(r[3]=1),n.highlightColor=r}return t.isActive!==void 0&&(n.isActive=!!t.isActive,n.isAttribute=!!t.isAttribute),t.useFloatColors!==void 0&&(n.useFloatColors=!!t.useFloatColors),n}const E_=`precision highp int;

// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
  vec3 color;
};

struct PointLight {
  vec3 color;
  vec3 position;
  vec3 attenuation; // 2nd order x:Constant-y:Linear-z:Exponential
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform lightingUniforms {
  int enabled;
  int lightType;

  int directionalLightCount;
  int pointLightCount;

  vec3 ambientColor;

  vec3 lightColor0;
  vec3 lightPosition0;
  vec3 lightDirection0;
  vec3 lightAttenuation0;

  vec3 lightColor1;
  vec3 lightPosition1;
  vec3 lightDirection1;
  vec3 lightAttenuation1;

  vec3 lightColor2;
  vec3 lightPosition2;
  vec3 lightDirection2;
  vec3 lightAttenuation2;
} lighting;

PointLight lighting_getPointLight(int index) {
  switch (index) {
    case 0:
      return PointLight(lighting.lightColor0, lighting.lightPosition0, lighting.lightAttenuation0);
    case 1:
      return PointLight(lighting.lightColor1, lighting.lightPosition1, lighting.lightAttenuation1);
    case 2:
    default:  
      return PointLight(lighting.lightColor2, lighting.lightPosition2, lighting.lightAttenuation2);
  }
}

DirectionalLight lighting_getDirectionalLight(int index) {
  switch (index) {
    case 0:
      return DirectionalLight(lighting.lightColor0, lighting.lightDirection0);
    case 1:
      return DirectionalLight(lighting.lightColor1, lighting.lightDirection1);
    case 2:
    default:   
      return DirectionalLight(lighting.lightColor2, lighting.lightDirection2);
  }
} 

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

// #endif
`,RM=`// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
  color: vec3<f32>,
};

struct PointLight {
  color: vec3<f32>,
  position: vec3<f32>,
  attenuation: vec3<f32>, // 2nd order x:Constant-y:Linear-z:Exponential
};

struct DirectionalLight {
  color: vec3<f32>,
  direction: vec3<f32>,
};

struct lightingUniforms {
  enabled: i32,
  poightCount: i32,
  directionalLightCount: i32,

  ambientColor: vec3<f32>,

  // TODO - support multiple lights by uncommenting arrays below
  lightType: i32,
  lightColor: vec3<f32>,
  lightDirection: vec3<f32>,
  lightPosition: vec3<f32>,
  lightAttenuation: vec3<f32>,

  // AmbientLight ambientLight;
  // PointLight pointLight[MAX_LIGHTS];
  // DirectionalLight directionalLight[MAX_LIGHTS];
};

// Binding 0:1 is reserved for lighting (Note: could go into separate bind group as it is stable across draw calls)
@binding(1) @group(0) var<uniform> lighting : lightingUniforms;

fn lighting_getPointLight(index: i32) -> PointLight {
  return PointLight(lighting.lightColor, lighting.lightPosition, lighting.lightAttenuation);
}

fn lighting_getDirectionalLight(index: i32) -> DirectionalLight {
  return DirectionalLight(lighting.lightColor, lighting.lightDirection);
} 

fn getPointLightAttenuation(pointLight: PointLight, distance: f32) -> f32 {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}
`,tb=3,IM=255;var Kl;(function(t){t[t.POINT=0]="POINT",t[t.DIRECTIONAL=1]="DIRECTIONAL"})(Kl||(Kl={}));const Tl={props:{},uniforms:{},name:"lighting",defines:{MAX_LIGHTS:tb},uniformTypes:{enabled:"i32",lightType:"i32",directionalLightCount:"i32",pointLightCount:"i32",ambientLightColor:"vec3<f32>",lightColor0:"vec3<f32>",lightPosition0:"vec3<f32>",lightDirection0:"vec3<f32>",lightAttenuation0:"vec3<f32>",lightColor1:"vec3<f32>",lightPosition1:"vec3<f32>",lightDirection1:"vec3<f32>",lightAttenuation1:"vec3<f32>",lightColor2:"vec3<f32>",lightPosition2:"vec3<f32>",lightDirection2:"vec3<f32>",lightAttenuation2:"vec3<f32>"},defaultUniforms:{enabled:1,lightType:Kl.POINT,directionalLightCount:0,pointLightCount:0,ambientLightColor:[.1,.1,.1],lightColor0:[1,1,1],lightPosition0:[1,1,2],lightDirection0:[1,1,1],lightAttenuation0:[1,0,0],lightColor1:[1,1,1],lightPosition1:[1,1,2],lightDirection1:[1,1,1],lightAttenuation1:[1,0,0],lightColor2:[1,1,1],lightPosition2:[1,1,2],lightDirection2:[1,1,1],lightAttenuation2:[1,0,0]},source:RM,vs:E_,fs:E_,getUniforms:MM};function MM(t,e={}){if(t=t&&{...t},!t)return{...Tl.defaultUniforms};t.lights&&(t={...t,...OM(t.lights),lights:void 0});const{ambientLight:n,pointLights:r,directionalLights:i}=t||{};if(!(n||r&&r.length>0||i&&i.length>0))return{...Tl.defaultUniforms,enabled:0};const o={...Tl.defaultUniforms,...e,...NM({ambientLight:n,pointLights:r,directionalLights:i})};return t.enabled!==void 0&&(o.enabled=t.enabled?1:0),o}function NM({ambientLight:t,pointLights:e=[],directionalLights:n=[]}){const r={};r.ambientLightColor=$h(t);let i=0;for(const s of e){r.lightType=Kl.POINT;const o=i;r[`lightColor${o}`]=$h(s),r[`lightPosition${o}`]=s.position,r[`lightAttenuation${o}`]=s.attenuation||[1,0,0],i++}for(const s of n){r.lightType=Kl.DIRECTIONAL;const o=i;r[`lightColor${o}`]=$h(s),r[`lightDirection${o}`]=s.direction,i++}return i>tb&&xe.warn("MAX_LIGHTS exceeded")(),r.directionalLightCount=n.length,r.pointLightCount=e.length,r}function OM(t){var n,r;const e={pointLights:[],directionalLights:[]};for(const i of t||[])switch(i.type){case"ambient":e.ambientLight=i;break;case"directional":(n=e.directionalLights)==null||n.push(i);break;case"point":(r=e.pointLights)==null||r.push(i);break}return e}function $h(t={}){const{color:e=[0,0,0],intensity:n=1}=t;return e.map(r=>r*n/IM)}const nb=`uniform phongMaterialUniforms {
  uniform float ambient;
  uniform float diffuse;
  uniform float shininess;
  uniform vec3  specularColor;
} material;
`,rb=`uniform phongMaterialUniforms {
  uniform float ambient;
  uniform float diffuse;
  uniform float shininess;
  uniform vec3  specularColor;
} material;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
  vec3 halfway_direction = normalize(light_direction + view_direction);
  float lambertian = dot(light_direction, normal_worldspace);
  float specular = 0.0;
  if (lambertian > 0.0) {
    float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
    specular = pow(specular_angle, material.shininess);
  }
  lambertian = max(lambertian, 0.0);
  return (lambertian * material.diffuse * surfaceColor + specular * material.specularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting.enabled == 0) {
    return lightColor;
  }

  vec3 view_direction = normalize(cameraPosition - position_worldspace);
  lightColor = material.ambient * surfaceColor * lighting.ambientColor;

  for (int i = 0; i < lighting.pointLightCount; i++) {
    PointLight pointLight = lighting_getPointLight(i);
    vec3 light_position_worldspace = pointLight.position;
    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
    float light_attenuation = getPointLightAttenuation(pointLight, distance(light_position_worldspace, position_worldspace));
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color / light_attenuation);
  }

  int totalLights = min(MAX_LIGHTS, lighting.pointLightCount + lighting.directionalLightCount);
  for (int i = lighting.pointLightCount; i < totalLights; i++) {
    DirectionalLight directionalLight = lighting_getDirectionalLight(i);
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  
  return lightColor;
}
`,gg={props:{},name:"gouraudMaterial",vs:rb.replace("phongMaterial","gouraudMaterial"),fs:nb.replace("phongMaterial","gouraudMaterial"),defines:{LIGHTING_VERTEX:1},dependencies:[Tl],uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(t){const e={...t};return e.specularColor&&(e.specularColor=e.specularColor.map(n=>n/255)),{...gg.defaultUniforms,...e}}},DM=`struct phongMaterialUniforms {
  ambient: f32,
  diffuse: f32,
  shininess: f32,
  specularColor: vec3<f32>,
};

@binding(2) @group(0) var<uniform> material : phongMaterialUniforms;

fn lighting_getLightColor(surfaceColor: vec3<f32>, light_direction: vec3<f32>, view_direction: vec3<f32>, normal_worldspace: vec3<f32>, color: vec3<f32>) -> vec3<f32> {
  let halfway_direction: vec3<f32> = normalize(light_direction + view_direction);
  var lambertian: f32 = dot(light_direction, normal_worldspace);
  var specular: f32 = 0.0;
  if (lambertian > 0.0) {
    let specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
    specular = pow(specular_angle, material.shininess);
  }
  lambertian = max(lambertian, 0.0);
  return (lambertian * material.diffuse * surfaceColor + specular * material.specularColor) * color;
}

fn lighting_getLightColor2(surfaceColor: vec3<f32>, cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32> {
  var lightColor: vec3<f32> = surfaceColor;

  if (lighting.enabled == 0) {
    return lightColor;
  }

  let view_direction: vec3<f32> = normalize(cameraPosition - position_worldspace);
  lightColor = material.ambient * surfaceColor * lighting.ambientColor;

  if (lighting.lightType == 0) {
    let pointLight: PointLight  = lighting_getPointLight(0);
    let light_position_worldspace: vec3<f32> = pointLight.position;
    let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
  } else if (lighting.lightType == 1) {
    var directionalLight: DirectionalLight = lighting_getDirectionalLight(0);
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  
  return lightColor;
  /*
  for (int i = 0; i < MAX_LIGHTS; i++) {
    if (i >= lighting.pointLightCount) {
      break;
    }
    PointLight pointLight = lighting.pointLight[i];
    vec3 light_position_worldspace = pointLight.position;
    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
  }

  for (int i = 0; i < MAX_LIGHTS; i++) {
    if (i >= lighting.directionalLightCount) {
      break;
    }
    DirectionalLight directionalLight = lighting.directionalLight[i];
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  */
}

fn lighting_getSpecularLightColor(cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32>{
  var lightColor = vec3<f32>(0, 0, 0);
  let surfaceColor = vec3<f32>(0, 0, 0);

  if (lighting.enabled == 0) {
    let view_direction = normalize(cameraPosition - position_worldspace);

    switch (lighting.lightType) {
      case 0, default: {
        let pointLight: PointLight = lighting_getPointLight(0);
        let light_position_worldspace: vec3<f32> = pointLight.position;
        let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);
        lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
      }
      case 1: {
        let directionalLight: DirectionalLight = lighting_getDirectionalLight(0);
        lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
      }
    }
  }
  return lightColor;
}
`,ib={name:"phongMaterial",dependencies:[Tl],source:DM,vs:nb,fs:rb,defines:{LIGHTING_FRAGMENT:1},uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(t){const e={...t};return e.specularColor&&(e.specularColor=e.specularColor.map(n=>n/255)),{...ib.defaultUniforms,...e}}},S_=`uniform layerUniforms {
  uniform float opacity;
} layer;
`,BM={name:"layer",vs:S_,fs:S_,getUniforms:t=>({opacity:Math.pow(t.opacity,1/2.2)}),uniformTypes:{opacity:"f32"}},sb="#define SMOOTH_EDGE_RADIUS 0.5",FM=`
${sb}

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`,LM=`
${sb}

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,ob={name:"geometry",vs:FM,fs:LM},UM=25;var mn;(function(t){t[t.Start=1]="Start",t[t.Move=2]="Move",t[t.End=4]="End",t[t.Cancel=8]="Cancel"})(mn||(mn={}));var yn;(function(t){t[t.None=0]="None",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.Up=4]="Up",t[t.Down=8]="Down",t[t.Horizontal=3]="Horizontal",t[t.Vertical=12]="Vertical",t[t.All=15]="All"})(yn||(yn={}));var ot;(function(t){t[t.Possible=1]="Possible",t[t.Began=2]="Began",t[t.Changed=4]="Changed",t[t.Ended=8]="Ended",t[t.Recognized=8]="Recognized",t[t.Cancelled=16]="Cancelled",t[t.Failed=32]="Failed"})(ot||(ot={}));const zM="compute",VM="auto",T0="manipulation",xc="none",E0="pan-x",S0="pan-y";function jM(t){if(t.includes(xc))return xc;const e=t.includes(E0),n=t.includes(S0);return e&&n?xc:e||n?e?E0:S0:t.includes(T0)?T0:VM}class WM{constructor(e,n){this.actions="",this.manager=e,this.set(n)}set(e){e===zM&&(e=this.compute()),this.manager.element&&(this.manager.element.style.touchAction=e,this.actions=e)}update(){this.set(this.manager.options.touchAction)}compute(){let e=[];for(const n of this.manager.recognizers)n.options.enable&&(e=e.concat(n.getTouchAction()));return jM(e.join(" "))}}function yu(t){return t.trim().split(/\s+/g)}function Hh(t,e,n){if(t)for(const r of yu(e))t.addEventListener(r,n,!1)}function Xh(t,e,n){if(t)for(const r of yu(e))t.removeEventListener(r,n,!1)}function C_(t){return(t.ownerDocument||t).defaultView}function $M(t,e){let n=t;for(;n;){if(n===e)return!0;n=n.parentNode}return!1}function ab(t){const e=t.length;if(e===1)return{x:Math.round(t[0].clientX),y:Math.round(t[0].clientY)};let n=0,r=0,i=0;for(;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:Math.round(n/e),y:Math.round(r/e)}}function k_(t){const e=[];let n=0;for(;n<t.pointers.length;)e[n]={clientX:Math.round(t.pointers[n].clientX),clientY:Math.round(t.pointers[n].clientY)},n++;return{timeStamp:Date.now(),pointers:e,center:ab(e),deltaX:t.deltaX,deltaY:t.deltaY}}function lb(t,e){const n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}function P_(t,e){const n=e.clientX-t.clientX,r=e.clientY-t.clientY;return Math.sqrt(n*n+r*r)}function HM(t,e){const n=e.x-t.x,r=e.y-t.y;return Math.atan2(r,n)*180/Math.PI}function R_(t,e){const n=e.clientX-t.clientX,r=e.clientY-t.clientY;return Math.atan2(r,n)*180/Math.PI}function Ab(t,e){return t===e?yn.None:Math.abs(t)>=Math.abs(e)?t<0?yn.Left:yn.Right:e<0?yn.Up:yn.Down}function XM(t,e){const n=e.center;let r=t.offsetDelta,i=t.prevDelta;const s=t.prevInput;return(e.eventType===mn.Start||(s==null?void 0:s.eventType)===mn.End)&&(i=t.prevDelta={x:(s==null?void 0:s.deltaX)||0,y:(s==null?void 0:s.deltaY)||0},r=t.offsetDelta={x:n.x,y:n.y}),{deltaX:i.x+(n.x-r.x),deltaY:i.y+(n.y-r.y)}}function cb(t,e,n){return{x:e/t||0,y:n/t||0}}function QM(t,e){return P_(e[0],e[1])/P_(t[0],t[1])}function YM(t,e){return R_(e[1],e[0])-R_(t[1],t[0])}function KM(t,e){const n=t.lastInterval||e,r=e.timeStamp-n.timeStamp;let i,s,o,a;if(e.eventType!==mn.Cancel&&(r>UM||n.velocity===void 0)){const f=e.deltaX-n.deltaX,p=e.deltaY-n.deltaY,m=cb(r,f,p);s=m.x,o=m.y,i=Math.abs(m.x)>Math.abs(m.y)?m.x:m.y,a=Ab(f,p),t.lastInterval=e}else i=n.velocity,s=n.velocityX,o=n.velocityY,a=n.direction;e.velocity=i,e.velocityX=s,e.velocityY=o,e.direction=a}function qM(t,e){const{session:n}=t,{pointers:r}=e,{length:i}=r;n.firstInput||(n.firstInput=k_(e)),i>1&&!n.firstMultiple?n.firstMultiple=k_(e):i===1&&(n.firstMultiple=!1);const{firstInput:s,firstMultiple:o}=n,a=o?o.center:s.center,f=e.center=ab(r);e.timeStamp=Date.now(),e.deltaTime=e.timeStamp-s.timeStamp,e.angle=HM(a,f),e.distance=lb(a,f);const{deltaX:p,deltaY:m}=XM(n,e);e.deltaX=p,e.deltaY=m,e.offsetDirection=Ab(e.deltaX,e.deltaY);const v=cb(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=v.x,e.overallVelocityY=v.y,e.overallVelocity=Math.abs(v.x)>Math.abs(v.y)?v.x:v.y,e.scale=o?QM(o.pointers,r):1,e.rotation=o?YM(o.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length;let w=t.element;return $M(e.srcEvent.target,w)&&(w=e.srcEvent.target),e.target=w,KM(n,e),e}function ZM(t,e,n){const r=n.pointers.length,i=n.changedPointers.length,s=e&mn.Start&&r-i===0,o=e&(mn.End|mn.Cancel)&&r-i===0;n.isFirst=!!s,n.isFinal=!!o,s&&(t.session={}),n.eventType=e;const a=qM(t,n);t.emit("hammer.input",a),t.recognize(a),t.session.prevInput=a}let GM=class{constructor(e){this.evEl="",this.evWin="",this.evTarget="",this.domHandler=n=>{this.manager.options.enable&&this.handler(n)},this.manager=e,this.element=e.element,this.target=e.options.inputTarget||e.element}callback(e,n){ZM(this.manager,e,n)}init(){Hh(this.element,this.evEl,this.domHandler),Hh(this.target,this.evTarget,this.domHandler),Hh(C_(this.element),this.evWin,this.domHandler)}destroy(){Xh(this.element,this.evEl,this.domHandler),Xh(this.target,this.evTarget,this.domHandler),Xh(C_(this.element),this.evWin,this.domHandler)}};const JM={pointerdown:mn.Start,pointermove:mn.Move,pointerup:mn.End,pointercancel:mn.Cancel,pointerout:mn.Cancel},e6="pointerdown",t6="pointermove pointerup pointercancel";class n6 extends GM{constructor(e){super(e),this.evEl=e6,this.evWin=t6,this.store=this.manager.session.pointerEvents=[],this.init()}handler(e){const{store:n}=this;let r=!1;const i=JM[e.type],s=e.pointerType,o=s==="touch";let a=n.findIndex(f=>f.pointerId===e.pointerId);i&mn.Start&&(e.buttons||o)?a<0&&(n.push(e),a=n.length-1):i&(mn.End|mn.Cancel)&&(r=!0),!(a<0)&&(n[a]=e,this.callback(i,{pointers:n,changedPointers:[e],eventType:i,pointerType:s,srcEvent:e}),r&&n.splice(a,1))}}const r6=["","webkit","Moz","MS","ms","o"];function i6(t,e){const n=e[0].toUpperCase()+e.slice(1);for(const r of r6){const i=r?r+n:e;if(i in t)return i}}const s6=1,I_=2,M_={touchAction:"compute",enable:!0,inputTarget:null,cssProps:{userSelect:"none",userDrag:"none",touchCallout:"none",tapHighlightColor:"rgba(0,0,0,0)"}};class o6{constructor(e,n){this.options={...M_,...n,cssProps:{...M_.cssProps,...n.cssProps},inputTarget:n.inputTarget||e},this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new n6(this),this.touchAction=new WM(this,this.options.touchAction),this.toggleCssProps(!0)}set(e){return Object.assign(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this}stop(e){this.session.stopped=e?I_:s6}recognize(e){const{session:n}=this;if(n.stopped)return;this.session.prevented&&e.srcEvent.preventDefault();let r;const{recognizers:i}=this;let{curRecognizer:s}=n;(!s||s&&s.state&ot.Recognized)&&(s=n.curRecognizer=null);let o=0;for(;o<i.length;)r=i[o],n.stopped!==I_&&(!s||r===s||r.canRecognizeWith(s))?r.recognize(e):r.reset(),!s&&r.state&(ot.Began|ot.Changed|ot.Ended)&&(s=n.curRecognizer=r),o++}get(e){const{recognizers:n}=this;for(let r=0;r<n.length;r++)if(n[r].options.event===e)return n[r];return null}add(e){if(Array.isArray(e)){for(const r of e)this.add(r);return this}const n=this.get(e.options.event);return n&&this.remove(n),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e}remove(e){if(Array.isArray(e)){for(const r of e)this.remove(r);return this}const n=typeof e=="string"?this.get(e):e;if(n){const{recognizers:r}=this,i=r.indexOf(n);i!==-1&&(r.splice(i,1),this.touchAction.update())}return this}on(e,n){if(!e||!n)return;const{handlers:r}=this;for(const i of yu(e))r[i]=r[i]||[],r[i].push(n)}off(e,n){if(!e)return;const{handlers:r}=this;for(const i of yu(e))n?r[i]&&r[i].splice(r[i].indexOf(n),1):delete r[i]}emit(e,n){const r=this.handlers[e]&&this.handlers[e].slice();if(!r||!r.length)return;const i=n;i.type=e,i.preventDefault=function(){n.srcEvent.preventDefault()};let s=0;for(;s<r.length;)r[s](i),s++}destroy(){this.toggleCssProps(!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}toggleCssProps(e){const{element:n}=this;if(n){for(const[r,i]of Object.entries(this.options.cssProps)){const s=i6(n.style,r);e?(this.oldCssProps[s]=n.style[s],n.style[s]=i):n.style[s]=this.oldCssProps[s]||""}e||(this.oldCssProps={})}}}let a6=1;function l6(){return a6++}function N_(t){return t&ot.Cancelled?"cancel":t&ot.Ended?"end":t&ot.Changed?"move":t&ot.Began?"start":""}class ub{constructor(e){this.options=e,this.id=l6(),this.state=ot.Possible,this.simultaneous={},this.requireFail=[]}set(e){return Object.assign(this.options,e),this.manager.touchAction.update(),this}recognizeWith(e){if(Array.isArray(e)){for(const i of e)this.recognizeWith(i);return this}let n;if(typeof e=="string"){if(n=this.manager.get(e),!n)throw new Error(`Cannot find recognizer ${e}`)}else n=e;const{simultaneous:r}=this;return r[n.id]||(r[n.id]=n,n.recognizeWith(this)),this}dropRecognizeWith(e){if(Array.isArray(e)){for(const r of e)this.dropRecognizeWith(r);return this}let n;return typeof e=="string"?n=this.manager.get(e):n=e,n&&delete this.simultaneous[n.id],this}requireFailure(e){if(Array.isArray(e)){for(const i of e)this.requireFailure(i);return this}let n;if(typeof e=="string"){if(n=this.manager.get(e),!n)throw new Error(`Cannot find recognizer ${e}`)}else n=e;const{requireFail:r}=this;return r.indexOf(n)===-1&&(r.push(n),n.requireFailure(this)),this}dropRequireFailure(e){if(Array.isArray(e)){for(const r of e)this.dropRequireFailure(r);return this}let n;if(typeof e=="string"?n=this.manager.get(e):n=e,n){const r=this.requireFail.indexOf(n);r>-1&&this.requireFail.splice(r,1)}return this}hasRequireFailures(){return!!this.requireFail.find(e=>e.options.enable)}canRecognizeWith(e){return!!this.simultaneous[e.id]}emit(e){if(!e)return;const{state:n}=this;n<ot.Ended&&this.manager.emit(this.options.event+N_(n),e),this.manager.emit(this.options.event,e),e.additionalEvent&&this.manager.emit(e.additionalEvent,e),n>=ot.Ended&&this.manager.emit(this.options.event+N_(n),e)}tryEmit(e){this.canEmit()?this.emit(e):this.state=ot.Failed}canEmit(){let e=0;for(;e<this.requireFail.length;){if(!(this.requireFail[e].state&(ot.Failed|ot.Possible)))return!1;e++}return!0}recognize(e){const n={...e};if(!this.options.enable){this.reset(),this.state=ot.Failed;return}this.state&(ot.Recognized|ot.Cancelled|ot.Failed)&&(this.state=ot.Possible),this.state=this.process(n),this.state&(ot.Began|ot.Changed|ot.Ended|ot.Cancelled)&&this.tryEmit(n)}getEventNames(){return[this.options.event]}reset(){}}class fb extends ub{attrTest(e){const n=this.options.pointers;return n===0||e.pointers.length===n}process(e){const{state:n}=this,{eventType:r}=e,i=n&(ot.Began|ot.Changed),s=this.attrTest(e);return i&&(r&mn.Cancel||!s)?n|ot.Cancelled:i||s?r&mn.End?n|ot.Ended:n&ot.Began?n|ot.Changed:ot.Began:ot.Failed}}class O_ extends ub{constructor(e={}){super({enable:!0,event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10,...e}),this.pTime=null,this.pCenter=null,this._timer=null,this._input=null,this.count=0}getTouchAction(){return[T0]}process(e){const{options:n}=this,r=e.pointers.length===n.pointers,i=e.distance<n.threshold,s=e.deltaTime<n.time;if(this.reset(),e.eventType&mn.Start&&this.count===0)return this.failTimeout();if(i&&s&&r){if(e.eventType!==mn.End)return this.failTimeout();const o=this.pTime?e.timeStamp-this.pTime<n.interval:!0,a=!this.pCenter||lb(this.pCenter,e.center)<n.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,!a||!o?this.count=1:this.count+=1,this._input=e,this.count%n.taps===0)return this.hasRequireFailures()?(this._timer=setTimeout(()=>{this.state=ot.Recognized,this.tryEmit(this._input)},n.interval),ot.Began):ot.Recognized}return ot.Failed}failTimeout(){return this._timer=setTimeout(()=>{this.state=ot.Failed},this.options.interval),ot.Failed}reset(){clearTimeout(this._timer)}emit(e){this.state===ot.Recognized&&(e.tapCount=this.count,this.manager.emit(this.options.event,e))}}const A6=["","start","move","end","cancel","up","down","left","right"];class D_ extends fb{constructor(e={}){super({enable:!0,pointers:1,event:"pan",threshold:10,direction:yn.All,...e}),this.pX=null,this.pY=null}getTouchAction(){const{options:{direction:e}}=this,n=[];return e&yn.Horizontal&&n.push(S0),e&yn.Vertical&&n.push(E0),n}getEventNames(){return A6.map(e=>this.options.event+e)}directionTest(e){const{options:n}=this;let r=!0,{distance:i}=e,{direction:s}=e;const o=e.deltaX,a=e.deltaY;return s&n.direction||(n.direction&yn.Horizontal?(s=o===0?yn.None:o<0?yn.Left:yn.Right,r=o!==this.pX,i=Math.abs(e.deltaX)):(s=a===0?yn.None:a<0?yn.Up:yn.Down,r=a!==this.pY,i=Math.abs(e.deltaY))),e.direction=s,r&&i>n.threshold&&!!(s&n.direction)}attrTest(e){return super.attrTest(e)&&(!!(this.state&ot.Began)||!(this.state&ot.Began)&&this.directionTest(e))}emit(e){this.pX=e.deltaX,this.pY=e.deltaY;const n=yn[e.direction].toLowerCase();n&&(e.additionalEvent=this.options.event+n),super.emit(e)}}const c6=["","start","move","end","cancel","in","out"];class u6 extends fb{constructor(e={}){super({enable:!0,event:"pinch",threshold:0,pointers:2,...e})}getTouchAction(){return[xc]}getEventNames(){return c6.map(e=>this.options.event+e)}attrTest(e){return super.attrTest(e)&&(Math.abs(e.scale-1)>this.options.threshold||!!(this.state&ot.Began))}emit(e){if(e.scale!==1){const n=e.scale<1?"in":"out";e.additionalEvent=this.options.event+n}super.emit(e)}}class hf{constructor(e,n,r){this.element=e,this.callback=n,this.options=r}}const f6=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",h6=f6.indexOf("firefox")!==-1,B_=4.000244140625,d6=40,p6=.25;class g6 extends hf{constructor(e,n,r){super(e,n,{enable:!0,...r}),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;globalThis.WheelEvent&&(h6&&i.deltaMode===globalThis.WheelEvent.DOM_DELTA_PIXEL&&(s/=globalThis.devicePixelRatio),i.deltaMode===globalThis.WheelEvent.DOM_DELTA_LINE&&(s*=d6)),s!==0&&s%B_===0&&(s=Math.floor(s/B_)),i.shiftKey&&s&&(s=s*p6),this.callback({type:"wheel",center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("wheel",this.handleEvent,{passive:!1})}destroy(){this.element.removeEventListener("wheel",this.handleEvent)}enableEventType(e,n){e==="wheel"&&(this.options.enable=n)}}const F_=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"];class m6 extends hf{constructor(e,n,r){super(e,n,{enable:!0,...r}),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,F_.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){F_.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){switch(e){case"pointermove":this.enableMoveEvent=n;break;case"pointerover":this.enableOverEvent=n;break;case"pointerout":this.enableOutEvent=n;break;case"pointerenter":this.enableEnterEvent=n;break;case"pointerleave":this.enableLeaveEvent=n;break}}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit("pointerover",e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit("pointerout",e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit("pointerenter",e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit("pointerleave",e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.buttons===0&&(this.pressed=!1),this.pressed||this._emit("pointermove",e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const L_=["keydown","keyup"];class _6 extends hf{constructor(e,n,r){super(e,n,{enable:!0,tabIndex:0,...r}),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:"keydown",srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:"keyup",srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,e.tabIndex=this.options.tabIndex,e.style.outline="none",L_.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){L_.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e==="keydown"&&(this.enableDownEvent=n),e==="keyup"&&(this.enableUpEvent=n)}}class y6 extends hf{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:"contextmenu",center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e==="contextmenu"&&(this.options.enable=n)}}const U_=1,C0=2,z_=4,v6={pointerdown:U_,pointermove:C0,pointerup:z_,mousedown:U_,mousemove:C0,mouseup:z_},w6=0,b6=1,x6=2,T6=1,E6=2,S6=4;function C6(t){const e=v6[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r}=t.srcEvent;let i=!1,s=!1,o=!1;return e===C0?(i=!!(n&T6),s=!!(n&S6),o=!!(n&E6)):(i=r===w6,s=r===b6,o=r===x6),{leftButton:i,middleButton:s,rightButton:o}}function k6(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,s=r.height/e.offsetHeight||1,o={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/s};return{center:n,offsetCenter:o}}const P6={srcElement:"root",priority:0};class R6{constructor(e,n){this.handleEvent=r=>{if(this.isEmpty())return;const i=this._normalizeEvent(r);let s=r.srcEvent.target;for(;s&&s!==i.rootElement;){if(this._emit(i,s),i.handled)return;s=s.parentNode}this._emit(i,"root")},this.eventManager=e,this.recognizerName=n,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,s=!1){const{handlers:o,handlersByElement:a}=this,f={...P6,...r};let p=a.get(f.srcElement);p||(p=[],a.set(f.srcElement,p));const m={type:e,handler:n,srcElement:f.srcElement,priority:f.priority};i&&(m.once=!0),s&&(m.passive=!0),o.push(m),this._active=this._active||!m.passive;let v=p.length-1;for(;v>=0&&!(p[v].priority>=m.priority);)v--;p.splice(v+1,0,m)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.type===e&&o.handler===n){r.splice(s,1);const a=i.get(o.srcElement);a.splice(a.indexOf(o),1),a.length===0&&i.delete(o.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,i=!0},a=[];for(let f=0;f<r.length;f++){const{type:p,handler:m,once:v}=r[f];if(m({...e,type:p,stopPropagation:s,stopImmediatePropagation:o}),v&&a.push(r[f]),i)break}for(let f=0;f<a.length;f++){const{type:p,handler:m}=a[f];this.remove(p,m)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...C6(e),...k6(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}function I6(t){if("recognizer"in t)return t;let e;const n=Array.isArray(t)?[...t]:[t];if(typeof n[0]=="function"){const r=n.shift(),i=n.shift()||{};e=new r(i)}else e=n.shift();return{recognizer:e,recognizeWith:typeof n[0]=="string"?[n[0]]:n[0],requireFailure:typeof n[1]=="string"?[n[1]]:n[1]}}class M6{constructor(e=null,n={}){if(this._onBasicInput=r=>{this.manager.emit(r.srcEvent.type,r)},this._onOtherEvent=r=>{this.manager.emit(r.type,r)},this.options={recognizers:[],events:{},touchAction:"compute",tabIndex:0,cssProps:{},...n},this.events=new Map,this.element=e,!!e){this.manager=new o6(e,this.options);for(const r of this.options.recognizers){const{recognizer:i,recognizeWith:s,requireFailure:o}=I6(r);this.manager.add(i),s&&i.recognizeWith(s),o&&i.requireFailure(o)}this.manager.on("hammer.input",this._onBasicInput),this.wheelInput=new g6(e,this._onOtherEvent,{enable:!1}),this.moveInput=new m6(e,this._onOtherEvent,{enable:!1}),this.keyInput=new _6(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new y6(e,this._onOtherEvent,{enable:!1}),this.on(this.options.events)}}getElement(){return this.element}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy())}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){var s,o,a,f;const{manager:r}=this;if(!r)return;const i=r.get(e);i&&(i.set({enable:n}),r.touchAction.update()),(s=this.wheelInput)==null||s.enableEventType(e,n),(o=this.moveInput)==null||o.enableEventType(e,n),(a=this.keyInput)==null||a.enableEventType(e,n),(f=this.contextmenuInput)==null||f.enableEventType(e,n)}_addEventHandler(e,n,r,i,s){if(typeof e!="string"){r=n;for(const[p,m]of Object.entries(e))this._addEventHandler(p,m,r,i,s);return}const{manager:o,events:a}=this;if(!o)return;let f=a.get(e);if(!f){const p=this._getRecognizerName(e)||e;f=new R6(this,p),a.set(e,f),o&&o.on(e,f.handleEvent)}f.add(e,n,r,i,s),f.isEmpty()||this._toggleRecognizer(f.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const[s,o]of Object.entries(e))this._removeEventHandler(s,o);return}const{events:r}=this,i=r.get(e);if(i&&(i.remove(e,n),i.isEmpty())){const{recognizerName:s}=i;let o=!1;for(const a of r.values())if(a.recognizerName===s&&!a.isEmpty()){o=!0;break}o||this._toggleRecognizer(s,!1)}}_getRecognizerName(e){var n;return(n=this.manager.recognizers.find(r=>r.getEventNames().includes(e)))==null?void 0:n.options.event}}const bt={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(bt,"IDENTITY",{get:()=>(ut.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const li={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Ii={common:0,meters:1,pixels:2},k0={click:"onClick",panstart:"onDragStart",panmove:"onDrag",panend:"onDragEnd"},V_={multipan:[D_,{threshold:10,direction:yn.Vertical,pointers:2}],pinch:[u6,{},null,["multipan"]],pan:[D_,{threshold:1},["pinch"],["multipan"]],dblclick:[O_,{event:"dblclick",taps:2}],click:[O_,{event:"click"},null,["dblclick"]]};function N6(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function uA(t){let e={},n;return r=>{for(const i in r)if(!N6(r[i],e[i])){n=t(r),e=r;break}return n}}const j_=[0,0,0,0],O6=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],hb=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],D6=[0,0,0],db=[0,0,0],B6=uA(U6);function pb(t,e,n=db){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,s=!0;switch(e===bt.LNGLAT_OFFSETS||e===bt.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case li.WEB_MERCATOR:(e===bt.LNGLAT||e===bt.CARTESIAN)&&(i=[0,0,0],s=!1);break;case li.WEB_MERCATOR_AUTO_OFFSET:e===bt.LNGLAT?r=i:e===bt.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case li.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case li.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function F6(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:o}=t,a=j_,f=j_,p=t.cameraPosition;const{geospatialOrigin:m,shaderCoordinateOrigin:v,offsetMode:w}=pb(t,e,n);return w&&(f=t.projectPosition(m||v),p=[p[0]-f[0],p[1]-f[1],p[2]-f[2]],f[3]=1,a=cA([],f,o),s=r||s,o=js([],i,s),o=js([],o,O6)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:f,cameraPosCommon:p,shaderCoordinateOrigin:v,geospatialOrigin:m}}function L6({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=bt.DEFAULT,coordinateOrigin:i=db,autoWrapLongitude:s=!1}){r===bt.DEFAULT&&(r=t.isGeospatial?bt.LNGLAT:bt.CARTESIAN);const o=B6({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return o.wrapLongitude=s,o.modelMatrix=n||hb,o}function U6({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:f,geospatialOrigin:p}=F6(t,n,r),m=t.getDistanceScales(),v=[t.width*e,t.height*e],w=cA([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,T={coordinateSystem:n,projectionMode:t.projectionMode,coordinateOrigin:f,commonOrigin:o.slice(0,3),center:i,pseudoMeters:!!t._pseudoMeters,viewportSize:v,devicePixelRatio:e,focalDistance:w,commonUnitsPerMeter:m.unitsPerMeter,commonUnitsPerWorldUnit:m.unitsPerMeter,commonUnitsPerWorldUnit2:D6,scale:t.scale,wrapLongitude:!1,viewProjectionMatrix:s,modelMatrix:hb,cameraPosition:a};if(p){const E=t.getDistanceScales(p);switch(n){case bt.METER_OFFSETS:T.commonUnitsPerWorldUnit=E.unitsPerMeter,T.commonUnitsPerWorldUnit2=E.unitsPerMeter2;break;case bt.LNGLAT:case bt.LNGLAT_OFFSETS:t._pseudoMeters||(T.commonUnitsPerMeter=E.unitsPerMeter),T.commonUnitsPerWorldUnit=E.unitsPerDegree,T.commonUnitsPerWorldUnit2=E.unitsPerDegree2;break;case bt.CARTESIAN:T.commonUnitsPerWorldUnit=[1,1,E.unitsPerMeter[2]],T.commonUnitsPerWorldUnit2=[0,0,E.unitsPerMeter2[2]];break}}return T}const z6=Object.keys(bt).map(t=>`const int COORDINATE_SYSTEM_${t} = ${bt[t]};`).join(""),V6=Object.keys(li).map(t=>`const int PROJECTION_MODE_${t} = ${li[t]};`).join(""),j6=Object.keys(Ii).map(t=>`const int UNIT_${t.toUpperCase()} = ${Ii[t]};`).join(""),W6=`${z6}
${V6}
${j6}
uniform projectUniforms {
bool wrapLongitude;
int coordinateSystem;
vec3 commonUnitsPerMeter;
int projectionMode;
float scale;
vec3 commonUnitsPerWorldUnit;
vec3 commonUnitsPerWorldUnit2;
vec4 center;
mat4 modelMatrix;
mat4 viewProjectionMatrix;
vec2 viewportSize;
float devicePixelRatio;
float focalDistance;
vec3 cameraPosition;
vec3 coordinateOrigin;
vec3 commonOrigin;
bool pseudoMeters;
} project;
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
float y = clamp(lat, -89.9, 89.9);
return 1.0 / cos(radians(y));
}
float project_size() {
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
project.pseudoMeters == false) {
if (geometry.position.w == 0.0) {
return project_size_at_latitude(geometry.worldPosition.y);
}
float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
float y2 = y * y;
float y4 = y2 * y2;
float y6 = y4 * y2;
return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
}
return 1.0;
}
float project_size_at_latitude(float meters, float lat) {
return meters * project.commonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
return meters * project.commonUnitsPerMeter.z * project_size();
}
vec2 project_size(vec2 meters) {
return meters * project.commonUnitsPerMeter.xy * project_size();
}
vec3 project_size(vec3 meters) {
return meters * project.commonUnitsPerMeter * project_size();
}
vec4 project_size(vec4 meters) {
return vec4(meters.xyz * project.commonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
vec3 uz = normalize(up);
vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
vec3 uy = cross(uz, ux);
return mat3(ux, uy, uz);
}
bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
transform = project_get_orientation_matrix(commonPosition);
return true;
}
return false;
}
vec3 project_normal(vec3 vector) {
vec4 normal_modelspace = project.modelMatrix * vec4(vector, 0.0);
vec3 n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
mat3 rotation;
if (project_needs_rotation(geometry.position.xyz, rotation)) {
n = rotation * n;
}
return n;
}
vec4 project_offset_(vec4 offset) {
float dy = offset.y;
vec3 commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
float x = lnglat.x;
if (project.wrapLongitude) {
x = mod(x + 180., 360.0) - 180.;
}
float y = clamp(lnglat.y, -89.9, 89.9);
return vec2(
radians(x) + PI,
PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
) * WORLD_SCALE;
}
vec3 project_globe_(vec3 lnglatz) {
float lambda = radians(lnglatz.x);
float phi = radians(lnglatz.y);
float cosPhi = cos(phi);
float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
return vec3(
sin(lambda) * cosPhi,
-cos(lambda) * cosPhi,
sin(phi)
) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
vec4 position_world = project.modelMatrix * position;
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_mercator_(position_world.xy),
project_size_at_latitude(position_world.z, position_world.y),
position_world.w
);
}
if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
position_world.xyz += project.coordinateOrigin;
}
}
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_globe_(position_world.xyz),
position_world.w
);
}
}
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
return vec4(
project_mercator_(position_world.xy) - project.commonOrigin.xy,
project_size(position_world.z),
position_world.w
);
}
}
}
if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
(project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
(project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
position_world.xyz -= project.coordinateOrigin;
}
return project_offset_(position_world) + project_offset_(project.modelMatrix * vec4(position64Low, 0.0));
}
vec4 project_position(vec4 position) {
return project_position(position, ZERO_64_LOW);
}
vec3 project_position(vec3 position, vec3 position64Low) {
vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
return projected_position.xyz;
}
vec3 project_position(vec3 position) {
vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
return projected_position.xyz;
}
vec2 project_position(vec2 position) {
vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
return projected_position.xy;
}
vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
return project_common_position_to_clipspace(position, project.viewProjectionMatrix, project.center);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
vec2 offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
return offset * project.focalDistance;
}
float project_size_to_pixel(float meters) {
return project_size(meters) * project.scale;
}
float project_size_to_pixel(float size, int unit) {
if (unit == UNIT_METERS) return project_size_to_pixel(size);
if (unit == UNIT_COMMON) return size * project.scale;
return size;
}
float project_pixel_size(float pixels) {
return pixels / project.scale;
}
vec2 project_pixel_size(vec2 pixels) {
return pixels / project.scale;
}
`,$6={};function H6(t=$6){return"viewport"in t?L6(t):{}}const mg={name:"project",dependencies:[bM,ob],vs:W6,getUniforms:H6,uniformTypes:{wrapLongitude:"f32",coordinateSystem:"i32",commonUnitsPerMeter:"vec3<f32>",projectionMode:"i32",scale:"f32",commonUnitsPerWorldUnit:"vec3<f32>",commonUnitsPerWorldUnit2:"vec3<f32>",center:"vec4<f32>",modelMatrix:"mat4x4<f32>",viewProjectionMatrix:"mat4x4<f32>",viewportSize:"vec2<f32>",devicePixelRatio:"f32",focalDistance:"f32",cameraPosition:"vec3<f32>",coordinateOrigin:"vec3<f32>",commonOrigin:"vec3<f32>",pseudoMeters:"f32"}},X6=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,Sa={name:"project32",dependencies:[mg],vs:X6};function Q6(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Jo(t,e){const n=cA([],e,t);return fM(n,n,1/n[3]),n}function W_(t,e){const n=t%e;return n<0?e+n:n}function P0(t,e,n){return t<e?e:t>n?n:t}function Y6(t){return Math.log(t)*Math.LOG2E}const _g=Math.log2||Y6;function Mi(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const Hr=Math.PI,gb=Hr/4,Mr=Hr/180,R0=180/Hr,pa=512,vu=4003e4,$_=85.051129,K6=1.5;function q6(t){return _g(t)}function wu(t){const[e,n]=t;Mi(Number.isFinite(e)),Mi(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*Mr,i=n*Mr,s=pa*(r+Hr)/(2*Hr),o=pa*(Hr+Math.log(Math.tan(gb+i*.5)))/(2*Hr);return[s,o]}function ga(t){const[e,n]=t,r=e/pa*(2*Hr)-Hr,i=2*(Math.atan(Math.exp(n/pa*(2*Hr)-Hr))-gb);return[r*R0,i*R0]}function Z6(t){const{latitude:e}=t;Mi(Number.isFinite(e));const n=Math.cos(e*Mr);return q6(vu*n)-9}function Qh(t){const e=Math.cos(t*Mr);return pa/vu/e}function I0(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;Mi(Number.isFinite(e)&&Number.isFinite(n));const i=pa,s=Math.cos(e*Mr),o=i/360,a=o/s,f=i/vu/s,p={unitsPerMeter:[f,f,f],metersPerUnit:[1/f,1/f,1/f],unitsPerDegree:[o,a,f],degreesPerUnit:[1/o,1/a,1/f]};if(r){const m=Mr*Math.tan(e*Mr)/s,v=o*m/2,w=i/vu*m,T=w/a*f;p.unitsPerDegree2=[0,v,w],p.unitsPerMeter2=[T,0,T]}return p}function mb(t,e){const[n,r,i]=t,[s,o,a]=e,{unitsPerMeter:f,unitsPerMeter2:p}=I0({longitude:n,latitude:r,highPrecision:!0}),m=wu(t);m[0]+=s*(f[0]+p[0]*o),m[1]+=o*(f[1]+p[1]*o);const v=ga(m),w=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[v[0],v[1],w]:v}function G6(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:s,center:o}=t,a=Q6();_u(a,a,[0,0,-i]),Gw(a,a,-n*Mr),Jw(a,a,r*Mr);const f=s/e;return pg(a,a,[f,f,f]),o&&_u(a,a,jI([],o)),a}function J6(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:s,center:o,scale:a,nearZMultiplier:f=1,farZMultiplier:p=1}=t;let{fovy:m=bu(K6)}=t;r!==void 0&&(m=bu(r));const v=m*Mr,w=i*Mr,T=_b(m);let E=T;o&&(E+=o[2]*a/Math.cos(w)/n);const N=v*(.5+(s?s[1]:0)/n),j=Math.sin(N)*E/Math.sin(P0(Math.PI/2-w-N,.01,Math.PI-.01)),I=Math.sin(w)*j+E,R=E*10,k=Math.min(I*p,R);return{fov:v,aspect:e/n,focalDistance:T,near:f,far:k}}function bu(t){return 2*Math.atan(.5/t)*R0}function _b(t){return .5/Math.tan(.5*t*Mr)}function yb(t,e){const[n,r,i=0]=t;return Mi(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),Jo(e,[n,r,i,1])}function yg(t,e,n=0){const[r,i,s]=t;if(Mi(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return Jo(e,[r,i,s,1]);const o=Jo(e,[r,i,0,1]),a=Jo(e,[r,i,1,1]),f=o[2],p=a[2],m=f===p?0:((n||0)-f)/(p-f);return Kw([],o,a,m)}function eN(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:o=[0,0]}=t,[[a,f],[p,m]]=r,v=tN(t.padding),w=wu([a,P0(m,-85.051129,$_)]),T=wu([p,P0(f,-85.051129,$_)]),E=[Math.max(Math.abs(T[0]-w[0]),i),Math.max(Math.abs(T[1]-w[1]),i)],N=[e-v.left-v.right-Math.abs(o[0])*2,n-v.top-v.bottom-Math.abs(o[1])*2];Mi(N[0]>0&&N[1]>0);const j=N[0]/E[0],I=N[1]/E[1],R=(v.right-v.left)/2/j,k=(v.top-v.bottom)/2/I,B=[(T[0]+w[0])/2+R,(T[1]+w[1])/2+k],Y=ga(B),G=Math.min(s,_g(Math.abs(Math.min(j,I))));return Mi(Number.isFinite(G)),{longitude:Y[0],latitude:Y[1],zoom:G}}function tN(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(Mi(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const H_=Math.PI/180;function nN(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},o=i([0,r],s),a=i([n,r],s);let f,p;const m=t.fovy?.5*t.fovy*H_:Math.atan(.5/t.altitude),v=(90-t.pitch)*H_;return m>v-.01?(f=X_(t,0,e),p=X_(t,n,e)):(f=i([0,0],s),p=i([n,0],s)),[o,a,p,f]}function X_(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=Jo(r,[e,0,1,1]),s=Jo(r,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),f=Kw([],i,s,a),p=ga(f);return p.push(n),p}const Q_=512;function rN(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:s,zoom:o,bearing:a=0}=t;(i<-180||i>180)&&(i=W_(i+180,360)-180),(a<-180||a>180)&&(a=W_(a+180,360)-180);const f=_g(n/Q_);if(o<=f)o=f,s=0;else{const p=n/2/Math.pow(2,o),m=ga([0,p])[1];if(s<m)s=m;else{const v=ga([0,Q_-p])[1];s>v&&(s=v)}}return{width:e,height:n,longitude:i,latitude:s,zoom:o,pitch:r,bearing:a}}const vb=`
uniform shadowUniforms {
  bool drawShadowMap;
  bool useShadowMap;
  vec4 color;
  highp int lightId;
  float lightCount;
  mat4 viewProjectionMatrix0;
  mat4 viewProjectionMatrix1;
  vec4 projectCenter0;
  vec4 projectCenter1;
} shadow;
`,iN=`
const int max_lights = 2;

out vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  mat4 viewProjectionMatrices[max_lights];
  viewProjectionMatrices[0] = shadow.viewProjectionMatrix0;
  viewProjectionMatrices[1] = shadow.viewProjectionMatrix1;
  vec4 projectCenters[max_lights];
  projectCenters[0] = shadow.projectCenter0;
  projectCenters[1] = shadow.projectCenter1;

  if (shadow.drawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[shadow.lightId], projectCenters[shadow.lightId]);
  }
  if (shadow.useShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow.lightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[i], projectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,sN=`
${vb}
${iN}
`,oN=`
const int max_lights = 2;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;

in vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow.drawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow.useShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow.lightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow.color.a / shadow.lightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow.color.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,aN=`
${vb}
${oN}
`,lN=uA(hN),AN=uA(dN),cN=[0,0,0,1],uN=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function fN(t,e){const[n,r,i]=t,s=yg([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function hN({viewport:t,center:e}){return new fi(t.viewProjectionMatrix).invert().transform(e)}function dN({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(o=>fN(o,r));for(const o of e){const a=o.clone().translate(new ui(t.center).negate()),f=s.map(m=>a.transform(m)),p=new fi().ortho({left:Math.min(...f.map(m=>m[0])),right:Math.max(...f.map(m=>m[0])),bottom:Math.min(...f.map(m=>m[1])),top:Math.max(...f.map(m=>m[1])),near:Math.min(...f.map(m=>-m[2])),far:Math.max(...f.map(m=>-m[2]))});n.push(p.multiplyRight(o))}return n}function pN(t){const{shadowEnabled:e=!0,project:n}=t;if(!e||!n||!t.shadowMatrices||!t.shadowMatrices.length)return{drawShadowMap:!1,useShadowMap:!1,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};const r=mg.getUniforms(n),i=lN({viewport:n.viewport,center:r.center}),s=[],o=AN({shadowMatrices:t.shadowMatrices,viewport:n.viewport}).slice();for(let f=0;f<t.shadowMatrices.length;f++){const p=o[f],m=p.clone().translate(new ui(n.viewport.center).negate());r.coordinateSystem===bt.LNGLAT&&r.projectionMode===li.WEB_MERCATOR?(o[f]=m,s[f]=i):(o[f]=p.clone().multiplyRight(uN),s[f]=m.transform(i))}const a={drawShadowMap:!!t.drawToShadowMap,useShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,color:t.shadowColor||cN,lightId:t.shadowLightId||0,lightCount:t.shadowMatrices.length,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};for(let f=0;f<o.length;f++)a[`viewProjectionMatrix${f}`]=o[f],a[`projectCenter${f}`]=s[f];for(let f=0;f<2;f++)a[`shadow_uShadowMap${f}`]=t.shadowMaps&&t.shadowMaps[f]||t.dummyShadowMap;return a}const Y_={name:"shadow",dependencies:[mg],vs:sN,fs:aN,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:pN,uniformTypes:{drawShadowMap:"f32",useShadowMap:"f32",color:"vec4<f32>",lightId:"i32",lightCount:"f32",viewProjectionMatrix0:"mat4x4<f32>",viewProjectionMatrix1:"mat4x4<f32>",projectCenter0:"vec4<f32>",projectCenter1:"vec4<f32>"}},Ca={...T_,defaultUniforms:{...T_.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}}},gN=[ob],mN=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"],_N=[];function yN(t){const e=ou.getDefaultShaderAssembler();for(const r of gN)e.addDefaultModule(r);const n=t==="glsl"?mN:_N;for(const r of n)e.addShaderHook(r);return e}const vN=[255,255,255],wN=1;let bN=0;class xN{constructor(e={}){this.type="ambient";const{color:n=vN}=e,{intensity:r=wN}=e;this.id=e.id||`ambient-${bN++}`,this.color=n,this.intensity=r}}const TN=[255,255,255],EN=1,SN=[0,0,-1];let CN=0;class K_{constructor(e={}){this.type="directional";const{color:n=TN}=e,{intensity:r=EN}=e,{direction:i=SN}=e,{_shadow:s=!1}=e;this.id=e.id||`directional-${CN++}`,this.color=n,this.intensity=r,this.type="directional",this.direction=new ui(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class kN{constructor(e,n={id:"pass"}){const{id:r}=n;this.id=r,this.device=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class vg extends kN{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){const[n,r]=this.device.canvasContext.getDrawingBufferSize(),i=e.clearCanvas??!0,s=e.clearColor??(i?[0,0,0,0]:!1),o=i?1:!1,a=i?0:!1,f=e.colorMask??15,p={viewport:[0,0,n,r]};e.colorMask&&(p.colorMask=f),e.scissorRect&&(p.scissorRect=e.scissorRect);const m=this.device.beginRenderPass({framebuffer:e.target,parameters:p,clearColor:s,clearDepth:o,clearStencil:a});try{return this._drawLayers(m,e)}finally{m.end(),this.device.submit()}}_drawLayers(e,n){const{target:r,shaderModuleProps:i,viewports:s,views:o,onViewportActive:a,clearStack:f=!0}=n;n.pass=n.pass||"unknown",f&&(this._lastRenderIndex=-1);const p=[];for(const m of s){const v=o&&o[m.id];a==null||a(m);const w=this._getDrawLayerParams(m,n),T=m.subViewports||[m];for(const E of T){const N=this._drawLayersInViewport(e,{target:r,shaderModuleProps:i,viewport:E,view:v,pass:n.pass,layers:n.layers},w);p.push(N)}}return p}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:s,cullRect:o,effects:a,shaderModuleProps:f},p=!1){var E;const m=[],v=wb(this._lastRenderIndex+1),w={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:o},T={};for(let N=0;N<n.length;N++){const j=n[N],I=this._shouldDrawLayer(j,w,s,T),R={shouldDrawLayer:I};I&&!p&&(R.shouldDrawLayer=!0,R.layerRenderIndex=v(j,I),R.shaderModuleProps=this._getShaderModuleProps(j,a,r,f),R.layerParameters={...(E=j.context.deck)==null?void 0:E.props.parameters,...this.getLayerParameters(j,N,e)}),m[N]=R}return m}_drawLayersInViewport(e,{layers:n,shaderModuleProps:r,pass:i,target:s,viewport:o,view:a},f){const p=PN(this.device,{shaderModuleProps:r,target:s,viewport:o});if(a&&a.props.clear){const v=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;this.device.beginRenderPass({framebuffer:s,parameters:{viewport:p,scissorRect:p},clearColor:v.color?[0,0,0,0]:!1,clearDepth:v.depth?1:!1}).end()}const m={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:p});for(let v=0;v<n.length;v++){const w=n[v],T=f[v],{shouldDrawLayer:E}=T;if(E&&w.props.pickable&&m.pickableCount++,w.isComposite&&m.compositeCount++,w.isDrawable&&T.shouldDrawLayer){const{layerRenderIndex:N,shaderModuleProps:j,layerParameters:I}=T;m.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,N),j.project&&(j.project.viewport=o),w.context.renderPass=e;try{w._drawLayer({renderPass:e,shaderModuleProps:j,uniforms:{layerIndex:N},parameters:I})}catch(R){w.raiseError(R,`drawing ${w} to ${i}`)}}}return m}shouldDrawLayer(e){return!0}getShaderModuleProps(e,n,r){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(n))return!1;n.layer=o,o=o.parent}if(r){const a=n.layer.id;if(a in i||(i[a]=r(n)),!i[a])return!1}return e.activateViewport(n.viewport),!0}_getShaderModuleProps(e,n,r,i){var f,p;const s=this.device.canvasContext.cssToDeviceRatio(),o=((f=e.internalState)==null?void 0:f.propsInTransition)||e.props,a={layer:o,picking:{isActive:!1},project:{viewport:e.context.viewport,devicePixelRatio:s,modelMatrix:o.modelMatrix,coordinateSystem:o.coordinateSystem,coordinateOrigin:o.coordinateOrigin,autoWrapLongitude:e.wrapLongitude}};if(n)for(const m of n)q_(a,(p=m.getShaderModuleProps)==null?void 0:p.call(m,e,a));return q_(a,this.getShaderModuleProps(e,n,a),i)}}function wb(t=0,e={}){const n={},r=(i,s)=>{const o=i.props._offset,a=i.id,f=i.parent&&i.parent.id;let p;if(f&&!(f in e)&&r(i.parent,!1),f in n){const m=n[f]=n[f]||wb(e[f],e);p=m(i,s),n[a]=m}else Number.isFinite(o)?(p=o+(e[f]||0),n[a]=null):p=t;return s&&p>=t&&(t=p+1),e[a]=p,p};return r}function PN(t,{shaderModuleProps:e,target:n,viewport:r}){var f;const i=((f=e==null?void 0:e.project)==null?void 0:f.devicePixelRatio)??t.canvasContext.cssToDeviceRatio(),[,s]=t.canvasContext.getDrawingBufferSize(),o=n?n.height:s,a=r;return[a.x*i,o-(a.y+a.height)*i,a.width*i,a.height*i,0,1]}function q_(t,...e){for(const n of e)if(n)for(const r in n)t[r]?Object.assign(t[r],n[r]):t[r]=n[r];return t}class RN extends vg{constructor(e,n){super(e,n);const r=e.createTexture({format:"rgba8unorm",width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},mipmaps:!0}),i=e.createTexture({format:"depth16unorm",width:1,height:1,mipmaps:!1});this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[r],depthStencilAttachment:i})}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null)}getShadowMap(){return this.fbo.colorAttachments[0].texture}render(e){const n=this.fbo,r=this.device.canvasContext.cssToDeviceRatio(),i=e.viewports[0],s=i.width*r,o=i.height*r,a=[1,1,1,1];(s!==n.width||o!==n.height)&&n.resize({width:s,height:o}),super.render({...e,clearColor:a,target:n,pass:"shadow"})}getLayerParameters(e,n,r){return{...e.props.parameters,blend:!1,depthWriteEnabled:!0,depthCompare:"less-equal"}}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getShaderModuleProps(e,n,r){return{shadow:{project:r.project,drawToShadowMap:!0}}}}const IN={color:[255,255,255],intensity:1},Z_=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],MN=[0,0,0,200/255];class bb{constructor(e={}){this.id="lighting-effect",this.shadowColor=MN,this.shadow=!1,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;const{device:n,deck:r}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(n),r._addDefaultShaderModule(Y_),this.dummyShadowMap=n.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=void 0,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.context&&this.setup(this.context),this.props=e}preRender({layers:e,layerFilter:n,viewports:r,onViewportActive:i,views:s}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let o=0;o<this.shadowPasses.length;o++)this.shadowPasses[o].render({layers:e,layerFilter:n,viewports:r,onViewportActive:i,views:s,shaderModuleProps:{shadow:{shadowLightId:o,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}}})}}getShaderModuleProps(e,n){const r=this.shadow?{project:n.project,shadowMaps:this.shadowPasses.map(o=>o.getShadowMap()),dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{},i={enabled:!0,ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(o=>o.getProjectedLight({layer:e})),pointLights:this.pointLights.map(o=>o.getProjectedLight({layer:e}))},s=e.props.material;return{shadow:r,lighting:i,phongMaterial:s,gouraudMaterial:s}}cleanup(e){for(const n of this.shadowPasses)n.delete();this.shadowPasses.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(Y_))}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new fi().lookAt({eye:new ui(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new RN(e);this.shadowPasses[n]=r}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new xN(IN),this.directionalLights.push(new K_(Z_[0]),new K_(Z_[1])))}}class NN{constructor(e={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:f}){const p=i||e&&e.constructor||Float32Array,m=n*r+s;if(ArrayBuffer.isView(e)){if(m<=e.length)return e;if(m*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new p(e.buffer,0,m)}let v=1/0;f&&(v=f*r+s);const w=this._allocate(p,m,a,v);return e&&o?w.set(e):a||w.fill(0,0,4),this._release(e),w}release(e){this._release(e)}_allocate(e,n,r,i){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>i&&(s=i);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,f=o.findIndex(p=>p.byteLength>=a);if(f>=0){const p=new e(o.splice(f,1)[0],0,s);return r&&p.fill(0),p}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,s=n.findIndex(o=>o.byteLength>=i);s<0?n.push(r):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,r),n.length>this.opts.poolSize&&n.shift()}}const ma=new NN;function al(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function ON(t){return[t[12],t[13],t[14]]}function DN(t){return{left:To(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:To(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:To(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:To(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:To(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:To(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const G_=new ui;function To(t,e,n,r){G_.set(t,e,n);const i=G_.len();return{distance:r/i,normal:new ui(-t/i,-e/i,-n/i)}}function BN(t){return t-Math.fround(t)}let qa;function Yh(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,s=(i-r)/n;qa=ma.allocate(qa,s,{type:Float32Array,size:n*2});let o=r,a=0;for(;o<i;){for(let f=0;f<n;f++){const p=t[o++];qa[a+f]=p,qa[a+f+n]=BN(p)}a+=n*2}return qa.subarray(0,s*n*2)}function FN(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const LN=Math.PI/180,UN=al(),J_=[0,0,0],zN={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function VN({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:s,near:o,far:a}){const f=t/e,p=n?new fi().orthographic({fovy:r,aspect:f,focalDistance:i,near:o,far:a}):new fi().perspective({fovy:r,aspect:f,near:o,far:a});if(s){const{left:m=0,right:v=0,top:w=0,bottom:T=0}=s,E=ts((m+t-v)/2,0,t)-t/2,N=ts((w+e-T)/2,0,e)-e/2;p[8]-=E*2/t,p[9]+=N*2/e}return p}class fA{constructor(e={}){this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||zN,this.focalDistance=e.focalDistance||1,this.position=e.position||J_,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?li.WEB_MERCATOR:li.WEB_MERCATOR_AUTO_OFFSET:li.IDENTITY}equals(e){return e instanceof fA?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Yl(e.projectionMatrix,this.projectionMatrix)&&Yl(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=yb(r,this.pixelProjectionMatrix),[s,o]=i,a=n?o:this.height-o;return e.length===2?[s,a]:[s,a,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,o]=e,a=n?s:this.height-s,f=r&&r*this.distanceScales.unitsPerMeter[2],p=yg([i,a,o],this.pixelUnprojectionMatrix,f),[m,v,w]=this.unprojectPosition(p);return Number.isFinite(o)?[m,v,w]:Number.isFinite(r)?[m,v,r]:[m,v]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=wu(e);return n[1]=ts(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?ga(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),o=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],s[0],o[0]),Math.min(r[1],i[1],s[1],o[1]),Math.max(r[0],i[0],s[0],o[0]),Math.max(r[1],i[1],s[1],o[1])]}getDistanceScales(e){return e&&this.isGeospatial?I0({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,DN(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=Z6({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||I0({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:o}=e;let a=J_;if(s&&(a=o?new fi(o).transformAsVector(s,[]):s),this.isGeospatial){const f=this.projectPosition([n,r,0]);this.center=new ui(a).scale(this.distanceScales.unitsPerMeter).add(f)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=UN,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:f=1e3,padding:p=null,focalDistance:m=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new fi().multiplyRight(n).translate(new ui(this.center).negate()),this.projectionMatrix=r||VN({width:this.width,height:this.height,orthographic:i,fovyRadians:s||o*LN,focalDistance:m,padding:p,near:a,far:f});const v=al();js(v,v,this.projectionMatrix),js(v,v,this.viewMatrix),this.viewProjectionMatrix=v,this.viewMatrixInverse=b0([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=ON(this.viewMatrixInverse);const w=al(),T=al();pg(w,w,[this.width/2,-this.height/2,1]),_u(w,w,[1,-1,0]),js(T,w,this.viewProjectionMatrix),this.pixelProjectionMatrix=T,this.pixelUnprojectionMatrix=b0(al(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||ut.warn("Pixel project matrix not invertible")()}}fA.displayName="Viewport";class _a extends fA{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:f=1.01,nearZ:p,farZ:m,orthographic:v=!1,projectionMatrix:w,repeat:T=!1,worldOffset:E=0,position:N,padding:j,legacyMeterSizes:I=!1}=e;let{width:R,height:k,altitude:B=1.5}=e;const Y=Math.pow(2,i);R=R||1,k=k||1;let G,ce=null;if(w)B=w[5]/2,G=bu(B);else{e.fovy?(G=e.fovy,B=_b(G)):G=bu(B);let $;if(j){const{top:K=0,bottom:ue=0}=j;$=[0,ts((K+k-ue)/2,0,k)-k/2]}ce=J6({width:R,height:k,scale:Y,center:N&&[0,0,N[2]*Qh(n)],offset:$,pitch:s,fovy:G,nearZMultiplier:a,farZMultiplier:f}),Number.isFinite(p)&&(ce.near=p),Number.isFinite(m)&&(ce.far=m)}let U=G6({height:k,pitch:s,bearing:o,scale:Y,altitude:B});E&&(U=new fi().translate([512*E,0,0]).multiplyLeft(U)),super({...e,width:R,height:k,viewMatrix:U,longitude:r,latitude:n,zoom:i,...ce,fovy:G,focalDistance:B}),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=o,this.altitude=B,this.fovy=G,this.orthographic=v,this._subViewports=T?[]:null,this._pseudoMeters=I,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const s=i?new _a({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*Qh(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/Qh(r);return[n,r,i]}addMetersToLngLat(e,n){return mb(e,n)}panByPosition(e,n){const r=yg(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=b_([],i,BI([],r)),o=b_([],this.center,s),[a,f]=this.unprojectFlat(o);return{longitude:a,latitude:f}}getBounds(e={}){const n=nN(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:o,zoom:a}=eN({width:r,height:i,bounds:e,...n});return new _a({width:r,height:i,longitude:s,latitude:o,zoom:a})}}_a.displayName="WebMercatorViewport";const e1=[0,0,0];function Kh(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof _a){const[i,s,o=0]=t,a=e.getDistanceScales([i,s]);r[2]=o*a.unitsPerMeter[2]}return r}function jN(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:o}=t;return i===bt.DEFAULT&&(i=e.isGeospatial?bt.LNGLAT:bt.CARTESIAN),s===void 0&&(s=i),o===void 0&&(o=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:o}}function xb(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[o,a,f=0]=t;switch(n&&([o,a,f]=cA([],[o,a,f,1],n)),r){case bt.LNGLAT:return Kh([o,a,f],e,s);case bt.LNGLAT_OFFSETS:return Kh([o+i[0],a+i[1],f+(i[2]||0)],e,s);case bt.METER_OFFSETS:return Kh(mb(i,[o,a,f]),e,s);case bt.CARTESIAN:default:return e.isGeospatial?[o+i[0],a+i[1],f+i[2]]:e.projectPosition([o,a,f])}}function WN(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=jN(e),{autoOffset:f=!0}=e,{geospatialOrigin:p=e1,shaderCoordinateOrigin:m=e1,offsetMode:v=!1}=f?pb(n,r,i):{},w=xb(t,{viewport:n,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:v});if(v){const T=n.projectPosition(p||m);ZI(w,w,T)}return w}let $N=1,HN=1;class Tb{constructor(){M(this,"time",0);M(this,"channels",new Map);M(this,"animations",new Map);M(this,"playing",!1);M(this,"lastEngineTime",-1)}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,o=$N++,a={time:0,delay:n,duration:r,rate:i,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:o}=i;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=HN++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}function XN(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function QN(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}let YN=0;const KN={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:t=>console.error(t),stats:f0.stats.get(`animation-loop-${YN++}`),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1};class qN{constructor(e){M(this,"device",null);M(this,"canvas",null);M(this,"props");M(this,"animationProps",null);M(this,"timeline",null);M(this,"stats");M(this,"cpuTime");M(this,"gpuTime");M(this,"frameRate");M(this,"display");M(this,"needsRedraw","initialized");M(this,"_initialized",!1);M(this,"_running",!1);M(this,"_animationFrameId",null);M(this,"_nextFramePromise",null);M(this,"_resolveNextFrame",null);M(this,"_cpuStartTime",0);M(this,"_error",null);if(this.props={...KN,...e},e=this.props,!e.device)throw new Error("No device provided");const{useDevicePixels:n=!0}=this.props;this.stats=e.stats||new cf({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport,autoResizeDrawingBuffer:e.autoResizeDrawingBuffer,useDevicePixels:n}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setError(e){var r,i;if(this.props.onError(e),this._error=Error(),((i=(r=this.device)==null?void 0:r.canvasContext)==null?void 0:i.canvas)instanceof HTMLCanvasElement){const s=document.createElement("h1");s.innerHTML=e.message,s.style.position="absolute",s.style.top="20%",s.style.left="10px",s.style.color="black",s.style.backgroundColor="red",document.body.appendChild(s)}}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),"autoResizeDrawingBuffer"in e&&(this.props.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer||!1),"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(e!==!1&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const n=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(n),n}}stop(){return this._running&&(this.animationProps&&!this._error&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){var e;return(e=this.device)!=null&&e.isLost||this._error?this:(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers(),this)}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){this._running&&(this._animationFrameId=XN(this._animationFrame.bind(this)))}_cancelAnimationFrame(){this._animationFrameId!==null&&(QN(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){var n;if(this.display){this.display._renderFrame(e);return}this.props.onRender(this._getAnimationProps()),(n=this.device)==null||n.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){var n,r;const e=(r=(n=this.device)==null?void 0:n.canvasContext)==null?void 0:r.canvas;if(!this.device||!e)throw new Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:e,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){var e;if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=((e=this.device.canvasContext)==null?void 0:e.canvas)||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){var s,o,a,f;if(!this.device)return{width:1,height:1,aspect:1};const[e,n]=((o=(s=this.device)==null?void 0:s.canvasContext)==null?void 0:o.getPixelSize())||[1,1];let r=1;const i=(f=(a=this.device)==null?void 0:a.canvasContext)==null?void 0:f.canvas;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){var e,n;this.props.autoResizeDrawingBuffer&&((n=(e=this.device)==null?void 0:e.canvasContext)==null||n.resize({useDevicePixels:this.props.useDevicePixels}))}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}const qh={};function df(t="id"){qh[t]=qh[t]||1;const e=qh[t]++;return`${t}-${e}`}class t1{constructor(e){M(this,"id");M(this,"userData",{});M(this,"topology");M(this,"bufferLayout",[]);M(this,"vertexCount");M(this,"indices");M(this,"attributes");if(this.id=e.id||df("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&!(this.indices.usage&Yt.INDEX))throw new Error("Index buffer must have INDEX usage")}destroy(){var e;(e=this.indices)==null||e.destroy();for(const n of Object.values(this.attributes))n.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount(e){return e.byteLength/12}}function ZN(t,e){if(e instanceof t1)return e;const n=GN(t,e),{attributes:r,bufferLayout:i}=JN(t,e);return new t1({topology:e.topology||"triangle-list",bufferLayout:i,vertexCount:e.vertexCount,indices:n,attributes:r})}function GN(t,e){if(!e.indices)return;const n=e.indices.value;return t.createBuffer({usage:Yt.INDEX,data:n})}function JN(t,e){const n=[],r={};for(const[s,o]of Object.entries(e.attributes)){let a=s;switch(s){case"POSITION":a="positions";break;case"NORMAL":a="normals";break;case"TEXCOORD_0":a="texCoords";break;case"COLOR_0":a="colors";break}if(o){r[a]=t.createBuffer({data:o.value,id:`${s}-buffer`});const{value:f,size:p,normalized:m}=o;n.push({name:a,format:ZR(f,p,m)})}}const i=e._calculateVertexCount(e.attributes,e.indices);return{attributes:r,bufferLayout:n,vertexCount:i}}const $u=class $u{constructor(e){M(this,"device");M(this,"destroyPolicy");M(this,"_hashCounter",0);M(this,"_hashes",{});M(this,"_renderPipelineCache",{});M(this,"_computePipelineCache",{});this.device=e,this.destroyPolicy=e.props._factoryDestroyPolicy}static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new $u(e),e._lumaData.defaultPipelineFactory}createRenderPipeline(e){const n={...ca.defaultProps,...e},r=this._hashRenderPipeline(n);if(!this._renderPipelineCache[r]){const i=this.device.createRenderPipeline({...n,id:n.id?`${n.id}-cached`:void 0});i.hash=r,this._renderPipelineCache[r]={pipeline:i,useCount:0}}return this._renderPipelineCache[r].useCount++,this._renderPipelineCache[r].pipeline}createComputePipeline(e){const n={...uu.defaultProps,...e},r=this._hashComputePipeline(n);if(!this._computePipelineCache[r]){const i=this.device.createComputePipeline({...n,id:n.id?`${n.id}-cached`:void 0});i.hash=r,this._computePipelineCache[r]={pipeline:i,useCount:0}}return this._computePipelineCache[r].useCount++,this._computePipelineCache[r].pipeline}release(e){const n=e.hash,r=e instanceof uu?this._computePipelineCache:this._renderPipelineCache;r[n].useCount--,r[n].useCount===0&&this.destroyPolicy==="unused"&&(r[n].pipeline.destroy(),delete r[n])}_hashComputePipeline(e){return`${this._getHash(e.shader.source)}`}_hashRenderPipeline(e){const n=e.vs?this._getHash(e.vs.source):0,r=e.fs?this._getHash(e.fs.source):0,i="-",s=this._getHash(JSON.stringify(e.bufferLayout));switch(this.device.type){case"webgl":return`${n}/${r}V${i}BL${s}`;default:const o=this._getHash(JSON.stringify(e.parameters));return`${n}/${r}V${i}T${e.topology}P${o}BL${s}`}}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}};M($u,"defaultProps",{...ca.defaultProps});let M0=$u;const Hu=class Hu{constructor(e){M(this,"device");M(this,"destroyPolicy");M(this,"_cache",{});this.device=e,this.destroyPolicy=e.props._factoryDestroyPolicy}static getDefaultShaderFactory(e){var n;return(n=e._lumaData).defaultShaderFactory||(n.defaultShaderFactory=new Hu(e)),e._lumaData.defaultShaderFactory}createShader(e){const n=this._hashShader(e);let r=this._cache[n];if(!r){const i=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[n]=r={shader:i,useCount:0}}return r.useCount++,r.shader}release(e){const n=this._hashShader(e),r=this._cache[n];r&&(r.useCount--,r.useCount===0&&this.destroyPolicy==="unused"&&(delete this._cache[n],r.shader.destroy()))}_hashShader(e){return`${e.stage}:${e.source}`}};M(Hu,"defaultProps",{...lu.defaultProps});let N0=Hu;function e8(t,e){var i;const n={},r="Values";if(t.attributes.length===0&&!((i=t.varyings)!=null&&i.length))return{"No attributes or varyings":{[r]:"N/A"}};for(const s of t.attributes)if(s){const o=`${s.location} ${s.name}: ${s.type}`;n[`in ${o}`]={[r]:s.stepMode||"vertex"}}for(const s of t.varyings||[]){const o=`${s.location} ${s.name}`;n[`out ${o}`]={[r]:JSON.stringify(s)}}return n}let kn=null,Ps=null;function t8(t,{id:e,minimap:n,opaque:r,top:i="0",left:s="0",rgbaScale:o=1}){kn||(kn=document.createElement("canvas"),kn.id=e,kn.title=e,kn.style.zIndex="100",kn.style.position="absolute",kn.style.top=i,kn.style.left=s,kn.style.border="blue 5px solid",kn.style.transform="scaleY(-1)",document.body.appendChild(kn),Ps=kn.getContext("2d")),(kn.width!==t.width||kn.height!==t.height)&&(kn.width=t.width/2,kn.height=t.height/2,kn.style.width="400px",kn.style.height="400px");const a=t.device.readPixelsToArrayWebGL(t),f=Ps==null?void 0:Ps.createImageData(t.width,t.height);if(f){for(let m=0;m<a.length;m+=4)f.data[0+m+0]=a[m+0]*o,f.data[0+m+1]=a[m+1]*o,f.data[0+m+2]=a[m+2]*o,f.data[0+m+3]=r?255:a[m+3]*o;Ps==null||Ps.putImageData(f,0,0)}}function O0(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!O0(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!O0(t[s],e[s],n-1))return!1;return!0}return!1}function n8(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function r8(t){return Array.isArray(t)?t.length===0||typeof t[0]=="number":!1}function Eb(t){return n8(t)||r8(t)}function i8(t){return Eb(t)||typeof t=="number"||typeof t=="boolean"}function Sb(t){const e={bindings:{},uniforms:{}};return Object.keys(t).forEach(n=>{const r=t[n];i8(r)?e.uniforms[n]=r:e.bindings[n]=r}),e}class s8{constructor(e,n){M(this,"options",{disableWarnings:!1});M(this,"modules");M(this,"moduleUniforms");M(this,"moduleBindings");Object.assign(this.options,n);const r=sg(Object.values(e).filter(i=>i.dependencies));for(const i of r)e[i.name]=i;xe.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[i,s]of Object.entries(e))this._addModule(s),s.name&&i!==s.name&&!this.options.disableWarnings&&xe.warn(`Module name: ${i} vs ${s.name}`)()}destroy(){}setProps(e){var n;for(const r of Object.keys(e)){const i=r,s=e[i]||{},o=this.modules[i];if(!o){this.options.disableWarnings||xe.warn(`Module ${r} not found`)();continue}const a=this.moduleUniforms[i],f=this.moduleBindings[i],p=((n=o.getUniforms)==null?void 0:n.call(o,s,a))||s,{uniforms:m,bindings:v}=Sb(p);this.moduleUniforms[i]={...a,...m},this.moduleBindings[i]={...f,...v}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){const e={};for(const n of Object.values(this.moduleBindings))Object.assign(e,n);return e}getDebugTable(){var n;const e={};for(const[r,i]of Object.entries(this.moduleUniforms))for(const[s,o]of Object.entries(i))e[`${r}.${s}`]={type:(n=this.modules[r].uniformTypes)==null?void 0:n[s],value:String(o)};return e}_addModule(e){const n=e.name;this.moduleUniforms[n]=e.defaultUniforms||{},this.moduleBindings[n]={}}}let o8="";async function a8(t,e){const n=new Image;return n.crossOrigin="anonymous",n.src=t.startsWith("http")?t:o8+t,await n.decode(),e?await createImageBitmap(n,e):await createImageBitmap(n)}class Zh{constructor(e,n){M(this,"device");M(this,"id");M(this,"texture");M(this,"sampler");M(this,"view");M(this,"ready");M(this,"isReady",!1);M(this,"destroyed",!1);M(this,"resolveReady",()=>{});M(this,"rejectReady",()=>{});this.device=e,this.id=n.id||df("async-texture"),typeof(n==null?void 0:n.data)=="string"&&n.dimension==="2d"&&(n={...n,data:a8(n.data)}),this.ready=new Promise((r,i)=>{this.resolveReady=()=>{this.isReady=!0,r()},this.rejectReady=i}),this.initAsync(n)}get[Symbol.toStringTag](){return"AsyncTexture"}toString(){return`AsyncTexture:"${this.id}"(${this.isReady?"ready":"loading"})`}async initAsync(e){let n,r;const i=e.data,s=await Cb(i).then(n,r);if(this.destroyed)return;const o={...e,data:s};this.texture=this.device.createTexture(o),this.sampler=this.texture.sampler,this.view=this.texture.view,this.isReady=!0}destroy(){this.texture&&(this.texture.destroy(),this.texture=null),this.destroyed=!0}resize(e){if(!this.isReady)throw new Error("Cannot resize texture before it is ready");if(e.width===this.texture.width&&e.height===this.texture.height)return!1;if(this.texture){const n=this.texture;this.texture=n.clone(e),n.destroy()}return!0}}async function Cb(t){if(t=await t,Array.isArray(t))return await Promise.all(t.map(Cb));if(t&&typeof t=="object"&&t.constructor===Object){const e=t,n=await Promise.all(Object.values(e)),r=Object.keys(e),i={};for(let s=0;s<r.length;s++)i[r[s]]=n[s];return i}return t}const Rs=2,l8=1e4,Xu=class Xu{constructor(e,n){M(this,"device");M(this,"id");M(this,"source");M(this,"vs");M(this,"fs");M(this,"pipelineFactory");M(this,"shaderFactory");M(this,"userData",{});M(this,"parameters");M(this,"topology");M(this,"bufferLayout");M(this,"isInstanced");M(this,"instanceCount",0);M(this,"vertexCount");M(this,"indexBuffer",null);M(this,"bufferAttributes",{});M(this,"constantAttributes",{});M(this,"bindings",{});M(this,"uniforms",{});M(this,"vertexArray");M(this,"transformFeedback",null);M(this,"pipeline");M(this,"shaderInputs");M(this,"_uniformStore");M(this,"_attributeInfos",{});M(this,"_gpuGeometry",null);M(this,"_getModuleUniforms");M(this,"props");M(this,"_pipelineNeedsUpdate","newly created");M(this,"_needsRedraw","initializing");M(this,"_destroyed",!1);M(this,"_lastDrawTimestamp",-1);M(this,"_lastLogTime",0);M(this,"_logOpen",!1);M(this,"_drawCount",0);var f,p,m,v;this.props={...Xu.defaultProps,...n},n=this.props,this.id=n.id||df("model"),this.device=e,Object.assign(this.userData,n.userData);const r=Object.fromEntries(((f=this.props.modules)==null?void 0:f.map(w=>[w.name,w]))||[]),i=n.shaderInputs||new s8(r,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(i);const s=c8(e),o=(((p=this.props.modules)==null?void 0:p.length)>0?this.props.modules:(m=this.shaderInputs)==null?void 0:m.getModules())||[];if(this.device.type==="webgpu"&&this.props.source){const{source:w,getUniforms:T}=this.props.shaderAssembler.assembleWGSLShader({platformInfo:s,...this.props,modules:o});this.source=w,this._getModuleUniforms=T,(v=this.props).shaderLayout||(v.shaderLayout=SI(this.source))}else{const{vs:w,fs:T,getUniforms:E}=this.props.shaderAssembler.assembleGLSLShaderPair({platformInfo:s,...this.props,modules:o});this.vs=w,this.fs=T,this._getModuleUniforms=E}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,n.geometry&&this.setGeometry(n.geometry),this.pipelineFactory=n.pipelineFactory||M0.getDefaultPipelineFactory(this.device),this.shaderFactory=n.shaderFactory||N0.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in n&&(this.isInstanced=n.isInstanced),n.instanceCount&&this.setInstanceCount(n.instanceCount),n.vertexCount&&this.setVertexCount(n.vertexCount),n.indexBuffer&&this.setIndexBuffer(n.indexBuffer),n.attributes&&this.setAttributes(n.attributes),n.constantAttributes&&this.setConstantAttributes(n.constantAttributes),n.bindings&&this.setBindings(n.bindings),n.uniforms&&this.setUniformsWebGL(n.uniforms),n.moduleSettings&&this.updateModuleSettingsWebGL(n.moduleSettings),n.transformFeedback&&(this.transformFeedback=n.transformFeedback),Object.seal(this)}get[Symbol.toStringTag](){return"Model"}toString(){return`Model(${this.id})`}destroy(){var e;this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),(e=this._gpuGeometry)==null||e.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||(this._needsRedraw=e)}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){const n=this._areBindingsLoading();if(n)return xe.info(Rs,`>>> DRAWING ABORTED ${this.id}: ${n} not loaded`)(),!1;try{e.pushDebugGroup(`${this}.predraw(${e})`),this.predraw()}finally{e.popDebugGroup()}let r;try{e.pushDebugGroup(`${this}.draw(${e})`),this._logDrawCallStart(),this.pipeline=this._updatePipeline();const i=this._getBindings();this.pipeline.setBindings(i,{disableWarnings:this.props.disableWarnings}),D0(this.uniforms)||this.pipeline.setUniformsWebGL(this.uniforms);const{indexBuffer:s}=this.vertexArray,o=s?s.byteLength/(s.indexType==="uint32"?4:2):void 0;r=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:o,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{e.popDebugGroup(),this._logDrawCallEnd()}return this._logFramebuffer(e),r?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",r}setGeometry(e){var r;(r=this._gpuGeometry)==null||r.destroy();const n=e&&ZN(this.device,e);if(n){this.setTopology(n.topology||"triangle-list");const i=new Bh(this.bufferLayout);this.bufferLayout=i.mergeBufferLayouts(n.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(n)}this._gpuGeometry=n}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){const n=new Bh(this.bufferLayout);this.bufferLayout=this._gpuGeometry?n.mergeBufferLayouts(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){O0(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,this.isInstanced===void 0&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new qR(this.shaderInputs.modules);for(const[n,r]of Object.entries(this.shaderInputs.modules))if(A8(r)){const i=this._uniformStore.getManagedUniformBuffer(this.device,n);this.bindings[`${n}Uniforms`]=i}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,n){const r=(n==null?void 0:n.disableWarnings)??this.props.disableWarnings;e.indices&&xe.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)();const i=new Bh(this.bufferLayout);for(const[s,o]of Object.entries(e)){const a=i.getBufferLayout(s);if(!a){r||xe.warn(`Model(${this.id}): Missing layout for buffer "${s}".`)();continue}const f=i.getAttributeNamesForBuffer(a);let p=!1;for(const m of f){const v=this._attributeInfos[m];v&&(this.vertexArray.setBuffer(v.location,o),p=!0)}!p&&!r&&xe.warn(`Model(${this.id}): Ignoring buffer "${o.id}" for unknown attribute "${s}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,n){for(const[r,i]of Object.entries(e)){const s=this._attributeInfos[r];s?this.vertexArray.setConstantWebGL(s.location,i):((n==null?void 0:n.disableWarnings)??this.props.disableWarnings)||xe.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${r}"`)()}this.setNeedsRedraw("constants")}setUniforms(e){this.setUniformsWebGL(e)}setUniformsWebGL(e){D0(e)||(this.pipeline.setUniformsWebGL(e),Object.assign(this.uniforms,e)),this.setNeedsRedraw("uniforms")}updateModuleSettingsWebGL(e){const{bindings:n,uniforms:r}=Sb(this._getModuleUniforms(e));Object.assign(this.bindings,n),Object.assign(this.uniforms,r),this.setNeedsRedraw("moduleSettings")}_areBindingsLoading(){for(const e of Object.values(this.bindings))if(e instanceof Zh&&!e.isReady)return e.id;return!1}_getBindings(){const e={};for(const[n,r]of Object.entries(this.bindings))r instanceof Zh?r.isReady&&(e[n]=r.texture):e[n]=r;return e}_getBindingsUpdateTimestamp(){let e=0;for(const n of Object.values(this.bindings))n instanceof au?e=Math.max(e,n.texture.updateTimestamp):n instanceof Yt||n instanceof an?e=Math.max(e,n.updateTimestamp):n instanceof Zh?e=n.texture?Math.max(e,n.texture.updateTimestamp):1/0:n instanceof Au||(e=Math.max(e,n.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const n={...e.attributes};for(const[r]of Object.entries(n))!this.pipeline.shaderLayout.attributes.find(i=>i.name===r)&&r!=="positions"&&delete n[r];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(n,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||(this._pipelineNeedsUpdate=e),this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,n=null;this.pipeline&&(xe.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),e=this.pipeline.vs,n=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const r=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debugShaders:this.props.debugShaders});let i=null;this.source?i=r:this.fs&&(i=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debugShaders:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:r,fs:i}),this._attributeInfos=xw(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),n&&this.shaderFactory.release(n)}return this.pipeline}_logDrawCallStart(){const e=xe.level>3?0:l8;xe.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,xe.group(Rs,`>>> DRAWING MODEL ${this.id}`,{collapsed:xe.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=e8(this.pipeline.shaderLayout,this.id);xe.table(Rs,e)();const n=this.shaderInputs.getDebugTable();for(const[i,s]of Object.entries(this.uniforms))n[i]={value:s};xe.table(Rs,n)();const r=this._getAttributeDebugTable();xe.table(Rs,this._attributeInfos)(),xe.table(Rs,r)(),xe.groupEnd(Rs)(),this._logOpen=!1}}_logFramebuffer(e){const n=this.device.props.debugFramebuffers;if(this._drawCount++,!n)return;const r=e.props.framebuffer;r&&t8(r,{id:r.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[n,r]of Object.entries(this._attributeInfos)){const i=this.vertexArray.attributes[r.location];e[r.location]={name:n,type:r.shaderType,values:i?this._getBufferOrConstantValues(i,r.bufferDataType):"null"}}if(this.vertexArray.indexBuffer){const{indexBuffer:n}=this.vertexArray,r=n.indexType==="uint32"?new Uint32Array(n.debugData):new Uint16Array(n.debugData);e.indices={name:"indices",type:n.indexType,values:r.toString()}}return e}_getBufferOrConstantValues(e,n){const r=Sw(n);return(e instanceof Yt?new r(e.debugData):e).toString()}};M(Xu,"defaultProps",{...ca.defaultProps,source:void 0,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],moduleSettings:void 0,geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:ou.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0});let yr=Xu;function A8(t){return!!(t.uniformTypes&&!D0(t.uniformTypes))}function c8(t){return{type:t.type,shaderLanguage:t.info.shadingLanguage,shaderLanguageVersion:t.info.shadingLanguageVersion,gpu:t.info.gpu,features:t.features}}function D0(t){for(const e in t)return!1;return!0}const Pl=class Pl{constructor(e,n=Pl.defaultProps){M(this,"device");M(this,"model");M(this,"transformFeedback");if(!Pl.isSupported(e))throw new Error("BufferTransform not yet implemented on WebGPU");this.device=e,this.model=new yr(this.device,{id:n.id||"buffer-transform-model",fs:n.fs||JP(),topology:n.topology||"point-list",varyings:n.outputs||n.varyings,...n}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:n.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}static isSupported(e){var n;return((n=e==null?void 0:e.info)==null?void 0:n.type)==="webgl"}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){e!=null&&e.inputBuffers&&this.model.setAttributes(e.inputBuffers),e!=null&&e.outputBuffers&&this.transformFeedback.setBuffers(e.outputBuffers);const n=this.device.beginRenderPass(e);this.model.draw(n),n.end()}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const n=this.getBuffer(e);if(!n)throw new Error("BufferTransform#getBuffer");if(n instanceof Yt)return n.readAsync();const{buffer:r,byteOffset:i=0,byteLength:s=r.byteLength}=n;return r.readAsync(i,s)}};M(Pl,"defaultProps",{...yr.defaultProps,outputs:void 0,feedbackBuffers:void 0});let ql=Pl;class Gs{constructor(e){M(this,"id");M(this,"topology");M(this,"vertexCount");M(this,"indices");M(this,"attributes");M(this,"userData",{});const{attributes:n={},indices:r=null,vertexCount:i=null}=e;this.id=e.id||df("geometry"),this.topology=e.topology,r&&(this.indices=ArrayBuffer.isView(r)?{value:r,size:1}:r),this.attributes={};for(const[s,o]of Object.entries(n)){const a=ArrayBuffer.isView(o)?{value:o}:o;if(!ArrayBuffer.isView(a.value))throw new Error(`${this._print(s)}: must be typed array or object with value as typed array`);if((s==="POSITION"||s==="positions")&&!a.size&&(a.size=3),s==="indices"){if(this.indices)throw new Error("Multiple indices detected");this.indices=a}else this.attributes[s]=a}this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=i||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,n){return this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i of Object.values(e)){const{value:s,size:o,constant:a}=i;!a&&s&&o!==void 0&&o>=1&&(r=Math.min(r,s.length/o))}return r}}const u8={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant-alpha",blendAlphaDstFactor:"zero"};class kb extends vg{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:f,width:p,height:m},cullRect:v,effects:w,pass:T="picking",pickZ:E,shaderModuleProps:N}){this.pickZ=E;const j=this._resetColorEncoder(E),I=[a,f,p,m],R=super.render({target:o,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:v,effects:w==null?void 0:w.filter(B=>B.useInPicking),pass:T,isPicking:!0,shaderModuleProps:N,clearColor:[0,0,0,0],colorMask:15,scissorRect:I});return this._colorEncoderState=null,{decodePickingColor:j&&h8.bind(null,j),stats:R}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getShaderModuleProps(e,n,r){return{picking:{isActive:1,isAttribute:this.pickZ},lighting:{enabled:!1}}}getLayerParameters(e,n,r){const i={...e.props.parameters},{pickable:s,operation:o}=e.props;return!this._colorEncoderState||o.includes("terrain")?i.blend=!1:s&&o.includes("draw")&&(Object.assign(i,u8),i.blend=!0,i.blendColor=f8(this._colorEncoderState,e,r)),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function f8(t,e,n){const{byLayer:r,byAlpha:i}=t;let s,o=r.get(e);return o?(o.viewports.push(n),s=o.a):(s=r.size+1,s<=255?(o={a:s,layer:e,viewports:[n]},r.set(e,o),i[s]=o):(ut.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function h8(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const So={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},xu=Symbol.for("component"),ds=Symbol.for("propTypes"),Gh=Symbol.for("deprecatedProps"),ea=Symbol.for("asyncPropDefaults"),Js=Symbol.for("asyncPropOriginal"),ns=Symbol.for("asyncPropResolved");function wg(t,e=()=>!0){return Array.isArray(t)?Pb(t,e,[]):e(t)?[t]:[]}function Pb(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?Pb(i,e,n):e(i)&&n.push(i)}return n}function d8({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let o=0;for(let a=n;o<i;o++)t[a++]=e[o];for(;o<s;)o<s-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+s-o),o=s);return t}class p8{constructor(e,n,r){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=ru(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class g8{constructor(e){var n;this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:(n=e.device)==null?void 0:n.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(n,r):(s=new p8(e,n,this._context),this._resources[e]=s),s.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(e=e.replace(o,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(r,i,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const s=this._consumers,o=s[e]=s[e]||{};let a=o[n];const f=a&&a.resourceId&&this._resources[a.resourceId];f&&(f.unsubscribe(a),this.prune()),r&&(a?(a.onChange=i,a.resourceId=r.id):a={onChange:i,resourceId:r.id},o[n]=a,r.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const m8="layerManager.setLayers",_8="layerManager.activateViewport";class y8{constructor(e,n){var a;this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=f=>{qn(_8,this,f),f&&(this.context.viewport=f)};const{deck:r,stats:i,viewport:s,timeline:o}=n||{};this.layers=[],this.resourceManager=new g8({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:e==null?void 0:e.gl,deck:r,shaderAssembler:yN(((a=e==null?void 0:e.info)==null?void 0:a.shadingLanguage)||"glsl"),defaultShaderModules:[BM],renderPass:void 0,stats:i||new cf({id:"deck.gl"}),viewport:s||new fA({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:o||new Tb,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){qn(m8,this,n,e),this._lastRenderedLayers=e;const r=wg(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw(`updating layers: ${e}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){const{defaultShaderModules:n}=this.context;n.find(r=>r.name===e.name)||(n.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){const{defaultShaderModules:n}=this.context,r=n.findIndex(i=>i.name===e.name);r>=0&&(n.splice(r,1),this._defaultShaderModulesChanged=!0)}_handleError(e,n,r){r.raiseError(n,`${e} of ${r}`)}_updateLayers(e,n){const r={};for(const o of e)r[o.id]?ut.warn(`Multiple old layers with same id ${o.id}`)():r[o.id]=o;if(this._defaultShaderModulesChanged){for(const o of e)o.setNeedsUpdate(),o.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let s=!1;for(const o of i)if(o.hasUniformTransition()){s=`Uniform transition in ${o}`;break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const s=n[i.id];s===null&&ut.warn(`Multiple new layers with same id ${i.id}`)(),n[i.id]=null;let o=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),o=i.isComposite?i.getSubLayers():null}catch(a){this._handleError("matching",a,i)}o&&this._updateSublayersRecursively(o,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=So.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=So.MATCHED,n!==e&&(e.lifecycle=So.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||`finalized ${e}`,e.lifecycle=So.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=So.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function Xr(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Xr(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!Xr(t[s],e[s],n-1))return!1;return!0}return!1}class v8{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const o=r[s];if(o.containsPixel(i)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=wg(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Xr(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):ut.warn("missing `viewState` or `initialViewState`")()}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var o;return(o=this.getView(e.id))==null?void 0:o.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const s=e.controller;if(s&&r){const o={...n,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!i||i.constructor!==s.type)&&(i=this._createController(e,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],o=this.getViewState(s),a=s.makeViewport({viewState:o,width:this.width,height:this.height});let f=n[s.id];const p=!!s.controller;p&&!f&&(r=!0),(r||!p)&&f&&(f.finalize(),f=null),this.controllers[s.id]=this._updateController(s,o,a,f),a&&this._viewports.unshift(a)}for(const i in n){const s=n[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const w8=/([0-9]+\.?[0-9]*)(%|px)/;function Vi(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=w8.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error(`Could not parse position string ${t}`)}}function ji(t,e){return t.relative?Math.round(t.position*e):t.position}class ya{constructor(e){const{id:n,x:r=0,y:i=0,width:s="100%",height:o="100%",padding:a=null}=e;this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Vi(r),this._y=Vi(i),this._width=Vi(s),this._height=Vi(o),this._padding=a&&{left:Vi(a.left||0),right:Vi(a.right||0),top:Vi(a.top||0),bottom:Vi(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.constructor===e.constructor&&Xr(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});if(!i.height||!i.width)return null;const s=this.getViewportType(r);return new s({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:ji(this._x,e),y:ji(this._y,n),width:ji(this._width,e),height:ji(this._height,n)};return this._padding&&(r.padding={left:ji(this._padding.left,e),top:ji(this._padding.top,n),right:ji(this._padding.right,e),bottom:ji(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class pf{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(r=(n=this.settings).onStart)==null||r.call(n,this)}end(){var e,n;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(n=(e=this.settings).onEnd)==null||n.call(e,this))}cancel(){var e,n;this._inProgress&&((n=(e=this.settings).onInterrupt)==null||n.call(e,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(n=(e=this.settings).onUpdate)==null||n.call(e,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const n1=()=>{},B0={BREAK:1,SNAP_TO_END:2,IGNORE:3},b8=t=>t,x8=B0.BREAK;class T8{constructor(e){this._onTransitionUpdate=n=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:o,duration:a,easing:f}}=n,p=f(r/a),m=i.interpolateProps(s,o,p);this.propsInTransition=this.getControllerState({...this.props,...m}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new pf(e.timeline),this.onViewStateChange=e.onViewStateChange||n1,this.onStateChange=e.onStateChange||n1}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:o}=this.transition.settings;i={...r,...s===B0.SNAP_TO_END?o:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===B0.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),s=n.transitionInterpolator,o=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(o===0)return;const a=s.initializeProps(e,i);this.propsInTransition={};const f={duration:o,easing:n.transitionEasing||b8,interpolator:s,interruption:n.transitionInterruption||x8,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(f),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}function On(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class E8{constructor(e){const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!Yl(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const s of this._propsToExtract)(s in e||s in n)&&(r[s]=e[s],i[s]=n[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];On(Number.isFinite(r)||Array.isArray(r),`${n} is required for transition`)})}}const S8=["longitude","latitude","zoom","bearing","pitch"],C8=["longitude","latitude","zoom"];class Rb extends E8{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:S8,required:C8},super(r.transitionProps),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:s}=this.opts;if(i&&s){const o=i(e),a=i(n),f=o.unproject(s);r.start.around=s,Object.assign(r.end,{around:a.project(f),aroundPosition:f,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const s of this._propsToExtract)i[s]=ha(e[s]||0,n[s]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...i});Object.assign(i,s.panByPosition(n.aroundPosition,ha(e.around,n.around,r)))}return i}}const Wi={transitionDuration:0},k8=300,ZA=t=>1-(1-t)*(1-t),Eo={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],MULTI_PAN:["multipanstart","multipanmove","multipanend"],DOUBLE_CLICK:["dblclick"],KEYBOARD:["keydown"]},Is={};class P8{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new T8({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){var e;for(const n in this._events)this._events[n]&&((e=this.eventManager)==null||e.off(n,this.handleEvent));this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"multipanstart":return n?!1:this._onMultiPanStart(e);case"multipanmove":return this._onMultiPan(e);case"multipanend":return this._onMultiPanEnd(e);case"dblclick":return this._onDoubleClick(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?k8:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:f=!1,keyboard:p=!0}=e,m=!!this.onViewStateChange;this.toggleEvents(Eo.WHEEL,m&&r),this.toggleEvents(Eo.PAN,m),this.toggleEvents(Eo.PINCH,m&&(a||f)),this.toggleEvents(Eo.MULTI_PAN,m&&f),this.toggleEvents(Eo.DOUBLE_CLICK,m&&o),this.toggleEvents(Eo.KEYBOARD,m&&p),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=f,this.keyboard=p}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:o,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,Wi,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,Wi,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:ZA},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Wi,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:ZA},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*r)));s<0&&o!==0&&(o=1/o);const a=this.controllerState.zoom({pos:n,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onMultiPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,Wi,{isDragging:!0}),!0}_onMultiPan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Wi,{isDragging:!0,isRotating:!0}),!0}_onMultiPanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:ZA},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Is._startPinchRotation=e.rotation,Is._lastPinchEvent=e,this.updateViewport(r,Wi,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:Is._startPinchRotation-r})}return this.updateViewport(n,Wi,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Is._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=Is;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),f=Math.pow(2,o+a*n/2);s=s.zoom({pos:i,scale:f}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:ZA},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Is._startPinchRotation=null,Is._lastPinchEvent=null,!0}_onDoubleClick(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let f;const p={};switch(e.srcEvent.code){case"Minus":f=n?a.zoomOut(r).zoomOut(r):a.zoomOut(r),p.isZooming=!0;break;case"Equal":f=n?a.zoomIn(r).zoomIn(r):a.zoomIn(r),p.isZooming=!0;break;case"ArrowLeft":n?(f=a.rotateLeft(s),p.isRotating=!0):(f=a.moveLeft(i),p.isPanning=!0);break;case"ArrowRight":n?(f=a.rotateRight(s),p.isRotating=!0):(f=a.moveRight(i),p.isPanning=!0);break;case"ArrowUp":n?(f=a.rotateUp(o),p.isRotating=!0):(f=a.moveUp(i),p.isPanning=!0);break;case"ArrowDown":n?(f=a.rotateDown(o),p.isRotating=!0):(f=a.moveDown(i),p.isPanning=!0);break;default:return!1}return this.updateViewport(f,this._getTransitionProps(),p),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?Wi:e?{...n,transitionInterpolator:new Rb({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class R8{constructor(e,n){this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const r1=5,I8=1.2;class M8 extends R8{constructor(e){const{width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a=0,pitch:f=0,altitude:p=1.5,position:m=[0,0,0],maxZoom:v=20,minZoom:w=0,maxPitch:T=60,minPitch:E=0,startPanLngLat:N,startZoomLngLat:j,startRotatePos:I,startBearing:R,startPitch:k,startZoom:B,normalize:Y=!0}=e;On(Number.isFinite(s)),On(Number.isFinite(i)),On(Number.isFinite(o)),super({width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a,pitch:f,altitude:p,maxZoom:v,minZoom:w,maxPitch:T,minPitch:E,normalize:Y,position:m},{startPanLngLat:N,startZoomLngLat:j,startRotatePos:I,startBearing:R,startPitch:k,startZoom:B}),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:o}=this.getState();if(!i||s===void 0||o===void 0)return this;let a;return e?a=this._getNewRotation(e,i,o,s):a={bearing:s+n,pitch:o+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let f=i+Math.log2(r);f=ts(f,a,o);const p=this.makeViewport({...this.getViewportProps(),zoom:f});return this._getUpdatedState({zoom:f,...p.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-n.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=ts(i,r,n);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=ts(a,o,s);const{normalize:f=!0}=e;return f&&Object.assign(e,rN(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const s=e[0]-n[0],o=e[1]-n[1],a=e[1],f=n[1],{width:p,height:m}=this.getViewportProps(),v=s/p;let w=0;o>0?Math.abs(m-f)>r1&&(w=o/(f-m)*I8):o<0&&f>r1&&(w=1-a/f),w=ts(w,-1,1);const{minPitch:T,maxPitch:E}=this.getViewportProps(),N=i+180*v;let j=r;return w>0?j=r+w*(E-r):w<0&&(j=r-w*(T-r)),{pitch:j,bearing:N}}}class N8 extends P8{constructor(){super(...arguments),this.ControllerState=M8,this.transition={transitionDuration:300,transitionInterpolator:new Rb({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class Ib extends ya{constructor(e={}){super(e)}getViewportType(){return _a}get ControllerType(){return N8}}Ib.displayName="MapView";const O8=new bb;function D8(t,e){const n=t.order??1/0,r=e.order??1/0;return n-r}class B8{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>D8(i,e)>0);r<0?n.push(e):n.splice(r,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Xr(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const s=n[i.id];let o=i;s&&s!==i?s.setProps?(s.setProps(i.props),o=s):s.cleanup(this._context):s||i.setup(this._context),r.push(o),delete n[i.id]}for(const i in n)n[i].cleanup(this._context);this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof bb)||this._resolvedEffects.push(O8),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class F8 extends vg{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const L8="deckRenderer.renderLayers";class U8{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new F8(e),this.pickLayersPass=new kb(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target;this.lastPostProcessEffect&&(r.clearColor=[0,0,0,0],r.clearCanvas=!0);const s=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,qn(L8,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this,n=this.device.canvasContext.getDrawingBufferSize();e.length===0&&[0,1].map(r=>{const i=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"}});e.push(this.device.createFramebuffer({id:`deck-renderbuffer-${r}`,colorAttachments:[i]}))});for(const r of e)r.resize(n)}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1]};for(const s of e)if(s.postRender){i.target=s.id===this.lastPostProcessEffect?n.target:void 0;const o=s.postRender(i);i.inputBuffer=o,i.swapBuffer=o===r[0]?r[1]:r[0]}}}const z8={pickedColor:null,pickedObjectIndex:-1};function V8({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:o,y:a,width:f,height:p}=s;let m=i*i,v=-1,w=0;for(let T=0;T<p;T++){const E=T+a-r,N=E*E;if(N>m)w+=4*f;else for(let j=0;j<f;j++){if(t[w+3]-1>=0){const R=j+o-n,k=R*R+N;k<=m&&(m=k,v=w)}w+=4}}if(v>=0){const T=t.slice(v,v+4),E=e(T);if(E){const N=Math.floor(v/4/f),j=v/4-N*f;return{...E,pickedColor:T,pickedX:o+j,pickedY:a+N}}ut.error("Picked non-existent layer. Is picking buffer corrupt?")()}return z8}function j8({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const s=t.slice(r,r+4),o=s.join(",");if(!n.has(o)){const a=e(s);a?n.set(o,{...a,color:s}):ut.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function Mb({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:s}){let o=e[0];e.length>1&&(o=$8((t==null?void 0:t.pickedViewports)||e,{x:r,y:i}));let a;if(o){const f=[r-o.x,i-o.y];s!==void 0&&(f[2]=s),a=o.unproject(f)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function W8(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,f=o?[o]:[];if(r==="hover"){const v=n.index,w=n.layerId,T=o?o.props.id:null;if(T!==w||a!==v){if(T!==w){const E=i.find(N=>N.props.id===w);E&&f.unshift(E)}n.layerId=T,n.index=a,n.info=null}}const p=Mb(t),m=new Map;return m.set(null,p),f.forEach(v=>{let w={...p};v===o&&(w.color=s,w.index=a,w.picked=!0),w=Nb({layer:v,info:w,mode:r});const T=w.layer;v===o&&r==="hover"&&(n.info=w),m.set(T.id,w),r==="hover"&&T.updateAutoHighlight(w)}),m}function Nb({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function $8(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class H8{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new kb(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,f=o?r.find(w=>w.id===o):null,p=a&&i.find(w=>w.id===a)||i[0],m=p&&p.unproject([e-p.x,n-p.y]);return{...s,...{x:e,y:n,viewport:p,coordinate:m,layer:f}}}_resizeBuffer(){var n,r;if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const i=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=i}const{canvas:e}=this.device.getDefaultCanvasContext();(n=this.pickingFBO)==null||n.resize({width:e.width,height:e.height}),(r=this.depthFBO)==null||r.resize({width:e.width,height:e.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:s,radius:o=0,depth:a=1,mode:f="query",unproject3D:p,onViewportActive:m,effects:v}){const w=this.device.canvasContext.cssToDeviceRatio(),T=this._getPickable(e);if(!T||r.length===0)return{result:[],emptyInfo:Mb({viewports:r,x:i,y:s,pixelRatio:w})};this._resizeBuffer();const E=this.device.canvasContext.cssToDevicePixels([i,s],!0),N=[E.x+Math.floor(E.width/2),E.y+Math.floor(E.height/2)],j=Math.round(o*w),{width:I,height:R}=this.pickingFBO,k=this._getPickingRect({deviceX:N[0],deviceY:N[1],deviceRadius:j,deviceWidth:I,deviceHeight:R}),B={x:i-o,y:s-o,width:o*2+1,height:o*2+1};let Y;const G=[],ce=new Set;for(let U=0;U<a;U++){let $;if(k){const ue=this._drawAndSample({layers:T,views:n,viewports:r,onViewportActive:m,deviceRect:k,cullRect:B,effects:v,pass:`picking:${f}`});$=V8({...ue,deviceX:N[0],deviceY:N[1],deviceRadius:j,deviceRect:k})}else $={pickedColor:null,pickedObjectIndex:-1};let K;if($.pickedLayer&&p&&this.depthFBO){const{pickedColors:ue}=this._drawAndSample({layers:[$.pickedLayer],views:n,viewports:r,onViewportActive:m,deviceRect:{x:$.pickedX,y:$.pickedY,width:1,height:1},cullRect:B,effects:v,pass:`picking:${f}:z`},!0);ue[3]&&(K=ue[0])}$.pickedLayer&&U+1<a&&(ce.add($.pickedLayer),$.pickedLayer.disablePickingIndex($.pickedObjectIndex)),Y=W8({pickInfo:$,lastPickedInfo:this.lastPickedInfo,mode:f,layers:T,viewports:r,x:i,y:s,z:K,pixelRatio:w});for(const ue of Y.values())ue.layer&&G.push(ue);if(!$.pickedColor)break}for(const U of ce)U.restorePickingColors();return{result:G,emptyInfo:Y.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:s,width:o=1,height:a=1,mode:f="query",maxObjects:p=null,onViewportActive:m,effects:v}){const w=this._getPickable(e);if(!w||r.length===0)return[];this._resizeBuffer();const T=this.device.canvasContext.cssToDeviceRatio(),E=this.device.canvasContext.cssToDevicePixels([i,s],!0),N=E.x,j=E.y+E.height,I=this.device.canvasContext.cssToDevicePixels([i+o,s+a],!0),R=I.x+I.width,k=I.y,B={x:N,y:k,width:R-N,height:j-k},Y=this._drawAndSample({layers:w,views:n,viewports:r,onViewportActive:m,deviceRect:B,cullRect:{x:i,y:s,width:o,height:a},effects:v,pass:`picking:${f}`}),G=j8(Y),ce=new Map,U=[],$=Number.isFinite(p);for(let K=0;K<G.length&&!($&&U.length>=p);K++){const ue=G[K];let ge={color:ue.pickedColor,layer:null,index:ue.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:T};ge=Nb({layer:ue.pickedLayer,info:ge,mode:f});const le=ge.layer.id;ce.has(le)||ce.set(le,new Set);const he=ce.get(le),Ue=ge.object??ge.index;he.has(Ue)||(he.add(Ue),U.push(ge))}return U}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:o,effects:a,pass:f},p=!1){const m=p?this.depthFBO:this.pickingFBO,v={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:m,deviceRect:s,cullRect:o,effects:a,pass:f,pickZ:p,preRenderStats:{},isPicking:!0};for(const R of a)R.useInPicking&&(v.preRenderStats[R.id]=R.preRender(v));const{decodePickingColor:w}=this.pickLayersPass.render(v),{x:T,y:E,width:N,height:j}=s,I=new(p?Float32Array:Uint8Array)(N*j*4);return this.device.readPixelsToArrayWebGL(m,{sourceX:T,sourceY:E,sourceWidth:N,sourceHeight:j,target:I}),{pickedColors:I,decodePickingColor:w}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const o=Math.max(0,e-r),a=Math.max(0,n-r),f=Math.min(i,e+r+1)-o,p=Math.min(s,n+r+1)-a;return f<=0||p<=0?null:{x:o,y:a,width:f,height:p}}}const X8={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},Q8="top-left",i1="__root";class Y8{constructor({deck:e,parentElement:n}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=e,this.parentElement=n}getWidgets(){return this.resolvedWidgets}setProps(e){e.widgets&&!Xr(e.widgets,this.widgets,1)&&this._setWidgets(e.widgets)}finalize(){for(const e of this.getWidgets())this._remove(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find(n=>n.id===e.id)||(this._add(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}_setWidgets(e){const n={};for(const r of this.resolvedWidgets)n[r.id]=r;this.resolvedWidgets.length=0;for(const r of this.defaultWidgets)n[r.id]=null,this.resolvedWidgets.push(r);for(let r of e){const i=n[r.id];i?i.viewId!==r.viewId||i.placement!==r.placement?(this._remove(i),this._add(r)):r!==i&&(i.setProps(r.props),r=i):this._add(r),n[r.id]=null,this.resolvedWidgets.push(r)}for(const r in n){const i=n[r];i&&this._remove(i)}this.widgets=e}_add(e){const{viewId:n=null,placement:r=Q8}=e,i=e.onAdd({deck:this.deck,viewId:n});i&&this._getContainer(n,r).append(i),e._element=i}_remove(e){var n;(n=e.onRemove)==null||n.call(e),e._element&&e._element.remove(),e._element=void 0}_getContainer(e,n){var o;const r=e||i1;let i=this.containers[r];i||(i=document.createElement("div"),i.style.pointerEvents="none",i.style.position="absolute",i.style.overflow="hidden",(o=this.parentElement)==null||o.append(i),this.containers[r]=i);let s=i.querySelector(`.${n}`);return s||(s=document.createElement("div"),s.className=n,s.style.position="absolute",s.style.zIndex="2",Object.assign(s.style,X8[n]),i.append(s)),s}_updateContainers(){const e=this.deck.width,n=this.deck.height;for(const r in this.containers){const i=this.lastViewports[r]||null,s=r===i1||i,o=this.containers[r];s?(o.style.display="block",o.style.left=`${i?i.x:0}px`,o.style.top=`${i?i.y:0}px`,o.style.width=`${i?i.width:e}px`,o.style.height=`${i?i.height:n}px`):o.style.display="none"}}onRedraw({viewports:e,layers:n}){var i,s;const r=e.reduce((o,a)=>(o[a.id]=a,o),{});for(const o of this.getWidgets()){const{viewId:a}=o;if(a){const f=r[a];f&&(o.onViewportChange&&o.onViewportChange(f),(i=o.onRedraw)==null||i.call(o,{viewports:[f],layers:n}))}else{if(o.onViewportChange)for(const f of e)o.onViewportChange(f);(s=o.onRedraw)==null||s.call(o,{viewports:e,layers:n})}}this.lastViewports=r,this._updateContainers()}onHover(e,n){var r,i;for(const s of this.getWidgets()){const{viewId:o}=s;(!o||o===((r=e.viewport)==null?void 0:r.id))&&((i=s.onHover)==null||i.call(s,e,n))}}onEvent(e,n){var i,s;const r=k0[n.type];if(r)for(const o of this.getWidgets()){const{viewId:a}=o;(!a||a===((i=e.viewport)==null?void 0:i.id))&&((s=o[r])==null||s.call(o,e,n))}}}const K8={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class q8{constructor(){this.id="default-tooltip",this.placement="fill",this.props={},this.isVisible=!1}onAdd({deck:e}){const n=document.createElement("div");return n.className="deck-tooltip",Object.assign(n.style,K8),this.deck=e,this.element=n,n}onRemove(){this.deck=void 0,this.element=void 0}setProps(){}onViewportChange(e){var n;this.isVisible&&e.id===((n=this.lastViewport)==null?void 0:n.id)&&e!==this.lastViewport&&this.setTooltip(null)}onHover(e){const{deck:n}=this,r=n&&n.props.getTooltip;if(!r)return;const i=r(e);this.lastViewport=e.viewport,this.setTooltip(i,e.x,e.y)}setTooltip(e,n,r){const i=this.element;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform=`translate(${n}px, ${r}px)`,e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}}var zo;(function(t){t[t.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",t[t.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",t[t.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",t[t.FUNC_ADD=32774]="FUNC_ADD",t[t.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",t[t.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",t[t.BLEND_EQUATION=32777]="BLEND_EQUATION",t[t.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",t[t.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",t[t.BLEND_DST_RGB=32968]="BLEND_DST_RGB",t[t.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",t[t.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",t[t.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",t[t.BLEND_COLOR=32773]="BLEND_COLOR",t[t.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",t[t.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",t[t.LINE_WIDTH=2849]="LINE_WIDTH",t[t.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",t[t.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",t[t.CULL_FACE_MODE=2885]="CULL_FACE_MODE",t[t.FRONT_FACE=2886]="FRONT_FACE",t[t.DEPTH_RANGE=2928]="DEPTH_RANGE",t[t.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",t[t.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",t[t.DEPTH_FUNC=2932]="DEPTH_FUNC",t[t.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",t[t.STENCIL_FUNC=2962]="STENCIL_FUNC",t[t.STENCIL_FAIL=2964]="STENCIL_FAIL",t[t.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",t[t.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",t[t.STENCIL_REF=2967]="STENCIL_REF",t[t.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",t[t.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",t[t.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",t[t.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",t[t.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",t[t.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",t[t.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",t[t.VIEWPORT=2978]="VIEWPORT",t[t.SCISSOR_BOX=3088]="SCISSOR_BOX",t[t.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",t[t.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",t[t.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",t[t.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",t[t.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",t[t.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",t[t.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",t[t.RED_BITS=3410]="RED_BITS",t[t.GREEN_BITS=3411]="GREEN_BITS",t[t.BLUE_BITS=3412]="BLUE_BITS",t[t.ALPHA_BITS=3413]="ALPHA_BITS",t[t.DEPTH_BITS=3414]="DEPTH_BITS",t[t.STENCIL_BITS=3415]="STENCIL_BITS",t[t.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",t[t.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",t[t.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",t[t.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",t[t.SAMPLES=32937]="SAMPLES",t[t.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",t[t.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",t[t.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",t[t.VENDOR=7936]="VENDOR",t[t.RENDERER=7937]="RENDERER",t[t.VERSION=7938]="VERSION",t[t.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",t[t.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",t[t.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.BUFFER_SIZE=34660]="BUFFER_SIZE",t[t.BUFFER_USAGE=34661]="BUFFER_USAGE",t[t.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",t[t.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",t[t.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",t[t.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",t[t.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",t[t.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",t[t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",t[t.CULL_FACE=2884]="CULL_FACE",t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK",t[t.BLEND=3042]="BLEND",t[t.DEPTH_TEST=2929]="DEPTH_TEST",t[t.DITHER=3024]="DITHER",t[t.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",t[t.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",t[t.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",t[t.SCISSOR_TEST=3089]="SCISSOR_TEST",t[t.STENCIL_TEST=2960]="STENCIL_TEST",t[t.NO_ERROR=0]="NO_ERROR",t[t.INVALID_ENUM=1280]="INVALID_ENUM",t[t.INVALID_VALUE=1281]="INVALID_VALUE",t[t.INVALID_OPERATION=1282]="INVALID_OPERATION",t[t.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",t[t.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",t[t.CW=2304]="CW",t[t.CCW=2305]="CCW",t[t.DONT_CARE=4352]="DONT_CARE",t[t.FASTEST=4353]="FASTEST",t[t.NICEST=4354]="NICEST",t[t.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.DOUBLE=5130]="DOUBLE",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER",t[t.COMPILE_STATUS=35713]="COMPILE_STATUS",t[t.DELETE_STATUS=35712]="DELETE_STATUS",t[t.LINK_STATUS=35714]="LINK_STATUS",t[t.VALIDATE_STATUS=35715]="VALIDATE_STATUS",t[t.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",t[t.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",t[t.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",t[t.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",t[t.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",t[t.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",t[t.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",t[t.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",t[t.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",t[t.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",t[t.SHADER_TYPE=35663]="SHADER_TYPE",t[t.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",t[t.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP",t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",t[t.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",t[t.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",t[t.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",t[t.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE=5890]="TEXTURE",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",t[t.TEXTURE0=33984]="TEXTURE0",t[t.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",t[t.REPEAT=10497]="REPEAT",t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t[t.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",t[t.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.LOW_FLOAT=36336]="LOW_FLOAT",t[t.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",t[t.HIGH_FLOAT=36338]="HIGH_FLOAT",t[t.LOW_INT=36339]="LOW_INT",t[t.MEDIUM_INT=36340]="MEDIUM_INT",t[t.HIGH_INT=36341]="HIGH_INT",t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.RENDERBUFFER=36161]="RENDERBUFFER",t[t.RGBA4=32854]="RGBA4",t[t.RGB5_A1=32855]="RGB5_A1",t[t.RGB565=36194]="RGB565",t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX=6401]="STENCIL_INDEX",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",t[t.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",t[t.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",t[t.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",t[t.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",t[t.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",t[t.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",t[t.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",t[t.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",t[t.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",t[t.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",t[t.NONE=0]="NONE",t[t.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",t[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",t[t.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",t[t.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",t[t.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",t[t.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",t[t.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",t[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",t[t.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",t[t.READ_BUFFER=3074]="READ_BUFFER",t[t.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",t[t.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",t[t.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",t[t.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",t[t.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",t[t.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",t[t.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",t[t.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",t[t.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",t[t.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",t[t.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",t[t.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",t[t.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",t[t.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",t[t.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",t[t.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",t[t.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",t[t.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",t[t.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",t[t.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",t[t.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",t[t.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",t[t.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",t[t.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",t[t.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",t[t.RED=6403]="RED",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB10_A2=32857]="RGB10_A2",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",t[t.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",t[t.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",t[t.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",t[t.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",t[t.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",t[t.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",t[t.SRGB=35904]="SRGB",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",t[t.RGBA32F=34836]="RGBA32F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.RGB16F=34843]="RGB16F",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R16F=33325]="R16F",t[t.R32F=33326]="R32F",t[t.RG16F=33327]="RG16F",t[t.RG32F=33328]="RG32F",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2UI=36975]="RGB10_A2UI",t[t.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",t[t.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.RG=33319]="RG",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",t[t.CURRENT_QUERY=34917]="CURRENT_QUERY",t[t.QUERY_RESULT=34918]="QUERY_RESULT",t[t.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",t[t.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",t[t.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",t[t.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",t[t.DRAW_BUFFER0=34853]="DRAW_BUFFER0",t[t.DRAW_BUFFER1=34854]="DRAW_BUFFER1",t[t.DRAW_BUFFER2=34855]="DRAW_BUFFER2",t[t.DRAW_BUFFER3=34856]="DRAW_BUFFER3",t[t.DRAW_BUFFER4=34857]="DRAW_BUFFER4",t[t.DRAW_BUFFER5=34858]="DRAW_BUFFER5",t[t.DRAW_BUFFER6=34859]="DRAW_BUFFER6",t[t.DRAW_BUFFER7=34860]="DRAW_BUFFER7",t[t.DRAW_BUFFER8=34861]="DRAW_BUFFER8",t[t.DRAW_BUFFER9=34862]="DRAW_BUFFER9",t[t.DRAW_BUFFER10=34863]="DRAW_BUFFER10",t[t.DRAW_BUFFER11=34864]="DRAW_BUFFER11",t[t.DRAW_BUFFER12=34865]="DRAW_BUFFER12",t[t.DRAW_BUFFER13=34866]="DRAW_BUFFER13",t[t.DRAW_BUFFER14=34867]="DRAW_BUFFER14",t[t.DRAW_BUFFER15=34868]="DRAW_BUFFER15",t[t.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",t[t.MAX_SAMPLES=36183]="MAX_SAMPLES",t[t.SAMPLER_BINDING=35097]="SAMPLER_BINDING",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",t[t.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",t[t.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",t[t.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",t[t.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",t[t.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",t[t.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",t[t.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",t[t.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",t[t.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",t[t.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",t[t.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",t[t.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",t[t.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",t[t.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",t[t.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",t[t.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",t[t.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",t[t.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",t[t.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",t[t.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",t[t.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",t[t.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",t[t.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",t[t.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",t[t.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",t[t.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",t[t.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",t[t.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",t[t.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",t[t.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",t[t.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",t[t.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",t[t.UNIFORM_TYPE=35383]="UNIFORM_TYPE",t[t.UNIFORM_SIZE=35384]="UNIFORM_SIZE",t[t.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",t[t.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",t[t.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",t[t.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",t[t.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",t[t.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",t[t.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",t[t.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",t[t.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS",t[t.SYNC_FENCE=37142]="SYNC_FENCE",t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED",t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED",t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",t[t.COLOR=6144]="COLOR",t[t.DEPTH=6145]="DEPTH",t[t.STENCIL=6146]="STENCIL",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STREAM_COPY=35042]="STREAM_COPY",t[t.STATIC_READ=35045]="STATIC_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",t[t.INVALID_INDEX=4294967295]="INVALID_INDEX",t[t.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",t[t.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",t[t.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",t[t.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",t[t.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",t[t.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",t[t.R16_EXT=33322]="R16_EXT",t[t.RG16_EXT=33324]="RG16_EXT",t[t.RGB16_EXT=32852]="RGB16_EXT",t[t.RGBA16_EXT=32859]="RGBA16_EXT",t[t.R16_SNORM_EXT=36760]="R16_SNORM_EXT",t[t.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",t[t.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",t[t.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",t[t.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",t[t.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",t[t.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",t[t.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",t[t.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",t[t.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",t[t.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",t[t.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",t[t.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",t[t.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",t[t.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",t[t.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",t[t.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",t[t.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",t[t.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",t[t.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",t[t.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",t[t.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",t[t.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",t[t.LINE_WEBGL=6913]="LINE_WEBGL",t[t.FILL_WEBGL=6914]="FILL_WEBGL",t[t.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",t[t.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",t[t.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",t[t.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",t[t.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",t[t.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",t[t.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",t[t.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",t[t.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",t[t.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",t[t.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",t[t.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",t[t.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",t[t.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",t[t.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",t[t.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",t[t.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",t[t.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",t[t.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",t[t.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",t[t.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",t[t.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",t[t.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",t[t.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"})(zo||(zo={}));const bg={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},dn=(t,e,n)=>e?t.enable(n):t.disable(n),s1=(t,e,n)=>t.hint(n,e),hr=(t,e,n)=>t.pixelStorei(n,e),o1=(t,e,n)=>{const r=n===36006?36009:36008;return t.bindFramebuffer(r,e)},Za=(t,e,n)=>{const i={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[n];t.bindBuffer(i,e)};function Jh(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}const Z8={3042:dn,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:dn,2885:(t,e)=>t.cullFace(e),2929:dn,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:dn,35723:s1,35725:(t,e)=>t.useProgram(e),36007:(t,e)=>t.bindRenderbuffer(36161,e),36389:(t,e)=>{var n;return(n=t.bindTransformFeedback)==null?void 0:n.call(t,36386,e)},34229:(t,e)=>t.bindVertexArray(e),36006:o1,36010:o1,34964:Za,36662:Za,36663:Za,35053:Za,35055:Za,2886:(t,e)=>t.frontFace(e),33170:s1,2849:(t,e)=>t.lineWidth(e),32823:dn,32824:"polygonOffset",10752:"polygonOffset",35977:dn,32926:dn,32928:dn,32938:"sampleCoverage",32939:"sampleCoverage",3089:dn,3088:(t,e)=>t.scissor(...e),2960:dn,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),34383:dn,10754:dn,12288:dn,12289:dn,12290:dn,12291:dn,12292:dn,12293:dn,12294:dn,12295:dn,3333:hr,3317:hr,37440:hr,37441:hr,37443:hr,3330:hr,3332:hr,3331:hr,3314:hr,32878:hr,3316:hr,3315:hr,32877:hr,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{const n=typeof e=="number"?[e,e]:e;t.blendEquationSeparate(...n)},blendFunc:(t,e)=>{const n=(e==null?void 0:e.length)===2?[...e,...e]:e;t.blendFuncSeparate(...n)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(e[0],e[1]||!1),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Jh(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=Jh(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,o,a)},stencilOp:(t,e)=>{e=Jh(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,o,a)},viewport:(t,e)=>t.viewport(...e)};function on(t,e,n){return e[t]!==void 0?e[t]:n[t]}const G8={blendEquation:(t,e,n)=>t.blendEquationSeparate(on(32777,e,n),on(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(on(32969,e,n),on(32968,e,n),on(32971,e,n),on(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(on(32824,e,n),on(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(on(32938,e,n),on(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,on(2962,e,n),on(2967,e,n),on(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,on(34816,e,n),on(36003,e,n),on(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,on(2964,e,n),on(2965,e,n),on(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,on(34817,e,n),on(34818,e,n),on(34819,e,n))},a1={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),useProgram:(t,e)=>t({35725:e}),bindRenderbuffer:(t,e,n)=>t({36007:n}),bindTransformFeedback:(t,e,n)=>t({36389:n}),bindVertexArray:(t,e)=>t({34229:e}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},bindBuffer:(t,e,n)=>{const r={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[e];return r?t({[r]:n}):{valueChanged:!0}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},ni=(t,e)=>t.isEnabled(e),l1={3042:ni,2884:ni,2929:ni,3024:ni,32823:ni,32926:ni,32928:ni,3089:ni,2960:ni,35977:ni},J8=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function ka(t,e){if(tO(e))return;const n={};for(const i in e){const s=Number(i),o=Z8[i];o&&(typeof o=="string"?n[o]=!0:o(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=G8[i];s(t,e,r)}}function Ob(t,e=bg){if(typeof e=="number"){const i=e,s=l1[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=l1[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function eO(t){ka(t,bg)}function tO(t){for(const e in t)return!1;return!0}function nO(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}class Ws{constructor(e,n){M(this,"gl");M(this,"program",null);M(this,"stateStack",[]);M(this,"enable",!0);M(this,"cache",null);M(this,"log");M(this,"initialized",!1);this.gl=e,this.log=(n==null?void 0:n.log)||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}static get(e){return e.state}push(e={}){this.stateStack.push({})}pop(){const e=this.stateStack[this.stateStack.length-1];ka(this.gl,e),this.stateStack.pop()}trackState(e,n){if(this.cache=n.copyState?Ob(e):Object.assign({},bg),this.initialized)throw new Error("WebGLStateTracker");this.initialized=!0,this.gl.state=this,iO(e);for(const r in a1){const i=a1[r];rO(e,r,i)}A1(e,"getParameter"),A1(e,"isEnabled")}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const s in e){const o=e[s],a=this.cache[s];nO(o,a)||(n=!0,r=a,i&&!(s in i)&&(i[s]=a),this.cache[s]=o)}return{valueChanged:n,oldValue:r}}}function A1(t,e){const n=t[e].bind(t);t[e]=function(i){if(i===void 0||J8.has(i))return n(i);const s=Ws.get(t);return i in s.cache||(s.cache[i]=n(i)),s.enable?s.cache[i]:n(i)},Object.defineProperty(t[e],"name",{value:`${e}-from-cache`,configurable:!1})}function rO(t,e,n){if(!t[e])return;const r=t[e].bind(t);t[e]=function(...s){const o=Ws.get(t),{valueChanged:a,oldValue:f}=n(o._updateCache,...s);return a&&r(...s),f},Object.defineProperty(t[e],"name",{value:`${e}-to-cache`,configurable:!1})}function iO(t){const e=t.useProgram.bind(t);t.useProgram=function(r){const i=Ws.get(t);i.program!==r&&(e(r),i.program=r)}}function sO(t,e,n){let r="";const i={preserveDrawingBuffer:!0,...n};let s=null;if(s||(s=t.getContext("webgl2",i)),i.failIfMajorPerformanceCaveat&&(r||(r="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow.")),!s&&!n.failIfMajorPerformanceCaveat&&(i.failIfMajorPerformanceCaveat=!1,s=t.getContext("webgl2",i),s.luma||(s.luma={}),s.luma.softwareRenderer=!0),s||(s=t.getContext("webgl",{}),s&&(s=null,r||(r="Your browser only supports WebGL1"))),!s)throw r||(r="Your browser does not support WebGL"),new Error(`Failed to create WebGL context: ${r}`);const{onContextLost:o,onContextRestored:a}=e;return t.addEventListener("webglcontextlost",f=>o(f),!1),t.addEventListener("webglcontextrestored",f=>a(f),!1),s.luma||(s.luma={}),s}function va(t,e,n){return n[e]===void 0&&(n[e]=t.getExtension(e)||null),n[e]}function oO(t,e){const n=t.getParameter(7936),r=t.getParameter(7937);va(t,"WEBGL_debug_renderer_info",e);const i=e.WEBGL_debug_renderer_info,s=t.getParameter(i?i.UNMASKED_VENDOR_WEBGL:7936),o=t.getParameter(i?i.UNMASKED_RENDERER_WEBGL:7937),a=s||n,f=o||r,p=t.getParameter(7938),m=Db(a,f),v=aO(a,f),w=lO(a,f);return{type:"webgl",gpu:m,gpuType:w,gpuBackend:v,vendor:a,renderer:f,version:p,shadingLanguage:"glsl",shadingLanguageVersion:300}}function Db(t,e){return/NVIDIA/i.exec(t)||/NVIDIA/i.exec(e)?"nvidia":/INTEL/i.exec(t)||/INTEL/i.exec(e)?"intel":/Apple/i.exec(t)||/Apple/i.exec(e)?"apple":/AMD/i.exec(t)||/AMD/i.exec(e)||/ATI/i.exec(t)||/ATI/i.exec(e)?"amd":/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e)?"software":"unknown"}function aO(t,e){return/Metal/i.exec(t)||/Metal/i.exec(e)?"metal":/ANGLE/i.exec(t)||/ANGLE/i.exec(e)?"opengl":"unknown"}function lO(t,e){if(/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e))return"cpu";switch(Db(t,e)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}function Bb(t){switch(t){case"uint8":return 5121;case"sint8":return 5120;case"unorm8":return 5121;case"snorm8":return 5120;case"uint16":return 5123;case"sint16":return 5122;case"unorm16":return 5123;case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(t))}const ll="WEBGL_compressed_texture_s3tc",Al="WEBGL_compressed_texture_s3tc_srgb",Vo="EXT_texture_compression_rgtc",jo="EXT_texture_compression_bptc",AO="WEBGL_compressed_texture_etc",cO="WEBGL_compressed_texture_astc",uO="WEBGL_compressed_texture_etc1",fO="WEBGL_compressed_texture_pvrtc",hO="WEBGL_compressed_texture_atc",c1="EXT_texture_norm16",u1="EXT_render_snorm",dO="EXT_color_buffer_float",xg={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[u1],"norm16-renderable-webgl":[c1],"snorm16-renderable-webgl":[c1,u1],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[ll,Al,Vo,jo],"texture-compression-bc5-webgl":[Vo],"texture-compression-bc7-webgl":[jo],"texture-compression-etc2":[AO],"texture-compression-astc":[cO],"texture-compression-etc1-webgl":[uO],"texture-compression-pvrtc-webgl":[fO],"texture-compression-atc-webgl":[hO]};function pO(t){return t in xg}function gO(t,e,n){return(xg[e]||[]).every(i=>va(t,i,n))}const Tg={r8unorm:{gl:33321,rb:!0},r8snorm:{gl:36756},r8uint:{gl:33330,rb:!0},r8sint:{gl:33329,rb:!0},rg8unorm:{gl:33323,rb:!0},rg8snorm:{gl:36757},rg8uint:{gl:33336,rb:!0},rg8sint:{gl:33335,rb:!0},r16uint:{gl:33332,rb:!0},r16sint:{gl:33331,rb:!0},r16float:{gl:33325,rb:!0},"r16unorm-webgl":{gl:33322,rb:!0},"r16snorm-webgl":{gl:36760},"rgba4unorm-webgl":{gl:32854,rb:!0},"rgb565unorm-webgl":{gl:36194,rb:!0},"rgb5a1unorm-webgl":{gl:32855,rb:!0},"rgb8unorm-webgl":{gl:32849},"rgb8snorm-webgl":{gl:36758},rgba8unorm:{gl:32856},"rgba8unorm-srgb":{gl:35907},rgba8snorm:{gl:36759},rgba8uint:{gl:36220},rgba8sint:{gl:36238},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:33338},rg16sint:{gl:33337},rg16float:{gl:33327,rb:!0},"rg16unorm-webgl":{gl:33324},"rg16snorm-webgl":{gl:36761},r32uint:{gl:33334,rb:!0},r32sint:{gl:33333,rb:!0},r32float:{gl:33326},rgb9e5ufloat:{gl:35901},rg11b10ufloat:{gl:35898,rb:!0},rgb10a2unorm:{gl:32857,rb:!0},"rgb10a2uint-webgl":{gl:36975,rb:!0},"rgb16unorm-webgl":{gl:32852},"rgb16snorm-webgl":{gl:36762},rg32uint:{gl:33340,rb:!0},rg32sint:{gl:33339,rb:!0},rg32float:{gl:33328,rb:!0},rgba16uint:{gl:36214,rb:!0},rgba16sint:{gl:36232,rb:!0},rgba16float:{gl:34842},"rgba16unorm-webgl":{gl:32859,rb:!0},"rgba16snorm-webgl":{gl:36763},"rgb32float-webgl":{gl:34837,x:dO,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,rb:!0},rgba32sint:{gl:36226,rb:!0},rgba32float:{gl:34836,rb:!0},stencil8:{gl:36168,rb:!0},depth16unorm:{gl:33189,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,dataFormat:6402,types:[5125]},depth32float:{gl:36012,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth32float-stencil8":{gl:36013,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:ll},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:Al},"bc1-rgba-unorm":{gl:33777,x:ll},"bc1-rgba-unorm-srgb":{gl:35916,x:Al},"bc2-rgba-unorm":{gl:33778,x:ll},"bc2-rgba-unorm-srgb":{gl:35918,x:Al},"bc3-rgba-unorm":{gl:33779,x:ll},"bc3-rgba-unorm-srgb":{gl:35919,x:Al},"bc4-r-unorm":{gl:36283,x:Vo},"bc4-r-snorm":{gl:36284,x:Vo},"bc5-rg-unorm":{gl:36285,x:Vo},"bc5-rg-snorm":{gl:36286,x:Vo},"bc6h-rgb-ufloat":{gl:36495,x:jo},"bc6h-rgb-float":{gl:36494,x:jo},"bc7-rgba-unorm":{gl:36492,x:jo},"bc7-rgba-unorm-srgb":{gl:36493,x:jo},"etc2-rgb8unorm":{gl:37492},"etc2-rgb8unorm-srgb":{gl:37494},"etc2-rgb8a1unorm":{gl:37496},"etc2-rgb8a1unorm-srgb":{gl:37497},"etc2-rgba8unorm":{gl:37493},"etc2-rgba8unorm-srgb":{gl:37495},"eac-r11unorm":{gl:37488},"eac-r11snorm":{gl:37489},"eac-rg11unorm":{gl:37490},"eac-rg11snorm":{gl:37491},"astc-4x4-unorm":{gl:37808},"astc-4x4-unorm-srgb":{gl:37840},"astc-5x4-unorm":{gl:37809},"astc-5x4-unorm-srgb":{gl:37841},"astc-5x5-unorm":{gl:37810},"astc-5x5-unorm-srgb":{gl:37842},"astc-6x5-unorm":{gl:37811},"astc-6x5-unorm-srgb":{gl:37843},"astc-6x6-unorm":{gl:37812},"astc-6x6-unorm-srgb":{gl:37844},"astc-8x5-unorm":{gl:37813},"astc-8x5-unorm-srgb":{gl:37845},"astc-8x6-unorm":{gl:37814},"astc-8x6-unorm-srgb":{gl:37846},"astc-8x8-unorm":{gl:37815},"astc-8x8-unorm-srgb":{gl:37847},"astc-10x5-unorm":{gl:37819},"astc-10x5-unorm-srgb":{gl:37851},"astc-10x6-unorm":{gl:37817},"astc-10x6-unorm-srgb":{gl:37849},"astc-10x8-unorm":{gl:37818},"astc-10x8-unorm-srgb":{gl:37850},"astc-10x10-unorm":{gl:37819},"astc-10x10-unorm-srgb":{gl:37851},"astc-12x10-unorm":{gl:37820},"astc-12x10-unorm-srgb":{gl:37852},"astc-12x12-unorm":{gl:37821},"astc-12x12-unorm-srgb":{gl:37853},"pvrtc-rgb4unorm-webgl":{gl:35840},"pvrtc-rgba4unorm-webgl":{gl:35842},"pvrtc-rbg2unorm-webgl":{gl:35841},"pvrtc-rgba2unorm-webgl":{gl:35843},"etc1-rbg-unorm-webgl":{gl:36196},"atc-rgb-unorm-webgl":{gl:35986},"atc-rgba-unorm-webgl":{gl:35986},"atc-rgbai-unorm-webgl":{gl:34798}};function mO(t,e,n){let r=e.create;const i=Tg[e.format];return(i==null?void 0:i.gl)===void 0&&(r=!1),i!=null&&i.x&&(r=r&&!!va(t,i.x,n)),{format:e.format,create:r&&e.create,render:r&&e.render,filter:r&&e.filter,blend:r&&e.blend,store:r&&e.store}}function Fb(t){var i;const e=Tg[t],n=vO(t),r=og(t);return{internalFormat:n,format:(e==null?void 0:e.dataFormat)||yO(r.channels,r.integer,r.normalized,n),type:r.dataType?Bb(r.dataType):((i=e==null?void 0:e.types)==null?void 0:i[0])||5121,compressed:r.compressed||!1}}function _O(t){switch(og(t).attachment){case"depth":return 36096;case"stencil":return 36128;case"depth-stencil":return 33306;default:throw new Error(`Not a depth stencil format: ${t}`)}}function yO(t,e,n,r){if(r===6408||r===6407)return r;switch(t){case"r":return e&&!n?36244:6403;case"rg":return e&&!n?33320:33319;case"rgb":return e&&!n?36248:6407;case"rgba":return e&&!n?36249:6408;case"bgra":throw new Error("bgra pixels not supported by WebGL");default:return 6408}}function vO(t){const e=Tg[t],n=e==null?void 0:e.gl;if(n===void 0)throw new Error(`Unsupported texture format ${t}`);return n}const f1={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class wO extends pR{constructor(n,r,i){super([],i);M(this,"gl");M(this,"extensions");M(this,"testedFeatures",new Set);this.gl=n,this.extensions=r,va(n,"EXT_color_buffer_float",r)}*[Symbol.iterator](){const n=this.getFeatures();for(const r of n)this.has(r)&&(yield r);return[]}has(n){var r;return(r=this.disabledFeatures)!=null&&r[n]?!1:(this.testedFeatures.has(n)||(this.testedFeatures.add(n),pO(n)&&gO(this.gl,n,this.extensions)&&this.features.add(n),this.getWebGLFeature(n)&&this.features.add(n)),this.features.has(n))}initializeFeatures(){const n=this.getFeatures().filter(r=>r!=="polygon-mode-webgl");for(const r of n)this.has(r)}getFeatures(){return[...Object.keys(f1),...Object.keys(xg)]}getWebGLFeature(n){const r=f1[n];return typeof r=="string"?!!va(this.gl,r,this.extensions):!!r}}class bO extends dR{constructor(n){super();M(this,"gl");M(this,"limits",{});this.gl=n}get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}getParameter(n){return this.limits[n]===void 0&&(this.limits[n]=this.gl.getParameter(n)),this.limits[n]||0}}class El extends cu{constructor(n,r){super(n,r);M(this,"device");M(this,"gl");M(this,"handle");M(this,"colorAttachments",[]);M(this,"depthStencilAttachment",null);const i=r.handle===null;this.device=n,this.gl=n.gl,this.handle=this.props.handle||i?this.props.handle:this.gl.createFramebuffer(),i||(n.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments())}destroy(){super.destroy(),!this.destroyed&&this.handle!==null&&this.gl.deleteFramebuffer(this.handle)}updateAttachments(){const n=this.gl.bindFramebuffer(36160,this.handle);for(let r=0;r<this.colorAttachments.length;++r){const i=this.colorAttachments[r];if(i){const s=36064+r;this._attachTextureView(s,i)}}if(this.depthStencilAttachment){const r=_O(this.depthStencilAttachment.props.format);this._attachTextureView(r,this.depthStencilAttachment)}if(this.device.props.debug){const r=this.gl.checkFramebufferStatus(36160);if(r!==36053)throw new Error(`Framebuffer ${TO(r)}`)}this.gl.bindFramebuffer(36160,n)}_attachTextureView(n,r){const{gl:i}=this.device,{texture:s}=r,o=r.props.baseMipLevel,a=r.props.baseArrayLayer;switch(i.bindTexture(s.glTarget,s.handle),s.glTarget){case 35866:case 32879:i.framebufferTextureLayer(36160,n,s.handle,o,a);break;case 34067:const f=xO(a);i.framebufferTexture2D(36160,n,f,s.handle,o);break;case 3553:i.framebufferTexture2D(36160,n,3553,s.handle,o);break;default:throw new Error("Illegal texture type")}i.bindTexture(s.glTarget,null)}}function xO(t){return t<34069?t+34069:t}function TO(t){switch(t){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${t}`}}class EO extends h0{constructor(n,r){super(r);M(this,"device");M(this,"format","rgba8unorm");M(this,"depthStencilFormat","depth24plus");M(this,"presentationSize");M(this,"_framebuffer",null);this.device=n,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this.update()}get[Symbol.toStringTag](){return"WebGLCanvasContext"}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new El(this.device,{handle:null}),this._framebuffer}update(){const n=this.getPixelSize();(n[0]!==this.presentationSize[0]||n[1]!==this.presentationSize[1])&&(this.presentationSize=n,this.resize())}resize(n){if(this.device.gl&&this.canvas){const r=this.getDevicePixelRatio(n==null?void 0:n.useDevicePixels);this.setDevicePixelRatio(r,n);return}}commit(){}}async function Lb(t,e){const n=document.getElementsByTagName("head")[0];if(!n)throw new Error("loadScript");const r=document.createElement("script");return r.setAttribute("type","text/javascript"),r.setAttribute("src",t),new Promise((i,s)=>{r.onload=i,r.onerror=o=>s(new Error(`Unable to load script '${t}': ${o}`)),n.appendChild(r)})}const SO=1;let Lt=null,h1=!1;const Eg={debugSpectorJS:xe.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0};async function CO(t){if(!globalThis.SPECTOR)try{await Lb(t.debugSpectorJSUrl||Eg.debugSpectorJSUrl)}catch(e){xe.warn(String(e))}}function kO(t){var e;if(t={...Eg,...t},!t.debugSpectorJS)return null;if(!Lt&&globalThis.SPECTOR&&!((e=globalThis.luma)!=null&&e.spector)){xe.probe(SO,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();const{Spector:n}=globalThis.SPECTOR;Lt=new n,globalThis.luma&&(globalThis.luma.spector=Lt)}if(!Lt)return null;if(h1||(h1=!0,Lt.spyCanvases(),Lt==null||Lt.onCaptureStarted.add(n=>xe.info("Spector capture started:",n)()),Lt==null||Lt.onCapture.add(n=>{xe.info("Spector capture complete:",n)(),Lt==null||Lt.getResultUI(),Lt==null||Lt.resultView.display(),Lt==null||Lt.resultView.addCapture(n)})),t.gl){const n=t.gl,r=n.device;Lt==null||Lt.startCapture(t.gl,500),n.device=r,new Promise(i=>setTimeout(i,2e3)).then(i=>{xe.info("Spector capture stopped after 2 seconds")(),Lt==null||Lt.stopCapture()})}return Lt}const PO="https://unpkg.com/webgl-debug@2.0.1/index.js";function Ub(t){return t.luma=t.luma||{},t.luma}async function RO(){so()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await Lb(PO))}function IO(t,e={}){return e.debugWebGL||e.traceWebGL?NO(t,e):MO(t)}function MO(t){const e=Ub(t);return e.realContext?e.realContext:t}function NO(t,e){if(!globalThis.WebGLDebugUtils)return xe.warn("webgl-debug not loaded")(),t;const n=Ub(t);if(n.debugContext)return n.debugContext;globalThis.WebGLDebugUtils.init({...zo,...t});const r=globalThis.WebGLDebugUtils.makeDebugContext(t,OO.bind(null,e),DO.bind(null,e));for(const o in zo)!(o in r)&&typeof zo[o]=="number"&&(r[o]=zo[o]);class i{}Object.setPrototypeOf(r,Object.getPrototypeOf(t)),Object.setPrototypeOf(i,r);const s=Object.create(i);return n.realContext=t,n.debugContext=s,s.debug=!0,s}function d1(t,e){e=Array.from(e).map(r=>r===void 0?"undefined":r);let n=globalThis.WebGLDebugUtils.glFunctionArgsToString(t,e);return n=`${n.slice(0,100)}${n.length>100?"...":""}`,`gl.${t}(${n})`}function OO(t,e,n,r){r=Array.from(r).map(a=>a===void 0?"undefined":a);const i=globalThis.WebGLDebugUtils.glEnumToString(e),s=globalThis.WebGLDebugUtils.glFunctionArgsToString(n,r),o=`${i} in gl.${n}(${s})`;xe.error(o)();debugger}function DO(t,e,n){let r="";xe.level>=1&&(r=d1(e,n),t.traceWebGL&&xe.log(1,r)());for(const i of n)if(i===void 0){r=r||d1(e,n);debugger}}const ed={};function BO(t="id"){ed[t]=ed[t]||1;const e=ed[t]++;return`${t}-${e}`}class Sl extends Yt{constructor(n,r={}){super(n,r);M(this,"device");M(this,"gl");M(this,"handle");M(this,"glTarget");M(this,"glUsage");M(this,"glIndexType",5123);M(this,"byteLength");M(this,"bytesUsed");this.device=n,this.gl=this.device.gl;const i=typeof r=="object"?r.handle:void 0;this.handle=i||this.gl.createBuffer(),n.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glTarget=FO(this.props.usage),this.glUsage=LO(this.props.usage),this.glIndexType=this.props.indexType==="uint32"?5125:5123,r.data?this._initWithData(r.data,r.byteOffset,r.byteLength):this._initWithByteLength(r.byteLength||0)}_initWithData(n,r=0,i=n.byteLength+r){const s=this.glTarget;this.gl.bindBuffer(s,this.handle),this.gl.bufferData(s,i,this.glUsage),this.gl.bufferSubData(s,r,n),this.gl.bindBuffer(s,null),this.bytesUsed=i,this.byteLength=i,this._setDebugData(n,r,i),this.trackAllocatedMemory(i)}_initWithByteLength(n){let r=n;n===0&&(r=new Float32Array(0));const i=this.glTarget;return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.glUsage),this.gl.bindBuffer(i,null),this.bytesUsed=n,this.byteLength=n,this._setDebugData(null,0,n),this.trackAllocatedMemory(n),this}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}write(n,r=0){this.gl.bindBuffer(36663,this.handle),this.gl.bufferSubData(36663,r,n),this.gl.bindBuffer(36663,null),this._setDebugData(n,r,n.byteLength)}async readAsync(n=0,r){return this.readSyncWebGL(n,r)}readSyncWebGL(n=0,r){r=r??this.byteLength-n;const i=new Uint8Array(r),s=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,i,s,r),this.gl.bindBuffer(36662,null),this._setDebugData(i,n,r),i}}function FO(t){return t&Yt.INDEX?34963:t&Yt.VERTEX?34962:t&Yt.UNIFORM?35345:34962}function LO(t){return t&Yt.INDEX||t&Yt.VERTEX?35044:t&Yt.UNIFORM?35048:35044}function UO(t){const e=t.split(/\r?\n/),n=[];for(const r of e){if(r.length<=1)continue;const i=r.split(":");if(i.length===2){const[v,w]=i;n.push({message:w.trim(),type:p1(v),lineNum:0,linePos:0});continue}const[s,o,a,...f]=i;let p=parseInt(a,10);isNaN(p)&&(p=0);let m=parseInt(o,10);isNaN(m)&&(m=0),n.push({message:f.join(":").trim(),type:p1(s),lineNum:p,linePos:m})}return n}function p1(t){const e=["warning","error","info"],n=t.toLowerCase();return e.includes(n)?n:"info"}class zO extends lu{constructor(n,r){super(n,r);M(this,"device");M(this,"handle");switch(this.device=n,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0)}get asyncCompilationStatus(){return this._waitForCompilationComplete().then(()=>this.compilationStatus)}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const n=this.device.gl.getShaderInfoLog(this.handle);return n?UO(n):[]}getTranslatedSource(){const r=this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders;return(r==null?void 0:r.getTranslatedShaderSource(this.handle))||null}async _compile(n){n=n.startsWith("#version ")?n:`#version 300 es
${n}`;const{gl:r}=this.device;if(r.shaderSource(this.handle,n),r.compileShader(this.handle),!this.device.props.debug){this.compilationStatus="pending";return}if(!this.device.features.has("compilation-status-async-webgl")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus==="error")throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}xe.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),xe.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){const n=async s=>await new Promise(o=>setTimeout(o,s));if(!this.device.features.has("compilation-status-async-webgl")){await n(10);return}const{gl:i}=this.device;for(;;){if(i.getShaderParameter(this.handle,37297))return;await n(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}function VO(t,e,n,r){if(HO(e))return r(t);const i=t;i.pushState();try{return jO(t,e),ka(i.gl,n),r(t)}finally{i.popState()}}function jO(t,e){const n=t,{gl:r}=n;if(e.cullMode)switch(e.cullMode){case"none":r.disable(2884);break;case"front":r.enable(2884),r.cullFace(1028);break;case"back":r.enable(2884),r.cullFace(1029);break}if(e.frontFace&&r.frontFace($s("frontFace",e.frontFace,{ccw:2305,cw:2304})),e.unclippedDepth&&t.features.has("depth-clip-control")&&r.enable(34383),e.depthBias!==void 0&&(r.enable(32823),r.polygonOffset(e.depthBias,e.depthBiasSlopeScale||0)),e.provokingVertex&&t.features.has("provoking-vertex-webgl")){const s=n.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,o=$s("provokingVertex",e.provokingVertex,{first:36429,last:36430});s==null||s.provokingVertexWEBGL(o)}if((e.polygonMode||e.polygonOffsetLine)&&t.features.has("polygon-mode-webgl")){if(e.polygonMode){const s=n.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,o=$s("polygonMode",e.polygonMode,{fill:6914,line:6913});s==null||s.polygonModeWEBGL(1028,o),s==null||s.polygonModeWEBGL(1029,o)}e.polygonOffsetLine&&r.enable(10754)}if(t.features.has("shader-clip-cull-distance-webgl")&&(e.clipDistance0&&r.enable(12288),e.clipDistance1&&r.enable(12289),e.clipDistance2&&r.enable(12290),e.clipDistance3&&r.enable(12291),e.clipDistance4&&r.enable(12292),e.clipDistance5&&r.enable(12293),e.clipDistance6&&r.enable(12294),e.clipDistance7&&r.enable(12295)),e.depthWriteEnabled!==void 0&&r.depthMask($O("depthWriteEnabled",e.depthWriteEnabled)),e.depthCompare&&(e.depthCompare!=="always"?r.enable(2929):r.disable(2929),r.depthFunc(F0("depthCompare",e.depthCompare))),e.stencilWriteMask){const i=e.stencilWriteMask;r.stencilMaskSeparate(1028,i),r.stencilMaskSeparate(1029,i)}if(e.stencilReadMask&&xe.warn("stencilReadMask not supported under WebGL"),e.stencilCompare){const i=e.stencilReadMask||4294967295,s=F0("depthCompare",e.stencilCompare);e.stencilCompare!=="always"?r.enable(2960):r.disable(2960),r.stencilFuncSeparate(1028,s,0,i),r.stencilFuncSeparate(1029,s,0,i)}if(e.stencilPassOperation&&e.stencilFailOperation&&e.stencilDepthFailOperation){const i=td("stencilPassOperation",e.stencilPassOperation),s=td("stencilFailOperation",e.stencilFailOperation),o=td("stencilDepthFailOperation",e.stencilDepthFailOperation);r.stencilOpSeparate(1028,s,o,i),r.stencilOpSeparate(1029,s,o,i)}switch(e.blend){case!0:r.enable(3042);break;case!1:r.disable(3042);break}if(e.blendColorOperation||e.blendAlphaOperation){const i=g1("blendColorOperation",e.blendColorOperation||"add"),s=g1("blendAlphaOperation",e.blendAlphaOperation||"add");r.blendEquationSeparate(i,s);const o=GA("blendColorSrcFactor",e.blendColorSrcFactor||"one"),a=GA("blendColorDstFactor",e.blendColorDstFactor||"zero"),f=GA("blendAlphaSrcFactor",e.blendAlphaSrcFactor||"one"),p=GA("blendAlphaDstFactor",e.blendAlphaDstFactor||"zero");r.blendFuncSeparate(o,a,f,p)}}function F0(t,e){return $s(t,e,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function td(t,e){return $s(t,e,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function g1(t,e){return $s(t,e,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function GA(t,e){return $s(t,e,{one:1,zero:0,"src-color":768,"one-minus-src-color":769,"dst-color":774,"one-minus-dst-color":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,"constant-color":32769,"one-minus-constant-color":32770,"constant-alpha":32771,"one-minus-constant-alpha":32772})}function WO(t,e){return`Illegal parameter ${e} for ${t}`}function $s(t,e,n){if(!(e in n))throw new Error(WO(t,e));return n[e]}function $O(t,e){return e}function HO(t){let e=!0;for(const n in t){e=!1;break}return e}function zb(t){const e={};return t.addressModeU&&(e[10242]=nd(t.addressModeU)),t.addressModeV&&(e[10243]=nd(t.addressModeV)),t.addressModeW&&(e[32882]=nd(t.addressModeW)),t.magFilter&&(e[10240]=L0(t.magFilter)),(t.minFilter||t.mipmapFilter)&&(e[10241]=XO(t.minFilter||"linear",t.mipmapFilter)),t.lodMinClamp!==void 0&&(e[33082]=t.lodMinClamp),t.lodMaxClamp!==void 0&&(e[33083]=t.lodMaxClamp),t.type==="comparison-sampler"&&(e[34892]=34894),t.compare&&(e[34893]=F0("compare",t.compare)),t.maxAnisotropy&&(e[34046]=t.maxAnisotropy),e}function nd(t){switch(t){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function L0(t){switch(t){case"nearest":return 9728;case"linear":return 9729}}function XO(t,e="none"){if(!e)return L0(t);switch(e){case"none":return L0(t);case"nearest":return t==="nearest"?9984:9986;case"linear":return t==="nearest"?9985:9987}}class U0 extends Au{constructor(n,r){super(n,r);M(this,"device");M(this,"handle");M(this,"parameters");this.device=n,this.parameters=zb(r),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(n){for(const[r,i]of Object.entries(n)){const s=Number(r);switch(s){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,s,i);break;default:this.device.gl.samplerParameteri(this.handle,s,i);break}}}}class Wo extends au{constructor(n,r){super(n,{...an.defaultProps,...r});M(this,"device");M(this,"gl");M(this,"handle");M(this,"texture");this.device=n,this.gl=this.device.gl,this.handle=null,this.texture=r.texture}}const QO="Failed to deduce GL constant from typed array";function YO(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(QO)}}function KO(t,e){const{clamped:n=!0}=e||{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return n?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Vb(t){switch(t){case 6406:case 33326:case 6403:case 36244:return 1;case 33339:case 33340:case 33328:case 33320:case 33319:return 2;case 6407:case 36248:case 34837:return 3;case 6408:case 36249:case 34836:return 4;default:return 0}}function qO(t){switch(t){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return 0}}function Tu(t,e,n){if(ZO(e))return n(t);const{nocatch:r=!0}=e,i=Ws.get(t);i.push(),ka(t,e);let s;if(r)s=n(t),i.pop();else try{s=n(t)}finally{i.pop()}return s}function ZO(t){for(const e in t)return!1;return!0}function GO(t,e,n){const{dimension:r,width:i,height:s,depth:o=0}=n,{glInternalFormat:a}=n,f=n.glTarget;switch(r){case"2d-array":case"3d":t.texStorage3D(f,e,a,i,s,o);break;default:t.texStorage2D(f,e,a,i,s)}}function m1(t,e,n,r){const{width:i,height:s}=r,{dimension:o,depth:a=0,mipLevel:f=0}=r,{x:p=0,y:m=0,z:v=0}=r,{glFormat:w,glType:T}=r,E=jb(r.glTarget,o,a),N=r.flipY?{37440:!0}:{};Tu(t,N,()=>{switch(o){case"2d-array":case"3d":t.bindTexture(E,e),t.texSubImage3D(E,f,p,m,v,i,s,a,w,T,n),t.bindTexture(E,null);break;case"2d":case"cube":t.bindTexture(E,e),t.texSubImage2D(E,f,p,m,i,s,w,T,n),t.bindTexture(E,null);break;default:throw new Error(o)}})}function _1(t,e,n){const{dimension:r,width:i,height:s,depth:o=0,mipLevel:a=0,byteOffset:f=0}=n,{x:p=0,y:m=0,z:v=0}=n,{glFormat:w,glType:T,compressed:E}=n,N=jb(n.glTarget,r,o);switch(r){case"2d-array":case"3d":E?t.compressedTexSubImage3D(N,a,p,m,v,i,s,o,w,e,f):t.texSubImage3D(N,a,p,m,v,i,s,o,w,T,e,f);break;case"2d":case"cube":E?t.compressedTexSubImage2D(N,a,p,m,i,s,w,e,f):t.texSubImage2D(N,a,p,m,i,s,w,T,e,f);break;default:throw new Error(r)}}function JO(t){switch(t){case"1d":break;case"2d":return 3553;case"3d":return 32879;case"cube":return 34067;case"2d-array":return 35866}throw new Error(t)}function jb(t,e,n){return e==="cube"?34069+n:t}function e5(t,e){var I;const{sourceX:n=0,sourceY:r=0,sourceAttachment:i=0}=e||{};let{target:s=null,sourceWidth:o,sourceHeight:a,sourceDepth:f,sourceFormat:p,sourceType:m}=e||{};const{framebuffer:v,deleteFramebuffer:w}=Wb(t),{gl:T,handle:E}=v;o||(o=v.width),a||(a=v.height);const N=(I=v.colorAttachments[i])==null?void 0:I.texture;if(!N)throw new Error(`Invalid framebuffer attachment ${i}`);f=(N==null?void 0:N.depth)||1,p||(p=(N==null?void 0:N.glFormat)||6408),m||(m=(N==null?void 0:N.glType)||5121),s=r5(s,m,p,o,a),m=m||YO(s);const j=T.bindFramebuffer(36160,E);return T.readBuffer(36064+i),T.readPixels(n,r,o,a,p,m,s),T.readBuffer(36064),T.bindFramebuffer(36160,j||null),w&&v.destroy(),s}function t5(t,e){const{target:n,sourceX:r=0,sourceY:i=0,sourceFormat:s=6408,targetByteOffset:o=0}=e||{};let{sourceWidth:a,sourceHeight:f,sourceType:p}=e||{};const{framebuffer:m,deleteFramebuffer:v}=Wb(t);a=a||m.width,f=f||m.height;const w=m;p=p||5121;let T=n;if(!T){const N=Vb(s),j=qO(p),I=o+a*f*N*j;T=w.device.createBuffer({byteLength:I})}const E=t.device.createCommandEncoder();return E.copyTextureToBuffer({sourceTexture:t,width:a,height:f,origin:[r,i],destinationBuffer:T,byteOffset:o}),E.destroy(),v&&m.destroy(),T}function Wb(t){return t instanceof cu?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:n5(t),deleteFramebuffer:!0}}function n5(t,e){const{device:n,width:r,height:i,id:s}=t;return n.createFramebuffer({...e,id:`framebuffer-for-${s}`,width:r,height:i,colorAttachments:[t]})}function r5(t,e,n,r,i,s){if(t)return t;e||(e=5121);const o=KO(e,{clamped:!1}),a=Vb(n);return new o(r*i*a)}class Cl extends an{constructor(n,r){super(n,r);M(this,"device");M(this,"gl");M(this,"handle");M(this,"sampler");M(this,"view");M(this,"mipmaps");M(this,"compressed");M(this,"glTarget");M(this,"glFormat");M(this,"glType");M(this,"glInternalFormat");M(this,"textureUnit",0);const i={...this.props};i.data=r.data,this.device=n,this.gl=this.device.gl,this.glTarget=JO(this.props.dimension);const s=Fb(this.props.format);this.glInternalFormat=s.internalFormat,this.glFormat=s.format,this.glType=s.type,this.compressed=s.compressed,this.mipmaps=!!this.props.mipmaps,this._initialize(i),Object.seal(this)}_initialize(n){this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,{...this.props,data:n.data});let{width:r,height:i}=n;if(!r||!i){const s=an.getTextureDataSize(n.data);r=(s==null?void 0:s.width)||1,i=(s==null?void 0:s.height)||1}if(this.width=r,this.height=i,this.depth=n.depth,this.setSampler(n.sampler),this.view=new Wo(this.device,{...this.props,texture:this}),this.bind(),GO(this.gl,this.mipLevels,this),n.data)switch(n.dimension){case"1d":this.setTexture1DData(n.data);break;case"2d":this.setTexture2DData(n.data);break;case"3d":this.setTexture3DData(n.data);break;case"cube":this.setTextureCubeData(n.data);break;case"2d-array":this.setTextureArrayData(n.data);break;case"cube-array":this.setTextureCubeArrayData(n.data);break;default:throw new Error(n.dimension)}this.mipmaps&&this.generateMipmap()}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}createView(n){return new Wo(this.device,{...n,texture:this})}setSampler(n={}){let r;n instanceof U0?(this.sampler=n,r=n.props):(this.sampler=new U0(this.device,n),r=n);const i=zb(r);this._setSamplerParameters(i)}generateMipmap(n){if(!(!(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format))&&(xe.warn(`${this} is not renderable or filterable, may not be able to generate mipmaps`)(),!(n!=null&&n.force))))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(i){xe.warn(`Error generating mipmap for ${this}: ${i.message}`)()}finally{this.gl.bindTexture(this.glTarget,null)}}copyExternalImage(n){const r=an.getExternalImageSize(n.image),i={...an.defaultCopyExternalImageOptions,...r,...n},{image:s,depth:o,mipLevel:a,x:f,y:p,z:m,flipY:v}=i;let{width:w,height:T}=i;const{dimension:E,glTarget:N,glFormat:j,glInternalFormat:I,glType:R}=this;if(w=Math.min(w,this.width-f),T=Math.min(T,this.height-p),n.sourceX||n.sourceY)throw new Error("WebGL does not support sourceX/sourceY)");return m1(this.device.gl,this.handle,s,{dimension:E,mipLevel:a,x:f,y:p,z:m,width:w,height:T,depth:o,glFormat:j,glType:R,glTarget:N,flipY:v}),{width:i.width,height:i.height}}setTexture1DData(n){throw new Error("setTexture1DData not supported in WebGL.")}setTexture2DData(n,r=0){this.bind();const i=an.normalizeTextureData(n,this);i.length>1&&this.props.mipmaps!==!1&&xe.warn(`Texture ${this.id} mipmap and multiple LODs.`)();for(let s=0;s<i.length;s++){const o=i[s];this._setMipLevel(r,s,o)}this.unbind()}setTexture3DData(n){if(this.props.dimension!=="3d")throw new Error(this.id);ArrayBuffer.isView(n)&&(this.bind(),_1(this.device.gl,n,this),this.unbind())}setTextureCubeData(n,r=0){if(this.props.dimension!=="cube")throw new Error(this.id);for(const i of an.CubeFaces)this.setTextureCubeFaceData(n[i],i)}setTextureArrayData(n){throw this.props.dimension!=="2d-array"?new Error(this.id):new Error("setTextureArrayData not implemented.")}setTextureCubeArrayData(n){throw new Error("setTextureCubeArrayData not supported in WebGL2.")}setTextureCubeFaceData(n,r,i=0){Array.isArray(n)&&n.length>1&&this.props.mipmaps!==!1&&xe.warn(`${this.id} has mipmap and multiple LODs.`)();const s=an.CubeFaces.indexOf(r);this.setTexture2DData(n,s)}update(){throw new Error("Texture.update() not implemented. Use ExternalTexture")}setImageDataForFace(n){const{face:r,width:i,height:s,pixels:o,data:a,format:f=6408,type:p=5121}=n,{gl:m}=this,v=o||a;this.bind(),v instanceof Promise?v.then(w=>this.setImageDataForFace(Object.assign({},n,{face:r,data:w,pixels:w}))):this.width||this.height?m.texImage2D(r,0,f,i,s,0,f,p,v):m.texImage2D(r,0,f,f,p,v)}_getImageDataMap(n){for(let r=0;r<an.CubeFaces.length;++r){const i=an.CubeFaces[r];n[i]&&(n[34069+r]=n[i],delete n[i])}return n}_setSamplerParameters(n){xe.log(1,`${this.id} sampler parameters`,this.device.getGLKeys(n))(),this.gl.bindTexture(this.glTarget,this.handle);for(const[r,i]of Object.entries(n)){const s=Number(r),o=i;switch(s){case 33082:case 33083:this.gl.texParameterf(this.glTarget,s,o);break;case 10241:this.gl.texParameteri(this.glTarget,s,o);break;case 10242:case 10243:this.gl.texParameteri(this.glTarget,s,o);break;case 34046:this.device.features.has("texture-filterable-anisotropic-webgl")&&this.gl.texParameteri(this.glTarget,s,o);break;default:this.gl.texParameteri(this.glTarget,s,o);break}}this.gl.bindTexture(this.glTarget,null)}_setMipLevel(n,r,i,s=this.glTarget){if(an.isExternalImage(i)){m1(this.device.gl,this.handle,i,{...this,depth:n,mipLevel:r,glTarget:s,flipY:this.props.flipY});return}if(an.isTextureLevelData(i)){_1(this.device.gl,i.data,{...this,depth:n,mipLevel:r,glTarget:s});return}throw new Error("Texture: invalid image data")}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(n){const{gl:r}=this;return n!==void 0&&(this.textureUnit=n,r.activeTexture(33984+n)),r.bindTexture(this.glTarget,this.handle),n}unbind(n){const{gl:r}=this;return n!==void 0&&(this.textureUnit=n,r.activeTexture(33984+n)),r.bindTexture(this.glTarget,null),n}}const i5=[1,2,4,8];class s5 extends d0{constructor(n,r){var o;super(n,r);M(this,"device");M(this,"glParameters");this.device=n;let i;if(!((o=r==null?void 0:r.parameters)!=null&&o.viewport))if(r!=null&&r.framebuffer){const{width:a,height:f}=r.framebuffer;i=[0,0,a,f]}else{const[a,f]=n.getCanvasContext().getDrawingBufferSize();i=[0,0,a,f]}this.device.pushState(),this.setParameters({viewport:i,...this.props.parameters});const s=this.props.framebuffer;if(s!=null&&s.handle)if(this.props.framebuffer){const a=this.props.framebuffer.colorAttachments.map((f,p)=>36064+p);this.device.gl.drawBuffers(a)}else this.device.gl.drawBuffers([1029]);this.clear()}end(){this.device.popState()}pushDebugGroup(n){}popDebugGroup(){}insertDebugMarker(n){}setParameters(n={}){const r={...this.glParameters};r.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(r.depthMask=!this.props.depthReadOnly),r.stencilMask=this.props.stencilReadOnly?0:1,r[35977]=this.props.discard,n.viewport&&(n.viewport.length>=6?(r.viewport=n.viewport.slice(0,4),r.depthRange=[n.viewport[4],n.viewport[5]]):r.viewport=n.viewport),n.scissorRect&&(r.scissorTest=!0,r.scissor=n.scissorRect),n.blendConstant&&(r.blendColor=n.blendConstant),n.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),n[2967]=n.stencilReference),n.colorMask&&(r.colorMask=i5.map(i=>!!(i&n.colorMask))),this.glParameters=r,ka(this.device.gl,r)}beginOcclusionQuery(n){const r=this.props.occlusionQuerySet;r==null||r.beginOcclusionQuery()}endOcclusionQuery(){const n=this.props.occlusionQuerySet;n==null||n.endOcclusionQuery()}clear(){const n={...this.glParameters};let r=0;this.props.clearColors&&this.props.clearColors.forEach((i,s)=>{i&&this.clearColorBuffer(s,i)}),this.props.clearColor!==!1&&this.props.clearColors===void 0&&(r|=16384,n.clearColor=this.props.clearColor),this.props.clearDepth!==!1&&(r|=256,n.clearDepth=this.props.clearDepth),this.props.clearStencil!==!1&&(r|=1024,n.clearStencil=this.props.clearStencil),r!==0&&Tu(this.device.gl,n,()=>{this.device.gl.clear(r)})}clearColorBuffer(n=0,r=[0,0,0,0]){Tu(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(r.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(6144,n,r);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(6144,n,r);break;case Float32Array:this.device.gl.clearBufferfv(6144,n,r);break;default:throw new Error("clearColorBuffer: color must be typed array")}})}}function o5(t){return a5.includes(t)}const a5=[35678,35680,35679,35682,36289,36292,36293,36298,36299,36300,36303,36306,36307,36308,36311],$b={5126:[5126,1,"float","f32","float32"],35664:[5126,2,"vec2","vec2<f32>","float32x2"],35665:[5126,3,"vec3","vec3<f32>","float32x3"],35666:[5126,4,"vec4","vec4<f32>","float32x4"],5124:[5124,1,"int","i32","sint32"],35667:[5124,2,"ivec2","vec2<i32>","sint32x2"],35668:[5124,3,"ivec3","vec3<i32>","sint32x3"],35669:[5124,4,"ivec4","vec4<i32>","sint32x4"],5125:[5125,1,"uint","u32","uint32"],36294:[5125,2,"uvec2","vec2<u32>","uint32x2"],36295:[5125,3,"uvec3","vec3<u32>","uint32x3"],36296:[5125,4,"uvec4","vec4<u32>","uint32x4"],35670:[5126,1,"bool","f32","float32"],35671:[5126,2,"bvec2","vec2<f32>","float32x2"],35672:[5126,3,"bvec3","vec3<f32>","float32x3"],35673:[5126,4,"bvec4","vec4<f32>","float32x4"],35674:[5126,8,"mat2","mat2x2<f32>"],35685:[5126,8,"mat2x3","mat2x3<f32>"],35686:[5126,8,"mat2x4","mat2x4<f32>"],35687:[5126,12,"mat3x2","mat3x2<f32>"],35675:[5126,12,"mat3","mat3x3<f32>"],35688:[5126,12,"mat3x4","mat3x4<f32>"],35689:[5126,16,"mat4x2","mat4x2<f32>"],35690:[5126,16,"mat4x3","mat4x3<f32>"],35676:[5126,16,"mat4","mat4x4<f32>"]};function Hb(t){const e=$b[t];if(!e)throw new Error("uniform");const[n,r,,i]=e;return{format:i,components:r,glType:n}}function l5(t){const e=$b[t];if(!e)throw new Error("attribute");const[,n,,r,i]=e;return{attributeType:r,vertexFormat:i,components:n}}function A5(t,e){const n={attributes:[],bindings:[]};n.attributes=c5(t,e);const r=h5(t,e);for(const a of r){const f=a.uniforms.map(p=>({name:p.name,format:p.format,byteOffset:p.byteOffset,byteStride:p.byteStride,arrayLength:p.arrayLength}));n.bindings.push({type:"uniform",name:a.name,group:0,location:a.location,visibility:(a.vertex?1:0)&(a.fragment?2:0),minBindingSize:a.byteLength,uniforms:f})}const i=f5(t,e);let s=0;for(const a of i)if(o5(a.type)){const{viewDimension:f,sampleType:p}=p5(a.type);n.bindings.push({type:"texture",name:a.name,group:0,location:s,viewDimension:f,sampleType:p}),a.textureUnit=s,s+=1}i.length&&(n.uniforms=i);const o=u5(t,e);return o!=null&&o.length&&(n.varyings=o),n}function c5(t,e){const n=[],r=t.getProgramParameter(e,35721);for(let i=0;i<r;i++){const s=t.getActiveAttrib(e,i);if(!s)throw new Error("activeInfo");const{name:o,type:a}=s,f=t.getAttribLocation(e,o);if(f>=0){const{attributeType:p}=l5(a),m=/instance/i.test(o)?"instance":"vertex";n.push({name:o,location:f,stepMode:m,type:p})}}return n.sort((i,s)=>i.location-s.location),n}function u5(t,e){const n=[],r=t.getProgramParameter(e,35971);for(let i=0;i<r;i++){const s=t.getTransformFeedbackVarying(e,i);if(!s)throw new Error("activeInfo");const{name:o,type:a,size:f}=s,{glType:p,components:m}=Hb(a),v={location:i,name:o,type:p,size:f*m};n.push(v)}return n.sort((i,s)=>i.location-s.location),n}function f5(t,e){const n=[],r=t.getProgramParameter(e,35718);for(let i=0;i<r;i++){const s=t.getActiveUniform(e,i);if(!s)throw new Error("activeInfo");const{name:o,size:a,type:f}=s,{name:p,isArray:m}=g5(o);let v=t.getUniformLocation(e,p);const w={location:v,name:p,size:a,type:f,isArray:m};if(n.push(w),w.size>1)for(let T=0;T<w.size;T++){const E=`${p}[${T}]`;v=t.getUniformLocation(e,E);const N={...w,name:E,location:v};n.push(N)}}return n}function h5(t,e){const n=(s,o)=>t.getActiveUniformBlockParameter(e,s,o),r=[],i=t.getProgramParameter(e,35382);for(let s=0;s<i;s++){const o={name:t.getActiveUniformBlockName(e,s)||"",location:n(s,35391),byteLength:n(s,35392),vertex:n(s,35396),fragment:n(s,35398),uniformCount:n(s,35394),uniforms:[]},a=n(s,35395)||[],f=t.getActiveUniforms(e,a,35383),p=t.getActiveUniforms(e,a,35384),m=t.getActiveUniforms(e,a,35387),v=t.getActiveUniforms(e,a,35388);for(let w=0;w<o.uniformCount;++w){const T=t.getActiveUniform(e,a[w]);if(!T)throw new Error("activeInfo");o.uniforms.push({name:T.name,format:Hb(f[w]).format,type:f[w],arrayLength:p[w],byteOffset:m[w],byteStride:v[w]})}r.push(o)}return r.sort((s,o)=>s.location-o.location),r}const d5={35678:["2d","float"],35680:["cube","float"],35679:["3d","float"],35682:["3d","depth"],36289:["2d-array","float"],36292:["2d-array","depth"],36293:["cube","float"],36298:["2d","sint"],36299:["3d","sint"],36300:["cube","sint"],36303:["2d-array","uint"],36306:["2d","uint"],36307:["3d","uint"],36308:["cube","uint"],36311:["2d-array","uint"]};function p5(t){const e=d5[t];if(!e)throw new Error("sampler");const[n,r]=e;return{viewDimension:n,sampleType:r}}function g5(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const n=/([^[]*)(\[[0-9]+\])?/.exec(t);if(!n||n.length<2)throw new Error(`Failed to parse GLSL uniform name ${t}`);return{name:n[1],length:n[2]?1:0,isArray:!!n[2]}}function m5(t,e,n,r){const i=t;let s=r;s===!0&&(s=1),s===!1&&(s=0);const o=typeof s=="number"?[s]:s;switch(n){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof r!="number")throw new Error("samplers must be set to integers");return t.uniform1i(e,r);case 5126:return t.uniform1fv(e,o);case 35664:return t.uniform2fv(e,o);case 35665:return t.uniform3fv(e,o);case 35666:return t.uniform4fv(e,o);case 5124:return t.uniform1iv(e,o);case 35667:return t.uniform2iv(e,o);case 35668:return t.uniform3iv(e,o);case 35669:return t.uniform4iv(e,o);case 35670:return t.uniform1iv(e,o);case 35671:return t.uniform2iv(e,o);case 35672:return t.uniform3iv(e,o);case 35673:return t.uniform4iv(e,o);case 5125:return i.uniform1uiv(e,o,1);case 36294:return i.uniform2uiv(e,o,2);case 36295:return i.uniform3uiv(e,o,3);case 36296:return i.uniform4uiv(e,o,4);case 35674:return t.uniformMatrix2fv(e,!1,o);case 35675:return t.uniformMatrix3fv(e,!1,o);case 35676:return t.uniformMatrix4fv(e,!1,o);case 35685:return i.uniformMatrix2x3fv(e,!1,o);case 35686:return i.uniformMatrix2x4fv(e,!1,o);case 35687:return i.uniformMatrix3x2fv(e,!1,o);case 35688:return i.uniformMatrix3x4fv(e,!1,o);case 35689:return i.uniformMatrix4x2fv(e,!1,o);case 35690:return i.uniformMatrix4x3fv(e,!1,o)}throw new Error("Illegal uniform")}function _5(t){return Eb(t)!==null||typeof t=="number"||typeof t=="boolean"}function y5(t){const e={bindings:{},uniforms:{}};return Object.keys(t).forEach(n=>{const r=t[n];_5(r)?e.uniforms[n]=r:e.bindings[n]=r}),e}function v5(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"triangle-list":return 4;case"triangle-strip":return 5;default:throw new Error(t)}}function w5(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 1;case"triangle-list":return 4;case"triangle-strip":return 4;default:throw new Error(t)}}const y1=4;class b5 extends ca{constructor(n,r){super(n,r);M(this,"device");M(this,"handle");M(this,"vs");M(this,"fs");M(this,"introspectedLayout");M(this,"uniforms",{});M(this,"bindings",{});M(this,"varyings",null);M(this,"_uniformCount",0);M(this,"_uniformSetters",{});this.device=n,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=r.vs,this.fs=r.fs;const{varyings:i,bufferMode:s=35981}=r;i&&i.length>0&&(this.varyings=i,this.device.gl.transformFeedbackVaryings(this.handle,i,s)),this._linkShaders(),xe.time(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=A5(this.device.gl,this.handle),xe.timeEnd(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=x5(this.introspectedLayout,r.shaderLayout)}destroy(){this.handle&&(this.device.gl.deleteProgram(this.handle),this.destroyed=!0)}setBindings(n,r){for(const[i,s]of Object.entries(n)){const o=this.shaderLayout.bindings.find(a=>a.name===i)||this.shaderLayout.bindings.find(a=>a.name===`${i}Uniforms`);if(!o){const a=this.shaderLayout.bindings.map(f=>`"${f.name}"`).join(", ");r!=null&&r.disableWarnings||xe.warn(`No binding "${i}" in render pipeline "${this.id}", expected one of ${a}`,s)();continue}switch(s||xe.warn(`Unsetting binding "${i}" in render pipeline "${this.id}"`)(),o.type){case"uniform":if(!(s instanceof Sl)&&!(s.buffer instanceof Sl))throw new Error("buffer value");break;case"texture":if(!(s instanceof Wo||s instanceof Cl||s instanceof El))throw new Error("texture value");break;case"sampler":xe.warn(`Ignoring sampler ${i}`)();break;default:throw new Error(o.type)}this.bindings[i]=s}}draw(n){var j;const{renderPass:r,parameters:i=this.props.parameters,topology:s=this.props.topology,vertexArray:o,vertexCount:a,instanceCount:f,isInstanced:p=!1,firstVertex:m=0,transformFeedback:v}=n,w=v5(s),T=!!o.indexBuffer,E=(j=o.indexBuffer)==null?void 0:j.glIndexType;if(this.linkStatus!=="success")return xe.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable())return xe.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;this.device.gl.useProgram(this.handle),o.bindBeforeRender(r),v&&v.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const N=r;return VO(this.device,i,N.glParameters,()=>{T&&p?this.device.gl.drawElementsInstanced(w,a||0,E,m,f||0):T?this.device.gl.drawElements(w,a||0,E,m):p?this.device.gl.drawArraysInstanced(w,m,a||0,f||0):this.device.gl.drawArrays(w,m,a||0),v&&v.end()}),o.unbindAfterRender(r),!0}setUniformsWebGL(n){const{bindings:r}=y5(n);Object.keys(r).forEach(i=>{xe.warn(`Unsupported value "${JSON.stringify(r[i])}" used in setUniforms() for key ${i}. Use setBindings() instead?`)()}),Object.assign(this.uniforms,n)}async _linkShaders(){const{gl:n}=this.device;if(n.attachShader(this.handle,this.vs.handle),n.attachShader(this.handle,this.fs.handle),xe.time(y1,`linkProgram for ${this.id}`)(),n.linkProgram(this.handle),xe.timeEnd(y1,`linkProgram for ${this.id}`)(),xe.level,!this.device.features.has("compilation-status-async-webgl")){const i=this._getLinkStatus();this._reportLinkStatus(i);return}xe.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),xe.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const r=this._getLinkStatus();this._reportLinkStatus(r)}async _reportLinkStatus(n){var r;switch(n){case"success":return;default:switch(this.vs.compilationStatus){case"error":throw this.vs.debugShader(),new Error(`Error during compilation of shader ${this.vs.id}`);case"pending":this.vs.asyncCompilationStatus.then(()=>this.vs.debugShader());break}switch((r=this.fs)==null?void 0:r.compilationStatus){case"error":throw this.fs.debugShader(),new Error(`Error during compilation of shader ${this.fs.id}`);case"pending":this.fs.asyncCompilationStatus.then(()=>this.fs.debugShader());break}const i=this.device.gl.getProgramInfoLog(this.handle);throw new Error(`Error during ${n}: ${i}`)}}_getLinkStatus(){const{gl:n}=this.device;return n.getProgramParameter(this.handle,35714)?(n.validateProgram(this.handle),n.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation")):(this.linkStatus="error","linking")}async _waitForLinkComplete(){const n=async s=>await new Promise(o=>setTimeout(o,s));if(!this.device.features.has("compilation-status-async-webgl")){await n(10);return}const{gl:i}=this.device;for(;;){if(i.getProgramParameter(this.handle,37297))return;await n(10)}}_areTexturesRenderable(){let n=!0;for(const r of this.shaderLayout.bindings)!this.bindings[r.name]&&!this.bindings[r.name.replace(/Uniforms$/,"")]&&(xe.warn(`Binding ${r.name} not found in ${this.id}`)(),n=!1);return n}_applyBindings(){if(this.linkStatus!=="success")return;const{gl:n}=this.device;n.useProgram(this.handle);let r=0,i=0;for(const s of this.shaderLayout.bindings){const o=this.bindings[s.name]||this.bindings[s.name.replace(/Uniforms$/,"")];if(!o)throw new Error(`No value for binding ${s.name} in ${this.id}`);switch(s.type){case"uniform":const{name:a}=s,f=n.getUniformBlockIndex(this.handle,a);if(f===4294967295)throw new Error(`Invalid uniform block name ${a}`);n.uniformBlockBinding(this.handle,i,f),o instanceof Sl?n.bindBufferBase(35345,i,o.handle):n.bindBufferRange(35345,i,o.buffer.handle,o.offset||0,o.size||o.buffer.byteLength-o.offset),i+=1;break;case"texture":if(!(o instanceof Wo||o instanceof Cl||o instanceof El))throw new Error("texture");let p;if(o instanceof Wo)p=o.texture;else if(o instanceof Cl)p=o;else if(o instanceof El&&o.colorAttachments[0]instanceof Wo)xe.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),p=o.colorAttachments[0].texture;else throw new Error("No texture");n.activeTexture(33984+r),n.bindTexture(p.glTarget,p.handle),r+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${s.type}' not supported in WebGL`)}}}_applyUniforms(){for(const n of this.shaderLayout.uniforms||[]){const{name:r,location:i,type:s,textureUnit:o}=n,a=this.uniforms[r]??o;a!==void 0&&m5(this.device.gl,i,s,a)}}}function x5(t,e){const n={...t,attributes:t.attributes.map(r=>({...r}))};for(const r of(e==null?void 0:e.attributes)||[]){const i=n.attributes.find(s=>s.name===r.name);i?(i.type=r.type||i.type,i.stepMode=r.stepMode||i.stepMode):xe.warn(`shader layout attribute ${r.name} not present in shader`)}return n}class T5 extends g0{constructor(n){super(n,{});M(this,"device");M(this,"commands",[]);this.device=n}submitCommands(n=this.commands){for(const r of n)switch(r.name){case"copy-buffer-to-buffer":E5(this.device,r.options);break;case"copy-buffer-to-texture":S5(this.device,r.options);break;case"copy-texture-to-buffer":C5(this.device,r.options);break;case"copy-texture-to-texture":k5(this.device,r.options);break;default:throw new Error(r.name)}}}function E5(t,e){const n=e.sourceBuffer,r=e.destinationBuffer;t.gl.bindBuffer(36662,n.handle),t.gl.bindBuffer(36663,r.handle),t.gl.copyBufferSubData(36662,36663,e.sourceOffset??0,e.destinationOffset??0,e.size),t.gl.bindBuffer(36662,null),t.gl.bindBuffer(36663,null)}function S5(t,e){throw new Error("Not implemented")}function C5(t,e){const{sourceTexture:n,mipLevel:r=0,aspect:i="all",width:s=e.sourceTexture.width,height:o=e.sourceTexture.height,depthOrArrayLayers:a=0,origin:f=[0,0],destinationBuffer:p,byteOffset:m=0,bytesPerRow:v,rowsPerImage:w}=e;if(i!=="all")throw new Error("aspect not supported in WebGL");if(r!==0||a!==0||v||w)throw new Error("not implemented");const{framebuffer:T,destroyFramebuffer:E}=Xb(n);let N;try{const j=p,I=s||T.width,R=o||T.height,k=Fb(T.colorAttachments[0].texture.props.format),B=k.format,Y=k.type;t.gl.bindBuffer(35051,j.handle),N=t.gl.bindFramebuffer(36160,T.handle),t.gl.readPixels(f[0],f[1],I,R,B,Y,m)}finally{t.gl.bindBuffer(35051,null),N!==void 0&&t.gl.bindFramebuffer(36160,N),E&&T.destroy()}}function k5(t,e){const{sourceTexture:n,destinationMipLevel:r=0,origin:i=[0,0],destinationOrigin:s=[0,0],destinationTexture:o}=e;let{width:a=e.destinationTexture.width,height:f=e.destinationTexture.height}=e;const{framebuffer:p,destroyFramebuffer:m}=Xb(n),[v,w]=i,[T,E,N]=s,j=t.gl.bindFramebuffer(36160,p.handle);let I=null,R;if(o instanceof Cl)I=o,a=Number.isFinite(a)?a:I.width,f=Number.isFinite(f)?f:I.height,I.bind(0),R=I.glTarget;else throw new Error("invalid destination");switch(R){case 3553:case 34067:t.gl.copyTexSubImage2D(R,r,T,E,v,w,a,f);break;case 35866:case 32879:t.gl.copyTexSubImage3D(R,r,T,E,N,v,w,a,f);break}I&&I.unbind(),t.gl.bindFramebuffer(36160,j),m&&p.destroy()}function Xb(t){if(t instanceof an){const{width:e,height:n,id:r}=t;return{framebuffer:t.device.createFramebuffer({id:`framebuffer-for-${r}`,width:e,height:n,colorAttachments:[t]}),destroyFramebuffer:!0}}return{framebuffer:t,destroyFramebuffer:!1}}class P5 extends p0{constructor(n,r){super(n,r);M(this,"device");M(this,"commandBuffer");this.device=n,this.commandBuffer=new T5(n)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer(n){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:n})}copyBufferToTexture(n){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:n})}copyTextureToBuffer(n){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:n})}copyTextureToTexture(n){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:n})}pushDebugGroup(n){}popDebugGroup(){}insertDebugMarker(n){}resolveQuerySet(n,r,i){}}function R5(t){const{target:e,source:n,start:r=0,count:i=1}=t,s=n.length,o=i*s;let a=0;for(let f=r;a<s;a++)e[f++]=n[a];for(;a<o;)a<o-a?(e.copyWithin(r+a,r,r+a),a*=2):(e.copyWithin(r+a,r,r+o-a),a=o);return t.target}class Sg extends m0{constructor(n,r){super(n,r);M(this,"device");M(this,"handle");M(this,"buffer",null);M(this,"bufferValue",null);this.device=n,this.handle=this.device.gl.createVertexArray()}get[Symbol.toStringTag](){return"VertexArray"}static isConstantAttributeZeroSupported(n){return iC()==="Chrome"}destroy(){var n;super.destroy(),this.buffer&&((n=this.buffer)==null||n.destroy()),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(n){const r=n;if(r&&r.glTarget!==34963)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,r?r.handle:null),this.indexBuffer=r,this.device.gl.bindVertexArray(null)}setBuffer(n,r){const i=r;if(i.glTarget===34963)throw new Error("Use .setIndexBuffer()");const{size:s,type:o,stride:a,offset:f,normalized:p,integer:m,divisor:v}=this._getAccessor(n);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,i.handle),m?this.device.gl.vertexAttribIPointer(n,s,o,a,f):this.device.gl.vertexAttribPointer(n,s,o,p,a,f),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(n),this.device.gl.vertexAttribDivisor(n,v||0),this.attributes[n]=i,this.device.gl.bindVertexArray(null)}setConstantWebGL(n,r){this._enable(n,!1),this.attributes[n]=r}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let n=0;n<this.maxVertexAttributes;++n){const r=this.attributes[n];ArrayBuffer.isView(r)&&this.device.setConstantAttributeWebGL(n,r)}}_getAccessor(n){const r=this.attributeInfos[n];if(!r)throw new Error(`Unknown attribute location ${n}`);const i=Bb(r.bufferDataType);return{size:r.bufferComponents,type:i,stride:r.byteStride,offset:r.byteOffset,normalized:r.normalized,integer:r.integer,divisor:r.stepMode==="instance"?1:0}}_enable(n,r=!0){const s=Sg.isConstantAttributeZeroSupported(this.device)||n!==0;(r||s)&&(n=Number(n),this.device.gl.bindVertexArray(this.handle),r?this.device.gl.enableVertexAttribArray(n):this.device.gl.disableVertexAttribArray(n),this.device.gl.bindVertexArray(null))}getConstantBuffer(n,r){const i=I5(r),s=i.byteLength*n,o=i.length*n;if(this.buffer&&s!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${s} !== ${this.buffer.byteLength}.`);let a=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:s}),a=a||!M5(i,this.bufferValue),a){const f=$R(r.constructor,o);R5({target:f,source:i,start:0,count:o}),this.buffer.write(f),this.bufferValue=r}return this.buffer}}function I5(t){return Array.isArray(t)?new Float32Array(t):t}function M5(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}class N5 extends _0{constructor(n,r){super(n,r);M(this,"device");M(this,"gl");M(this,"handle");M(this,"layout");M(this,"buffers",{});M(this,"unusedBuffers",{});M(this,"bindOnUse",!0);M(this,"_bound",!1);this.device=n,this.gl=n.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,r.buffers&&this.setBuffers(r.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(n="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(w5(n))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(n){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(const r in n)this.setBuffer(r,n[r])})}setBuffer(n,r){const i=this._getVaryingIndex(n),{buffer:s,byteLength:o,byteOffset:a}=this._getBufferRange(r);if(i<0){this.unusedBuffers[n]=s,xe.warn(`${this.id} unusedBuffers varying buffer ${n}`)();return}this.buffers[i]={buffer:s,byteLength:o,byteOffset:a},this.bindOnUse||this._bindBuffer(i,s,a,o)}getBuffer(n){if(v1(n))return this.buffers[n]||null;const r=this._getVaryingIndex(n);return r>=0?this.buffers[r]:null}bind(n=this.handle){if(typeof n!="function")return this.gl.bindTransformFeedback(36386,n),this;let r;return this._bound?r=n():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,r=n(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),r}unbind(){this.bind(null)}_getBufferRange(n){if(n instanceof Sl)return{buffer:n,byteOffset:0,byteLength:n.byteLength};const{buffer:r,byteOffset:i=0,byteLength:s=n.buffer.byteLength}=n;return{buffer:r,byteOffset:i,byteLength:s}}_getVaryingIndex(n){if(v1(n))return Number(n);for(const r of this.layout.varyings)if(n===r.name)return r.location;return-1}_bindBuffers(){for(const n in this.buffers){const{buffer:r,byteLength:i,byteOffset:s}=this._getBufferRange(this.buffers[n]);this._bindBuffer(Number(n),r,s,i)}}_unbindBuffers(){for(const n in this.buffers)this.gl.bindBufferBase(35982,Number(n),null)}_bindBuffer(n,r,i=0,s){const o=r&&r.handle;!o||s===void 0?this.gl.bindBufferBase(35982,n,o):this.gl.bindBufferRange(35982,n,o,i,s)}}function v1(t){return typeof t=="number"?Number.isInteger(t):/^\d+$/.test(t)}class O5 extends y0{constructor(n,r){super(n,r);M(this,"device");M(this,"handle");M(this,"target",null);M(this,"_queryPending",!1);M(this,"_pollingPromise",null);if(this.device=n,r.count>1)throw new Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}get[Symbol.toStringTag](){return"Query"}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(n){return this._begin(n!=null&&n.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(n){this._queryPending||(this.target=n,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const n=this.device.gl.getQueryParameter(this.handle,34919);return n&&(this._queryPending=!1),n}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(n=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let r=0;return this._pollingPromise=new Promise((i,s)=>{const o=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):r++>n?(s("Timed out"),this._pollingPromise=null):requestAnimationFrame(o)};requestAnimationFrame(o)}),this._pollingPromise}}class $o extends fs{constructor(n){var v,w;super({...n,id:n.id||BO("webgl-device")});M(this,"type","webgl");M(this,"handle");M(this,"features");M(this,"limits");M(this,"info");M(this,"canvasContext");M(this,"lost");M(this,"_resolveContextLost");M(this,"gl");M(this,"debug",!1);M(this,"_canvasSizeInfo",{clientWidth:0,clientHeight:0,devicePixelRatio:1});M(this,"_extensions",{});M(this,"_polyfilled",!1);M(this,"spectorJS");M(this,"renderPass",null);M(this,"_constants");const r=fs._getCanvasContextProps(n);if(!r)throw new Error("WebGLDevice requires props.createCanvasContext to be set");let i=(w=(v=r.canvas)==null?void 0:v.gl)==null?void 0:w.device;if(i)throw new Error(`WebGL context already attached to device ${i.id}`);this.canvasContext=new EO(this,r),this.lost=new Promise(T=>{this._resolveContextLost=T});const s={...n.webgl};r.alphaMode==="premultiplied"&&(s.premultipliedAlpha=!0),n.powerPreference!==void 0&&(s.powerPreference=n.powerPreference);const a=this.props._handle||sO(this.canvasContext.canvas,{onContextLost:T=>{var E;return(E=this._resolveContextLost)==null?void 0:E.call(this,{reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."})},onContextRestored:T=>console.log("WebGL context restored")},s);if(!a)throw new Error("WebGL context creation failed");if(i=a.device,i){if(n._reuseDevices)return xe.log(1,`Not creating a new Device, instead returning a reference to Device ${i.id} already attached to WebGL context`,i)(),i._reused=!0,i;throw new Error(`WebGL context already attached to device ${i.id}`)}this.handle=a,this.gl=a,this.spectorJS=kO({...this.props,gl:this.handle}),this.gl.device=this,this.gl._version=2,this.info=oO(this.gl,this._extensions),this.limits=new bO(this.gl),this.features=new wO(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures&&this.features.initializeFeatures(),r.autoResize!==!1&&this.canvasContext.resize(),new Ws(this.gl,{log:(...T)=>xe.log(1,...T)()}).trackState(this.gl,{copyState:!1});const p=n.debugWebGL||n.debug,m=n.debugWebGL;p&&(this.gl=IO(this.gl,{debugWebGL:p,traceWebGL:m}),xe.warn("WebGL debug mode activated. Performance reduced.")(),n.debugWebGL&&(xe.level=Math.max(xe.level,1)))}destroy(){!this.props._reuseDevices&&!this._reused&&delete this.gl.device}get isLost(){return this.gl.isContextLost()}createCanvasContext(n){throw new Error("WebGL only supports a single canvas")}createBuffer(n){const r=this._normalizeBufferProps(n);return new Sl(this,r)}createTexture(n){return new Cl(this,n)}createExternalTexture(n){throw new Error("createExternalTexture() not implemented")}createSampler(n){return new U0(this,n)}createShader(n){return new zO(this,n)}createFramebuffer(n){return new El(this,n)}createVertexArray(n){return new Sg(this,n)}createTransformFeedback(n){return new N5(this,n)}createQuerySet(n){return new O5(this,n)}createRenderPipeline(n){return new b5(this,n)}beginRenderPass(n){return new s5(this,n)}createComputePipeline(n){throw new Error("ComputePipeline not supported in WebGL")}beginComputePass(n){throw new Error("ComputePass not supported in WebGL")}createCommandEncoder(n={}){return new P5(this,n)}submit(){var n;(n=this.renderPass)==null||n.end(),this.renderPass=null}readPixelsToArrayWebGL(n,r){return e5(n,r)}readPixelsToBufferWebGL(n,r){return t5(n,r)}setParametersWebGL(n){ka(this.gl,n)}getParametersWebGL(n){return Ob(this.gl,n)}withParametersWebGL(n,r){return Tu(this.gl,n,r)}resetWebGL(){xe.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),eO(this.gl)}_getDeviceSpecificTextureFormatCapabilities(n){return mO(this.gl,n,this._extensions)}loseDevice(){var s;let n=!1;const i=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return i&&(n=!0,i.loseContext()),(s=this._resolveContextLost)==null||s.call(this,{reason:"destroyed",message:"Application triggered context loss"}),n}pushState(){Ws.get(this.gl).push()}popState(){Ws.get(this.gl).pop()}setSpectorMetadata(n,r){n.__SPECTOR_Metadata=r}getGLKey(n,r){const i=Number(n);for(const s in this.gl)if(this.gl[s]===i)return`GL.${s}`;return r!=null&&r.emptyIfUnknown?"":String(n)}getGLKeys(n){const r={emptyIfUnknown:!0};return Object.entries(n).reduce((i,[s,o])=>(i[`${s}:${this.getGLKey(s,r)}`]=`${o}:${this.getGLKey(o,r)}`,i),{})}setConstantAttributeWebGL(n,r){const i=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(i).fill(null);const s=this._constants[n];switch(s&&L5(s,r)&&xe.info(1,`setConstantAttributeWebGL(${n}) could have been skipped, value unchanged`)(),this._constants[n]=r,r.constructor){case Float32Array:D5(this,n,r);break;case Int32Array:B5(this,n,r);break;case Uint32Array:F5(this,n,r);break;default:throw new Error("constant")}}getExtension(n){return va(this.gl,n,this._extensions),this._extensions}}function D5(t,e,n){switch(n.length){case 1:t.gl.vertexAttrib1fv(e,n);break;case 2:t.gl.vertexAttrib2fv(e,n);break;case 3:t.gl.vertexAttrib3fv(e,n);break;case 4:t.gl.vertexAttrib4fv(e,n);break}}function B5(t,e,n){t.gl.vertexAttribI4iv(e,n)}function F5(t,e,n){t.gl.vertexAttribI4uiv(e,n)}function L5(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}const U5={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}},z5=t=>({drawBuffersWEBGL(e){return t.drawBuffers(e)},COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),V5=t=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES(){return t.createVertexArray()},deleteVertexArrayOES(e){return t.deleteVertexArray(e)},isVertexArrayOES(e){return t.isVertexArray(e)},bindVertexArrayOES(e){return t.bindVertexArray(e)}}),j5=t=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE(...e){return t.drawArraysInstanced(...e)},drawElementsInstancedANGLE(...e){return t.drawElementsInstanced(...e)},vertexAttribDivisorANGLE(...e){return t.vertexAttribDivisor(...e)}});function W5(t=!0){const e=HTMLCanvasElement.prototype;if(!t&&e.originalGetContext){e.getContext=e.originalGetContext,e.originalGetContext=void 0;return}e.originalGetContext=e.getContext,e.getContext=function(n,r){if(n==="webgl"||n==="experimental-webgl"){const i=this.originalGetContext("webgl2",r);return i instanceof HTMLElement&&$5(i),i}return this.originalGetContext(n,r)}}function $5(t){t.getExtension("EXT_color_buffer_float");const e={...U5,WEBGL_disjoint_timer_query:t.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:z5(t),OES_vertex_array_object:V5(t),ANGLE_instanced_arrays:j5(t)},n=t.getExtension;t.getExtension=function(i){const s=n.call(t,i);return s||(i in e?e[i]:null)};const r=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=r.apply(t)||[];return i==null?void 0:i.concat(Object.keys(e))}}const JA=1;class H5 extends vR{constructor(){super();M(this,"type","webgl");fs.defaultProps={...fs.defaultProps,...Eg},$o.adapter=this}isSupported(){return typeof WebGL2RenderingContext<"u"}enforceWebGL2(n){W5(n)}async attach(n){if(n instanceof $o)return n;if((n==null?void 0:n.device)instanceof fs)return n.device;if(!X5(n))throw new Error("Invalid WebGL2RenderingContext");return new $o({_handle:n,createCanvasContext:{canvas:n.canvas,autoResize:!1}})}async create(n={}){xe.groupCollapsed(JA,"WebGLDevice created")();const r=[];(n.debugWebGL||n.debug)&&r.push(RO()),n.debugSpectorJS&&r.push(CO(n));const i=await Promise.allSettled(r);for(const a of i)a.status==="rejected"&&xe.error(`Failed to initialize debug libraries ${a.reason}`)();const s=new $o(n),o=`${s._reused?"Reusing":"Created"} device with WebGL2 ${s.debug?"debug ":""}context: ${s.info.vendor}, ${s.info.renderer} for canvas: ${s.canvasContext.id}`;return xe.probe(JA,o)(),xe.table(JA,s.info)(),xe.groupEnd(JA)(),s}}function X5(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}const w1=new H5;function $i(){}const Q5=({isDragging:t})=>t?"grabbing":"grab",Qb={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{},gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:$i,onWebGLInitialized:$i,onResize:$i,onViewStateChange:$i,onInteractionStateChange:$i,onBeforeRender:$i,onAfterRender:$i,onLoad:$i,onError:t=>ut.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:Q5,getTooltip:null,debug:!1,drawPickingColors:!1};class Cg{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new cf({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=r=>{const{_pickRequest:i}=this;if(r.type==="pointerleave")i.x=-1,i.y=-1,i.radius=0;else{if(r.leftButton||r.rightButton)return;{const s=r.offsetCenter;if(!s)return;i.x=s.x,i.y=s.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=r},this._onEvent=r=>{const i=k0[r.type],s=r.offsetCenter;if(!i||!s||!this.layerManager)return;const o=this.layerManager.getLayers(),a=this.deckPicker.getLastPickedObject({x:s.x,y:s.y,layers:o,viewports:this.getViewports(s)},this._lastPointerDownInfo),{layer:f}=a,p=f&&(f[i]||f.props[i]),m=this.props[i];let v=!1;p&&(v=p.call(f,a,r)),v||(m==null||m(a,r),this.widgetManager.onEvent(a,r))},this._onPointerDown=r=>{var o;if(((o=this.device)==null?void 0:o.type)==="webgpu")return;const i=r.offsetCenter,s=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=s.result[0]||s.emptyInfo},this.props={...Qb,...e},e=this.props,e.viewState&&e.initialViewState&&ut.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device&&(this.device=e.device);let n=this.device;!n&&e.gl&&(e.gl instanceof WebGLRenderingContext&&ut.error("WebGL1 context not supported.")(),n=w1.attach(e.gl)),n||(n=f0.createDevice({type:"best-available",_reuseDevices:!0,adapters:[w1],...e.deviceProps,createCanvasContext:{canvas:this._createCanvas(e),useDevicePixels:this.props.useDevicePixels,autoResize:!1}})),this.animationLoop=this._createAnimationLoop(n,e),this.setProps(e),e._typedArrayManagerProps&&ma.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,s,o,a,f,p,m;(e=this.animationLoop)==null||e.stop(),(n=this.animationLoop)==null||n.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,(r=this.layerManager)==null||r.finalize(),this.layerManager=null,(i=this.viewManager)==null||i.finalize(),this.viewManager=null,(s=this.effectManager)==null||s.finalize(),this.effectManager=null,(o=this.deckRenderer)==null||o.finalize(),this.deckRenderer=null,(a=this.deckPicker)==null||a.finalize(),this.deckPicker=null,(f=this.eventManager)==null||f.destroy(),this.eventManager=null,(p=this.widgetManager)==null||p.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas&&((m=this.canvas.parentElement)==null||m.removeChild(this.canvas),this.canvas=null)}setProps(e){var r;this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&ut.removed("onLayerHover","onHover")(),"onLayerClick"in e&&ut.removed("onLayerClick","onClick")(),e.initialViewState&&!Xr(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),(r=this.animationLoop)==null||r.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n),this.widgetManager.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return n=n||r||i||s||o,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return On(this.viewManager),this.viewManager.views}getViewports(e){return On(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){var n;(n=this.layerManager)==null||n.removeDefaultShaderModule(e)}_pick(e,n,r){On(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),On(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){var i;if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const s=Number.isFinite(n)?`${n}px`:n;this.canvas.style.width=s}if(r||r===0){const s=Number.isFinite(r)?`${r}px`:r;this.canvas.style.position=((i=e.style)==null?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var i,s;const{canvas:e}=this;if(!e)return;const n=e.clientWidth??e.width,r=e.clientHeight??e.height;(n!==this.width||r!==this.height)&&(this.width=n,this.height=r,(i=this.viewManager)==null||i.setProps({width:n,height:r}),(s=this.layerManager)==null||s.activateViewport(this.getViewports()[0]),this.props.onResize({width:n,height:r}))}_createAnimationLoop(e,n){const{gl:r,onError:i,useDevicePixels:s}=n;return new qN({device:e,useDevicePixels:s,autoResizeDrawingBuffer:!r,autoResizeViewport:!1,onInitialize:o=>this._setDevice(o.device),onRender:this._onRenderFrame.bind(this),onError:i})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:e}=this.props,n=Array.isArray(e)?e:e?[e]:[new Ib({id:"default-view"})];return n.length&&this.props.controller&&(n[0].props.controller=this.props.controller),n}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){var n,r,i,s;if(((n=this.device)==null?void 0:n.type)==="webgpu")return;const{_pickRequest:e}=this;if(e.event){const{result:o,emptyInfo:a}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=o.length>0;let f=a,p=!1;for(const m of o)f=m,p=((r=m.layer)==null?void 0:r.onHover(m,e.event))||p;p||((s=(i=this.props).onHover)==null||s.call(i,f,e.event),this.widgetManager.onHover(f,e.event)),e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){var i,s;if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=(i=this.device.canvasContext)==null?void 0:i.canvas),this.device.type==="webgl"&&this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device.type==="webgl"&&this.props.onWebGLInitialized(this.device.gl);const n=new Tb;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new M6(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizers:Object.keys(V_).map(o=>{var T;const[a,f,p,m]=V_[o],v=(T=this.props.eventRecognizerOptions)==null?void 0:T[o],w={...f,...v,event:o};return{recognizer:new a(w),recognizeWith:p,requestFailure:m}}),events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const o in k0)this.eventManager.on(o,this._onEvent);this.viewManager=new v8({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new y8(this.device,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new B8({deck:this,device:this.device}),this.deckRenderer=new U8(this.device),this.deckPicker=new H8(this.device),this.widgetManager=new Y8({deck:this,parentElement:(s=this.canvas)==null?void 0:s.parentElement}),this.widgetManager.addDefault(new q8),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){var o;const{device:r,gl:i}=this.layerManager.context;this.props.onBeforeRender({device:r,gl:i});const s={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n};(o=this.deckRenderer)==null||o.renderLayers(s),s.pass==="screen"&&this.widgetManager.onRedraw({viewports:s.viewports,layers:s.layers}),this.props.onAfterRender({device:r,gl:i})}_onRenderFrame(){var e;this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),ut.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),((e=this.device)==null?void 0:e.type)!=="webgpu"&&this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=f0.stats.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}Cg.defaultProps=Qb;Cg.VERSION=EP;function Y5(t){switch(t){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return Sw(t)}}const K5=Ew;function ec(t,e){return{attribute:t,format:e.size>1?`${e.type}x${e.size}`:e.type,byteOffset:e.offset||0}}function Ls(t){return t.stride||t.size*t.bytesPerElement}function q5(t,e){return t.type===e.type&&t.size===e.size&&Ls(t)===Ls(e)&&(t.offset||0)===(e.offset||0)}function z0(t,e){e.offset&&ut.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=Ls(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,s=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function Z5(t,e){const n=z0(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class G5{constructor(e,n,r){this._buffer=null,this.device=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,s=i==="float64";let{defaultValue:o}=n;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0);let a;s?a="float32":!i&&n.isIndexed?a="uint32":a=i||"float32";let f=Y5(i||a);this.doublePrecision=s,s&&n.fp64===!1&&(f=Float32Array),this.value=null,this.settings={...n,defaultType:f,defaultValue:o,logicalType:i,type:a,normalized:a.includes("norm"),size:this.size,bytesPerElement:f.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Ls(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),ma.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(e=this.id,n=null){const r={};if(this.state.constant){const i=this.value;if(n){const s=z0(this.getAccessor(),n),o=s.offset/i.BYTES_PER_ELEMENT,a=s.size||this.size;r[e]=i.subarray(o,o+a)}else r[e]=i}else r[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?r[`${e}64Low`]=r[e]:r[`${e}64Low`]=new Float32Array(this.size)),r}_getBufferLayout(e=this.id,n=null){const r=this.getAccessor(),i=[],s={name:this.id,byteStride:Ls(r),attributes:i};if(this.doublePrecision){const o=Z5(r,n||{});i.push(ec(e,{...r,...o.high}),ec(`${e}64Low`,{...r,...o.low}))}else if(n){const o=z0(r,n);i.push(ec(e,{...r,...o}))}else i.push(ec(e,r));return s}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,s=r*i;if(n&&s&&n.length>=s){const o=new Array(i).fill(1/0),a=new Array(i).fill(-1/0);for(let f=0;f<s;)for(let p=0;p<i;p++){const m=n[f++];m<o[p]&&(o[p]=m),m>a[p]&&(a[p]=m)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof Yt?r={buffer:e}:r=e;const i={...this.settings,...r};if(ArrayBuffer.isView(r.value)){if(!r.type)if(this.doublePrecision&&r.value instanceof Float64Array)i.type="float32";else{const o=K5(r.value);i.type=i.normalized?o.replace("int","norm"):o}i.bytesPerElement=r.value.BYTES_PER_ELEMENT,i.stride=Ls(i)}if(n.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=ArrayBuffer.isView(s)?s:new Float32Array(s)}else if(r.buffer){const s=r.buffer;n.externalBuffer=s,n.constant=!1,this.value=r.value||null}else if(r.value){this._checkExternalBuffer(r);let s=r.value;n.externalBuffer=null,n.constant=!1,this.value=s;let{buffer:o}=this;const a=Ls(i),f=(i.vertexOffset||0)*a;if(this.doublePrecision&&s instanceof Float64Array&&(s=Yh(s,i)),this.settings.isIndexed){const m=this.settings.defaultType;s.constructor!==m&&(s=new m(s))}const p=s.byteLength+f+a*2;(!o||o.byteLength<p)&&(o=this._createBuffer(p)),o.write(s,f)}return this.setAccessor(i),!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.write(this.doublePrecision&&n instanceof Float64Array?Yh(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),r*n.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,s=ma.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{byteOffset:o}=this;let{buffer:a}=this;return(!a||a.byteLength<s.byteLength+o)&&(a=this._createBuffer(s.byteLength+o),n&&i&&a.write(i instanceof Float64Array?Yh(i,this):i,o)),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error(`Attribute ${this.id} value is not TypedArray`);const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error(`Attribute ${this.id} does not support ${n.constructor.name}`);!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&ut.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map(n=>(n+128)/255*2-1);case"snorm16":return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case"unorm8":return new Float32Array(e).map(n=>n/255);case"unorm16":return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let o=s;for(;--o>=0;)n[r+o]=i[o];return n}switch(s){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let o=s;for(;--o>=0;)n[r+o]=Number.isFinite(e[o])?e[o]:i[o]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}_createBuffer(e){var i;this._buffer&&this._buffer.destroy();const{isIndexed:n,type:r}=this.settings;return this._buffer=this.device.createBuffer({...(i=this._buffer)==null?void 0:i.props,id:this.id,usage:(n?Yt.INDEX:Yt.VERTEX)|Yt.COPY_DST,indexType:n?r:void 0,byteLength:e}),this._buffer}}const b1=[],x1=[];function Pa(t,e=0,n=1/0){let r=b1;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(x1.length=t.length,r=x1):r=b1,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function Yb(t){return t&&t[Symbol.asyncIterator]}function Kb(t,e){const{size:n,stride:r,offset:i,startIndices:s,nested:o}=e,a=t.BYTES_PER_ELEMENT,f=r?r/a:n,p=i?i/a:0,m=Math.floor((t.length-p)/f);return(v,{index:w,target:T})=>{if(!s){const I=w*f+p;for(let R=0;R<n;R++)T[R]=t[I+R];return T}const E=s[w],N=s[w+1]||m;let j;if(o){j=new Array(N-E);for(let I=E;I<N;I++){const R=I*f+p;T=new Array(n);for(let k=0;k<n;k++)T[k]=t[R+k];j[I-E]=T}}else if(f===n)j=t.subarray(E*n+p,N*n+p);else{j=new t.constructor((N-E)*n);let I=0;for(let R=E;R<N;R++){const k=R*f+p;for(let B=0;B<n;B++)j[I++]=t[k+B]}}return j}}const J5=[],Tc=[[0,1/0]];function eD(t,e){if(t===Tc||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const o=t[s];o[1]<e[0]?(n.push(o),i=s+1):o[0]>e[1]?n.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return n.splice(i,0,e),n}const tD={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function qb(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...tD[n],...e,...t,type:n}}class Zb extends G5{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:Tc}),this.constant=!1,this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var n;(n=this.state).layoutChanged||(n.layoutChanged=!q5(e,this.getAccessor())),super.setAccessor(e)}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return qb(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=eD(this.state.updateRanges,[r,i])}else this.state.updateRanges=Tc}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=J5}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==Tc),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let f=!0;if(o){for(const[p,m]of s)o.call(i,this,{data:n,startRow:p,endRow:m,props:r,numInstances:e});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[p,m]of s){const v=Number.isFinite(p)?this.getVertexOffset(p):0,w=Number.isFinite(m)?this.getVertexOffset(m):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:v,endOffset:w})}this._checkAttributeArray()}else f=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),f}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;On(ArrayBuffer.isView(o.value),`invalid ${i.accessor}`);const a=!!o.size&&o.size!==this.size;return r.binaryAccessor=Kb(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:n,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getValue(){const e=this.settings.shaderAttributes,n=super.getValue();if(!e)return n;for(const r in e)Object.assign(n,super.getValue(r,e[r]));return n}getBufferLayout(e){this.state.layoutChanged=!1;const n=this.settings.shaderAttributes,r=super._getBufferLayout(),{stepMode:i}=this.settings;if(i==="dynamic"?r.stepMode=e?e.isInstanced?"instance":"vertex":"instance":r.stepMode=i??"vertex",!n)return r;for(const s in n){const o=super._getBufferLayout(s,n[s]);r.attributes.push(...o.attributes)}return r}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:f,value:p,size:m,startIndices:v}=e,{accessor:w,transform:T}=a,E=f.binaryAccessor||(typeof w=="function"?w:s[w]);On(typeof E=="function",`accessor "${w}" is not a function`);let N=e.getVertexOffset(r);const{iterable:j,objectInfo:I}=Pa(n,r,i);for(const R of j){I.index++;let k=E(R,I);if(T&&(k=T.call(this,k)),v){const B=(I.index<v.length-1?v[I.index+1]:o)-v[I.index];if(k&&Array.isArray(k[0])){let Y=N;for(const G of k)e._normalizeValue(G,p,Y),Y+=m}else k&&k.length>m?p.set(k,N):(e._normalizeValue(k,I.target,0),d8({target:p,source:I.target,start:N,count:B}));N+=B*m}else e._normalizeValue(k,p,N),N+=m}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error(`Illegal attribute generated for ${this.id}`)}}}function rd(t){const{source:e,target:n,start:r=0,size:i,getData:s}=t,o=t.end||n.length,a=e.length,f=o-r;if(a>f){n.set(e.subarray(0,f),r);return}if(n.set(e,r),!s)return;let p=a;for(;p<f;){const m=s(p,e);for(let v=0;v<i;v++)n[r+p]=m[v]||0,p++}}function nD({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!i||!s)return rd({source:t,target:e,size:n,getData:r}),e;let o=0,a=0;const f=r&&((m,v)=>r(m+a,v)),p=Math.min(i.length,s.length);for(let m=1;m<p;m++){const v=i[m]*n,w=s[m]*n;rd({source:t.subarray(o,v),target:e,start:a,end:w,size:n,getData:f}),o=v,a=w}return a<e.length&&rd({source:[],target:e,start:a,size:n,getData:f}),e}function rD(t){const{device:e,settings:n,value:r}=t,i=new Zb(e,n);return i.setData({value:r instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:n.normalized}),i}function Gb(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${t}"`)}}function Jb(t){switch(t){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function ex(t){t.push(t.shift())}function iD(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,o=n&&i instanceof Float64Array?2:1;let a=0;const{shaderAttributes:f}=t.settings;if(f)for(const p of Object.values(f))a=Math.max(a,p.vertexOffset??0);return(r.noAlloc?i.length:(e+a)*s)*o}function tx({device:t,source:e,target:n}){return(!n||n.byteLength<e.byteLength)&&(n==null||n.destroy(),n=t.createBuffer({byteLength:e.byteLength,usage:e.usage})),n}function nx({device:t,buffer:e,attribute:n,fromLength:r,toLength:i,fromStartIndices:s,getData:o=a=>a}){const a=n.doublePrecision&&n.value instanceof Float64Array?2:1,f=n.size*a,p=n.byteOffset,m=n.settings.bytesPerElement<4?p/n.settings.bytesPerElement*4:p,v=n.startIndices,w=s&&v,T=n.isConstant;if(!w&&e&&r>=i)return e;const E=n.value instanceof Float64Array?Float32Array:n.value.constructor,N=T?n.value:new E(n.getBuffer().readSyncWebGL(p,i*E.BYTES_PER_ELEMENT).buffer);if(n.settings.normalized&&!T){const k=o;o=(B,Y)=>n.normalizeConstant(k(B,Y))}const j=T?(k,B)=>o(N,B):(k,B)=>o(N.subarray(k+p,k+p+f),B),I=e?new Float32Array(e.readSyncWebGL(m,r*4).buffer):new Float32Array(0),R=new Float32Array(i);return nD({source:I,target:R,sourceStartIndices:s,targetStartIndices:v,size:f,getData:j}),(!e||e.byteLength<R.byteLength+m)&&(e==null||e.destroy(),e=t.createBuffer({byteLength:R.byteLength+m,usage:35050})),e.write(R,m),e}class rx{constructor({device:e,attribute:n,timeline:r}){this.buffers=[],this.currentLength=0,this.device=e,this.transition=new pf(r),this.attribute=n,this.attributeInTransition=rD(n),this.currentStartIndices=n.startIndices}get inProgress(){return this.transition.inProgress}start(e,n,r=1/0){this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=iD(this.attribute,n),this.transition.start({...e,duration:r})}update(){const e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const e of this.buffers)e.destroy();this.buffers.length=0}}class sD extends rx{constructor({device:e,attribute:n,timeline:r}){super({device:e,attribute:n,timeline:r}),this.type="interpolation",this.transform=AD(e,n)}start(e,n){const r=this.currentLength,i=this.currentStartIndices;if(super.start(e,n,e.duration),e.duration<=0){this.transition.cancel();return}const{buffers:s,attribute:o}=this;ex(s),s[0]=nx({device:this.device,buffer:s[0],attribute:o,fromLength:r,toLength:this.currentLength,fromStartIndices:i,getData:e.enter}),s[1]=tx({device:this.device,source:s[0],target:s[1]}),this.setBuffer(s[1]);const{transform:a}=this,f=a.model;let p=Math.floor(this.currentLength/o.size);ix(o)&&(p/=2),f.setVertexCount(p),o.isConstant?(f.setAttributes({aFrom:s[0]}),f.setConstantAttributes({aTo:o.value})):f.setAttributes({aFrom:s[0],aTo:o.getBuffer()}),a.transformFeedback.setBuffers({vCurrent:s[1]})}onUpdate(){const{duration:e,easing:n}=this.settings,{time:r}=this.transition;let i=r/e;n&&(i=n(i));const{model:s}=this.transform,o={time:i};s.shaderInputs.setProps({interpolation:o}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}}const oD=`uniform interpolationUniforms {
  float time;
} interpolation;
`,T1={name:"interpolation",vs:oD,uniformTypes:{time:"f32"}},aD=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, interpolation.time);
  gl_Position = vec4(0.0);
}
`,lD=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aFrom64Low;
in ATTRIBUTE_TYPE aTo;
in ATTRIBUTE_TYPE aTo64Low;
out ATTRIBUTE_TYPE vCurrent;
out ATTRIBUTE_TYPE vCurrent64Low;

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void main(void) {
  for (int i=0; i<ATTRIBUTE_SIZE; i++) {
    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), interpolation.time);
    vCurrent[i] = value.x;
    vCurrent64Low[i] = value.y;
  }
  gl_Position = vec4(0.0);
}
`;function ix(t){return t.doublePrecision&&t.value instanceof Float64Array}function AD(t,e){const n=e.size,r=Gb(n),i=Jb(n),s=e.getBufferLayout();return ix(e)?new ql(t,{vs:lD,bufferLayout:[{name:"aFrom",byteStride:8*n,attributes:[{attribute:"aFrom",format:i,byteOffset:0},{attribute:"aFrom64Low",format:i,byteOffset:4*n}]},{name:"aTo",byteStride:8*n,attributes:[{attribute:"aTo",format:i,byteOffset:0},{attribute:"aTo64Low",format:i,byteOffset:4*n}]}],modules:[EM,T1],defines:{ATTRIBUTE_TYPE:r,ATTRIBUTE_SIZE:n},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0}):new ql(t,{vs:aD,bufferLayout:[{name:"aFrom",format:i},{name:"aTo",format:s.attributes[0].format}],modules:[T1],defines:{ATTRIBUTE_TYPE:r},varyings:["vCurrent"],disableWarnings:!0})}class cD extends rx{constructor({device:e,attribute:n,timeline:r}){super({device:e,attribute:n,timeline:r}),this.type="spring",this.texture=gD(e),this.framebuffer=mD(e,this.texture),this.transform=pD(e,n)}start(e,n){const r=this.currentLength,i=this.currentStartIndices;super.start(e,n);const{buffers:s,attribute:o}=this;for(let f=0;f<2;f++)s[f]=nx({device:this.device,buffer:s[f],attribute:o,fromLength:r,toLength:this.currentLength,fromStartIndices:i,getData:e.enter});s[2]=tx({device:this.device,source:s[0],target:s[2]}),this.setBuffer(s[1]);const{model:a}=this.transform;a.setVertexCount(Math.floor(this.currentLength/o.size)),o.isConstant?a.setConstantAttributes({aTo:o.value}):a.setAttributes({aTo:o.getBuffer()})}onUpdate(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this,s=this.settings;n.model.setAttributes({aPrev:e[0],aCur:e[1]}),n.transformFeedback.setBuffers({vNext:e[2]});const o={stiffness:s.stiffness,damping:s.damping};n.model.shaderInputs.setProps({spring:o}),n.run({framebuffer:r,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),ex(e),this.setBuffer(e[1]),this.device.readPixelsToArrayWebGL(r)[0]>0||i.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}const uD=`uniform springUniforms {
  float damping;
  float stiffness;
} spring;
`,fD={name:"spring",vs:uD,uniformTypes:{damping:"f32",stiffness:"f32"}},hD=`#version 300 es
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

in ATTRIBUTE_TYPE aPrev;
in ATTRIBUTE_TYPE aCur;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vNext;
out float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE force = delta * spring.stiffness;
  ATTRIBUTE_TYPE resistance = velocity * spring.damping;
  return force - resistance + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,dD=`#version 300 es
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

in float vIsTransitioningFlag;

out vec4 fragColor;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  fragColor = vec4(1.0);
}`;function pD(t,e){const n=Gb(e.size),r=Jb(e.size);return new ql(t,{vs:hD,fs:dD,bufferLayout:[{name:"aPrev",format:r},{name:"aCur",format:r},{name:"aTo",format:e.getBufferLayout().attributes[0].format}],varyings:["vNext"],modules:[fD],defines:{ATTRIBUTE_TYPE:n},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}function gD(t){return t.createTexture({data:new Uint8Array(4),format:"rgba8unorm",mipmaps:!1,width:1,height:1})}function mD(t,e){return t.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[e]})}const _D={interpolation:sD,spring:cD};class yD{constructor(e,{id:n,timeline:r}){if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=n,this.device=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],o=s.getTransitionSetting(n);o&&this._updateAttribute(i,s,o)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){i&&this._removeTransition(e);const o=_D[r.type];o?this.transitions[e]=new o({attribute:n,timeline:this.timeline,device:this.device}):(ut.error(`unsupported transition type '${r.type}'`)(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const E1="attributeManager.invalidate",vD="attributeManager.updateStart",wD="attributeManager.updateEnd",bD="attribute.updateStart",xD="attribute.allocate",TD="attribute.updateEnd";class ED{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){this.mergeBoundsMemoized=uA(FN),this.id=n,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new yD(e,{id:`${n}-transitions`,timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);qn(E1,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);qn(E1,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:o={},context:a={}}){let f=!1;qn(vD,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const p in this.attributes){const m=this.attributes[p],v=m.settings.accessor;m.startIndices=r,m.numInstances=n,s[p]&&ut.removed(`props.${p}`,`data.attributes.${p}`)(),m.setExternalBuffer(o[p])||m.setBinaryValue(typeof v=="string"?o[v]:void 0,e.startIndices)||typeof v=="string"&&!o[v]&&m.setConstantValue(s[v])||m.needsUpdate()&&(f=!0,this._updateAttribute({attribute:m,numInstances:n,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||m.needsRedraw()}f&&qn(wD,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(e){const n=e.map(r=>{var i;return(i=this.attributes[r])==null?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in n){const o=n[s];o.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=o)}return i}getBufferLayouts(e){return Object.values(this.getAttributes()).map(n=>n.getBufferLayout(e))}_add(e,n){for(const r in e){const i=e[r],s={...i,id:r,size:i.isIndexed&&1||i.size||1,...n};this.attributes[r]=new Zb(this.device,s)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(o=>{const a=r[o];a&&a.setNeedsUpdate(a.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(qn(bD,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&qn(xD,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,qn(TD,n,r))}}class SD extends pf{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:s}}=this,o=s(e/i);this._value=ha(n,r,o)}}const S1=1e-5;function C1(t,e,n,r,i){const s=e-t,a=(n-e)*i,f=-s*r;return a+f+s+e}function CD(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let o=0;o<n.length;o++)s[o]=C1(t[o],e[o],n[o],r,i);return s}return C1(t,e,n,r,i)}function k1(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class kD extends pf{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=CD(s,o,n,r,i);const f=k1(a,n),p=k1(a,o);f<S1&&p<S1&&(a=n,this.end()),this._prevValue=o,this._currValue=a}}const PD={interpolation:SD,spring:kD};class RD{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:s}=this;if(s.has(e)){const f=s.get(e),{value:p=f.settings.fromValue}=f;n=p,this.remove(e)}if(i=qb(i),!i)return;const o=PD[i.type];if(!o){ut.error(`unsupported transition type '${i.type}'`)();return}const a=new o(this.timeline);a.start({...i,fromValue:n,toValue:r}),s.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function ID(t){const e=t[ds];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error(`Invalid prop ${n}: ${t[n]}`)}}function MD(t,e){const n=sx({newProps:t,oldProps:e,propTypes:t[ds],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=OD(t,e);let i=!1;return r||(i=DD(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:BD(t,e),transitionsChanged:ND(t,e)}}function ND(t,e){if(!t.transitions)return!1;const n={},r=t[ds];let i=!1;for(const s in t.transitions){const o=r[s],a=o&&o.type;(a==="number"||a==="color"||a==="array")&&V0(t[s],e[s],o)&&(n[s]=!0,i=!0)}return i?n:!1}function sx({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null)return`${i} changed shallowly`;if(typeof e!="object"||e===null)return`${i} changed shallowly`;for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return`${i}.${s} added`;const o=V0(t[s],e[s],r[s]);if(o)return`${i}.${s} ${o}`}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return`${i}.${s} dropped`;if(!Object.hasOwnProperty.call(t,s)){const o=V0(t[s],e[s],r[s]);if(o)return`${i}.${s} ${o}`}}return!1}function V0(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function OD(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function DD(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&P1(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&P1(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function BD(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function P1(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},sx({oldProps:i,newProps:r,triggerName:n})}const FD="count(): argument not an object",LD="count(): argument not a container";function UD(t){if(!VD(t))throw new Error(FD);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(zD(t))return Object.keys(t).length;throw new Error(LD)}function zD(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function VD(t){return t!==null&&typeof t=="object"}function R1(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const jD={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},j0={};function WD(t,e,n,r){if(n instanceof an)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={minFilter:"linear",mipmapFilter:n.data.length>1?"nearest":"linear"});const s=e.createTexture({...n,sampler:{...jD,...i,...r},mipmaps:!0});return j0[s.id]=t,s}function $D(t,e){!e||!(e instanceof an)||j0[e.id]===t&&(e.delete(),delete j0[e.id])}const HD={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||W0(t)&&(t.length===3||t.length===4)},equal(t,e,n){return Xr(t,e,1)}},accessor:{validate(t,e){const n=Eu(t);return n==="function"||n===Eu(e.value)},equal(t,e,n){return typeof e=="function"?!0:Xr(t,e,1)}},array:{validate(t,e){return e.optional&&!t||W0(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Xr(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Xr(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{if(!t)return t;const{dataTransform:r}=n.props;return r?r(t):typeof t.shape=="string"&&t.shape.endsWith("-table")&&Array.isArray(t.data)?t.data:t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.device?null:WD(n.id,r.device,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{$D(n.id,t)}}};function XD(t){const e={},n={},r={};for(const[i,s]of Object.entries(t)){const o=s==null?void 0:s.deprecatedFor;if(o)r[i]=Array.isArray(o)?o:[o];else{const a=QD(i,s);e[i]=a,n[i]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function QD(t,e){switch(Eu(e)){case"object":return Ga(t,e);case"array":return Ga(t,{type:"array",value:e,compare:!1});case"boolean":return Ga(t,{type:"boolean",value:e});case"number":return Ga(t,{type:"number",value:e});case"function":return Ga(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Ga(t,e){return"type"in e?{name:t,...HD[e.type],...e}:"value"in e?{name:t,type:Eu(e.value),...e}:{name:t,type:"object",value:e}}function W0(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Eu(t){return W0(t)?"array":t===null?"null":typeof t}function YD(t,e){let n;for(let s=e.length-1;s>=0;s--){const o=e[s];"extensions"in o&&(n=o.extensions)}const r=$0(t.constructor,n),i=Object.create(r);i[xu]=t,i[Js]={},i[ns]={};for(let s=0;s<e.length;++s){const o=e[s];for(const a in o)i[a]=o[a]}return Object.freeze(i),i}const KD="_mergedDefaultProps";function $0(t,e){if(!(t instanceof gf.constructor))return{};let n=KD;if(e)for(const i of e){const s=i.constructor;s&&(n+=`:${s.extensionName||s.name}`)}const r=ox(t,n);return r||(t[n]=qD(t,e||[]))}function qD(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=$0(r),s=ox(t,"defaultProps")||{},o=XD(s),a=Object.assign(Object.create(null),i,o.defaultProps),f=Object.assign(Object.create(null),i==null?void 0:i[ds],o.propTypes),p=Object.assign(Object.create(null),i==null?void 0:i[Gh],o.deprecatedProps);for(const m of e){const v=$0(m.constructor);v&&(Object.assign(a,v),Object.assign(f,v[ds]),Object.assign(p,v[Gh]))}return ZD(a,t),JD(a,f),GD(a,p),a[ds]=f,a[Gh]=p,e.length===0&&!kg(t,"_propTypes")&&(t._propTypes=f),a}function ZD(t,e){const n=tB(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function GD(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i=`${this.id}: ${n}`;for(const s of e[n])kg(this,s)||(this[s]=r);ut.deprecated(i,e[n].join("/"))()}})}function JD(t,e){const n={},r={};for(const i in e){const s=e[i],{name:o,value:a}=s;s.async&&(n[o]=a,r[o]=eB(o))}t[ea]=n,t[Js]={},Object.defineProperties(t,r)}function eB(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||Yb(e)?this[Js][t]=e:this[ns][t]=e},get(){if(this[ns]){if(t in this[ns])return this[ns][t]||this[ea][t];if(t in this[Js]){const e=this[xu]&&this[xu].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[ea][t]}}return this[ea][t]}}}function kg(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ox(t,e){return kg(t,e)&&t[e]}function tB(t){const e=t.componentName;return e||ut.warn(`${t.name}.componentName not specified`)(),e||t.name}let nB=0;class gf{constructor(...e){this.props=YD(this,e),this.id=this.props.id,this.count=nB++}clone(e){const{props:n}=this,r={};for(const i in n[ea])i in n[ns]?r[i]=n[ns][i]:i in n[Js]&&(r[i]=n[Js][i]);return new this.constructor({...n,...r,...e})}}gf.componentName="Component";gf.defaultProps={};const rB=Object.freeze({});class iB{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||rB}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[xu]||this.component;const n=e[ns]||{},r=e[Js]||e,i=e[ea]||{};for(const s in n){const o=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o),n[s]=this.getAsyncProp(s)}for(const s in r){const o=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(Yb(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(s=>{this.component&&(s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],o=0;for await(const a of n){if(!this.component)return;const{dataTransform:f}=this.component.props;f?s=f(a,s):s=s.concat(a),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:o,endRow:s.length}]}),o=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[ds];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class sB extends iB{constructor({attributeManager:e,layer:n}){super(n),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r==null?void 0:r.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,`loading ${e} of ${this.layer}`)}}const oB="layer.changeFlag",aB="layer.initialize",lB="layer.update",AB="layer.finalize",cB="layer.matched",I1=2**24-1,uB=Object.freeze([]),fB=uA(({oldViewport:t,viewport:e})=>t.equals(e));let Ur=new Uint8ClampedArray(0);const hB={data:{type:"data",value:uB,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:o}=n.context;i=i||n.getLoadOptions(),r=r||n.props.loaders,s&&(i={...i,fetch:{...i==null?void 0:i.fetch,signal:s}});let a=o.contains(t);return!a&&!i&&(o.add({resourceId:t,data:ru(t,r),persistent:!1}),a=!0),a?o.subscribe({resourceId:t,onChange:f=>{var p;return(p=n.internalState)==null?void 0:p.reloadAsyncProp(e,f)},consumerId:n.id,requestId:e}):ru(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:bt.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class di extends gf{constructor(){super(...arguments),this.internalState=null,this.lifecycle=So.NO_STATE,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(e){On(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=xb(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,o]=yb(r,n.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,o]}unproject(e){return On(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){On(this.internalState);const r=this.internalState.viewport||this.context.viewport;return WN(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}get isDrawable(){return!0}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setShaderModuleProps(...e){for(const n of this.getModels())n.shaderInputs.setProps(...e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===bt.DEFAULT||e===bt.LNGLAT||e===bt.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){On(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:UD(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())==null?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){e=R1(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const n of this.props.extensions)e=R1(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,s=this.internalState.hasPickingBuffer,o=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(a=>a.getNeedsPickingBuffer.call(this,a));if(s!==o){this.internalState.hasPickingBuffer=o;const{pickingColors:a,instancePickingColors:f}=n.attributes,p=a||f;p&&(o&&p.constant&&(p.constant=!1,n.invalidate(p.id)),!p.value&&!o&&(p.constant=!0,p.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.destroy();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e.renderPass)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i,s,o;n&&(e=new Error(`${n}: ${e.message}`,{cause:e})),(i=(r=this.props).onError)!=null&&i.call(r,e)||(o=(s=this.context)==null?void 0:s.onError)==null||o.call(s,e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)==null?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!fB({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){let n=!1;for(const r in e)e[r].layoutChanged()&&(n=!0);for(const r of this.getModels())this._setModelAttributes(r,e,n)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(Ur.length/4);if(this.internalState.usesPickingColorCache=!0,r<n){n>I1&&ut.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Ur=ma.allocate(Ur,n,{size:4,copy:!0,maxCount:Math.max(n,I1)});const i=Math.floor(Ur.length/4),s=[0,0,0];for(let o=r;o<i;o++)this.encodePickingColor(o,s),Ur[o*4+0]=s[0],Ur[o*4+1]=s[1],Ur[o*4+2]=s[2],Ur[o*4+3]=0}e.value=Ur.subarray(0,n*4)}_setModelAttributes(e,n,r=!1){var a;if(!Object.keys(n).length)return;if(r){const f=this.getAttributeManager();e.setBufferLayout(f.getBufferLayouts(e)),n=f.getAttributes()}const i=((a=e.userData)==null?void 0:a.excludeAttributes)||{},s={},o={};for(const f in n){if(i[f])continue;const p=n[f].getValue();for(const m in p){const v=p[m];v instanceof Yt?n[f].settings.isIndexed?e.setIndexBuffer(v):s[m]=v:v&&(o[m]=v)}}e.setAttributes(s),e.setConstantAttributes(o)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,s=r||i,o=s&&n.attributes&&n.attributes[s.id];if(o&&o.value){const a=o.value,f=this.encodePickingColor(e);for(let p=0;p<n.length;p++){const m=s.getVertexOffset(p);a[m]===f[0]&&a[m+1]===f[1]&&a[m+2]===f[2]&&this._disablePickingIndex(p)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const s=i.getVertexOffset(e),o=i.getVertexOffset(e+1);i.buffer.write(new Uint8Array(o-s),s)}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==Ur.buffer&&(r.value=Ur.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){On(!this.internalState),On(Number.isFinite(this.props.coordinateSystem)),qn(aB,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new sB({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(ut.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new RD(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){qn(cB,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(qn(lB,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,s=r.viewport,o=this._updateUniformTransition();i.propsInTransition=o,r.viewport=i.viewport||s,this.props=o;try{const a=this._getUpdateParams(),f=this.getModels();if(r.device)this.updateState(a);else try{this.updateState(a)}catch{}for(const m of this.props.extensions)m.updateState.call(this,a,m);this.setNeedsRedraw(),this._updateAttributes();const p=this.getModels()[0]!==f[0];this._postUpdate(a,p)}finally{r.viewport=s,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){qn(AB,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({renderPass:e,shaderModuleProps:n=null,uniforms:r={},parameters:i={}}){this._updateAttributeTransition();const s=this.props,o=this.context;this.props=this.internalState.propsInTransition||s;try{n&&this.setShaderModuleProps(n);const{getPolygonOffset:a}=this.props,f=a&&a(r)||[0,0];o.device instanceof $o&&o.device.setParametersWebGL({polygonOffset:f});for(const p of this.getModels())p.device.type==="webgpu"?p.setParameters({...p.parameters,...i}):p.setParameters(i);if(o.device instanceof $o)o.device.withParametersWebGL(i,()=>{const p={renderPass:e,shaderModuleProps:n,uniforms:r,parameters:i,context:o};for(const m of this.props.extensions)m.draw.call(this,p,m);this.draw(p)});else{const p={renderPass:e,shaderModuleProps:n,uniforms:r,parameters:i,context:o};for(const m of this.props.extensions)m.draw.call(this,p,m);this.draw(p)}}finally{this.props=s}}getChangeFlags(){var e;return(e=this.internalState)==null?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const o=e[i],a=n[i];o&&Array.isArray(a)&&(n.dataChanged=Array.isArray(o)?a.concat(o):o,s=!0);default:n[i]||(n[i]=e[i],s=!0)}s&&qn(oB,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){var i;const r=MD(e,n);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged)this.internalState.uniformTransitions.add(s,n[s],e[s],(i=e.transitions)==null?void 0:i[s]);return this.setChangeFlags(r)}validateProps(){ID(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={highlightedObjectColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.highlightColor=r(e)),this.setShaderModuleProps({picking:n}),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new ED(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e,s=this.state.model;s!=null&&s.isInstanced&&s.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:f}=r;if(n||i.autoHighlight!==o||i.highlightedObjectIndex!==a||i.highlightColor!==f){const p={};Array.isArray(f)&&(p.highlightColor=f),(n||i.autoHighlight!==o||a!==i.highlightedObjectIndex)&&(p.highlightedObjectColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setShaderModuleProps({picking:p})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}di.defaultProps=hB;di.layerName="Layer";const dB="compositeLayer.renderLayers";class hA extends di{get isComposite(){return!0}get isDrawable(){return!1}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var ce;const{opacity:n,pickable:r,visible:i,parameters:s,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:f,highlightColor:p,coordinateSystem:m,coordinateOrigin:v,wrapLongitude:w,positionFormat:T,modelMatrix:E,extensions:N,fetch:j,operation:I,_subLayerProps:R}=this.props,k={id:"",updateTriggers:{},opacity:n,pickable:r,visible:i,parameters:s,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:f,highlightColor:p,coordinateSystem:m,coordinateOrigin:v,wrapLongitude:w,positionFormat:T,modelMatrix:E,extensions:N,fetch:j,operation:I},B=R&&e.id&&R[e.id],Y=B&&B.updateTriggers,G=e.id||"sublayer";if(B){const U=this.props[ds],$=e.type?e.type._propTypes:{};for(const K in B){const ue=$[K]||U[K];ue&&ue.type==="accessor"&&(B[K]=this.getSubLayerAccessor(B[K]))}}Object.assign(k,e,B),k.id=`${this.props.id}-${G}`,k.updateTriggers={all:(ce=this.props.updateTriggers)==null?void 0:ce.all,...e.updateTriggers,...Y};for(const U of N){const $=U.getSubLayerProps.call(this,U);$&&Object.assign(k,$,{updateTriggers:Object.assign(k.updateTriggers,$.updateTriggers)})}return k}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const s=this.renderLayers();r=wg(s,Boolean),this.internalState.subLayers=r}qn(dB,this,i,r);for(const s of r)s.parent=this}}hA.layerName="CompositeLayer";class ax{constructor(e){this.indexStarts=[0],this.vertexStarts=[0],this.vertexCount=0,this.instanceCount=0;const{attributes:n={}}=e;this.typedArrayManager=ma,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:r={},getGeometry:i,geometryBuffer:s,positionFormat:o,dataChanged:a,normalize:f=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=s&&s.size||(o==="XY"?2:3),this.buffers=r,this.normalize=f,s&&(On(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),f||(r.vertexPositions=s)),this.geometryBuffer=r.vertexPositions,Array.isArray(a))for(const p of a)this._rebuildGeometry(p);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?Kb(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:r,buffers:i,_attributeDefs:s,typedArrayManager:o}=this;for(const a in s)if(a in i)o.release(r[a]),r[a]=null;else{const f=s[a];f.copy=n,r[a]=o.allocate(r[a],e,f)}}_forEachGeometry(e,n,r){const{data:i,getGeometry:s}=this,{iterable:o,objectInfo:a}=Pa(i,n,r);for(const f of o){a.index++;const p=s?s(f,a):null;e(p,a.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this;const{data:s,geometryBuffer:o}=this,{startRow:a=0,endRow:f=1/0}=e||{},p={};if(e||(n=[0],r=[0]),this.normalize||!o)this._forEachGeometry((v,w)=>{const T=v&&this.normalizeGeometry(v);p[w]=T,r[w+1]=r[w]+(T?this.getGeometrySize(T):0)},a,f),i=r[r.length-1];else if(r=s.startIndices,i=r[s.length]||0,ArrayBuffer.isView(o))i=i||o.length/this.positionSize;else if(o instanceof Yt){const v=this.positionSize*4;i=i||o.byteLength/v}else if(o.buffer){const v=o.stride||this.positionSize*4;i=i||o.buffer.byteLength/v}else if(o.value){const v=o.value,w=o.stride/v.BYTES_PER_ELEMENT||this.positionSize;i=i||v.length/w}this._allocate(i,!!e),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;const m={};this._forEachGeometry((v,w)=>{const T=p[w]||v;m.vertexStart=r[w],m.indexStart=n[w];const E=w<r.length-1?r[w+1]:i;m.geometrySize=E-r[w],m.geometryIndex=w,this.updateGeometryAttributes(T,m)},a,f),this.vertexCount=n[n.length-1]}}const pB=typeof window<"u"?pe.useLayoutEffect:pe.useEffect;function Su(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const gB={position:"absolute",zIndex:-1};function lx(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>lx(n,e));if(mf(t)){if(mB(t))return e.style=gB,pe.cloneElement(t,e);if(_B(t))return pe.cloneElement(t,e)}return t}function mf(t){return t&&typeof t=="object"&&"type"in t||!1}function mB(t){var e;return(e=t.props)==null?void 0:e.mapStyle}function _B(t){const e=t.type;return e&&e.deckGLViewProps}function H0(t){if(typeof t=="function")return pe.createElement(ya,{},t);if(Array.isArray(t))return t.map(H0);if(mf(t)){if(t.type===pe.Fragment)return H0(t.props.children);if(Su(t.type,ya))return t}return t}function yB({children:t,layers:e=[],views:n=null}){const r=[],i=[],s={};return pe.Children.forEach(H0(t),o=>{if(mf(o)){const a=o.type;if(Su(a,di)){const f=vB(a,o.props);i.push(f)}else r.push(o);if(Su(a,ya)&&a!==ya&&o.props.id){const f=new a(o.props);s[f.id]=f}}else o&&r.push(o)}),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach(o=>{s[o.id]=o}):n&&(s[n.id]=n),n=Object.values(s)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function vB(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}const wB=pe.createContext();function bB({children:t,deck:e,ContextProvider:n=wB.Provider}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},s=r.views[0].id;for(const o of t){let a=s,f=o;mf(o)&&Su(o.type,ya)&&(a=o.props.id||s,f=o.props.children);const p=r.getViewport(a),m=r.getViewState(a);if(p){m.padding=p.padding;const{x:v,y:w,width:T,height:E}=p;f=lx(f,{x:v,y:w,width:T,height:E,viewport:p,viewState:m}),i[a]||(i[a]={viewport:p,children:[]}),i[a].children.push(f)}}return Object.keys(i).map(o=>{const{viewport:a,children:f}=i[o],{x:p,y:m,width:v,height:w}=a,T={position:"absolute",left:p,top:m,width:v,height:w},E=`view-${o}`,N=pe.createElement("div",{key:E,id:E,style:T},...f),j={deck:e,viewport:a,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:R=>{R.viewId=o,e._onViewStateChange(R)},widgets:[]},I=`view-${o}-context`;return pe.createElement(n,{key:I,value:j},N)})}const xB={mixBlendMode:null};function TB({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const s in n)s in xB?i[s]=n[s]:r[s]=n[s];return{containerStyle:r,canvasStyle:i}}function EB(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function Ax(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function SB(t,e,n){var i,s,o;const r=new e({...n,_customRender:((o=(s=(i=n.deviceProps)==null?void 0:i.adapters)==null?void 0:s[0])==null?void 0:o.type)==="webgpu"?void 0:a=>{t.redrawReason=a;const f=r.getViewports();t.lastRenderedViewports!==f?t.forceUpdate():Ax(t)}});return r}function CB(t,e){const[n,r]=pe.useState(0),s=pe.useRef({control:null,version:n,forceUpdate:()=>r(Y=>Y+1)}).current,o=pe.useRef(null),a=pe.useRef(null),f=pe.useMemo(()=>yB(t),[t.layers,t.views,t.children]);let p=!0;const m=Y=>{var G;return p&&t.viewState?(s.viewStateUpdateRequested=Y,null):(s.viewStateUpdateRequested=null,(G=t.onViewStateChange)==null?void 0:G.call(t,Y))},v=Y=>{var G;p?s.interactionStateUpdateRequested=Y:(s.interactionStateUpdateRequested=null,(G=t.onInteractionStateChange)==null||G.call(t,Y))},w=pe.useMemo(()=>{const Y={widgets:[],...t,style:null,width:"100%",height:"100%",parent:o.current,canvas:a.current,layers:f.layers,views:f.views,onViewStateChange:m,onInteractionStateChange:v};return delete Y._customRender,s.deck&&s.deck.setProps(Y),Y},[t]);pe.useEffect(()=>{const Y=t.Deck||Cg;return s.deck=SB(s,Y,{...w,parent:o.current,canvas:a.current}),()=>{var G;return(G=s.deck)==null?void 0:G.finalize()}},[]),pB(()=>{Ax(s);const{viewStateUpdateRequested:Y,interactionStateUpdateRequested:G}=s;Y&&m(Y),G&&v(G)}),pe.useImperativeHandle(e,()=>EB(s),[]);const T=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:E,width:N="100%",height:j="100%",id:I,style:R}=t,{containerStyle:k,canvasStyle:B}=pe.useMemo(()=>TB({width:N,height:j,style:R}),[N,j,R]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===T||s.version!==n){s.lastRenderedViewports=T,s.version=n;const Y=bB({children:f.children,deck:s.deck,ContextProvider:E}),G=pe.createElement("canvas",{key:"canvas",id:I||"deckgl-overlay",ref:a,style:B});s.control=pe.createElement("div",{id:`${I||"deckgl"}-wrapper`,ref:o,style:k},[G,Y])}return p=!1,s.control}const kB=pe.forwardRef(CB),PB="modulepreload",RB=function(t){return"/mapviewer-gl/"+t},M1={},IB=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(f=>{if(f=RB(f),f in M1)return;M1[f]=!0;const p=f.endsWith(".css"),m=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${m}`))return;const v=document.createElement("link");if(v.rel=p?"stylesheet":PB,p||(v.as="script"),v.crossOrigin="",v.href=f,a&&v.setAttribute("nonce",a),document.head.appendChild(v),p)return new Promise((w,T)=>{v.addEventListener("load",w),v.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${f}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})},MB=pe.createContext(null);function NB(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===s}function xi(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!xi(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!xi(t[i],e[i]))return!1;return!0}return!1}function OB(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function N1(t,e){if(!t.getProjection)return;const n=t.getProjection(),r=e.getProjection();xi(n,r)||e.setProjection(n)}function O1(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function D1(t,e){const n=e.viewState||e;let r=!1;if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}if(n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),"longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}return r}const DB=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function B1(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const s=e[r.ref];if(s){i=i||Object.assign({},r),delete i.ref;for(const o of DB)o in s&&(i[o]=s[o])}return i||r});return{...t,layers:n}}var F1={};const L1={version:8,sources:{},layers:[]},U1={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},id={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},z1={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},BB=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],FB=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class wa{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const s=this.props[z1[i.type]];s?s(i):i.type==="error"&&console.error(i.error)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const s=this.props[U1[i.type]];s&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),s(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const s=this.props[id[i.type]];s&&s(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=wa.savedMaps.pop();if(!r)return null;const i=r.map,s=i.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);i._container=n;const o=i._resizeObserver;o&&(o.disconnect(),o.observe(n)),r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:a}=e;return a&&(a.bounds?i.fitBounds(a.bounds,{...a.fitBoundsOptions,duration:0}):r._updateViewState(a,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=L1}=n,i={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||LB()||null,container:e,style:B1(r)},s=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),n.gl){const m=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=m,n.gl)}const o=new this._MapClass(i);s.padding&&o.setPadding(s.padding),n.cursor&&(o.getCanvas().style.cursor=n.cursor),this._createShadowTransform(o);const a=o._render;o._render=m=>{this._inRender=!0,a.call(o,m),this._inRender=!1};const f=o._renderTaskQueue.run;o._renderTaskQueue.run=m=>{f.call(o._renderTaskQueue,m),this._onBeforeRepaint()},o.on("render",()=>this._onAfterRepaint());const p=o.fire;o.fire=this._fireEvent.bind(this,p),o.on("resize",()=>{this._renderTransform.resize(o.transform.width,o.transform.height)}),o.on("styledata",()=>{this._updateStyleComponents(this.props,{}),N1(o.transform,this._renderTransform)}),o.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const m in U1)o.on(m,this._onPointerEvent);for(const m in id)o.on(m,this._onCameraEvent);for(const m in z1)o.on(m,this._onEvent);this._map=o}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),wa.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=OB(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:s,pitch:o,bearing:a}=i,f=r.isMoving();f&&(i.cameraElevationReference="sea");const p=D1(i,{...O1(r.transform),...e});if(f&&(i.cameraElevationReference="ground"),p&&n){const m=this._deferredEvents;m.move=!0,m.zoom||(m.zoom=s!==i.zoom),m.rotate||(m.rotate=a!==i.bearing),m.pitch||(m.pitch=o!==i.pitch)}return f||D1(r.transform,e),p}_updateSettings(e,n){const r=this._map;let i=!1;for(const s of BB)if(s in e&&!xi(e[s],n[s])){i=!0;const o=r[`set${s[0].toUpperCase()}${s.slice(1)}`];o==null||o.call(r,e[s])}return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=L1,styleDiffing:i=!0}=e,s={diff:i};return"localIdeographFontFamily"in e&&(s.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(B1(r),s),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.isStyleLoaded()&&("light"in e&&r.setLight&&!xi(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&r.setFog&&!xi(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&r.setTerrain&&!xi(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){var r,i;const s=this._map;let o=!1;for(const a of FB){const f=(r=e[a])!==null&&r!==void 0?r:!0,p=(i=n[a])!==null&&i!==void 0?i:!0;xi(f,p)||(o=!0,f?s[a].enable(f):s[a].disable())}return o}_queryRenderedFeatures(e){const n=this._map,r=n.transform,{interactiveLayerIds:i=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:i.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=r}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const s=e.type,o=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,a=this._queryRenderedFeatures(e.point),f=a.length>0;!f&&o&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=a,f&&!o&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,s=i.transform,o=typeof n=="string"?n:n.type;return o==="move"&&this._updateViewState(this.props,!1),o in id&&(typeof n=="object"&&(n.viewState=O1(s)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=s,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{N1(this._renderTransform,n),e.transform=n}}}wa.savedMaps=[];function LB(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||F1.MapboxAccessToken}catch{}try{t=t||F1.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const UB=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function zB(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:r=>{const i=e.transform;e.transform=t.transform;const s=e.project(r);return e.transform=i,s},unproject:r=>{const i=e.transform;e.transform=t.transform;const s=e.unproject(r);return e.transform=i,s},queryTerrainElevation:(r,i)=>{const s=e.transform;e.transform=t.transform;const o=e.queryTerrainElevation(r,i);return e.transform=s,o},queryRenderedFeatures:(r,i)=>{const s=e.transform;e.transform=t.transform;const o=e.queryRenderedFeatures(r,i);return e.transform=s,o}};for(const r of VB(e))!(r in n)&&!UB.includes(r)&&(n[r]=e[r].bind(e));return n}function VB(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const jB=typeof document<"u"?pe.useLayoutEffect:pe.useEffect,WB=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function $B(t,e){for(const r of WB)r in e&&(t[r]=e[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,r=>{r&&console.error(r)},!0)}const _f=pe.createContext(null);function HB(t,e,n){const r=pe.useContext(MB),[i,s]=pe.useState(null),o=pe.useRef(),{current:a}=pe.useRef({mapLib:null,map:null});pe.useEffect(()=>{const m=t.mapLib;let v=!0,w;return Promise.resolve(m||n).then(T=>{if(!v)return;if(!T)throw new Error("Invalid mapLib");const E="Map"in T?T:T.default;if(!E.Map)throw new Error("Invalid mapLib");if($B(E,t),!E.supported||E.supported(t))t.reuseMaps&&(w=wa.reuse(t,o.current)),w||(w=new wa(E.Map,t,o.current)),a.map=zB(w),a.mapLib=E,s(w),r==null||r.onMapMount(a.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(T=>{const{onError:E}=t;E?E({type:"error",target:null,originalEvent:null,error:T}):console.error(T)}),()=>{v=!1,w&&(r==null||r.onMapUnmount(t.id),t.reuseMaps?w.recycle():w.destroy())}},[]),jB(()=>{i&&i.setProps(t)}),pe.useImperativeHandle(e,()=>a.map,[i]);const f=pe.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),p={height:"100%"};return pe.createElement("div",{id:t.id,ref:o,style:f},i&&pe.createElement(_f.Provider,{value:a},pe.createElement("div",{"mapboxgl-children":"",style:p},t.children)))}const XB=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function lo(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!XB.test(r)?n[r]=`${i}px`:n[r]=i}}function QB(t,e){const{map:n,mapLib:r}=pe.useContext(_f),i=pe.useRef({props:t});i.current.props=t;const s=pe.useMemo(()=>{let N=!1;pe.Children.forEach(t.children,R=>{R&&(N=!0)});const j={...t,element:N?document.createElement("div"):null},I=new r.Marker(j);return I.setLngLat([t.longitude,t.latitude]),I.getElement().addEventListener("click",R=>{var k,B;(B=(k=i.current.props).onClick)===null||B===void 0||B.call(k,{type:"click",target:I,originalEvent:R})}),I.on("dragstart",R=>{var k,B;const Y=R;Y.lngLat=s.getLngLat(),(B=(k=i.current.props).onDragStart)===null||B===void 0||B.call(k,Y)}),I.on("drag",R=>{var k,B;const Y=R;Y.lngLat=s.getLngLat(),(B=(k=i.current.props).onDrag)===null||B===void 0||B.call(k,Y)}),I.on("dragend",R=>{var k,B;const Y=R;Y.lngLat=s.getLngLat(),(B=(k=i.current.props).onDragEnd)===null||B===void 0||B.call(k,Y)}),I},[]);pe.useEffect(()=>(s.addTo(n.getMap()),()=>{s.remove()}),[]);const{longitude:o,latitude:a,offset:f,style:p,draggable:m=!1,popup:v=null,rotation:w=0,rotationAlignment:T="auto",pitchAlignment:E="auto"}=t;return pe.useEffect(()=>{lo(s.getElement(),p)},[p]),pe.useImperativeHandle(e,()=>s,[]),(s.getLngLat().lng!==o||s.getLngLat().lat!==a)&&s.setLngLat([o,a]),f&&!NB(s.getOffset(),f)&&s.setOffset(f),s.isDraggable()!==m&&s.setDraggable(m),s.getRotation()!==w&&s.setRotation(w),s.getRotationAlignment()!==T&&s.setRotationAlignment(T),s.getPitchAlignment()!==E&&s.setPitchAlignment(E),s.getPopup()!==v&&s.setPopup(v),qp.createPortal(t.children,s.getElement())}pe.memo(pe.forwardRef(QB));function V1(t){return new Set(t?t.trim().split(/\s+/):[])}function YB(t,e){const{map:n,mapLib:r}=pe.useContext(_f),i=pe.useMemo(()=>document.createElement("div"),[]),s=pe.useRef({props:t});s.current.props=t;const o=pe.useMemo(()=>{const a={...t},f=new r.Popup(a);return f.setLngLat([t.longitude,t.latitude]),f.once("open",p=>{var m,v;(v=(m=s.current.props).onOpen)===null||v===void 0||v.call(m,p)}),f},[]);if(pe.useEffect(()=>{const a=f=>{var p,m;(m=(p=s.current.props).onClose)===null||m===void 0||m.call(p,f)};return o.on("close",a),o.setDOMContent(i).addTo(n.getMap()),()=>{o.off("close",a),o.isOpen()&&o.remove()}},[]),pe.useEffect(()=>{lo(o.getElement(),t.style)},[t.style]),pe.useImperativeHandle(e,()=>o,[]),o.isOpen()&&((o.getLngLat().lng!==t.longitude||o.getLngLat().lat!==t.latitude)&&o.setLngLat([t.longitude,t.latitude]),t.offset&&!xi(o.options.offset,t.offset)&&o.setOffset(t.offset),(o.options.anchor!==t.anchor||o.options.maxWidth!==t.maxWidth)&&(o.options.anchor=t.anchor,o.setMaxWidth(t.maxWidth)),o.options.className!==t.className)){const a=V1(o.options.className),f=V1(t.className);for(const p of a)f.has(p)||o.removeClassName(p);for(const p of f)a.has(p)||o.addClassName(p);o.options.className=t.className}return qp.createPortal(t.children,i)}pe.memo(pe.forwardRef(YB));function dA(t,e,n,r){const i=pe.useContext(_f),s=pe.useMemo(()=>t(i),[]);return pe.useEffect(()=>{const o=e,a=null,f=typeof e=="function"?e:null,{map:p}=i;return p.hasControl(s)||(p.addControl(s,o==null?void 0:o.position),a&&a(i)),()=>{f&&f(i),p.hasControl(s)&&p.removeControl(s)}},[]),s}function KB(t){const e=dA(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return pe.useEffect(()=>{lo(e._container,t.style)},[t.style]),null}pe.memo(KB);function qB(t){const e=dA(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return pe.useEffect(()=>{lo(e._controlContainer,t.style)},[t.style]),null}pe.memo(qB);function ZB(t,e){const n=pe.useRef({props:t}),r=dA(({mapLib:i})=>{const s=new i.GeolocateControl(t),o=s._setupUI;return s._setupUI=a=>{s._container.hasChildNodes()||o(a)},s.on("geolocate",a=>{var f,p;(p=(f=n.current.props).onGeolocate)===null||p===void 0||p.call(f,a)}),s.on("error",a=>{var f,p;(p=(f=n.current.props).onError)===null||p===void 0||p.call(f,a)}),s.on("outofmaxbounds",a=>{var f,p;(p=(f=n.current.props).onOutOfMaxBounds)===null||p===void 0||p.call(f,a)}),s.on("trackuserlocationstart",a=>{var f,p;(p=(f=n.current.props).onTrackUserLocationStart)===null||p===void 0||p.call(f,a)}),s.on("trackuserlocationend",a=>{var f,p;(p=(f=n.current.props).onTrackUserLocationEnd)===null||p===void 0||p.call(f,a)}),s},{position:t.position});return n.current.props=t,pe.useImperativeHandle(e,()=>r,[]),pe.useEffect(()=>{lo(r._container,t.style)},[t.style]),null}pe.memo(pe.forwardRef(ZB));function GB(t){const e=dA(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return pe.useEffect(()=>{lo(e._container,t.style)},[t.style]),null}pe.memo(GB);function JB(t){const e=dA(({mapLib:s})=>new s.ScaleControl(t),{position:t.position}),n=pe.useRef(t),r=n.current;n.current=t;const{style:i}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),pe.useEffect(()=>{lo(e._container,i)},[i]),null}pe.memo(JB);const eF=IB(()=>import("./maplibre-gl-CJtKx_S0.js").then(t=>t.m),[]),tF=pe.forwardRef(function(e,n){return HB(e,n,eF)}),j1=`uniform iconUniforms {
  float sizeScale;
  vec2 iconsTextureDim;
  float sizeMinPixels;
  float sizeMaxPixels;
  bool billboard;
  highp int sizeUnits;
  float alphaCutoff;
} icon;
`,nF={name:"icon",vs:j1,fs:j1,uniformTypes:{sizeScale:"f32",iconsTextureDim:"vec2<f32>",sizeMinPixels:"f32",sizeMaxPixels:"f32",billboard:"f32",sizeUnits:"i32",alphaCutoff:"f32"}},rF=`#version 300 es
#define SHADER_NAME icon-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceSizes;
in float instanceAngles;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec4 instanceIconFrames;
in float instanceColorModes;
in vec2 instanceOffsets;
in vec2 instancePixelOffset;
out float vColorMode;
out vec4 vColor;
out vec2 vTextureCoords;
out vec2 uv;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = angle * PI / 180.0;
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vec2 iconSize = instanceIconFrames.zw;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * icon.sizeScale, icon.sizeUnits),
icon.sizeMinPixels, icon.sizeMaxPixels
);
float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
pixelOffset += instancePixelOffset;
pixelOffset.y *= -1.0;
if (icon.billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vTextureCoords = mix(
instanceIconFrames.xy,
instanceIconFrames.xy + iconSize,
(positions.xy + 1.0) / 2.0
) / icon.iconsTextureDim;
vColor = instanceColors;
DECKGL_FILTER_COLOR(vColor, geometry);
vColorMode = instanceColorModes;
}
`,iF=`#version 300 es
#define SHADER_NAME icon-layer-fragment-shader
precision highp float;
uniform sampler2D iconsTexture;
in float vColorMode;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
vec4 texColor = texture(iconsTexture, vTextureCoords);
vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
float a = texColor.a * layer.opacity * vColor.a;
if (a < icon.alphaCutoff) {
discard;
}
fragColor = vec4(color, a);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,sF=1024,oF=4,W1=()=>{},$1={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},aF={x:0,y:0,width:0,height:0};function lF(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function AF(t,e,n,r){const i=Math.min(n/e.width,r/e.height),s=Math.floor(e.width*i),o=Math.floor(e.height*i);return i===1?{image:e,width:s,height:o}:(t.canvas.height=o,t.canvas.width=s,t.clearRect(0,0,s,o),t.drawImage(e,0,0,e.width,e.height,0,0,s,o),{image:t.canvas,width:s,height:o})}function Zl(t){return t&&(t.id||t.url)}function cF(t,e,n,r){const{width:i,height:s,device:o}=t,a=o.createTexture({format:"rgba8unorm",width:e,height:n,sampler:r,mipmaps:!0}),f=o.createCommandEncoder();return f.copyTextureToTexture({sourceTexture:t,destinationTexture:a,width:i,height:s}),f.finish(),t.destroy(),a}function H1(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:s}=e[r],o=Zl(i);t[o]={...i,x:s,y:n}}}function uF({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:s=0,canvasWidth:o}){let a=[];for(let f=0;f<t.length;f++){const p=t[f],m=Zl(p);if(!n[m]){const{height:v,width:w}=p;r+w+e>o&&(H1(n,a,i),r=0,i=s+i+e,s=0,a=[]),a.push({icon:p,xOffset:r}),r=r+w+e,s=Math.max(s,v)}}return a.length>0&&H1(n,a,i),{mapping:n,rowHeight:s,xOffset:r,yOffset:i,canvasWidth:o,canvasHeight:lF(s+i+e)}}function fF(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:s}=Pa(t);for(const o of i){s.index++;const a=e(o,s),f=Zl(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!r[f]&&(!n[f]||a.url!==n[f].url)&&(r[f]={...a,source:o,sourceIndex:s.index})}return r}class hF{constructor(e,{onUpdate:n=W1,onError:r=W1}){this._loadOptions=null,this._texture=null,this._externalTexture=null,this._mapping={},this._samplerParameters=null,this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=oF,this._canvasWidth=sF,this._canvasHeight=0,this._canvas=null,this.device=e,this.onUpdate=n,this.onError=r}finalize(){var e;(e=this._texture)==null||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?Zl(e):e;return this._mapping[n]||aF}setProps({loadOptions:e,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:s}){var o;e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),i&&(this._mapping=i),r&&((o=this._texture)==null||o.delete(),this._texture=null,this._externalTexture=r),s&&(this._samplerParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const r=Object.values(fF(e,n,this._mapping)||{});if(r.length>0){const{mapping:i,xOffset:s,yOffset:o,rowHeight:a,canvasHeight:f}=uF({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=i,this._xOffset=s,this._yOffset=o,this._canvasHeight=f,this._texture||(this._texture=this.device.createTexture({format:"rgba8unorm",width:this._canvasWidth,height:this._canvasHeight,sampler:this._samplerParameters||$1,mipmaps:!0})),this._texture.height!==this._canvasHeight&&(this._texture=cF(this._texture,this._canvasWidth,this._canvasHeight,this._samplerParameters||$1)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(r)}}_loadIcons(e){const n=this._canvas.getContext("2d",{willReadFrequently:!0});for(const r of e)this._pendingCount++,ru(r.url,this._loadOptions).then(i=>{var E;const s=Zl(r),o=this._mapping[s],{x:a,y:f,width:p,height:m}=o,{image:v,width:w,height:T}=AF(n,i,p,m);(E=this._texture)==null||E.copyExternalImage({image:v,x:a+(p-w)/2,y:f+(m-T)/2,width:w,height:T}),o.width=w,o.height=T,this._texture.generateMipmap(),this.onUpdate()}).catch(i=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}}const cx=[0,0,0,255],dF={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:cx},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0,value:null}};class yf extends di{getShaders(){return super.getShaders({vs:rF,fs:iF,modules:[Sa,Ca,nF]})}initializeState(){this.state={iconManager:new hF(this.context.device,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:"uint8",accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:cx},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){var T;super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:f,getIcon:p,textureParameters:m}=n,{iconManager:v}=this.state;if(typeof o=="string")return;const w=o||this.internalState.isAsyncPropLoading("iconAtlas");v.setProps({loadOptions:n.loadOptions,autoPacking:!w,iconAtlas:o,iconMapping:w?a:null,textureParameters:m}),w?r.iconMapping!==n.iconMapping&&s.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&v.packIcons(f,p),i.extensionsChanged&&((T=this.state.model)==null||T.destroy(),this.state.model=this._getModel(),s.invalidateAll())}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:s,billboard:o,alphaCutoff:a}=this.props,{iconManager:f}=this.state,p=f.getTexture();if(p){const m=this.state.model,v={iconsTexture:p,iconsTextureDim:[p.width,p.height],sizeUnits:Ii[s],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,billboard:o,alphaCutoff:a};m.shaderInputs.setProps({icon:v}),m.draw(this.context.renderPass)}}_getModel(){const e=[-1,-1,1,-1,-1,1,1,1];return new yr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Gs({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array(e)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var r;const n=(r=this.getCurrentLayer())==null?void 0:r.props.onIconError;n?n(e):ut.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:r,anchorX:i=n/2,anchorY:s=r/2}=this.state.iconManager.getIconMapping(e);return[n/2-i,r/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:r,width:i,height:s}=this.state.iconManager.getIconMapping(e);return[n,r,i,s]}}yf.defaultProps=dF;yf.layerName="IconLayer";const X1=`uniform scatterplotUniforms {
  float radiusScale;
  float radiusMinPixels;
  float radiusMaxPixels;
  float lineWidthScale;
  float lineWidthMinPixels;
  float lineWidthMaxPixels;
  float stroked;
  float filled;
  bool antialiasing;
  bool billboard;
  highp int radiusUnits;
  highp int lineWidthUnits;
} scatterplot;
`,pF={name:"scatterplot",vs:X1,fs:X1,uniformTypes:{radiusScale:"f32",radiusMinPixels:"f32",radiusMaxPixels:"f32",lineWidthScale:"f32",lineWidthMinPixels:"f32",lineWidthMaxPixels:"f32",stroked:"f32",filled:"f32",antialiasing:"f32",billboard:"f32",radiusUnits:"i32",lineWidthUnits:"i32"}},gF=`#version 300 es
#define SHADER_NAME scatterplot-layer-vertex-shader
in vec3 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceRadius;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
out vec4 vFillColor;
out vec4 vLineColor;
out vec2 unitPosition;
out float innerUnitRadius;
out float outerRadiusPixels;
void main(void) {
geometry.worldPosition = instancePositions;
outerRadiusPixels = clamp(
project_size_to_pixel(scatterplot.radiusScale * instanceRadius, scatterplot.radiusUnits),
scatterplot.radiusMinPixels, scatterplot.radiusMaxPixels
);
float lineWidthPixels = clamp(
project_size_to_pixel(scatterplot.lineWidthScale * instanceLineWidths, scatterplot.lineWidthUnits),
scatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels
);
outerRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;
float edgePadding = scatterplot.antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
unitPosition = edgePadding * positions.xy;
geometry.uv = unitPosition;
geometry.pickingColor = instancePickingColors;
innerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / outerRadiusPixels;
if (scatterplot.billboard) {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = edgePadding * positions * outerRadiusPixels;
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,mF=`#version 300 es
#define SHADER_NAME scatterplot-layer-fragment-shader
precision highp float;
in vec4 vFillColor;
in vec4 vLineColor;
in vec2 unitPosition;
in float innerUnitRadius;
in float outerRadiusPixels;
out vec4 fragColor;
void main(void) {
geometry.uv = unitPosition;
float distToCenter = length(unitPosition) * outerRadiusPixels;
float inCircle = scatterplot.antialiasing ?
smoothedge(distToCenter, outerRadiusPixels) :
step(distToCenter, outerRadiusPixels);
if (inCircle == 0.0) {
discard;
}
if (scatterplot.stroked > 0.5) {
float isLine = scatterplot.antialiasing ?
smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
step(innerUnitRadius * outerRadiusPixels, distToCenter);
if (scatterplot.filled > 0.5) {
fragColor = mix(vFillColor, vLineColor, isLine);
} else {
if (isLine == 0.0) {
discard;
}
fragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
}
} else if (scatterplot.filled < 0.5) {
discard;
} else {
fragColor = vFillColor;
}
fragColor.a *= inCircle;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,Q1=[0,0,0,255],_F={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:Q1},getLineColor:{type:"accessor",value:Q1},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class vf extends di{getShaders(){return super.getShaders({vs:gF,fs:mF,modules:[Sa,Ca,pF]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){var n;super.updateState(e),e.changeFlags.extensionsChanged&&((n=this.state.model)==null||n.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,stroked:o,filled:a,billboard:f,antialiasing:p,lineWidthUnits:m,lineWidthScale:v,lineWidthMinPixels:w,lineWidthMaxPixels:T}=this.props,E={stroked:o,filled:a,billboard:f,antialiasing:p,radiusUnits:Ii[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,lineWidthUnits:Ii[m],lineWidthScale:v,lineWidthMinPixels:w,lineWidthMaxPixels:T},N=this.state.model;N.shaderInputs.setProps({scatterplot:E}),N.draw(this.context.renderPass)}_getModel(){const e=[-1,-1,0,1,-1,0,-1,1,0,1,1,0];return new yr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Gs({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array(e)}}}),isInstanced:!0})}}vf.defaultProps=_F;vf.layerName="ScatterplotLayer";const Pg={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function Rg(t,e,n={}){return yF(t,n)!==e?(wF(t,n),!0):!1}function yF(t,e={}){return Math.sign(vF(t,e))}const Y1={x:0,y:1,z:2};function vF(t,e={}){const{start:n=0,end:r=t.length,plane:i="xy"}=e,s=e.size||2;let o=0;const a=Y1[i[0]],f=Y1[i[1]];for(let p=n,m=r-s;p<r;p+=s)o+=(t[p+a]-t[m+a])*(t[p+f]+t[m+f]),m=p;return o/2}function wF(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,s=(r-n)/i,o=Math.floor(s/2);for(let a=0;a<o;++a){const f=n+a*i,p=n+(s-1-a)*i;for(let m=0;m<i;++m){const v=t[f+m];t[f+m]=t[p+m],t[p+m]=v}}}function Qr(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let s=0;s<n;s++)if(t[r-n+s]!==e[s]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function X0(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function Gl(t,e,n,r,i=[]){const s=r+e*n;for(let o=0;o<n;o++)i[o]=t[s+o];return i}function Q0(t,e,n,r,i=[]){let s,o;if(n&8)s=(r[3]-t[1])/(e[1]-t[1]),o=3;else if(n&4)s=(r[1]-t[1])/(e[1]-t[1]),o=1;else if(n&2)s=(r[2]-t[0])/(e[0]-t[0]),o=2;else if(n&1)s=(r[0]-t[0])/(e[0]-t[0]),o=0;else return null;for(let a=0;a<t.length;a++)i[a]=(o&1)===a?r[o]:s*(e[a]-t[a])+t[a];return i}function Ec(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function ux(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:s=[0,0],startIndex:o=0,endIndex:a=t.length}=e||{},f=(a-o)/n;let p=[];const m=[p],v=Gl(t,0,n,o);let w,T;const E=hx(v,i,s,[]),N=[];Qr(p,v);for(let j=1;j<f;j++){for(w=Gl(t,j,n,o,w),T=Ec(w,E);T;){Q0(v,w,T,E,N);const I=Ec(N,E);I&&(Q0(v,N,I,E,N),T=I),Qr(p,N),X0(v,N),xF(E,i,T),r&&p.length>n&&(p=[],m.push(p),Qr(p,v)),T=Ec(w,E)}Qr(p,w),X0(v,w)}return r?m:m[0]}const K1=0,bF=1;function fx(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:s=[0,0],edgeTypes:o=!1}=n||{},a=[],f=[{pos:t,types:o?new Array(t.length/r).fill(bF):null,holes:e||[]}],p=[[],[]];let m=[];for(;f.length;){const{pos:v,types:w,holes:T}=f.shift();TF(v,r,T[0]||v.length,p),m=hx(p[0],i,s,m);const E=Ec(p[1],m);if(E){let N=q1(v,w,r,0,T[0]||v.length,m,E);const j={pos:N[0].pos,types:N[0].types,holes:[]},I={pos:N[1].pos,types:N[1].types,holes:[]};f.push(j,I);for(let R=0;R<T.length;R++)N=q1(v,w,r,T[R],T[R+1]||v.length,m,E),N[0]&&(j.holes.push(j.pos.length),j.pos=tc(j.pos,N[0].pos),o&&(j.types=tc(j.types,N[0].types))),N[1]&&(I.holes.push(I.pos.length),I.pos=tc(I.pos,N[1].pos),o&&(I.types=tc(I.types,N[1].types)))}else{const N={positions:v};o&&(N.edgeTypes=w),T.length&&(N.holeIndices=T),a.push(N)}}return a}function q1(t,e,n,r,i,s,o){const a=(i-r)/n,f=[],p=[],m=[],v=[],w=[];let T,E,N;const j=Gl(t,a-1,n,r);let I=Math.sign(o&8?j[1]-s[3]:j[0]-s[2]),R=e&&e[a-1],k=0,B=0;for(let Y=0;Y<a;Y++)T=Gl(t,Y,n,r,T),E=Math.sign(o&8?T[1]-s[3]:T[0]-s[2]),N=e&&e[r/n+Y],E&&I&&I!==E&&(Q0(j,T,o,s,w),Qr(f,w)&&m.push(R),Qr(p,w)&&v.push(R)),E<=0?(Qr(f,T)&&m.push(N),k-=E):m.length&&(m[m.length-1]=K1),E>=0?(Qr(p,T)&&v.push(N),B+=E):v.length&&(v[v.length-1]=K1),X0(j,T),I=E,R=N;return[k?{pos:f,types:e&&m}:null,B?{pos:p,types:e&&v}:null]}function hx(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],s=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=s,r[2]=i+e,r[3]=s+e,r}function xF(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function TF(t,e,n,r){let i=1/0,s=-1/0,o=1/0,a=-1/0;for(let f=0;f<n;f+=e){const p=t[f],m=t[f+1];i=p<i?p:i,s=p>s?p:s,o=m<o?m:o,a=m>a?m:a}return r[0][0]=i,r[0][1]=o,r[1][0]=s,r[1][1]=a,r}function tc(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}const EF=85.051129;function SF(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:s=!0}=e||{},o=t.slice(r,i);dx(o,n,0,i-r);const a=ux(o,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const f of a)px(f,n);return a}function CF(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:s=!1}=n||{};e=e||[];const o=[],a=[];let f=0,p=0;for(let v=0;v<=e.length;v++){const w=e[v]||t.length,T=p,E=kF(t,r,f,w);for(let N=E;N<w;N++)o[p++]=t[N];for(let N=f;N<E;N++)o[p++]=t[N];dx(o,r,T,p),PF(o,r,T,p,n==null?void 0:n.maxLatitude),f=w,a[v]=p}a.pop();const m=fx(o,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(i)for(const v of m)px(v.positions,r);return m}function kF(t,e,n,r){let i=-1,s=-1;for(let o=n+1;o<r;o+=e){const a=Math.abs(t[o]);a>i&&(i=a,s=o-1)}return s}function PF(t,e,n,r,i=EF){const s=t[n],o=t[r-e];if(Math.abs(s-o)>180){const a=Gl(t,0,e,n);a[0]+=Math.round((o-s)/360)*360,Qr(t,a),a[1]=Math.sign(a[1])*i,Qr(t,a),a[0]=s,Qr(t,a)}}function dx(t,e,n,r){let i=t[0],s;for(let o=n;o<r;o+=e){s=t[o];const a=s-i;(a>180||a<-180)&&(s-=Math.round(a/360)*360),t[o]=i=s}}function px(t,e){let n;const r=t.length/e;for(let s=0;s<r&&(n=t[s*e],(n+180)%360===0);s++);const i=-Math.round(n/360)*360;if(i!==0)for(let s=0;s<r;s++)t[s*e]+=i}class RF extends Gs{constructor(e){const{indices:n,attributes:r}=IF(e);super({...e,indices:n,attributes:r})}}function IF(t){const{radius:e,height:n=1,nradial:r=10}=t;let{vertices:i}=t;i&&(ut.assert(i.length>=r),i=i.flatMap(T=>[T[0],T[1]]),Rg(i,Pg.COUNTER_CLOCKWISE));const s=n>0,o=r+1,a=s?o*3+1:r,f=Math.PI*2/r,p=new Uint16Array(s?r*3*2:0),m=new Float32Array(a*3),v=new Float32Array(a*3);let w=0;if(s){for(let T=0;T<o;T++){const E=T*f,N=T%r,j=Math.sin(E),I=Math.cos(E);for(let R=0;R<2;R++)m[w+0]=i?i[N*2]:I*e,m[w+1]=i?i[N*2+1]:j*e,m[w+2]=(1/2-R)*n,v[w+0]=i?i[N*2]:I,v[w+1]=i?i[N*2+1]:j,w+=3}m[w+0]=m[w-3],m[w+1]=m[w-2],m[w+2]=m[w-1],w+=3}for(let T=s?0:1;T<o;T++){const E=Math.floor(T/2)*Math.sign(.5-T%2),N=E*f,j=(E+r)%r,I=Math.sin(N),R=Math.cos(N);m[w+0]=i?i[j*2]:R*e,m[w+1]=i?i[j*2+1]:I*e,m[w+2]=n/2,v[w+2]=1,w+=3}if(s){let T=0;for(let E=0;E<r;E++)p[T++]=E*2+0,p[T++]=E*2+2,p[T++]=E*2+0,p[T++]=E*2+1,p[T++]=E*2+1,p[T++]=E*2+3}return{indices:p,attributes:{POSITION:{size:3,value:m},NORMAL:{size:3,value:v}}}}const Z1=`uniform columnUniforms {
  float radius;
  float angle;
  vec2 offset;
  bool extruded;
  bool stroked;
  bool isStroke;
  float coverage;
  float elevationScale;
  float edgeDistance;
  float widthScale;
  float widthMinPixels;
  float widthMaxPixels;
  highp int radiusUnits;
  highp int widthUnits;
} column;
`,MF={name:"column",vs:Z1,fs:Z1,uniformTypes:{radius:"f32",angle:"f32",offset:"vec2<f32>",extruded:"f32",stroked:"f32",isStroke:"f32",coverage:"f32",elevationScale:"f32",edgeDistance:"f32",widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",radiusUnits:"i32",widthUnits:"i32"}},NF=`#version 300 es
#define SHADER_NAME column-layer-vertex-shader
in vec3 positions;
in vec3 normals;
in vec3 instancePositions;
in float instanceElevations;
in vec3 instancePositions64Low;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in float instanceStrokeWidths;
in vec3 instancePickingColors;
out vec4 vColor;
#ifdef FLAT_SHADING
out vec3 cameraPosition;
out vec4 position_commonspace;
#endif
void main(void) {
geometry.worldPosition = instancePositions;
vec4 color = column.isStroke ? instanceLineColors : instanceFillColors;
mat2 rotationMatrix = mat2(cos(column.angle), sin(column.angle), -sin(column.angle), cos(column.angle));
float elevation = 0.0;
float strokeOffsetRatio = 1.0;
if (column.extruded) {
elevation = instanceElevations * (positions.z + 1.0) / 2.0 * column.elevationScale;
} else if (column.stroked) {
float widthPixels = clamp(
project_size_to_pixel(instanceStrokeWidths * column.widthScale, column.widthUnits),
column.widthMinPixels, column.widthMaxPixels) / 2.0;
float halfOffset = project_pixel_size(widthPixels) / project_size(column.edgeDistance * column.coverage * column.radius);
if (column.isStroke) {
strokeOffsetRatio -= sign(positions.z) * halfOffset;
} else {
strokeOffsetRatio -= halfOffset;
}
}
float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);
float dotRadius = column.radius * column.coverage * shouldRender;
geometry.pickingColor = instancePickingColors;
vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);
vec3 centroidPosition64Low = instancePositions64Low;
vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + column.offset) * dotRadius;
if (column.radiusUnits == UNIT_METERS) {
offset = project_size(offset);
}
vec3 pos = vec3(offset, 0.);
DECKGL_FILTER_SIZE(pos, geometry);
gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (column.extruded && !column.isStroke) {
#ifdef FLAT_SHADING
cameraPosition = project.cameraPosition;
position_commonspace = geometry.position;
vColor = vec4(color.rgb, color.a * layer.opacity);
#else
vec3 lightColor = lighting_getLightColor(color.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, color.a * layer.opacity);
#endif
} else {
vColor = vec4(color.rgb, color.a * layer.opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,OF=`#version 300 es
#define SHADER_NAME column-layer-fragment-shader
precision highp float;
out vec4 fragColor;
in vec4 vColor;
#ifdef FLAT_SHADING
in vec3 cameraPosition;
in vec4 position_commonspace;
#endif
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
#ifdef FLAT_SHADING
if (column.extruded && !column.isStroke && !bool(picking.isActive)) {
vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
fragColor.rgb = lighting_getLightColor(vColor.rgb, cameraPosition, position_commonspace.xyz, normal);
}
#endif
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,Cu=[0,0,0,255],DF={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,flatShading:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:Cu},getLineColor:{type:"accessor",value:Cu},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class Ig extends di{getShaders(){const e={},{flatShading:n}=this.props;return n&&(e.FLAT_SHADING=1),super.getShaders({vs:NF,fs:OF,defines:e,modules:[Sa,n?ib:gg,Ca,MF]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getFillColor",defaultValue:Cu},instanceLineColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getLineColor",defaultValue:Cu},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(e){var a;super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=i.extensionsChanged||n.flatShading!==r.flatShading;s&&((a=this.state.models)==null||a.forEach(f=>f.destroy()),this.setState(this._getModels()),this.getAttributeManager().invalidateAll());const o=this.getNumInstances();this.state.fillModel.setInstanceCount(o),this.state.wireframeModel.setInstanceCount(o),(s||n.diskResolution!==r.diskResolution||n.vertices!==r.vertices||(n.extruded||n.stroked)!==(r.extruded||r.stroked))&&this._updateGeometry(n)}getGeometry(e,n,r){const i=new RF({radius:1,height:r?2:0,vertices:n,nradial:e});let s=0;if(n)for(let o=0;o<e;o++){const a=n[o],f=Math.sqrt(a[0]*a[0]+a[1]*a[1]);s+=f/e}else s=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*s}),i}_getModels(){const e=this.getShaders(),n=this.getAttributeManager().getBufferLayouts(),r=new yr(this.context.device,{...e,id:`${this.props.id}-fill`,bufferLayout:n,isInstanced:!0}),i=new yr(this.context.device,{...e,id:`${this.props.id}-wireframe`,bufferLayout:n,isInstanced:!0});return{fillModel:r,wireframeModel:i,models:[i,r]}}_updateGeometry({diskResolution:e,vertices:n,extruded:r,stroked:i}){const s=this.getGeometry(e,n,r||i);this.setState({fillVertexCount:s.attributes.POSITION.value.length/3});const o=this.state.fillModel,a=this.state.wireframeModel;o.setGeometry(s),o.setTopology("triangle-strip"),o.setIndexBuffer(null),a.setGeometry(s),a.setTopology("line-list")}draw({uniforms:e}){const{lineWidthUnits:n,lineWidthScale:r,lineWidthMinPixels:i,lineWidthMaxPixels:s,radiusUnits:o,elevationScale:a,extruded:f,filled:p,stroked:m,wireframe:v,offset:w,coverage:T,radius:E,angle:N}=this.props,j=this.state.fillModel,I=this.state.wireframeModel,{fillVertexCount:R,edgeDistance:k}=this.state,B={radius:E,angle:N/180*Math.PI,offset:w,extruded:f,stroked:m,coverage:T,elevationScale:a,edgeDistance:k,radiusUnits:Ii[o],widthUnits:Ii[n],widthScale:r,widthMinPixels:i,widthMaxPixels:s};f&&v&&(I.shaderInputs.setProps({column:{...B,isStroke:!0}}),I.draw(this.context.renderPass)),p&&(j.setVertexCount(R),j.shaderInputs.setProps({column:{...B,isStroke:!1}}),j.draw(this.context.renderPass)),!f&&m&&(j.setVertexCount(R*2/3),j.shaderInputs.setProps({column:{...B,isStroke:!0}}),j.draw(this.context.renderPass))}}Ig.layerName="ColumnLayer";Ig.defaultProps=DF;function BF(t,e,n,r){let i;if(Array.isArray(t[0])){const s=t.length*e;i=new Array(s);for(let o=0;o<t.length;o++)for(let a=0;a<e;a++)i[o*e+a]=t[o][a]||0}else i=t;return n?ux(i,{size:e,gridResolution:n}):r?SF(i,{size:e}):i}const FF=1,LF=2,sd=4;class UF extends ax{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?BF(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(G1(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&G1(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:s,geometrySize:o}=n;r.fill(0,s,s+o),i?(r[s]=sd,r[s+o-2]=sd):(r[s]+=FF,r[s+o-2]+=LF),r[s+o-1]=sd}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:s}=n,o=new Array(3);for(let a=i,f=0;f<s;a++,f++)this.getPointOnPath(e,f,o),r[a*3]=o[0],r[a*3+1]=o[1],r[a*3+2]=o[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const s=n*i;return r[0]=e[s],r[1]=e[s+1],r[2]=i===3&&e[s+2]||0,r}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function G1(t){return Array.isArray(t[0])}const J1=`uniform pathUniforms {
  float widthScale;
  float widthMinPixels;
  float widthMaxPixels;
  float jointType;
  float capType;
  float miterLimit;
  bool billboard;
  highp int widthUnits;
} path;
`,zF={name:"path",vs:J1,fs:J1,uniformTypes:{widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",jointType:"f32",capType:"f32",miterLimit:"f32",billboard:"f32",widthUnits:"i32"}},VF=`#version 300 es
#define SHADER_NAME path-layer-vertex-shader
in vec2 positions;
in float instanceTypes;
in vec3 instanceStartPositions;
in vec3 instanceEndPositions;
in vec3 instanceLeftPositions;
in vec3 instanceRightPositions;
in vec3 instanceLeftPositions64Low;
in vec3 instanceStartPositions64Low;
in vec3 instanceEndPositions64Low;
in vec3 instanceRightPositions64Low;
in float instanceStrokeWidths;
in vec4 instanceColors;
in vec3 instancePickingColors;
uniform float opacity;
out vec4 vColor;
out vec2 vCornerOffset;
out float vMiterLength;
out vec2 vPathPosition;
out float vPathLength;
out float vJointType;
const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);
float flipIfTrue(bool flag) {
return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
vec2 width
) {
bool isEnd = positions.x > 0.0;
float sideOfPath = positions.y;
float isJoint = float(sideOfPath == 0.0);
vec3 deltaA3 = (currPoint - prevPoint);
vec3 deltaB3 = (nextPoint - currPoint);
mat3 rotationMatrix;
bool needsRotation = !path.billboard && project_needs_rotation(currPoint, rotationMatrix);
if (needsRotation) {
deltaA3 = deltaA3 * rotationMatrix;
deltaB3 = deltaB3 * rotationMatrix;
}
vec2 deltaA = deltaA3.xy / width;
vec2 deltaB = deltaB3.xy / width;
float lenA = length(deltaA);
float lenB = length(deltaB);
vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);
vec2 perpA = vec2(-dirA.y, dirA.x);
vec2 perpB = vec2(-dirB.y, dirB.x);
vec2 tangent = dirA + dirB;
tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
vec2 miterVec = vec2(-tangent.y, tangent.x);
vec2 dir = isEnd ? dirA : dirB;
vec2 perp = isEnd ? perpA : perpB;
float L = isEnd ? lenA : lenB;
float sinHalfA = abs(dot(miterVec, perp));
float cosHalfA = abs(dot(dirA, miterVec));
float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
float cornerPosition = sideOfPath * turnDirection;
float miterSize = 1.0 / max(sinHalfA, EPSILON);
miterSize = mix(
min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
miterSize,
step(0.0, cornerPosition)
);
vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
* (sideOfPath + isJoint * turnDirection);
bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
bool isCap = isStartCap || isEndCap;
if (isCap) {
offsetVec = mix(perp * sideOfPath, dir * path.capType * 4.0 * flipIfTrue(isStartCap), isJoint);
vJointType = path.capType;
} else {
vJointType = path.jointType;
}
vPathLength = L;
vCornerOffset = offsetVec;
vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
vMiterLength = isCap ? isJoint : vMiterLength;
vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
vPathPosition = vec2(
dot(offsetFromStartOfPath, perp),
dot(offsetFromStartOfPath, dir)
);
geometry.uv = vPathPosition;
float isValid = step(instanceTypes, 3.5);
vec3 offset = vec3(offsetVec * width * isValid, 0.0);
if (needsRotation) {
offset = rotationMatrix * offset;
}
return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
if (position.w < EPSILON) {
float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
position = refPosition + (position - refPosition) * r;
}
}
void main() {
geometry.pickingColor = instancePickingColors;
vColor = vec4(instanceColors.rgb, instanceColors.a * layer.opacity);
float isEnd = positions.x;
vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);
vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);
vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);
geometry.worldPosition = currPosition;
vec2 widthPixels = vec2(clamp(
project_size_to_pixel(instanceStrokeWidths * path.widthScale, path.widthUnits),
path.widthMinPixels, path.widthMaxPixels) / 2.0);
vec3 width;
if (path.billboard) {
vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);
clipLine(prevPositionScreen, currPositionScreen);
clipLine(nextPositionScreen, currPositionScreen);
clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));
width = vec3(widthPixels, 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(
prevPositionScreen.xyz / prevPositionScreen.w,
currPositionScreen.xyz / currPositionScreen.w,
nextPositionScreen.xyz / nextPositionScreen.w,
project_pixel_size_to_clipspace(width.xy)
);
DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
} else {
prevPosition = project_position(prevPosition, prevPosition64Low);
currPosition = project_position(currPosition, currPosition64Low);
nextPosition = project_position(nextPosition, nextPosition64Low);
width = vec3(project_pixel_size(widthPixels), 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
geometry.position = vec4(currPosition + offset, 1.0);
gl_Position = project_common_position_to_clipspace(geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,jF=`#version 300 es
#define SHADER_NAME path-layer-fragment-shader
precision highp float;
in vec4 vColor;
in vec2 vCornerOffset;
in float vMiterLength;
in vec2 vPathPosition;
in float vPathLength;
in float vJointType;
out vec4 fragColor;
void main(void) {
geometry.uv = vPathPosition;
if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
discard;
}
if (vJointType < 0.5 && vMiterLength > path.miterLimit + 1.0) {
discard;
}
}
fragColor = vColor;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,gx=[0,0,0,255],WF={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:gx},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},od={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class wf extends di{getShaders(){return super.getShaders({vs:VF,fs:jF,modules:[Sa,Ca,zF]})}get wrapLongitude(){return!1}getBounds(){var e;return(e=this.getAttributeManager())==null?void 0:e.getBounds(["vertexPositions"])}initializeState(){this.getAttributeManager().addInstanced({vertexPositions:{size:3,vertexOffset:1,type:"float64",fp64:this.use64bitPositions(),transition:od,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:"uint8",update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:od,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",accessor:"getColor",transition:od,defaultValue:gx},instancePickingColors:{size:4,type:"uint8",accessor:(r,{index:i,target:s})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,s)}}),this.setState({pathTesselator:new UF({fp64:this.use64bitPositions()})})}updateState(e){var o;super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:a}=this.state,f=n.data.attributes||{};a.updateGeometry({data:n.data,geometryBuffer:f.getPath,buffers:f,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),r.dataChanged||i.invalidateAll()}r.extensionsChanged&&((o=this.state.model)==null||o.destroy(),this.state.model=this._getModel(),i.invalidateAll())}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,i=this.props.data;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const n=this.props.data;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:s,widthUnits:o,widthScale:a,widthMinPixels:f,widthMaxPixels:p}=this.props,m=this.state.model,v={jointType:Number(n),capType:Number(r),billboard:i,widthUnits:Ii[o],widthScale:a,miterLimit:s,widthMinPixels:f,widthMaxPixels:p};m.shaderInputs.setProps({path:v}),m.draw(this.context.renderPass)}_getModel(){const e=[0,1,2,1,4,2,1,3,4,3,5,4],n=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new yr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Gs({topology:"triangle-list",attributes:{indices:new Uint16Array(e),positions:{value:new Float32Array(n),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}wf.defaultProps=WF;wf.layerName="PathLayer";var Mg={exports:{}};Mg.exports=bf;Mg.exports.default=bf;function bf(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,s=mx(t,0,i,n,!0),o=[];if(!s||s.next===s.prev)return o;var a,f,p,m,v,w,T;if(r&&(s=YF(t,e,s,n)),t.length>80*n){a=p=t[0],f=m=t[1];for(var E=n;E<i;E+=n)v=t[E],w=t[E+1],v<a&&(a=v),w<f&&(f=w),v>p&&(p=v),w>m&&(m=w);T=Math.max(p-a,m-f),T=T!==0?32767/T:0}return Jl(s,o,n,a,f,T,0),o}function mx(t,e,n,r,i){var s,o;if(i===q0(t,e,n,r)>0)for(s=e;s<n;s+=r)o=ey(s,t[s],t[s+1],o);else for(s=n-r;s>=e;s-=r)o=ey(s,t[s],t[s+1],o);return o&&xf(o,o.next)&&(tA(o),o=o.next),o}function eo(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(xf(n,n.next)||tn(n.prev,n,n.next)===0)){if(tA(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function Jl(t,e,n,r,i,s,o){if(t){!o&&s&&JF(t,r,i,s);for(var a=t,f,p;t.prev!==t.next;){if(f=t.prev,p=t.next,s?HF(t,r,i,s):$F(t)){e.push(f.i/n|0),e.push(t.i/n|0),e.push(p.i/n|0),tA(t),t=p.next,a=p.next;continue}if(t=p,t===a){o?o===1?(t=XF(eo(t),e,n),Jl(t,e,n,r,i,s,2)):o===2&&QF(t,e,n,r,i,s):Jl(eo(t),e,n,r,i,s,1);break}}}}function $F(t){var e=t.prev,n=t,r=t.next;if(tn(e,n,r)>=0)return!1;for(var i=e.x,s=n.x,o=r.x,a=e.y,f=n.y,p=r.y,m=i<s?i<o?i:o:s<o?s:o,v=a<f?a<p?a:p:f<p?f:p,w=i>s?i>o?i:o:s>o?s:o,T=a>f?a>p?a:p:f>p?f:p,E=r.next;E!==e;){if(E.x>=m&&E.x<=w&&E.y>=v&&E.y<=T&&Ho(i,a,s,f,o,p,E.x,E.y)&&tn(E.prev,E,E.next)>=0)return!1;E=E.next}return!0}function HF(t,e,n,r){var i=t.prev,s=t,o=t.next;if(tn(i,s,o)>=0)return!1;for(var a=i.x,f=s.x,p=o.x,m=i.y,v=s.y,w=o.y,T=a<f?a<p?a:p:f<p?f:p,E=m<v?m<w?m:w:v<w?v:w,N=a>f?a>p?a:p:f>p?f:p,j=m>v?m>w?m:w:v>w?v:w,I=Y0(T,E,e,n,r),R=Y0(N,j,e,n,r),k=t.prevZ,B=t.nextZ;k&&k.z>=I&&B&&B.z<=R;){if(k.x>=T&&k.x<=N&&k.y>=E&&k.y<=j&&k!==i&&k!==o&&Ho(a,m,f,v,p,w,k.x,k.y)&&tn(k.prev,k,k.next)>=0||(k=k.prevZ,B.x>=T&&B.x<=N&&B.y>=E&&B.y<=j&&B!==i&&B!==o&&Ho(a,m,f,v,p,w,B.x,B.y)&&tn(B.prev,B,B.next)>=0))return!1;B=B.nextZ}for(;k&&k.z>=I;){if(k.x>=T&&k.x<=N&&k.y>=E&&k.y<=j&&k!==i&&k!==o&&Ho(a,m,f,v,p,w,k.x,k.y)&&tn(k.prev,k,k.next)>=0)return!1;k=k.prevZ}for(;B&&B.z<=R;){if(B.x>=T&&B.x<=N&&B.y>=E&&B.y<=j&&B!==i&&B!==o&&Ho(a,m,f,v,p,w,B.x,B.y)&&tn(B.prev,B,B.next)>=0)return!1;B=B.nextZ}return!0}function XF(t,e,n){var r=t;do{var i=r.prev,s=r.next.next;!xf(i,s)&&_x(i,r,r.next,s)&&eA(i,s)&&eA(s,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),tA(r),tA(r.next),r=t=s),r=r.next}while(r!==t);return eo(r)}function QF(t,e,n,r,i,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&nL(o,a)){var f=yx(o,a);o=eo(o,o.next),f=eo(f,f.next),Jl(o,e,n,r,i,s,0),Jl(f,e,n,r,i,s,0);return}a=a.next}o=o.next}while(o!==t)}function YF(t,e,n,r){var i=[],s,o,a,f,p;for(s=0,o=e.length;s<o;s++)a=e[s]*r,f=s<o-1?e[s+1]*r:t.length,p=mx(t,a,f,r,!1),p===p.next&&(p.steiner=!0),i.push(tL(p));for(i.sort(KF),s=0;s<i.length;s++)n=qF(i[s],n);return n}function KF(t,e){return t.x-e.x}function qF(t,e){var n=ZF(t,e);if(!n)return e;var r=yx(n,t);return eo(r,r.next),eo(n,n.next)}function ZF(t,e){var n=e,r=t.x,i=t.y,s=-1/0,o;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var a=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>s&&(s=a,o=n.x<n.next.x?n:n.next,a===r))return o}n=n.next}while(n!==e);if(!o)return null;var f=o,p=o.x,m=o.y,v=1/0,w;n=o;do r>=n.x&&n.x>=p&&r!==n.x&&Ho(i<m?r:s,i,p,m,i<m?s:r,i,n.x,n.y)&&(w=Math.abs(i-n.y)/(r-n.x),eA(n,t)&&(w<v||w===v&&(n.x>o.x||n.x===o.x&&GF(o,n)))&&(o=n,v=w)),n=n.next;while(n!==f);return o}function GF(t,e){return tn(t.prev,t,e.prev)<0&&tn(e.next,t,t.next)<0}function JF(t,e,n,r){var i=t;do i.z===0&&(i.z=Y0(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,eL(i)}function eL(t){var e,n,r,i,s,o,a,f,p=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,r=n,a=0,e=0;e<p&&(a++,r=r.nextZ,!!r);e++);for(f=p;a>0||f>0&&r;)a!==0&&(f===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,f--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,p*=2}while(o>1);return t}function Y0(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function tL(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function Ho(t,e,n,r,i,s,o,a){return(i-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(r-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(i-o)*(r-a)}function nL(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!rL(t,e)&&(eA(t,e)&&eA(e,t)&&iL(t,e)&&(tn(t.prev,t,e.prev)||tn(t,e.prev,e))||xf(t,e)&&tn(t.prev,t,t.next)>0&&tn(e.prev,e,e.next)>0)}function tn(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function xf(t,e){return t.x===e.x&&t.y===e.y}function _x(t,e,n,r){var i=rc(tn(t,e,n)),s=rc(tn(t,e,r)),o=rc(tn(n,r,t)),a=rc(tn(n,r,e));return!!(i!==s&&o!==a||i===0&&nc(t,n,e)||s===0&&nc(t,r,e)||o===0&&nc(n,t,r)||a===0&&nc(n,e,r))}function nc(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function rc(t){return t>0?1:t<0?-1:0}function rL(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&_x(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function eA(t,e){return tn(t.prev,t,t.next)<0?tn(t,e,t.next)>=0&&tn(t,t.prev,e)>=0:tn(t,e,t.prev)<0||tn(t,t.next,e)<0}function iL(t,e){var n=t,r=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function yx(t,e){var n=new K0(t.i,t.x,t.y),r=new K0(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function ey(t,e,n,r){var i=new K0(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function tA(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function K0(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}bf.deviation=function(t,e,n,r){var i=e&&e.length,s=i?e[0]*n:t.length,o=Math.abs(q0(t,0,s,n));if(i)for(var a=0,f=e.length;a<f;a++){var p=e[a]*n,m=a<f-1?e[a+1]*n:t.length;o-=Math.abs(q0(t,p,m,n))}var v=0;for(a=0;a<r.length;a+=3){var w=r[a]*n,T=r[a+1]*n,E=r[a+2]*n;v+=Math.abs((t[w]-t[E])*(t[T+1]-t[w+1])-(t[w]-t[T])*(t[E+1]-t[w+1]))}return o===0&&v===0?0:Math.abs((v-o)/o)};function q0(t,e,n,r){for(var i=0,s=e,o=n-r;s<n;s+=r)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}bf.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[i][s][o]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};var sL=Mg.exports;const oL=tp(sL),ic=Pg.CLOCKWISE,ty=Pg.COUNTER_CLOCKWISE,rs={};function aL(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function cl(t){return"positions"in t?t.positions:t}function Sc(t){return"holeIndices"in t?t.holeIndices:null}function lL(t){return Array.isArray(t[0])}function AL(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function cL(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function uL(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function ny(t,e,n,r,i){let s=e;const o=n.length;for(let a=0;a<o;a++)for(let f=0;f<r;f++)t[s++]=n[a][f]||0;if(!cL(n))for(let a=0;a<r;a++)t[s++]=n[0][a]||0;return rs.start=e,rs.end=s,rs.size=r,Rg(t,i,rs),s}function ry(t,e,n,r,i=0,s,o){s=s||n.length;const a=s-i;if(a<=0)return e;let f=e;for(let p=0;p<a;p++)t[f++]=n[i+p];if(!uL(n,r,i,s))for(let p=0;p<r;p++)t[f++]=n[i+p];return rs.start=e,rs.end=f,rs.size=r,Rg(t,o,rs),f}function vx(t,e){aL(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:s}=t;if(s){let o=0;for(let a=0;a<=s.length;a++)o=ry(n,o,i,e,s[a-1],s[a],a===0?ic:ty),r.push(o);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!lL(t))return ry(n,0,t,e,0,n.length,ic),n;if(!AL(t)){let i=0;for(const[s,o]of t.entries())i=ny(n,i,o,e,s===0?ic:ty),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return ny(n,0,t,e,ic),n}function ad(t,e,n){const r=t.length/3;let i=0;for(let s=0;s<r;s++){const o=(s+1)%r;i+=t[s*3+e]*t[o*3+n],i-=t[o*3+e]*t[s*3+n]}return Math.abs(i/2)}function iy(t,e,n,r){const i=t.length/3;for(let s=0;s<i;s++){const o=s*3,a=t[o+0],f=t[o+1],p=t[o+2];t[o+e]=a,t[o+n]=f,t[o+r]=p}}function fL(t,e,n,r){let i=Sc(t);i&&(i=i.map(a=>a/e));let s=cl(t);const o=r&&e===3;if(n){const a=s.length;s=s.slice();const f=[];for(let p=0;p<a;p+=e){f[0]=s[p],f[1]=s[p+1],o&&(f[2]=s[p+2]);const m=n(f);s[p]=m[0],s[p+1]=m[1],o&&(s[p+2]=m[2])}}if(o){const a=ad(s,0,1),f=ad(s,0,2),p=ad(s,1,2);if(!a&&!f&&!p)return[];a>f&&a>p||(f>p?(n||(s=s.slice()),iy(s,0,2,1)):(n||(s=s.slice()),iy(s,2,0,1)))}return oL(s,i,e)}class hL extends ax{constructor(e){const{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint16Array,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=vx(e,this.positionSize);return this.opts.resolution?fx(cl(n),Sc(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?CF(cl(n),Sc(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(sy(e)){let n=0;for(const r of e)n+=this.getGeometrySize(r);return n}return cl(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&sy(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else{const r=e;this._updateIndices(r,n),this._updatePositions(r,n),this._updateVertexValid(r,n)}}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){const{attributes:s,indexStarts:o,typedArrayManager:a}=this;let f=s.indices;if(!f||!e)return;let p=i;const m=fL(e,this.positionSize,this.opts.preproject,this.opts.full3d);f=a.allocate(f,i+m.length,{copy:!0});for(let v=0;v<m.length;v++)f[p++]=m[v]+r;o[n+1]=i+m.length,s.indices=f}_updatePositions(e,{vertexStart:n,geometrySize:r}){const{attributes:{positions:i},positionSize:s}=this;if(!i||!e)return;const o=cl(e);for(let a=n,f=0;f<r;a++,f++){const p=o[f*s],m=o[f*s+1],v=s>2?o[f*s+2]:0;i[a*3]=p,i[a*3+1]=m,i[a*3+2]=v}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){const{positionSize:i}=this,s=this.attributes.vertexValid,o=e&&Sc(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+r),o)for(let a=0;a<o.length;a++)s[n+o[a]/i-1]=0;s[n+r-1]=0}}function sy(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const oy=`uniform solidPolygonUniforms {
  bool extruded;
  bool isWireframe;
  float elevationScale;
} solidPolygon;
`,dL={name:"solidPolygon",vs:oy,fs:oy,uniformTypes:{extruded:"f32",isWireframe:"f32",elevationScale:"f32"}},wx=`in vec4 fillColors;
in vec4 lineColors;
in vec3 pickingColors;
out vec4 vColor;
struct PolygonProps {
vec3 positions;
vec3 positions64Low;
vec3 normal;
float elevations;
};
vec3 project_offset_normal(vec3 vector) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
return normalize(vector * project.commonUnitsPerWorldUnit);
}
return project_normal(vector);
}
void calculatePosition(PolygonProps props) {
vec3 pos = props.positions;
vec3 pos64Low = props.positions64Low;
vec3 normal = props.normal;
vec4 colors = solidPolygon.isWireframe ? lineColors : fillColors;
geometry.worldPosition = props.positions;
geometry.pickingColor = pickingColors;
if (solidPolygon.extruded) {
pos.z += props.elevations * solidPolygon.elevationScale;
}
gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (solidPolygon.extruded) {
#ifdef IS_SIDE_VERTEX
normal = project_offset_normal(normal);
#else
normal = project_normal(normal);
#endif
geometry.normal = normal;
vec3 lightColor = lighting_getLightColor(colors.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, colors.a * layer.opacity);
} else {
vColor = vec4(colors.rgb, colors.a * layer.opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,pL=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader
in vec3 vertexPositions;
in vec3 vertexPositions64Low;
in float elevations;
${wx}
void main(void) {
PolygonProps props;
props.positions = vertexPositions;
props.positions64Low = vertexPositions64Low;
props.elevations = elevations;
props.normal = vec3(0.0, 0.0, 1.0);
calculatePosition(props);
}
`,gL=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX
in vec2 positions;
in vec3 vertexPositions;
in vec3 nextVertexPositions;
in vec3 vertexPositions64Low;
in vec3 nextVertexPositions64Low;
in float elevations;
in float instanceVertexValid;
${wx}
void main(void) {
if(instanceVertexValid < 0.5){
gl_Position = vec4(0.);
return;
}
PolygonProps props;
vec3 pos;
vec3 pos64Low;
vec3 nextPos;
vec3 nextPos64Low;
#if RING_WINDING_ORDER_CW == 1
pos = vertexPositions;
pos64Low = vertexPositions64Low;
nextPos = nextVertexPositions;
nextPos64Low = nextVertexPositions64Low;
#else
pos = nextVertexPositions;
pos64Low = nextVertexPositions64Low;
nextPos = vertexPositions;
nextPos64Low = vertexPositions64Low;
#endif
props.positions = mix(pos, nextPos, positions.x);
props.positions64Low = mix(pos64Low, nextPos64Low, positions.x);
props.normal = vec3(
pos.y - nextPos.y + (pos64Low.y - nextPos64Low.y),
nextPos.x - pos.x + (nextPos64Low.x - pos64Low.x),
0.0);
props.elevations = elevations * positions.y;
calculatePosition(props);
}
`,mL=`#version 300 es
#define SHADER_NAME solid-polygon-layer-fragment-shader
precision highp float;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,ku=[0,0,0,255],_L={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:ku},getLineColor:{type:"accessor",value:ku},material:!0},sc={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class Tf extends di{getShaders(e){return super.getShaders({vs:e==="top"?pL:gL,fs:mL,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[Sa,gg,Ca,dL]})}get wrapLongitude(){return!1}getBounds(){var e;return(e=this.getAttributeManager())==null?void 0:e.getBounds(["vertexPositions"])}initializeState(){const{viewport:e}=this.context;let{coordinateSystem:n}=this.props;const{_full3d:r}=this.props;e.isGeospatial&&n===bt.DEFAULT&&(n=bt.LNGLAT);let i;n===bt.LNGLAT&&(r?i=e.projectPosition.bind(e):i=e.projectFlat.bind(e)),this.setState({numInstances:0,polygonTesselator:new hL({preproject:i,fp64:this.use64bitPositions(),IndexType:Uint32Array})});const s=this.getAttributeManager(),o=!0;s.remove(["instancePickingColors"]),s.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:o},vertexPositions:{size:3,type:"float64",stepMode:"dynamic",fp64:this.use64bitPositions(),transition:sc,accessor:"getPolygon",update:this.calculatePositions,noAlloc:o,shaderAttributes:{nextVertexPositions:{vertexOffset:1}}},instanceVertexValid:{size:1,type:"uint16",stepMode:"instance",update:this.calculateVertexValid,noAlloc:o},elevations:{size:1,stepMode:"dynamic",transition:sc,accessor:"getElevation"},fillColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:sc,accessor:"getFillColor",defaultValue:ku},lineColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:sc,accessor:"getLineColor",defaultValue:ku},pickingColors:{size:4,type:"uint8",stepMode:"dynamic",accessor:(a,{index:f,target:p})=>this.encodePickingColor(a&&a.__source?a.__source.index:f,p)}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,i=this.props.data;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const n=this.props.data;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:r,wireframe:i,elevationScale:s}=this.props,{topModel:o,sideModel:a,wireframeModel:f,polygonTesselator:p}=this.state,m={extruded:!!n,elevationScale:s,isWireframe:!1};f&&i&&(f.setInstanceCount(p.instanceCount-1),f.shaderInputs.setProps({solidPolygon:{...m,isWireframe:!0}}),f.draw(this.context.renderPass)),a&&r&&(a.setInstanceCount(p.instanceCount-1),a.shaderInputs.setProps({solidPolygon:m}),a.draw(this.context.renderPass)),o&&r&&(o.setVertexCount(p.vertexCount),o.shaderInputs.setProps({solidPolygon:m}),o.draw(this.context.renderPass))}updateState(e){var a;super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager();(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded)&&((a=this.state.models)==null||a.forEach(f=>f.destroy()),this.setState(this._getModels()),s.invalidateAll())}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:s}=this.state,o=e.data.attributes||{};s.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:o.getPolygon,buffers:o,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:e._full3d}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(){const{id:e,filled:n,extruded:r}=this.props;let i,s,o;if(n){const a=this.getShaders("top");a.defines.NON_INSTANCED_MODEL=1;const f=this.getAttributeManager().getBufferLayouts({isInstanced:!1});i=new yr(this.context.device,{...a,id:`${e}-top`,topology:"triangle-list",bufferLayout:f,isIndexed:!0,userData:{excludeAttributes:{instanceVertexValid:!0}}})}if(r){const a=this.getAttributeManager().getBufferLayouts({isInstanced:!0});s=new yr(this.context.device,{...this.getShaders("side"),id:`${e}-side`,bufferLayout:a,geometry:new Gs({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,1,1,0,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}}),o=new yr(this.context.device,{...this.getShaders("side"),id:`${e}-wireframe`,bufferLayout:a,geometry:new Gs({topology:"line-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}})}return{models:[s,o,i].filter(Boolean),topModel:i,sideModel:s,wireframeModel:o}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}Tf.defaultProps=_L;Tf.layerName="SolidPolygonLayer";function bx({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:s=1/0}=n,o=t.length;let a=o,f=o;for(let w=0;w<o;w++){const T=e(t[w]);if(a>w&&T>=i&&(a=w),T>=s){f=w;break}}let p=a;const v=f-a!==r.length?t.slice(f):void 0;for(let w=0;w<r.length;w++)t[p++]=r[w];if(v){for(let w=0;w<v.length;w++)t[p++]=v[w];t.length=p}return{startRow:a,endRow:a+r.length}}const xx=[0,0,0,255],yL=[0,0,0,255],vL={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:yL},getLineColor:{type:"accessor",value:xx},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class Ef extends hA{initializeState(){this.state={paths:[],pathsDiff:null},this.props.getLineDashArray&&ut.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:e}){const n=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(n&&Array.isArray(e.dataChanged)){const r=this.state.paths.slice(),i=e.dataChanged.map(s=>bx({data:r,getIndex:o=>o.__source.index,dataRange:s,replace:this._getPaths(s)}));this.setState({paths:r,pathsDiff:i})}else n&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(e={}){const{data:n,getPolygon:r,positionFormat:i,_normalize:s}=this.props,o=[],a=i==="XY"?2:3,{startRow:f,endRow:p}=e,{iterable:m,objectInfo:v}=Pa(n,f,p);for(const w of m){v.index++;let T=r(w,v);s&&(T=vx(T,a));const{holeIndices:E}=T,N=T.positions||T;if(E)for(let j=0;j<=E.length;j++){const I=N.slice(E[j-1]||0,E[j]||N.length);o.push(this.getSubLayerRow({path:I},w,v.index))}else o.push(this.getSubLayerRow({path:N},w,v.index))}return o}renderLayers(){const{data:e,_dataDiff:n,stroked:r,filled:i,extruded:s,wireframe:o,_normalize:a,_windingOrder:f,elevationScale:p,transitions:m,positionFormat:v}=this.props,{lineWidthUnits:w,lineWidthScale:T,lineWidthMinPixels:E,lineWidthMaxPixels:N,lineJointRounded:j,lineMiterLimit:I,lineDashJustified:R}=this.props,{getFillColor:k,getLineColor:B,getLineWidth:Y,getLineDashArray:G,getElevation:ce,getPolygon:U,updateTriggers:$,material:K}=this.props,{paths:ue,pathsDiff:ge}=this.state,le=this.getSubLayerClass("fill",Tf),he=this.getSubLayerClass("stroke",wf),Ue=this.shouldRenderSubLayer("fill",ue)&&new le({_dataDiff:n,extruded:s,elevationScale:p,filled:i,wireframe:o,_normalize:a,_windingOrder:f,getElevation:ce,getFillColor:k,getLineColor:s&&o?B:xx,material:K,transitions:m},this.getSubLayerProps({id:"fill",updateTriggers:$&&{getPolygon:$.getPolygon,getElevation:$.getElevation,getFillColor:$.getFillColor,lineColors:s&&o,getLineColor:$.getLineColor}}),{data:e,positionFormat:v,getPolygon:U}),je=!s&&r&&this.shouldRenderSubLayer("stroke",ue)&&new he({_dataDiff:ge&&(()=>ge),widthUnits:w,widthScale:T,widthMinPixels:E,widthMaxPixels:N,jointRounded:j,miterLimit:I,dashJustified:R,_pathType:"loop",transitions:m&&{getWidth:m.getLineWidth,getColor:m.getLineColor,getPath:m.getPolygon},getColor:this.getSubLayerAccessor(B),getWidth:this.getSubLayerAccessor(Y),getDashArray:this.getSubLayerAccessor(G)},this.getSubLayerProps({id:"stroke",updateTriggers:$&&{getWidth:$.getLineWidth,getColor:$.getLineColor,getDashArray:$.getLineDashArray}}),{data:ue,positionFormat:v,getPath:ze=>ze.path});return[!s&&Ue,je,s&&Ue]}}Ef.layerName="PolygonLayer";Ef.defaultProps=vL;function wL(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return n!==-1?bL(t,r,n):null}function bL(t,e,n){const r={properties:{...t.properties[e]}};for(const i in t.numericProps)r.properties[i]=t.numericProps[i].value[n];return r}function xL(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(i.length*4);const s=[];for(let o=0;o<i.length;o++)e(i[o],s),n[r][o*4+0]=s[0],n[r][o*4+1]=s[1],n[r][o*4+2]=s[2],n[r][o*4+3]=255}return n}const ay=`uniform sdfUniforms {
  float gamma;
  bool enabled;
  float buffer;
  float outlineBuffer;
  vec4 outlineColor;
} sdf;
`,TL={name:"sdf",vs:ay,fs:ay,uniformTypes:{gamma:"f32",enabled:"f32",buffer:"f32",outlineBuffer:"f32",outlineColor:"vec4<f32>"}},EL=`#version 300 es
#define SHADER_NAME multi-icon-layer-fragment-shader
precision highp float;
uniform sampler2D iconsTexture;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
if (!bool(picking.isActive)) {
float alpha = texture(iconsTexture, vTextureCoords).a;
vec4 color = vColor;
if (sdf.enabled) {
float distance = alpha;
alpha = smoothstep(sdf.buffer - sdf.gamma, sdf.buffer + sdf.gamma, distance);
if (sdf.outlineBuffer > 0.0) {
float inFill = alpha;
float inBorder = smoothstep(sdf.outlineBuffer - sdf.gamma, sdf.outlineBuffer + sdf.gamma, distance);
color = mix(sdf.outlineColor, vColor, inFill);
alpha = inBorder;
}
}
float a = alpha * color.a;
if (a < icon.alphaCutoff) {
discard;
}
fragColor = vec4(color.rgb, a * layer.opacity);
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,ld=192/256,ly=[],SL={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class Ng extends yf{getShaders(){const e=super.getShaders();return{...e,modules:[...e.modules,TL],fs:EL}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:"uint8",size:3,accessor:(n,{index:r,target:i})=>this.encodePickingColor(r,i)}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;let{outlineColor:i}=n;i!==r.outlineColor&&(i=i.map(s=>s/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!n.sdf&&n.outlineWidth&&ut.warn(`${this.id}: fontSettings.sdf is required to render outline`)()}draw(e){const{sdf:n,smoothing:r,outlineWidth:i}=this.props,{outlineColor:s}=this.state,o=i?Math.max(r,ld*(1-i)):-1,a=this.state.model,f={buffer:ld,outlineBuffer:o,gamma:r,enabled:!!n,outlineColor:s};if(a.shaderInputs.setProps({sdf:f}),super.draw(e),n&&i){const{iconManager:p}=this.state;p.getTexture()&&(a.shaderInputs.setProps({sdf:{...f,outlineBuffer:ld}}),a.draw(this.context.renderPass))}}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):ly}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):ly}}Ng.defaultProps=SL;Ng.layerName="MultiIconLayer";const Pu=1e20;class CL{constructor({fontSize:e=24,buffer:n=3,radius:r=8,cutoff:i=.25,fontFamily:s="sans-serif",fontWeight:o="normal",fontStyle:a="normal",lang:f=null}={}){this.buffer=n,this.cutoff=i,this.radius=r,this.lang=f;const p=this.size=e+n*4,m=this._createCanvas(p),v=this.ctx=m.getContext("2d",{willReadFrequently:!0});v.font=`${a} ${o} ${e}px ${s}`,v.textBaseline="alphabetic",v.textAlign="left",v.fillStyle="black",this.gridOuter=new Float64Array(p*p),this.gridInner=new Float64Array(p*p),this.f=new Float64Array(p),this.z=new Float64Array(p+1),this.v=new Uint16Array(p)}_createCanvas(e){const n=document.createElement("canvas");return n.width=n.height=e,n}draw(e){const{width:n,actualBoundingBoxAscent:r,actualBoundingBoxDescent:i,actualBoundingBoxLeft:s,actualBoundingBoxRight:o}=this.ctx.measureText(e),a=Math.ceil(r),f=0,p=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-s))),m=Math.min(this.size-this.buffer,a+Math.ceil(i)),v=p+2*this.buffer,w=m+2*this.buffer,T=Math.max(v*w,0),E=new Uint8ClampedArray(T),N={data:E,width:v,height:w,glyphWidth:p,glyphHeight:m,glyphTop:a,glyphLeft:f,glyphAdvance:n};if(p===0||m===0)return N;const{ctx:j,buffer:I,gridInner:R,gridOuter:k}=this;this.lang&&(j.lang=this.lang),j.clearRect(I,I,p,m),j.fillText(e,I,I+a);const B=j.getImageData(I,I,p,m);k.fill(Pu,0,T),R.fill(0,0,T);for(let Y=0;Y<m;Y++)for(let G=0;G<p;G++){const ce=B.data[4*(Y*p+G)+3]/255;if(ce===0)continue;const U=(Y+I)*v+G+I;if(ce===1)k[U]=0,R[U]=Pu;else{const $=.5-ce;k[U]=$>0?$*$:0,R[U]=$<0?$*$:0}}Ay(k,0,0,v,w,v,this.f,this.v,this.z),Ay(R,I,I,p,m,v,this.f,this.v,this.z);for(let Y=0;Y<T;Y++){const G=Math.sqrt(k[Y])-Math.sqrt(R[Y]);E[Y]=Math.round(255-255*(G/this.radius+this.cutoff))}return N}}function Ay(t,e,n,r,i,s,o,a,f){for(let p=e;p<e+r;p++)cy(t,n*s+p,s,i,o,a,f);for(let p=n;p<n+i;p++)cy(t,p*s+e,1,r,o,a,f)}function cy(t,e,n,r,i,s,o){s[0]=0,o[0]=-1e20,o[1]=Pu,i[0]=t[e];for(let a=1,f=0,p=0;a<r;a++){i[a]=t[e+a*n];const m=a*a;do{const v=s[f];p=(i[a]-i[v]+m-v*v)/(a-v)/2}while(p<=o[f]&&--f>-1);f++,s[f]=a,o[f]=p,o[f+1]=Pu}for(let a=0,f=0;a<r;a++){for(;o[f+1]<a;)f++;const p=s[f],m=a-p;t[e+a*n]=i[p]+m*m}}const kL=32,PL=[];function RL(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function IL({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:s={},xOffset:o=0,yOffset:a=0}){let f=0,p=o;const m=n+r*2;for(const v of t)if(!s[v]){const w=e(v);p+w+r*2>i&&(p=0,f++),s[v]={x:p+r,y:a+f*m+r,width:w,height:m,layoutWidth:w,layoutHeight:n},p+=w+r*2}return{mapping:s,xOffset:p,yOffset:a+f*m,canvasHeight:RL(a+(f+1)*m)}}function Tx(t,e,n,r){var s;let i=0;for(let o=e;o<n;o++){const a=t[o];i+=((s=r[a])==null?void 0:s.layoutWidth)||0}return i}function Ex(t,e,n,r,i,s){let o=e,a=0;for(let f=e;f<n;f++){const p=Tx(t,f,f+1,i);a+p>r&&(o<f&&s.push(f),o=f,a=0),a+=p}return a}function ML(t,e,n,r,i,s){let o=e,a=e,f=e,p=0;for(let m=e;m<n;m++)if((t[m]===" "||t[m+1]===" "||m+1===n)&&(f=m+1),f>a){let v=Tx(t,a,f,i);p+v>r&&(o<a&&(s.push(a),o=a,p=0),v>r&&(v=Ex(t,a,f,r,i,s),o=s[s.length-1])),a=f,p+=v}return p}function NL(t,e,n,r,i=0,s){s===void 0&&(s=t.length);const o=[];return e==="break-all"?Ex(t,i,s,n,r,o):ML(t,i,s,n,r,o),o}function OL(t,e,n,r,i,s){let o=0,a=0;for(let f=e;f<n;f++){const p=t[f],m=r[p];m?(a||(a=m.layoutHeight),i[f]=o+m.layoutWidth/2,o+=m.layoutWidth):(ut.warn(`Missing character: ${p} (${p.codePointAt(0)})`)(),i[f]=o,o+=kL)}s[0]=o,s[1]=a}function DL(t,e,n,r,i){var j;const s=Array.from(t),o=s.length,a=new Array(o),f=new Array(o),p=new Array(o),m=(n==="break-word"||n==="break-all")&&isFinite(r)&&r>0,v=[0,0],w=[0,0];let T=0,E=0,N=0;for(let I=0;I<=o;I++){const R=s[I];if((R===`
`||I===o)&&(N=I),N>E){const k=m?NL(s,n,r,i,E,N):PL;for(let B=0;B<=k.length;B++){const Y=B===0?E:k[B-1],G=B<k.length?k[B]:N;OL(s,Y,G,i,a,w);for(let ce=Y;ce<G;ce++){const U=s[ce],$=((j=i[U])==null?void 0:j.layoutOffsetY)||0;f[ce]=T+w[1]/2+$,p[ce]=w[0]}T=T+w[1]*e,v[0]=Math.max(v[0],w[0])}E=N}R===`
`&&(a[E]=0,f[E]=0,p[E]=0,E++)}return v[1]=T,{x:a,y:f,rowWidth:p,size:v}}function BL({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:s}){const o=t.BYTES_PER_ELEMENT,a=n?n/o:1,f=r?r/o:0,p=i[e]||Math.ceil((t.length-f)/a),m=s&&new Set,v=new Array(e);let w=t;if(a>1||f>0){const T=t.constructor;w=new T(p);for(let E=0;E<p;E++)w[E]=t[E*a+f]}for(let T=0;T<e;T++){const E=i[T],N=i[T+1]||p,j=w.subarray(E,N);v[T]=String.fromCodePoint.apply(null,j),m&&j.forEach(m.add,m)}if(m)for(const T of m)s.add(String.fromCodePoint(T));return{texts:v,characterCount:p}}class Sx{constructor(e=5){this._cache={},this._order=[],this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function FL(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const ta={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:FL(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},uy=1024,fy=.9,hy=1.2,Cx=3;let Ru=new Sx(Cx);function LL(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const r=Ru.get(t);if(!r)return n;for(const i in r.mapping)n.has(i)&&n.delete(i);return n}function UL(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function dy(t,e,n,r){t.font=`${r} ${n}px ${e}`,t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function zL(t){ut.assert(Number.isFinite(t)&&t>=Cx,"Invalid cache limit"),Ru=new Sx(t)}class VL{constructor(){this.props={...ta}}get atlas(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:n}=this.props;return(e*hy+n*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const n=LL(this._key,this.props.characterSet),r=Ru.get(this._key);if(r&&n.size===0){this._atlas!==r&&(this._atlas=r);return}const i=this._generateFontAtlas(n,r);this._atlas=i,Ru.set(this._key,i)}_generateFontAtlas(e,n){const{fontFamily:r,fontWeight:i,fontSize:s,buffer:o,sdf:a,radius:f,cutoff:p}=this.props;let m=n&&n.data;m||(m=document.createElement("canvas"),m.width=uy);const v=m.getContext("2d",{willReadFrequently:!0});dy(v,r,s,i);const{mapping:w,canvasHeight:T,xOffset:E,yOffset:N}=IL({getFontWidth:j=>v.measureText(j).width,fontHeight:s*hy,buffer:o,characterSet:e,maxCanvasWidth:uy,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(m.height!==T){const j=v.getImageData(0,0,m.width,m.height);m.height=T,v.putImageData(j,0,0)}if(dy(v,r,s,i),a){const j=new CL({fontSize:s,buffer:o,radius:f,cutoff:p,fontFamily:r,fontWeight:`${i}`});for(const I of e){const{data:R,width:k,height:B,glyphTop:Y}=j.draw(I);w[I].width=k,w[I].layoutOffsetY=s*fy-Y;const G=v.createImageData(k,B);UL(R,G),v.putImageData(G,w[I].x,w[I].y)}}else for(const j of e)v.fillText(j,w[j].x,w[j].y+o+s*fy);return{xOffset:E,yOffset:N,mapping:w,data:m,width:m.width,height:m.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:r,buffer:i,sdf:s,radius:o,cutoff:a}=this.props;return s?`${e} ${n} ${r} ${i} ${o} ${a}`:`${e} ${n} ${r} ${i}`}}const py=`uniform textBackgroundUniforms {
  bool billboard;
  float sizeScale;
  float sizeMinPixels;
  float sizeMaxPixels;
  vec4 padding;
  highp int sizeUnits;
  bool stroked;
} textBackground;
`,jL={name:"textBackground",vs:py,fs:py,uniformTypes:{billboard:"f32",sizeScale:"f32",sizeMinPixels:"f32",sizeMaxPixels:"f32",padding:"vec4<f32>",sizeUnits:"i32",stroked:"f32"}},WL=`#version 300 es
#define SHADER_NAME text-background-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceRects;
in float instanceSizes;
in float instanceAngles;
in vec2 instancePixelOffsets;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
out vec4 vFillColor;
out vec4 vLineColor;
out float vLineWidth;
out vec2 uv;
out vec2 dimensions;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = radians(angle);
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vLineWidth = instanceLineWidths;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * textBackground.sizeScale, textBackground.sizeUnits),
textBackground.sizeMinPixels, textBackground.sizeMaxPixels
);
dimensions = instanceRects.zw * sizePixels + textBackground.padding.xy + textBackground.padding.zw;
vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-textBackground.padding.xy, textBackground.padding.zw, positions);
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
pixelOffset += instancePixelOffsets;
pixelOffset.y *= -1.0;
if (textBackground.billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,$L=`#version 300 es
#define SHADER_NAME text-background-layer-fragment-shader
precision highp float;
in vec4 vFillColor;
in vec4 vLineColor;
in float vLineWidth;
in vec2 uv;
in vec2 dimensions;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
vec2 pixelPosition = uv * dimensions;
if (textBackground.stroked) {
float distToEdge = min(
min(pixelPosition.x, dimensions.x - pixelPosition.x),
min(pixelPosition.y, dimensions.y - pixelPosition.y)
);
float isBorder = smoothedge(distToEdge, vLineWidth);
fragColor = mix(vFillColor, vLineColor, isBorder);
} else {
fragColor = vFillColor;
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,HL={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class Og extends di{getShaders(){return super.getShaders({vs:WL,fs:$L,modules:[Sa,Ca,jL]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){var r;super.updateState(e);const{changeFlags:n}=e;n.extensionsChanged&&((r=this.state.model)==null||r.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){const{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:s,sizeMaxPixels:o,getLineWidth:a}=this.props;let{padding:f}=this.props;f.length<4&&(f=[f[0],f[1],f[0],f[1]]);const p=this.state.model,m={billboard:n,stroked:!!a,padding:f,sizeUnits:Ii[i],sizeScale:r,sizeMinPixels:s,sizeMaxPixels:o};p.shaderInputs.setProps({textBackground:m}),p.draw(this.context.renderPass)}_getModel(){const e=[0,0,1,0,0,1,1,1];return new yr(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Gs({topology:"triangle-strip",vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(e)}}}),isInstanced:!0})}}Og.defaultProps=HL;Og.layerName="TextBackgroundLayer";const gy={start:1,middle:0,end:-1},my={top:1,center:0,bottom:-1},Ad=[0,0,0,255],XL=1,QL={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:Ad},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:ta.characterSet},fontFamily:ta.fontFamily,fontWeight:ta.fontWeight,lineHeight:XL,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:Ad},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Ad},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class Dg extends hA{constructor(){super(...arguments),this.getBoundingRect=(e,n)=>{let{size:[r,i]}=this.transformParagraph(e,n);const{fontSize:s}=this.state.fontAtlasManager.props;r/=s,i/=s;const{getTextAnchor:o,getAlignmentBaseline:a}=this.props,f=gy[typeof o=="function"?o(e,n):o],p=my[typeof a=="function"?a(e,n):a];return[(f-1)*r/2,(p-1)*i/2,r,i]},this.getIconOffsets=(e,n)=>{const{getTextAnchor:r,getAlignmentBaseline:i}=this.props,{x:s,y:o,rowWidth:a,size:[f,p]}=this.transformParagraph(e,n),m=gy[typeof r=="function"?r(e,n):r],v=my[typeof i=="function"?i(e,n):i],w=s.length,T=new Array(w*2);let E=0;for(let N=0;N<w;N++){const j=(1-m)*(f-a[N])/2;T[E++]=(m-1)*f/2+j+s[N],T[E++]=(v-1)*p/2+o[N]}return T}}initializeState(){this.state={styleVersion:0,fontAtlasManager:new VL},this.props.maxWidth>0&&ut.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:n,oldProps:r,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==r.lineHeight||n.wordBreak!==r.wordBreak||n.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:r}=this.props,{fontAtlasManager:i,characterSet:s}=this.state,o={...e,characterSet:s,fontFamily:n,fontWeight:r};if(!i.mapping)return i.setProps(o),!0;for(const a in o)if(o[a]!==i.props[a])return i.setProps(o),!0;return!1}_updateText(){var f;const{data:e,characterSet:n}=this.props,r=(f=e.attributes)==null?void 0:f.getText;let{getText:i}=this.props,s=e.startIndices,o;const a=n==="auto"&&new Set;if(r&&s){const{texts:p,characterCount:m}=BL({...ArrayBuffer.isView(r)?{value:r}:r,length:e.length,startIndices:s,characterSet:a});o=m,i=(v,{index:w})=>p[w]}else{const{iterable:p,objectInfo:m}=Pa(e);s=[0],o=0;for(const v of p){m.index++;const w=Array.from(i(v,m)||"");a&&w.forEach(a.add,a),o+=w.length,s.push(o)}}this.setState({getText:i,startIndices:s,numInstances:o,characterSet:a||n})}transformParagraph(e,n){const{fontAtlasManager:r}=this.state,i=r.mapping,s=this.state.getText,{wordBreak:o,lineHeight:a,maxWidth:f}=this.props,p=s(e,n)||"";return DL(p,a,o,f*r.props.fontSize,i)}renderLayers(){const{startIndices:e,numInstances:n,getText:r,fontAtlasManager:{scale:i,atlas:s,mapping:o},styleVersion:a}=this.state,{data:f,_dataDiff:p,getPosition:m,getColor:v,getSize:w,getAngle:T,getPixelOffset:E,getBackgroundColor:N,getBorderColor:j,getBorderWidth:I,backgroundPadding:R,background:k,billboard:B,fontSettings:Y,outlineWidth:G,outlineColor:ce,sizeScale:U,sizeUnits:$,sizeMinPixels:K,sizeMaxPixels:ue,transitions:ge,updateTriggers:le}=this.props,he=this.getSubLayerClass("characters",Ng),Ue=this.getSubLayerClass("background",Og);return[k&&new Ue({getFillColor:N,getLineColor:j,getLineWidth:I,padding:R,getPosition:m,getSize:w,getAngle:T,getPixelOffset:E,billboard:B,sizeScale:U,sizeUnits:$,sizeMinPixels:K,sizeMaxPixels:ue,transitions:ge&&{getPosition:ge.getPosition,getAngle:ge.getAngle,getSize:ge.getSize,getFillColor:ge.getBackgroundColor,getLineColor:ge.getBorderColor,getLineWidth:ge.getBorderWidth,getPixelOffset:ge.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:le.getPosition,getAngle:le.getAngle,getSize:le.getSize,getFillColor:le.getBackgroundColor,getLineColor:le.getBorderColor,getLineWidth:le.getBorderWidth,getPixelOffset:le.getPixelOffset,getBoundingRect:{getText:le.getText,getTextAnchor:le.getTextAnchor,getAlignmentBaseline:le.getAlignmentBaseline,styleVersion:a}}}),{data:f.attributes&&f.attributes.background?{length:f.length,attributes:f.attributes.background}:f,_dataDiff:p,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new he({sdf:Y.sdf,smoothing:Number.isFinite(Y.smoothing)?Y.smoothing:ta.smoothing,outlineWidth:G/(Y.radius||ta.radius),outlineColor:ce,iconAtlas:s,iconMapping:o,getPosition:m,getColor:v,getSize:w,getAngle:T,getPixelOffset:E,billboard:B,sizeScale:U*i,sizeUnits:$,sizeMinPixels:K*i,sizeMaxPixels:ue*i,transitions:ge&&{getPosition:ge.getPosition,getAngle:ge.getAngle,getColor:ge.getColor,getSize:ge.getSize,getPixelOffset:ge.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:le.getText,getPosition:le.getPosition,getAngle:le.getAngle,getColor:le.getColor,getSize:le.getSize,getPixelOffset:le.getPixelOffset,getIconOffsets:{getTextAnchor:le.getTextAnchor,getAlignmentBaseline:le.getAlignmentBaseline,styleVersion:a}}}),{data:f,_dataDiff:p,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:r})]}static set fontAtlasCacheLimit(e){zL(e)}}Dg.defaultProps=QL;Dg.layerName="TextLayer";const Cc={circle:{type:vf,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:yf,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:Dg,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},kc={type:wf,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},Z0={type:Tf,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Ja({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function cd(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in e){const o=e[s];let a=t.props[s];s.startsWith("get")&&(a=t.getSubLayerAccessor(a),i.updateTriggers[o]=r[s],n&&(i.transitions[o]=n[s])),i[o]=a}return i}function YL(t){if(Array.isArray(t))return t;switch(ut.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return ut.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function _y(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:s=t.length}=n;for(let o=i;o<s;o++){const a=t[o],{geometry:f}=a;if(f)if(f.type==="GeometryCollection"){ut.assert(Array.isArray(f.geometries),"GeoJSON does not have geometries array");const{geometries:p}=f;for(let m=0;m<p.length;m++){const v=p[m];yy(v,r,e,a,o)}}else yy(f,r,e,a,o)}return r}function yy(t,e,n,r,i){const{type:s,coordinates:o}=t,{pointFeatures:a,lineFeatures:f,polygonFeatures:p,polygonOutlineFeatures:m}=e;if(!qL(s,o)){ut.warn(`${s} coordinates are malformed`)();return}switch(s){case"Point":a.push(n({geometry:t},r,i));break;case"MultiPoint":o.forEach(v=>{a.push(n({geometry:{type:"Point",coordinates:v}},r,i))});break;case"LineString":f.push(n({geometry:t},r,i));break;case"MultiLineString":o.forEach(v=>{f.push(n({geometry:{type:"LineString",coordinates:v}},r,i))});break;case"Polygon":p.push(n({geometry:t},r,i)),o.forEach(v=>{m.push(n({geometry:{type:"LineString",coordinates:v}},r,i))});break;case"MultiPolygon":o.forEach(v=>{p.push(n({geometry:{type:"Polygon",coordinates:v}},r,i)),v.forEach(w=>{m.push(n({geometry:{type:"LineString",coordinates:w}},r,i))})});break}}const KL={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function qL(t,e){let n=KL[t];for(ut.assert(n,`Unknown GeoJSON type ${t}`);e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function kx(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function oc(t){return t.geometry.coordinates}function ZL(t,e){const n=kx(),{pointFeatures:r,lineFeatures:i,polygonFeatures:s,polygonOutlineFeatures:o}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=oc,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=oc,n.polygons.data=s,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=oc,n.polygonsOutline.data=o,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=oc,n}function GL(t,e){const n=kx(),{points:r,lines:i,polygons:s}=t,o=xL(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:4,value:o.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:4,value:o.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,pickingColors:{size:4,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:4,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const JL=["points","linestrings","polygons"],eU={...Ja(Cc.circle),...Ja(Cc.icon),...Ja(Cc.text),...Ja(kc),...Ja(Z0),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class Bg extends hA{initializeState(){this.state={layerProps:{},features:{},featuresDiff:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:r}=this.props,i=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:i}),i?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const r=GL(e.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON({props:e,changeFlags:n}){const r=YL(e.data),i=this.getSubLayerRow.bind(this);let s={};const o={};if(Array.isArray(n.dataChanged)){const f=this.state.features;for(const p in f)s[p]=f[p].slice(),o[p]=[];for(const p of n.dataChanged){const m=_y(r,i,p);for(const v in f)o[v].push(bx({data:s[v],getIndex:w=>w.__source.index,dataRange:p,replace:m[v]}))}}else s=_y(r,i);const a=ZL(s,o);this.setState({features:s,featuresDiff:o,layerProps:a})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r,sourceLayer:i}=n;return n.featureType=JL.find(s=>i.id.startsWith(`${this.id}-${s}-`)),r>=0&&i.id.startsWith(`${this.id}-points-text`)&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[r]),n}_updateAutoHighlight(e){const n=`${this.id}-points-`,r=e.featureType==="points";for(const i of this.getSubLayers())i.id.startsWith(n)===r&&i.updateAutoHighlight(e)}_renderPolygonLayer(){var o;const{extruded:e,wireframe:n}=this.props,{layerProps:r}=this.state,i="polygons-fill",s=this.shouldRenderSubLayer(i,(o=r.polygons)==null?void 0:o.data)&&this.getSubLayerClass(i,Z0.type);if(s){const a=cd(this,Z0.props),f=e&&n;return f||delete a.getLineColor,a.updateTriggers.lineColors=f,new s(a,this.getSubLayerProps({id:i,updateTriggers:a.updateTriggers}),r.polygons)}return null}_renderLineLayers(){var f,p;const{extruded:e,stroked:n}=this.props,{layerProps:r}=this.state,i="polygons-stroke",s="linestrings",o=!e&&n&&this.shouldRenderSubLayer(i,(f=r.polygonsOutline)==null?void 0:f.data)&&this.getSubLayerClass(i,kc.type),a=this.shouldRenderSubLayer(s,(p=r.lines)==null?void 0:p.data)&&this.getSubLayerClass(s,kc.type);if(o||a){const m=cd(this,kc.props);return[o&&new o(m,this.getSubLayerProps({id:i,updateTriggers:m.updateTriggers}),r.polygonsOutline),a&&new a(m,this.getSubLayerProps({id:s,updateTriggers:m.updateTriggers}),r.lines)]}return null}_renderPointLayers(){var a;const{pointType:e}=this.props,{layerProps:n,binary:r}=this.state;let{highlightedObjectIndex:i}=this.props;!r&&Number.isFinite(i)&&(i=n.points.data.findIndex(f=>f.__source.index===i));const s=new Set(e.split("+")),o=[];for(const f of s){const p=`points-${f}`,m=Cc[f],v=m&&this.shouldRenderSubLayer(p,(a=n.points)==null?void 0:a.data)&&this.getSubLayerClass(p,m.type);if(v){const w=cd(this,m.props);let T=n.points;if(f==="text"&&r){const{instancePickingColors:E,...N}=T.data.attributes;T={...T,data:{...T.data,attributes:N}}}o.push(new v(w,this.getSubLayerProps({id:p,updateTriggers:w.updateTriggers,highlightedObjectIndex:i}),T))}}return o}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),r=this._renderLineLayers(),i=this._renderPointLayers();return[!e&&n,r,i,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(r,i)=>{const{data:s,index:o}=i,a=wL(s,o);return e(a,i)}}}Bg.layerName="GeoJsonLayer";Bg.defaultProps=eU;var Px={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){((n,r)=>{t.exports=r()})(IE,function n(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},i,s=!r.document&&!!r.postMessage,o=r.IS_PAPA_WORKER||!1,a={},f=0,p={};function m(U){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function($){var K=Y($);K.chunkSize=parseInt(K.chunkSize),$.step||$.chunk||(K.chunkSize=null),this._handle=new N(K),(this._handle.streamer=this)._config=K}).call(this,U),this.parseChunk=function($,K){var ue=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<ue){let le=this._config.newline;le||(ge=this._config.quoteChar||'"',le=this._handle.guessLineEndings($,ge)),$=[...$.split(le).slice(ue)].join(le)}this.isFirstChunk&&ce(this._config.beforeFirstChunk)&&(ge=this._config.beforeFirstChunk($))!==void 0&&($=ge),this.isFirstChunk=!1,this._halted=!1;var ue=this._partialLine+$,ge=(this._partialLine="",this._handle.parse(ue,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if($=ge.meta.cursor,ue=(this._finished||(this._partialLine=ue.substring($-this._baseIndex),this._baseIndex=$),ge&&ge.data&&(this._rowCount+=ge.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),o)r.postMessage({results:ge,workerId:p.WORKER_ID,finished:ue});else if(ce(this._config.chunk)&&!K){if(this._config.chunk(ge,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=ge=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(ge.data),this._completeResults.errors=this._completeResults.errors.concat(ge.errors),this._completeResults.meta=ge.meta),this._completed||!ue||!ce(this._config.complete)||ge&&ge.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),ue||ge&&ge.meta.paused||this._nextChunk(),ge}this._halted=!0},this._sendError=function($){ce(this._config.error)?this._config.error($):o&&this._config.error&&r.postMessage({workerId:p.WORKER_ID,error:$,finished:!1})}}function v(U){var $;(U=U||{}).chunkSize||(U.chunkSize=p.RemoteChunkSize),m.call(this,U),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(K){this._input=K,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if($=new XMLHttpRequest,this._config.withCredentials&&($.withCredentials=this._config.withCredentials),s||($.onload=G(this._chunkLoaded,this),$.onerror=G(this._chunkError,this)),$.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var K,ue=this._config.downloadRequestHeaders;for(K in ue)$.setRequestHeader(K,ue[K])}var ge;this._config.chunkSize&&(ge=this._start+this._config.chunkSize-1,$.setRequestHeader("Range","bytes="+this._start+"-"+ge));try{$.send(this._config.downloadRequestBody)}catch(le){this._chunkError(le.message)}s&&$.status===0&&this._chunkError()}},this._chunkLoaded=function(){$.readyState===4&&($.status<200||400<=$.status?this._chunkError():(this._start+=this._config.chunkSize||$.responseText.length,this._finished=!this._config.chunkSize||this._start>=(K=>(K=K.getResponseHeader("Content-Range"))!==null?parseInt(K.substring(K.lastIndexOf("/")+1)):-1)($),this.parseChunk($.responseText)))},this._chunkError=function(K){K=$.statusText||K,this._sendError(new Error(K))}}function w(U){(U=U||{}).chunkSize||(U.chunkSize=p.LocalChunkSize),m.call(this,U);var $,K,ue=typeof FileReader<"u";this.stream=function(ge){this._input=ge,K=ge.slice||ge.webkitSlice||ge.mozSlice,ue?(($=new FileReader).onload=G(this._chunkLoaded,this),$.onerror=G(this._chunkError,this)):$=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var ge=this._input,le=(this._config.chunkSize&&(le=Math.min(this._start+this._config.chunkSize,this._input.size),ge=K.call(ge,this._start,le)),$.readAsText(ge,this._config.encoding));ue||this._chunkLoaded({target:{result:le}})},this._chunkLoaded=function(ge){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(ge.target.result)},this._chunkError=function(){this._sendError($.error)}}function T(U){var $;m.call(this,U=U||{}),this.stream=function(K){return $=K,this._nextChunk()},this._nextChunk=function(){var K,ue;if(!this._finished)return K=this._config.chunkSize,$=K?(ue=$.substring(0,K),$.substring(K)):(ue=$,""),this._finished=!$,this.parseChunk(ue)}}function E(U){m.call(this,U=U||{});var $=[],K=!0,ue=!1;this.pause=function(){m.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){m.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(ge){this._input=ge,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){ue&&$.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),$.length?this.parseChunk($.shift()):K=!0},this._streamData=G(function(ge){try{$.push(typeof ge=="string"?ge:ge.toString(this._config.encoding)),K&&(K=!1,this._checkIsFinished(),this.parseChunk($.shift()))}catch(le){this._streamError(le)}},this),this._streamError=G(function(ge){this._streamCleanUp(),this._sendError(ge)},this),this._streamEnd=G(function(){this._streamCleanUp(),ue=!0,this._streamData("")},this),this._streamCleanUp=G(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function N(U){var $,K,ue,ge,le=Math.pow(2,53),he=-le,Ue=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,je=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,ze=this,me=0,ye=0,De=!1,Me=!1,Oe=[],Le={data:[],errors:[],meta:{}};function xt(lt){return U.skipEmptyLines==="greedy"?lt.join("").trim()==="":lt.length===1&&lt[0].length===0}function Rt(){if(Le&&ue&&(sn("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+p.DefaultDelimiter+"'"),ue=!1),U.skipEmptyLines&&(Le.data=Le.data.filter(function(qe){return!xt(qe)})),Ct()){let qe=function(zt,Jt){ce(U.transformHeader)&&(zt=U.transformHeader(zt,Jt)),Oe.push(zt)};if(Le)if(Array.isArray(Le.data[0])){for(var lt=0;Ct()&&lt<Le.data.length;lt++)Le.data[lt].forEach(qe);Le.data.splice(0,1)}else Le.data.forEach(qe)}function gt(qe,zt){for(var Jt=U.header?{}:[],Tt=0;Tt<qe.length;Tt++){var kt=Tt,At=qe[Tt],At=((un,Ze)=>(Dt=>(U.dynamicTypingFunction&&U.dynamicTyping[Dt]===void 0&&(U.dynamicTyping[Dt]=U.dynamicTypingFunction(Dt)),(U.dynamicTyping[Dt]||U.dynamicTyping)===!0))(un)?Ze==="true"||Ze==="TRUE"||Ze!=="false"&&Ze!=="FALSE"&&((Dt=>{if(Ue.test(Dt)&&(Dt=parseFloat(Dt),he<Dt&&Dt<le))return 1})(Ze)?parseFloat(Ze):je.test(Ze)?new Date(Ze):Ze===""?null:Ze):Ze)(kt=U.header?Tt>=Oe.length?"__parsed_extra":Oe[Tt]:kt,At=U.transform?U.transform(At,kt):At);kt==="__parsed_extra"?(Jt[kt]=Jt[kt]||[],Jt[kt].push(At)):Jt[kt]=At}return U.header&&(Tt>Oe.length?sn("FieldMismatch","TooManyFields","Too many fields: expected "+Oe.length+" fields but parsed "+Tt,ye+zt):Tt<Oe.length&&sn("FieldMismatch","TooFewFields","Too few fields: expected "+Oe.length+" fields but parsed "+Tt,ye+zt)),Jt}var Ut;Le&&(U.header||U.dynamicTyping||U.transform)&&(Ut=1,!Le.data.length||Array.isArray(Le.data[0])?(Le.data=Le.data.map(gt),Ut=Le.data.length):Le.data=gt(Le.data,0),U.header&&Le.meta&&(Le.meta.fields=Oe),ye+=Ut)}function Ct(){return U.header&&Oe.length===0}function sn(lt,gt,Ut,qe){lt={type:lt,code:gt,message:Ut},qe!==void 0&&(lt.row=qe),Le.errors.push(lt)}ce(U.step)&&(ge=U.step,U.step=function(lt){Le=lt,Ct()?Rt():(Rt(),Le.data.length!==0&&(me+=lt.data.length,U.preview&&me>U.preview?K.abort():(Le.data=Le.data[0],ge(Le,ze))))}),this.parse=function(lt,gt,Ut){var qe=U.quoteChar||'"',qe=(U.newline||(U.newline=this.guessLineEndings(lt,qe)),ue=!1,U.delimiter?ce(U.delimiter)&&(U.delimiter=U.delimiter(lt),Le.meta.delimiter=U.delimiter):((qe=((zt,Jt,Tt,kt,At)=>{var un,Ze,Dt,xr;At=At||[",","	","|",";",p.RECORD_SEP,p.UNIT_SEP];for(var xn=0;xn<At.length;xn++){for(var Ln,Zr=At[xn],Bt=0,Un=0,Ht=0,Tn=(Dt=void 0,new I({comments:kt,delimiter:Zr,newline:Jt,preview:10}).parse(zt)),or=0;or<Tn.data.length;or++)Tt&&xt(Tn.data[or])?Ht++:(Ln=Tn.data[or].length,Un+=Ln,Dt===void 0?Dt=Ln:0<Ln&&(Bt+=Math.abs(Ln-Dt),Dt=Ln));0<Tn.data.length&&(Un/=Tn.data.length-Ht),(Ze===void 0||Bt<=Ze)&&(xr===void 0||xr<Un)&&1.99<Un&&(Ze=Bt,un=Zr,xr=Un)}return{successful:!!(U.delimiter=un),bestDelimiter:un}})(lt,U.newline,U.skipEmptyLines,U.comments,U.delimitersToGuess)).successful?U.delimiter=qe.bestDelimiter:(ue=!0,U.delimiter=p.DefaultDelimiter),Le.meta.delimiter=U.delimiter),Y(U));return U.preview&&U.header&&qe.preview++,$=lt,K=new I(qe),Le=K.parse($,gt,Ut),Rt(),De?{meta:{paused:!0}}:Le||{meta:{paused:!1}}},this.paused=function(){return De},this.pause=function(){De=!0,K.abort(),$=ce(U.chunk)?"":$.substring(K.getCharIndex())},this.resume=function(){ze.streamer._halted?(De=!1,ze.streamer.parseChunk($,!0)):setTimeout(ze.resume,3)},this.aborted=function(){return Me},this.abort=function(){Me=!0,K.abort(),Le.meta.aborted=!0,ce(U.complete)&&U.complete(Le),$=""},this.guessLineEndings=function(zt,qe){zt=zt.substring(0,1048576);var qe=new RegExp(j(qe)+"([^]*?)"+j(qe),"gm"),Ut=(zt=zt.replace(qe,"")).split("\r"),qe=zt.split(`
`),zt=1<qe.length&&qe[0].length<Ut[0].length;if(Ut.length===1||zt)return`
`;for(var Jt=0,Tt=0;Tt<Ut.length;Tt++)Ut[Tt][0]===`
`&&Jt++;return Jt>=Ut.length/2?`\r
`:"\r"}}function j(U){return U.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function I(U){var $=(U=U||{}).delimiter,K=U.newline,ue=U.comments,ge=U.step,le=U.preview,he=U.fastMode,Ue=null,je=!1,ze=U.quoteChar==null?'"':U.quoteChar,me=ze;if(U.escapeChar!==void 0&&(me=U.escapeChar),(typeof $!="string"||-1<p.BAD_DELIMITERS.indexOf($))&&($=","),ue===$)throw new Error("Comment character same as delimiter");ue===!0?ue="#":(typeof ue!="string"||-1<p.BAD_DELIMITERS.indexOf(ue))&&(ue=!1),K!==`
`&&K!=="\r"&&K!==`\r
`&&(K=`
`);var ye=0,De=!1;this.parse=function(Me,Oe,Le){if(typeof Me!="string")throw new Error("Input must be a string");var xt=Me.length,Rt=$.length,Ct=K.length,sn=ue.length,lt=ce(ge),gt=[],Ut=[],qe=[],zt=ye=0;if(!Me)return Bt();if(he||he!==!1&&Me.indexOf(ze)===-1){for(var Jt=Me.split(K),Tt=0;Tt<Jt.length;Tt++){if(qe=Jt[Tt],ye+=qe.length,Tt!==Jt.length-1)ye+=K.length;else if(Le)return Bt();if(!ue||qe.substring(0,sn)!==ue){if(lt){if(gt=[],xr(qe.split($)),Un(),De)return Bt()}else xr(qe.split($));if(le&&le<=Tt)return gt=gt.slice(0,le),Bt(!0)}}return Bt()}for(var kt=Me.indexOf($,ye),At=Me.indexOf(K,ye),un=new RegExp(j(me)+j(ze),"g"),Ze=Me.indexOf(ze,ye);;)if(Me[ye]===ze)for(Ze=ye,ye++;;){if((Ze=Me.indexOf(ze,Ze+1))===-1)return Le||Ut.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:gt.length,index:ye}),Ln();if(Ze===xt-1)return Ln(Me.substring(ye,Ze).replace(un,ze));if(ze===me&&Me[Ze+1]===me)Ze++;else if(ze===me||Ze===0||Me[Ze-1]!==me){kt!==-1&&kt<Ze+1&&(kt=Me.indexOf($,Ze+1));var Dt=xn((At=At!==-1&&At<Ze+1?Me.indexOf(K,Ze+1):At)===-1?kt:Math.min(kt,At));if(Me.substr(Ze+1+Dt,Rt)===$){qe.push(Me.substring(ye,Ze).replace(un,ze)),Me[ye=Ze+1+Dt+Rt]!==ze&&(Ze=Me.indexOf(ze,ye)),kt=Me.indexOf($,ye),At=Me.indexOf(K,ye);break}if(Dt=xn(At),Me.substring(Ze+1+Dt,Ze+1+Dt+Ct)===K){if(qe.push(Me.substring(ye,Ze).replace(un,ze)),Zr(Ze+1+Dt+Ct),kt=Me.indexOf($,ye),Ze=Me.indexOf(ze,ye),lt&&(Un(),De))return Bt();if(le&&gt.length>=le)return Bt(!0);break}Ut.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:gt.length,index:ye}),Ze++}}else if(ue&&qe.length===0&&Me.substring(ye,ye+sn)===ue){if(At===-1)return Bt();ye=At+Ct,At=Me.indexOf(K,ye),kt=Me.indexOf($,ye)}else if(kt!==-1&&(kt<At||At===-1))qe.push(Me.substring(ye,kt)),ye=kt+Rt,kt=Me.indexOf($,ye);else{if(At===-1)break;if(qe.push(Me.substring(ye,At)),Zr(At+Ct),lt&&(Un(),De))return Bt();if(le&&gt.length>=le)return Bt(!0)}return Ln();function xr(Ht){gt.push(Ht),zt=ye}function xn(Ht){var Tn=0;return Tn=Ht!==-1&&(Ht=Me.substring(Ze+1,Ht))&&Ht.trim()===""?Ht.length:Tn}function Ln(Ht){return Le||(Ht===void 0&&(Ht=Me.substring(ye)),qe.push(Ht),ye=xt,xr(qe),lt&&Un()),Bt()}function Zr(Ht){ye=Ht,xr(qe),qe=[],At=Me.indexOf(K,ye)}function Bt(Ht){if(U.header&&!Oe&&gt.length&&!je){var Tn=gt[0],or=Object.create(null),Oi=new Set(Tn);let Di=!1;for(let En=0;En<Tn.length;En++){let zn=Tn[En];if(or[zn=ce(U.transformHeader)?U.transformHeader(zn,En):zn]){let Fr,Ao=or[zn];for(;Fr=zn+"_"+Ao,Ao++,Oi.has(Fr););Oi.add(Fr),Tn[En]=Fr,or[zn]++,Di=!0,(Ue=Ue===null?{}:Ue)[Fr]=zn}else or[zn]=1,Tn[En]=zn;Oi.add(zn)}Di&&console.warn("Duplicate headers found and renamed."),je=!0}return{data:gt,errors:Ut,meta:{delimiter:$,linebreak:K,aborted:De,truncated:!!Ht,cursor:zt+(Oe||0),renamedHeaders:Ue}}}function Un(){ge(Bt()),gt=[],Ut=[]}},this.abort=function(){De=!0},this.getCharIndex=function(){return ye}}function R(U){var $=U.data,K=a[$.workerId],ue=!1;if($.error)K.userError($.error,$.file);else if($.results&&$.results.data){var ge={abort:function(){ue=!0,k($.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:B,resume:B};if(ce(K.userStep)){for(var le=0;le<$.results.data.length&&(K.userStep({data:$.results.data[le],errors:$.results.errors,meta:$.results.meta},ge),!ue);le++);delete $.results}else ce(K.userChunk)&&(K.userChunk($.results,ge,$.file),delete $.results)}$.finished&&!ue&&k($.workerId,$.results)}function k(U,$){var K=a[U];ce(K.userComplete)&&K.userComplete($),K.terminate(),delete a[U]}function B(){throw new Error("Not implemented.")}function Y(U){if(typeof U!="object"||U===null)return U;var $,K=Array.isArray(U)?[]:{};for($ in U)K[$]=Y(U[$]);return K}function G(U,$){return function(){U.apply($,arguments)}}function ce(U){return typeof U=="function"}return p.parse=function(U,$){var K=($=$||{}).dynamicTyping||!1;if(ce(K)&&($.dynamicTypingFunction=K,K={}),$.dynamicTyping=K,$.transform=!!ce($.transform)&&$.transform,!$.worker||!p.WORKERS_SUPPORTED)return K=null,p.NODE_STREAM_INPUT,typeof U=="string"?(U=(ue=>ue.charCodeAt(0)!==65279?ue:ue.slice(1))(U),K=new($.download?v:T)($)):U.readable===!0&&ce(U.read)&&ce(U.on)?K=new E($):(r.File&&U instanceof File||U instanceof Object)&&(K=new w($)),K.stream(U);(K=(()=>{var ue;return!!p.WORKERS_SUPPORTED&&(ue=(()=>{var ge=r.URL||r.webkitURL||null,le=n.toString();return p.BLOB_URL||(p.BLOB_URL=ge.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",le,")();"],{type:"text/javascript"})))})(),(ue=new r.Worker(ue)).onmessage=R,ue.id=f++,a[ue.id]=ue)})()).userStep=$.step,K.userChunk=$.chunk,K.userComplete=$.complete,K.userError=$.error,$.step=ce($.step),$.chunk=ce($.chunk),$.complete=ce($.complete),$.error=ce($.error),delete $.worker,K.postMessage({input:U,config:$,workerId:K.id})},p.unparse=function(U,$){var K=!1,ue=!0,ge=",",le=`\r
`,he='"',Ue=he+he,je=!1,ze=null,me=!1,ye=((()=>{if(typeof $=="object"){if(typeof $.delimiter!="string"||p.BAD_DELIMITERS.filter(function(Oe){return $.delimiter.indexOf(Oe)!==-1}).length||(ge=$.delimiter),typeof $.quotes!="boolean"&&typeof $.quotes!="function"&&!Array.isArray($.quotes)||(K=$.quotes),typeof $.skipEmptyLines!="boolean"&&typeof $.skipEmptyLines!="string"||(je=$.skipEmptyLines),typeof $.newline=="string"&&(le=$.newline),typeof $.quoteChar=="string"&&(he=$.quoteChar),typeof $.header=="boolean"&&(ue=$.header),Array.isArray($.columns)){if($.columns.length===0)throw new Error("Option columns is empty");ze=$.columns}$.escapeChar!==void 0&&(Ue=$.escapeChar+he),$.escapeFormulae instanceof RegExp?me=$.escapeFormulae:typeof $.escapeFormulae=="boolean"&&$.escapeFormulae&&(me=/^[=+\-@\t\r].*$/)}})(),new RegExp(j(he),"g"));if(typeof U=="string"&&(U=JSON.parse(U)),Array.isArray(U)){if(!U.length||Array.isArray(U[0]))return De(null,U,je);if(typeof U[0]=="object")return De(ze||Object.keys(U[0]),U,je)}else if(typeof U=="object")return typeof U.data=="string"&&(U.data=JSON.parse(U.data)),Array.isArray(U.data)&&(U.fields||(U.fields=U.meta&&U.meta.fields||ze),U.fields||(U.fields=Array.isArray(U.data[0])?U.fields:typeof U.data[0]=="object"?Object.keys(U.data[0]):[]),Array.isArray(U.data[0])||typeof U.data[0]=="object"||(U.data=[U.data])),De(U.fields||[],U.data||[],je);throw new Error("Unable to serialize unrecognized input");function De(Oe,Le,xt){var Rt="",Ct=(typeof Oe=="string"&&(Oe=JSON.parse(Oe)),typeof Le=="string"&&(Le=JSON.parse(Le)),Array.isArray(Oe)&&0<Oe.length),sn=!Array.isArray(Le[0]);if(Ct&&ue){for(var lt=0;lt<Oe.length;lt++)0<lt&&(Rt+=ge),Rt+=Me(Oe[lt],lt);0<Le.length&&(Rt+=le)}for(var gt=0;gt<Le.length;gt++){var Ut=(Ct?Oe:Le[gt]).length,qe=!1,zt=Ct?Object.keys(Le[gt]).length===0:Le[gt].length===0;if(xt&&!Ct&&(qe=xt==="greedy"?Le[gt].join("").trim()==="":Le[gt].length===1&&Le[gt][0].length===0),xt==="greedy"&&Ct){for(var Jt=[],Tt=0;Tt<Ut;Tt++){var kt=sn?Oe[Tt]:Tt;Jt.push(Le[gt][kt])}qe=Jt.join("").trim()===""}if(!qe){for(var At=0;At<Ut;At++){0<At&&!zt&&(Rt+=ge);var un=Ct&&sn?Oe[At]:At;Rt+=Me(Le[gt][un],At)}gt<Le.length-1&&(!xt||0<Ut&&!zt)&&(Rt+=le)}}return Rt}function Me(Oe,Le){var xt,Rt;return Oe==null?"":Oe.constructor===Date?JSON.stringify(Oe).slice(1,25):(Rt=!1,me&&typeof Oe=="string"&&me.test(Oe)&&(Oe="'"+Oe,Rt=!0),xt=Oe.toString().replace(ye,Ue),(Rt=Rt||K===!0||typeof K=="function"&&K(Oe,Le)||Array.isArray(K)&&K[Le]||((Ct,sn)=>{for(var lt=0;lt<sn.length;lt++)if(-1<Ct.indexOf(sn[lt]))return!0;return!1})(xt,p.BAD_DELIMITERS)||-1<xt.indexOf(ge)||xt.charAt(0)===" "||xt.charAt(xt.length-1)===" ")?he+xt+he:xt)}},p.RECORD_SEP="",p.UNIT_SEP="",p.BYTE_ORDER_MARK="\uFEFF",p.BAD_DELIMITERS=["\r",`
`,'"',p.BYTE_ORDER_MARK],p.WORKERS_SUPPORTED=!s&&!!r.Worker,p.NODE_STREAM_INPUT=1,p.LocalChunkSize=10485760,p.RemoteChunkSize=5242880,p.DefaultDelimiter=",",p.Parser=I,p.ParserHandle=N,p.NetworkStreamer=v,p.FileStreamer=w,p.StringStreamer=T,p.ReadableStreamStreamer=E,r.jQuery&&((i=r.jQuery).fn.parse=function(U){var $=U.config||{},K=[];return this.each(function(le){if(!(i(this).prop("tagName").toUpperCase()==="INPUT"&&i(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var he=0;he<this.files.length;he++)K.push({file:this.files[he],inputElem:this,instanceConfig:i.extend({},$)})}),ue(),this;function ue(){if(K.length===0)ce(U.complete)&&U.complete();else{var le,he,Ue,je,ze=K[0];if(ce(U.before)){var me=U.before(ze.file,ze.inputElem);if(typeof me=="object"){if(me.action==="abort")return le="AbortError",he=ze.file,Ue=ze.inputElem,je=me.reason,void(ce(U.error)&&U.error({name:le},he,Ue,je));if(me.action==="skip")return void ge();typeof me.config=="object"&&(ze.instanceConfig=i.extend(ze.instanceConfig,me.config))}else if(me==="skip")return void ge()}var ye=ze.instanceConfig.complete;ze.instanceConfig.complete=function(De){ce(ye)&&ye(De,ze.file,ze.inputElem),ge()},p.parse(ze.file,ze.instanceConfig)}}function ge(){K.splice(0,1),ue()}}),o&&(r.onmessage=function(U){U=U.data,p.WORKER_ID===void 0&&U&&(p.WORKER_ID=U.workerId),typeof U.input=="string"?r.postMessage({workerId:p.WORKER_ID,results:p.parse(U.input,U.config),finished:!0}):(r.File&&U.input instanceof File||U.input instanceof Object)&&(U=p.parse(U.input,U.config))&&r.postMessage({workerId:p.WORKER_ID,results:U,finished:!0})}),(v.prototype=Object.create(m.prototype)).constructor=v,(w.prototype=Object.create(m.prototype)).constructor=w,(T.prototype=Object.create(T.prototype)).constructor=T,(E.prototype=Object.create(m.prototype)).constructor=E,p})})(Px);var tU=Px.exports;const vy=tp(tU);function nU({title:t,titleId:e,...n},r){return pe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?pe.createElement("title",{id:e},t):null,pe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}const rU=pe.forwardRef(nU);function iU({title:t,titleId:e,...n},r){return pe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?pe.createElement("title",{id:e},t):null,pe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.53 16.122a3 3 0 0 0-5.78 1.128 2.25 2.25 0 0 1-2.4 2.245 4.5 4.5 0 0 0 8.4-2.245c0-.399-.078-.78-.22-1.128Zm0 0a15.998 15.998 0 0 0 3.388-1.62m-5.043-.025a15.994 15.994 0 0 1 1.622-3.395m3.42 3.42a15.995 15.995 0 0 0 4.764-4.648l3.876-5.814a1.151 1.151 0 0 0-1.597-1.597L14.146 6.32a15.996 15.996 0 0 0-4.649 4.763m3.42 3.42a6.776 6.776 0 0 0-3.42-3.42"}))}const sU=pe.forwardRef(iU);function oU({title:t,titleId:e,...n},r){return pe.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?pe.createElement("title",{id:e},t):null,pe.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const na=pe.forwardRef(oU),aU=({isOpen:t,onClose:e,data:n,onApplyFilter:r,activeFilters:i,onRemoveFilter:s})=>{var ge;const[o,a]=pe.useState([]),[f,p]=pe.useState(""),[m,v]=pe.useState({min:0,max:0}),[w,T]=pe.useState(""),[E,N]=pe.useState([]),[j,I]=pe.useState([]),[R,k]=pe.useState("="),[B,Y]=pe.useState("");pe.useEffect(()=>{N([]),T(""),Y(""),k("=")},[f]),pe.useEffect(()=>{if(n.length>0){const le=n[0],he=le.properties||le,Ue=Object.keys(he).filter(je=>je!=="position").map(je=>{const ze=n.map(Oe=>(Oe.properties||Oe)[je]),me=ze.filter(Oe=>Oe!=null&&Oe!==""),ye=me.filter(Oe=>typeof Oe=="number"?!0:typeof Oe=="string"?!isNaN(parseFloat(Oe)):!1).length,De=me.length>0&&ye/me.length>=.5,Me=De?void 0:[...new Set(ze.map(String))].sort((Oe,Le)=>Oe.toLowerCase().localeCompare(Le.toLowerCase()));return{name:je,type:De?"numeric":"text",uniqueValues:Me}});a(Ue)}},[n]),pe.useEffect(()=>{if(f){const le=o.find(he=>he.name===f);if((le==null?void 0:le.type)==="numeric"){const he=n.map(Ue=>(Ue.properties||Ue)[f]);v({min:Math.min(...he),max:Math.max(...he)})}else(le==null?void 0:le.type)==="text"&&le.uniqueValues&&I(le.uniqueValues)}else I([])},[f,o,n]),pe.useEffect(()=>{if(f&&w){const le=o.find(he=>he.name===f);if((le==null?void 0:le.type)==="text"&&le.uniqueValues){const he=le.uniqueValues.filter(Ue=>Ue.toLowerCase().includes(w.toLowerCase()));I(he)}}},[f,w,o]);const G=le=>{if(le.type==="numeric"){if(le.value.type==="range")return`${le.column}: ${le.value.min} to ${le.value.max}`;{const Ue=le.value;return`${le.column} ${Ue.operator} ${Ue.value}`}}if(le.value.type==="multiple")return`${le.column}: ${le.value.values.join(" OR ")}`;const he=le.value;return`${le.column} ${he.operator} "${he.value}"`},ce=()=>{if(!f)return;const le=o.find(je=>je.name===f);if(!le)return;let he,Ue;if(le.type==="numeric")if(R==="="||B!==""){const je=Number(B);he=ze=>{const ye=(ze.properties||ze)[f];switch(R){case"=":return ye===je;case"<":return ye<je;case"<=":return ye<=je;case">":return ye>je;case">=":return ye>=je;default:return!1}},Ue={column:f,type:"numeric",value:{type:"comparison",operator:R,value:je}}}else he=je=>{const me=(je.properties||je)[f];return me>=m.min&&me<=m.max},Ue={column:f,type:"numeric",value:{type:"range",min:m.min,max:m.max}};else if(R==="="&&E.length>0)he=je=>{const ze=je.properties||je,me=String(ze[f]).toLowerCase();return E.some(ye=>me.includes(ye.toLowerCase()))},Ue={column:f,type:"text",value:{type:"multiple",values:E}};else if(B)he=je=>{const ze=je.properties||je,me=String(ze[f]),ye=B;switch(R){case"=":return me===ye;case"<":return me<ye;case"<=":return me<=ye;case">":return me>ye;case">=":return me>=ye;default:return!1}},Ue={column:f,type:"text",value:{type:"comparison",operator:R,value:B}};else return;r(he,Ue),e()},U=()=>{const le=o.find(he=>he.name===f);(le==null?void 0:le.type)==="text"&&le.uniqueValues&&I(le.uniqueValues.slice(0,5))},$=le=>{E.includes(le)||N(he=>[...he,le]),T("")},K=le=>{N(he=>he.filter(Ue=>Ue!==le))},ue=()=>{const le=o.find(he=>he.name===f);return le?V.jsxs("div",{className:"space-y-4",children:[V.jsxs("div",{className:"flex items-center space-x-2",children:[V.jsxs("select",{className:"p-2 border rounded-md bg-white shadow-sm",value:R,onChange:he=>k(he.target.value),children:[V.jsx("option",{value:"=",children:"="}),V.jsx("option",{value:"<=",children:""}),V.jsx("option",{value:"<",children:"<"}),V.jsx("option",{value:">=",children:""}),V.jsx("option",{value:">",children:">"})]}),R==="="&&le.type==="text"?V.jsxs("div",{className:"flex-1",children:[V.jsx("input",{type:"text",className:"w-full p-2 border rounded-md shadow-sm",value:w,onChange:he=>T(he.target.value),onFocus:U,placeholder:"Type to search..."}),E.length>0&&V.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:E.map(he=>V.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-700",children:[he,V.jsx("button",{onClick:()=>K(he),className:"ml-1.5 text-blue-500 hover:text-blue-700",children:V.jsx(na,{className:"h-4 w-4"})})]},he))})]}):V.jsx("input",{type:le.type==="numeric"?"number":"text",className:"flex-1 p-2 border rounded-md shadow-sm",value:B,onChange:he=>Y(he.target.value),placeholder:`Enter ${le.type==="numeric"?"number":"text"}...`})]}),R==="="&&le.type==="text"&&j.length>0&&V.jsx("div",{className:"mt-1 border rounded-md bg-white shadow-lg max-h-60 overflow-y-auto",children:j.filter(he=>!E.includes(he)).map(he=>V.jsx("div",{className:"px-3 py-2 hover:bg-gray-50 cursor-pointer text-gray-700",onClick:()=>$(he),children:he},he))})]}):null};return t?V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:V.jsxs("div",{className:"bg-white rounded-xl p-6 w-[480px] max-h-[90vh] overflow-y-auto",children:[V.jsxs("div",{className:"flex justify-between items-center mb-6",children:[V.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Filter Data"}),V.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-500 transition-colors",children:V.jsx(na,{className:"w-6 h-6"})})]}),i.length>0&&V.jsxs("div",{className:"mb-6",children:[V.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Active Filters"}),V.jsx("div",{className:"space-y-2",children:i.map((le,he)=>V.jsxs("div",{className:"flex items-center justify-between bg-gray-50 px-3 py-2 rounded-lg",children:[V.jsx("span",{className:"text-sm text-gray-600",children:G(le)}),V.jsx("button",{onClick:()=>s(he),className:"text-gray-400 hover:text-gray-500",children:V.jsx(na,{className:"h-4 w-4"})})]},he))})]}),V.jsxs("div",{className:"space-y-4",children:[V.jsxs("div",{children:[V.jsx("label",{className:"block text-base font-medium text-gray-700 mb-2",children:"Select Column"}),V.jsxs("select",{className:"w-full p-2.5 border rounded-lg bg-white shadow-sm text-gray-900",value:f,onChange:le=>p(le.target.value),children:[V.jsx("option",{value:"",children:"Select a column"}),o.map(le=>V.jsx("option",{value:le.name,children:le.name},le.name))]})]}),f&&ue()]}),V.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[V.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-700 hover:text-gray-900 font-medium",children:"Cancel"}),V.jsx("button",{onClick:ce,className:"px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",disabled:!f||((ge=o.find(le=>le.name===f))==null?void 0:ge.type)==="text"&&R==="="&&E.length===0&&!B,children:"Apply Filter"})]})]})}):null};var cn=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},r;for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);var i="";function s(S){return e.locateFile?e.locateFile(S,i):i+S}var o;typeof document<"u"&&document.currentScript&&(i=document.currentScript.src),i.indexOf("blob:")!==0?i=i.substr(0,i.lastIndexOf("/")+1):i="",o=function(O,q,ie){var l=new XMLHttpRequest;l.open("GET",O,!0),l.responseType="arraybuffer",l.onload=function(){if(l.status==200||l.status==0&&l.response){q(l.response);return}var Ae=Ia(O);if(Ae){q(Ae.buffer);return}ie()},l.onerror=ie,l.send(null)};var a=e.print||console.log.bind(console),f=e.printErr||console.warn.bind(console);for(r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);n=null,e.arguments&&e.arguments;var p=0,m=function(S){p=S},v=function(){return p},w=8;function T(S,O,q,ie){switch(q=q||"i8",q.charAt(q.length-1)==="*"&&(q="i32"),q){case"i1":ge[S>>0]=O;break;case"i8":ge[S>>0]=O;break;case"i16":he[S>>1]=O;break;case"i32":Ue[S>>2]=O;break;case"i64":Un=[O>>>0,(Bt=O,+Jt(Bt)>=1?Bt>0?(At(+kt(Bt/4294967296),4294967295)|0)>>>0:~~+Tt((Bt-+(~~Bt>>>0))/4294967296)>>>0:0)],Ue[S>>2]=Un[0],Ue[S+4>>2]=Un[1];break;case"float":je[S>>2]=O;break;case"double":ze[S>>3]=O;break;default:pi("invalid type for setValue: "+q)}}function E(S,O,q){switch(O=O||"i8",O.charAt(O.length-1)==="*"&&(O="i32"),O){case"i1":return ge[S>>0];case"i8":return ge[S>>0];case"i16":return he[S>>1];case"i32":return Ue[S>>2];case"i64":return Ue[S>>2];case"float":return je[S>>2];case"double":return ze[S>>3];default:pi("invalid type for getValue: "+O)}return null}var N=!1;function j(S,O){S||pi("Assertion failed: "+O)}function I(S){var O=e["_"+S];return j(O,"Cannot call unknown function "+S+", make sure it is exported"),O}function R(S,O,q,ie,l){var P={string:function(Re){var _t=0;if(Re!=null&&Re!==0){var Kt=(Re.length<<2)+1;_t=ws(Kt),U(Re,_t,Kt)}return _t},array:function(Re){var _t=ws(Re.length);return $(Re,_t),_t}};function Ae(Re){return O==="string"?G(Re):O==="boolean"?!!Re:Re}var Ee=I(S),Ne=[],Ce=0;if(ie)for(var Be=0;Be<ie.length;Be++){var ft=P[q[Be]];ft?(Ce===0&&(Ce=Mf()),Ne[Be]=ft(ie[Be])):Ne[Be]=ie[Be]}var He=Ee.apply(null,Ne);return He=Ae(He),Ce!==0&&If(Ce),He}function k(S,O,q,ie){q=q||[];var l=q.every(function(Ae){return Ae==="number"}),P=O!=="string";return P&&l&&!ie?I(S):function(){return R(S,O,q,arguments)}}var B=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Y(S,O,q){for(var ie=O+q,l=O;S[l]&&!(l>=ie);)++l;if(l-O>16&&S.subarray&&B)return B.decode(S.subarray(O,l));for(var P="";O<l;){var Ae=S[O++];if(!(Ae&128)){P+=String.fromCharCode(Ae);continue}var Ee=S[O++]&63;if((Ae&224)==192){P+=String.fromCharCode((Ae&31)<<6|Ee);continue}var Ne=S[O++]&63;if((Ae&240)==224?Ae=(Ae&15)<<12|Ee<<6|Ne:Ae=(Ae&7)<<18|Ee<<12|Ne<<6|S[O++]&63,Ae<65536)P+=String.fromCharCode(Ae);else{var Ce=Ae-65536;P+=String.fromCharCode(55296|Ce>>10,56320|Ce&1023)}}return P}function G(S,O){return S?Y(le,S,O):""}function ce(S,O,q,ie){if(!(ie>0))return 0;for(var l=q,P=q+ie-1,Ae=0;Ae<S.length;++Ae){var Ee=S.charCodeAt(Ae);if(Ee>=55296&&Ee<=57343){var Ne=S.charCodeAt(++Ae);Ee=65536+((Ee&1023)<<10)|Ne&1023}if(Ee<=127){if(q>=P)break;O[q++]=Ee}else if(Ee<=2047){if(q+1>=P)break;O[q++]=192|Ee>>6,O[q++]=128|Ee&63}else if(Ee<=65535){if(q+2>=P)break;O[q++]=224|Ee>>12,O[q++]=128|Ee>>6&63,O[q++]=128|Ee&63}else{if(q+3>=P)break;O[q++]=240|Ee>>18,O[q++]=128|Ee>>12&63,O[q++]=128|Ee>>6&63,O[q++]=128|Ee&63}}return O[q]=0,q-l}function U(S,O,q){return ce(S,le,O,q)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function $(S,O){ge.set(S,O)}function K(S,O){return S%O>0&&(S+=O-S%O),S}var ue,ge,le,he,Ue,je,ze;function me(S){ue=S,e.HEAP8=ge=new Int8Array(S),e.HEAP16=he=new Int16Array(S),e.HEAP32=Ue=new Int32Array(S),e.HEAPU8=le=new Uint8Array(S),e.HEAPU16=new Uint16Array(S),e.HEAPU32=new Uint32Array(S),e.HEAPF32=je=new Float32Array(S),e.HEAPF64=ze=new Float64Array(S)}var ye=5267040,De=24128,Me=e.TOTAL_MEMORY||33554432;e.buffer?ue=e.buffer:ue=new ArrayBuffer(Me),Me=ue.byteLength,me(ue),Ue[De>>2]=ye;function Oe(S){for(;S.length>0;){var O=S.shift();if(typeof O=="function"){O();continue}var q=O.func;typeof q=="number"?O.arg===void 0?e.dynCall_v(q):e.dynCall_vi(q,O.arg):q(O.arg===void 0?null:O.arg)}}var Le=[],xt=[],Rt=[],Ct=[];function sn(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)qe(e.preRun.shift());Oe(Le)}function lt(){Oe(xt)}function gt(){Oe(Rt)}function Ut(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)zt(e.postRun.shift());Oe(Ct)}function qe(S){Le.unshift(S)}function zt(S){Ct.unshift(S)}var Jt=Math.abs,Tt=Math.ceil,kt=Math.floor,At=Math.min,un=0,Ze=null;function Dt(S){un++,e.monitorRunDependencies&&e.monitorRunDependencies(un)}function xr(S){if(un--,e.monitorRunDependencies&&e.monitorRunDependencies(un),un==0&&Ze){var O=Ze;Ze=null,O()}}e.preloadedImages={},e.preloadedAudios={};var xn=null,Ln="data:application/octet-stream;base64,";function Zr(S){return String.prototype.startsWith?S.startsWith(Ln):S.indexOf(Ln)===0}var Bt,Un;xn="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var Ht=24144;function Tn(S,O,q,ie){pi("Assertion failed: "+G(S)+", at: "+[O?G(O):"unknown filename",q,ie?G(ie):"unknown function"])}function or(){return ge.length}function Oi(S,O,q){le.set(le.subarray(O,O+q),S)}function Di(S){return e.___errno_location&&(Ue[e.___errno_location()>>2]=S),S}function En(S){pi("OOM")}function zn(S){try{var O=new ArrayBuffer(S);return O.byteLength!=S?void 0:(new Int8Array(O).set(ge),pA(O),me(O),1)}catch{}}function Fr(S){var O=or(),q=16777216,ie=2147483648-q;if(S>ie)return!1;for(var l=16777216,P=Math.max(O,l);P<S;)P<=536870912?P=K(2*P,q):P=Math.min(K((3*P+2147483648)/4,q),ie);var Ae=zn(P);return!!Ae}var Ao=typeof atob=="function"?atob:function(S){var O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",q="",ie,l,P,Ae,Ee,Ne,Ce,Be=0;S=S.replace(/[^A-Za-z0-9\+\/\=]/g,"");do Ae=O.indexOf(S.charAt(Be++)),Ee=O.indexOf(S.charAt(Be++)),Ne=O.indexOf(S.charAt(Be++)),Ce=O.indexOf(S.charAt(Be++)),ie=Ae<<2|Ee>>4,l=(Ee&15)<<4|Ne>>2,P=(Ne&3)<<6|Ce,q=q+String.fromCharCode(ie),Ne!==64&&(q=q+String.fromCharCode(l)),Ce!==64&&(q=q+String.fromCharCode(P));while(Be<S.length);return q};function kf(S){try{for(var O=Ao(S),q=new Uint8Array(O.length),ie=0;ie<O.length;++ie)q[ie]=O.charCodeAt(ie);return q}catch{throw new Error("Converting base64 string to bytes failed.")}}function Ia(S){if(Zr(S))return kf(S.slice(Ln.length))}var Pf={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Rf={b:m,c:v,d:Tn,e:Di,f:or,g:Oi,h:Fr,i:En,o:Ht,p:De},we=function(S,O,q){"almost asm";var ie=new S.Int8Array(q),l=new S.Int32Array(q);new S.Uint8Array(q),new S.Float32Array(q);var P=new S.Float64Array(q),Ae=O.o|0,Ee=O.p|0,Ne=S.Math.floor,Ce=S.Math.abs,Be=S.Math.sqrt,ft=S.Math.pow,He=S.Math.cos,Re=S.Math.sin,_t=S.Math.tan,Kt=S.Math.acos,ht=S.Math.asin,Sn=S.Math.atan,at=S.Math.atan2,pt=S.Math.ceil,Qe=S.Math.imul,wt=S.Math.min,Vt=S.Math.max,qt=S.Math.clz32,Xe=O.b,z=O.c,$e=O.d,fo=O.e,Nf=O.f,zx=O.g,Vx=O.h,jx=O.i,D=24160;function Wx(c){return ie=new Int8Array(c),l=new Int32Array(c),P=new Float64Array(c),q=c,!0}function $x(c){c=c|0;var A=0;return A=D,D=D+c|0,D=D+15&-16,A|0}function Hx(){return D|0}function Xx(c){c=c|0,D=c}function Qx(c,A){c=c|0,D=c}function Yx(c,A){c=c|0,A=A|0;var u=0,h=0,d=0;return(c|0)<0?(A=2,A|0):(c|0)>13780509?(A=Yf(15,A)|0,A|0):(u=((c|0)<0)<<31>>31,d=Wn(c|0,u|0,3,0)|0,h=z()|0,u=ct(c|0,u|0,1,0)|0,u=Wn(d|0,h|0,u|0,z()|0)|0,u=ct(u|0,z()|0,1,0)|0,c=z()|0,l[A>>2]=u,l[A+4>>2]=c,A=0,A|0)}function Fg(c,A,u,h){return c=c|0,A=A|0,u=u|0,h=h|0,Lg(c,A,u,h,0)|0}function Lg(c,A,u,h,d){c=c|0,A=A|0,u=u|0,h=h|0,d=d|0;var g=0,_=0,y=0,b=0,x=0;if(b=D,D=D+16|0,_=b,!(Ug(c,A,u,h,d)|0))return h=0,D=b,h|0;do if((u|0)>=0){if((u|0)>13780509){if(g=Yf(15,_)|0,g|0)break;y=_,_=l[y>>2]|0,y=l[y+4>>2]|0}else g=((u|0)<0)<<31>>31,x=Wn(u|0,g|0,3,0)|0,y=z()|0,g=ct(u|0,g|0,1,0)|0,g=Wn(x|0,y|0,g|0,z()|0)|0,g=ct(g|0,z()|0,1,0)|0,y=z()|0,l[_>>2]=g,l[_+4>>2]=y,_=g;if(ks(h|0,0,_<<3|0)|0,d|0){ks(d|0,0,_<<2|0)|0,g=gi(c,A,u,h,d,_,y,0)|0;break}g=Jr(_,4)|0,g?(x=gi(c,A,u,h,g,_,y,0)|0,Ge(g),g=x):g=13}else g=2;while(!1);return x=g,D=b,x|0}function Ug(c,A,u,h,d){c=c|0,A=A|0,u=u|0,h=h|0,d=d|0;var g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0,ne=0;if(ne=D,D=D+16|0,Q=ne,H=ne+8|0,X=Q,l[X>>2]=c,l[X+4>>2]=A,(u|0)<0)return H=2,D=ne,H|0;if(g=h,l[g>>2]=c,l[g+4>>2]=A,g=(d|0)!=0,g&&(l[d>>2]=0),Wt(c,A)|0)return H=9,D=ne,H|0;l[H>>2]=0;e:do if((u|0)>=1)if(g)for(C=1,x=0,F=0,X=1,g=c;;){if(!(x|F)){if(g=Cn(g,A,4,H,Q)|0,g|0)break e;if(A=Q,g=l[A>>2]|0,A=l[A+4>>2]|0,Wt(g,A)|0){g=9;break e}}if(g=Cn(g,A,l[22384+(F<<2)>>2]|0,H,Q)|0,g|0)break e;if(A=Q,g=l[A>>2]|0,A=l[A+4>>2]|0,c=h+(C<<3)|0,l[c>>2]=g,l[c+4>>2]=A,l[d+(C<<2)>>2]=X,c=x+1|0,_=(c|0)==(X|0),y=F+1|0,b=(y|0)==6,Wt(g,A)|0){g=9;break e}if(X=X+(b&_&1)|0,(X|0)>(u|0)){g=0;break}else C=C+1|0,x=_?0:c,F=_?b?0:y:F}else for(C=1,x=0,F=0,X=1,g=c;;){if(!(x|F)){if(g=Cn(g,A,4,H,Q)|0,g|0)break e;if(A=Q,g=l[A>>2]|0,A=l[A+4>>2]|0,Wt(g,A)|0){g=9;break e}}if(g=Cn(g,A,l[22384+(F<<2)>>2]|0,H,Q)|0,g|0)break e;if(A=Q,g=l[A>>2]|0,A=l[A+4>>2]|0,c=h+(C<<3)|0,l[c>>2]=g,l[c+4>>2]=A,c=x+1|0,_=(c|0)==(X|0),y=F+1|0,b=(y|0)==6,Wt(g,A)|0){g=9;break e}if(X=X+(b&_&1)|0,(X|0)>(u|0)){g=0;break}else C=C+1|0,x=_?0:c,F=_?b?0:y:F}else g=0;while(!1);return H=g,D=ne,H|0}function gi(c,A,u,h,d,g,_,y){c=c|0,A=A|0,u=u|0,h=h|0,d=d|0,g=g|0,_=_|0,y=y|0;var b=0,x=0,C=0,F=0,X=0,Q=0,H=0,ne=0,de=0,fe=0;if(ne=D,D=D+16|0,Q=ne+8|0,H=ne,b=mo(c|0,A|0,g|0,_|0)|0,C=z()|0,F=h+(b<<3)|0,de=F,fe=l[de>>2]|0,de=l[de+4>>2]|0,x=(fe|0)==(c|0)&(de|0)==(A|0),!((fe|0)==0&(de|0)==0|x))do b=ct(b|0,C|0,1,0)|0,b=wA(b|0,z()|0,g|0,_|0)|0,C=z()|0,F=h+(b<<3)|0,fe=F,de=l[fe>>2]|0,fe=l[fe+4>>2]|0,x=(de|0)==(c|0)&(fe|0)==(A|0);while(!((de|0)==0&(fe|0)==0|x));if(b=d+(b<<2)|0,x&&(l[b>>2]|0)<=(y|0)||(fe=F,l[fe>>2]=c,l[fe+4>>2]=A,l[b>>2]=y,(y|0)>=(u|0)))return fe=0,D=ne,fe|0;switch(x=y+1|0,l[Q>>2]=0,b=Cn(c,A,2,Q,H)|0,b|0){case 9:{X=9;break}case 0:{b=H,b=gi(l[b>>2]|0,l[b+4>>2]|0,u,h,d,g,_,x)|0,b||(X=9);break}}e:do if((X|0)==9){switch(l[Q>>2]=0,b=Cn(c,A,3,Q,H)|0,b|0){case 9:break;case 0:{if(b=H,b=gi(l[b>>2]|0,l[b+4>>2]|0,u,h,d,g,_,x)|0,b|0)break e;break}default:break e}switch(l[Q>>2]=0,b=Cn(c,A,1,Q,H)|0,b|0){case 9:break;case 0:{if(b=H,b=gi(l[b>>2]|0,l[b+4>>2]|0,u,h,d,g,_,x)|0,b|0)break e;break}default:break e}switch(l[Q>>2]=0,b=Cn(c,A,5,Q,H)|0,b|0){case 9:break;case 0:{if(b=H,b=gi(l[b>>2]|0,l[b+4>>2]|0,u,h,d,g,_,x)|0,b|0)break e;break}default:break e}switch(l[Q>>2]=0,b=Cn(c,A,4,Q,H)|0,b|0){case 9:break;case 0:{if(b=H,b=gi(l[b>>2]|0,l[b+4>>2]|0,u,h,d,g,_,x)|0,b|0)break e;break}default:break e}switch(l[Q>>2]=0,b=Cn(c,A,6,Q,H)|0,b|0){case 9:break;case 0:{if(b=H,b=gi(l[b>>2]|0,l[b+4>>2]|0,u,h,d,g,_,x)|0,b|0)break e;break}default:break e}return fe=0,D=ne,fe|0}while(!1);return fe=b,D=ne,fe|0}function Cn(c,A,u,h,d){c=c|0,A=A|0,u=u|0,h=h|0,d=d|0;var g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0;if(u>>>0>6)return d=1,d|0;if(F=(l[h>>2]|0)%6|0,l[h>>2]=F,(F|0)>0){g=0;do u=Es(u)|0,g=g+1|0;while((g|0)<(l[h>>2]|0))}if(F=ve(c|0,A|0,45)|0,z()|0,C=F&127,C>>>0>121)return d=5,d|0;b=ar(c,A)|0,g=ve(c|0,A|0,52)|0,z()|0,g=g&15;e:do if(!g)x=8;else{for(;;){if(_=(15-g|0)*3|0,y=ve(c|0,A|0,_|0)|0,z()|0,y=y&7,(y|0)==7){A=5;break}if(H=(Tr(g)|0)==0,g=g+-1|0,X=Se(7,0,_|0)|0,A=A&~(z()|0),Q=Se(l[(H?432:16)+(y*28|0)+(u<<2)>>2]|0,0,_|0)|0,_=z()|0,u=l[(H?640:224)+(y*28|0)+(u<<2)>>2]|0,c=Q|c&~X,A=_|A,!u){u=0;break e}if(!g){x=8;break e}}return A|0}while(!1);(x|0)==8&&(H=l[848+(C*28|0)+(u<<2)>>2]|0,Q=Se(H|0,0,45)|0,c=Q|c,A=z()|0|A&-1040385,u=l[4272+(C*28|0)+(u<<2)>>2]|0,(H&127|0)==127&&(H=Se(l[848+(C*28|0)+20>>2]|0,0,45)|0,A=z()|0|A&-1040385,u=l[4272+(C*28|0)+20>>2]|0,c=Ss(H|c,A)|0,A=z()|0,l[h>>2]=(l[h>>2]|0)+1)),y=ve(c|0,A|0,45)|0,z()|0,y=y&127;e:do if(jt(y)|0){t:do if((ar(c,A)|0)==1){if((C|0)!=(y|0))if(jg(y,l[7696+(C*28|0)>>2]|0)|0){c=Hf(c,A)|0,_=1,A=z()|0;break}else $e(23313,22416,436,22424);switch(b|0){case 3:{c=Ss(c,A)|0,A=z()|0,l[h>>2]=(l[h>>2]|0)+1,_=0;break t}case 5:{c=Hf(c,A)|0,A=z()|0,l[h>>2]=(l[h>>2]|0)+5,_=0;break t}case 0:return H=9,H|0;default:return H=1,H|0}}else _=0;while(!1);if((u|0)>0){g=0;do c=$f(c,A)|0,A=z()|0,g=g+1|0;while((g|0)!=(u|0))}if((C|0)!=(y|0)){if(!(Df(y)|0)){if((_|0)!=0|(ar(c,A)|0)!=5)break;l[h>>2]=(l[h>>2]|0)+1;break}switch(F&127){case 8:case 118:break e}(ar(c,A)|0)!=3&&(l[h>>2]=(l[h>>2]|0)+1)}}else if((u|0)>0){g=0;do c=Ss(c,A)|0,A=z()|0,g=g+1|0;while((g|0)!=(u|0))}while(!1);return l[h>>2]=((l[h>>2]|0)+u|0)%6|0,H=d,l[H>>2]=c,l[H+4>>2]=A,H=0,H|0}function Of(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0;var d=0,g=0,_=0,y=0,b=0,x=0;for(y=D,D=D+16|0,g=y,_=y+8|0,d=(Wt(c,A)|0)==0,d=d?1:2;;){if(l[_>>2]=0,x=(Cn(c,A,d,_,g)|0)==0,b=g,x&((l[b>>2]|0)==(u|0)?(l[b+4>>2]|0)==(h|0):0)){c=4;break}if(d=d+1|0,d>>>0>=7){d=7,c=4;break}}return(c|0)==4?(D=y,d|0):0}function Kx(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0;var d=0,g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0;if(H=D,D=D+16|0,X=H,Q=H+8|0,F=X,l[F>>2]=c,l[F+4>>2]=A,!u)return Q=h,l[Q>>2]=c,l[Q+4>>2]=A,Q=0,D=H,Q|0;l[Q>>2]=0;e:do if(Wt(c,A)|0)c=9;else{if(g=(u|0)>0,g){d=0,F=c;do{if(c=Cn(F,A,4,Q,X)|0,c|0)break e;if(A=X,F=l[A>>2]|0,A=l[A+4>>2]|0,d=d+1|0,Wt(F,A)|0){c=9;break e}}while((d|0)<(u|0));if(C=h,l[C>>2]=F,l[C+4>>2]=A,C=u+-1|0,g){x=0,c=1;do{if(d=22384+(x<<2)|0,(x|0)==5)for(_=l[d>>2]|0,g=0,d=c;;){if(c=X,c=Cn(l[c>>2]|0,l[c+4>>2]|0,_,Q,X)|0,c|0)break e;if((g|0)!=(C|0))if(b=X,y=l[b>>2]|0,b=l[b+4>>2]|0,c=h+(d<<3)|0,l[c>>2]=y,l[c+4>>2]=b,!(Wt(y,b)|0))c=d+1|0;else{c=9;break e}else c=d;if(g=g+1|0,(g|0)>=(u|0))break;d=c}else for(_=X,b=l[d>>2]|0,y=0,d=c,g=l[_>>2]|0,_=l[_+4>>2]|0;;){if(c=Cn(g,_,b,Q,X)|0,c|0)break e;if(_=X,g=l[_>>2]|0,_=l[_+4>>2]|0,c=h+(d<<3)|0,l[c>>2]=g,l[c+4>>2]=_,c=d+1|0,Wt(g,_)|0){c=9;break e}if(y=y+1|0,(y|0)>=(u|0))break;d=c}x=x+1|0}while(x>>>0<6);c=X,_=F,d=l[c>>2]|0,g=A,c=l[c+4>>2]|0}else _=F,d=F,g=A,c=A}else _=h,l[_>>2]=c,l[_+4>>2]=A,_=c,d=c,g=A,c=A;c=(_|0)==(d|0)&(g|0)==(c|0)?0:9}while(!1);return Q=c,D=H,Q|0}function qx(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0;var d=0,g=0,_=0,y=0,b=0,x=0;if(y=D,D=D+48|0,d=y+16|0,g=y+8|0,_=y,u|0)return _=15,D=y,_|0;if(x=c,b=l[x+4>>2]|0,u=g,l[u>>2]=l[x>>2],l[u+4>>2]=b,um(g,d),A=Hg(d,A,_)|0,!A){if(u=l[g>>2]|0,g=l[c+8>>2]|0,(g|0)>0){d=l[c+12>>2]|0,A=0;do u=(l[d+(A<<3)>>2]|0)+u|0,A=A+1|0;while((A|0)<(g|0))}A=_,d=l[A>>2]|0,A=l[A+4>>2]|0,g=((u|0)<0)<<31>>31,(A|0)<(g|0)|(A|0)==(g|0)&d>>>0<u>>>0?(A=_,l[A>>2]=u,l[A+4>>2]=g,A=g):u=d,b=ct(u|0,A|0,12,0)|0,x=z()|0,A=_,l[A>>2]=b,l[A+4>>2]=x,A=h,l[A>>2]=b,l[A+4>>2]=x,A=0}return x=A,D=y,x|0}function zg(c,A,u,h,d,g,_){c=c|0,A=A|0,u=u|0,h=h|0,d=d|0,g=g|0,_=_|0;var y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0,ne=0,de=0,fe=0,oe=0,ae=0,te=0,ke=0,Fe=0,Te=0,Pe=0,Et=0,mt=0,yt=0,rt=0,nt=0,it=0,It=0,Je=0,Ft=0,er=0,bm=0;if(It=D,D=D+64|0,yt=It+48|0,rt=It+32|0,nt=It+24|0,ke=It+8|0,Fe=It,b=l[c>>2]|0,(b|0)<=0)return it=0,D=It,it|0;for(Te=c+4|0,Pe=yt+8|0,Et=rt+8|0,mt=ke+8|0,y=0,ae=0;;){x=l[Te>>2]|0,oe=x+(ae<<4)|0,l[yt>>2]=l[oe>>2],l[yt+4>>2]=l[oe+4>>2],l[yt+8>>2]=l[oe+8>>2],l[yt+12>>2]=l[oe+12>>2],(ae|0)==(b+-1|0)?(l[rt>>2]=l[x>>2],l[rt+4>>2]=l[x+4>>2],l[rt+8>>2]=l[x+8>>2],l[rt+12>>2]=l[x+12>>2]):(oe=x+(ae+1<<4)|0,l[rt>>2]=l[oe>>2],l[rt+4>>2]=l[oe+4>>2],l[rt+8>>2]=l[oe+8>>2],l[rt+12>>2]=l[oe+12>>2]),b=sT(yt,rt,h,nt)|0;e:do if(b)x=0,y=b;else if(x=nt,b=l[x>>2]|0,x=l[x+4>>2]|0,(x|0)>0|(x|0)==0&b>>>0>0){fe=0,oe=0;t:for(;;){if(bm=+P[yt>>3],de=jn(b|0,x|0,fe|0,oe|0)|0,er=+(de>>>0)+4294967296*+(z()|0),Je=+(b>>>0)+4294967296*+(x|0),Ft=+(fe>>>0)+4294967296*+(oe|0),P[ke>>3]=bm*er/Je+ +P[rt>>3]*Ft/Je,P[mt>>3]=+P[Pe>>3]*er/Je+ +P[Et>>3]*Ft/Je,b=nm(ke,h,Fe)|0,b|0){y=b;break}de=Fe,ne=l[de>>2]|0,de=l[de+4>>2]|0,X=mo(ne|0,de|0,A|0,u|0)|0,C=z()|0,b=_+(X<<3)|0,F=b,x=l[F>>2]|0,F=l[F+4>>2]|0;n:do if((x|0)==0&(F|0)==0)te=b,it=16;else for(Q=0,H=0;;){if((Q|0)>(u|0)|(Q|0)==(u|0)&H>>>0>A>>>0){y=1;break t}if((x|0)==(ne|0)&(F|0)==(de|0))break n;if(b=ct(X|0,C|0,1,0)|0,X=wA(b|0,z()|0,A|0,u|0)|0,C=z()|0,H=ct(H|0,Q|0,1,0)|0,Q=z()|0,b=_+(X<<3)|0,F=b,x=l[F>>2]|0,F=l[F+4>>2]|0,(x|0)==0&(F|0)==0){te=b,it=16;break}}while(!1);if((it|0)==16&&(it=0,!((ne|0)==0&(de|0)==0))&&(H=te,l[H>>2]=ne,l[H+4>>2]=de,H=g+(l[d>>2]<<3)|0,l[H>>2]=ne,l[H+4>>2]=de,H=d,H=ct(l[H>>2]|0,l[H+4>>2]|0,1,0)|0,ne=z()|0,de=d,l[de>>2]=H,l[de+4>>2]=ne),fe=ct(fe|0,oe|0,1,0)|0,oe=z()|0,x=nt,b=l[x>>2]|0,x=l[x+4>>2]|0,!((x|0)>(oe|0)|(x|0)==(oe|0)&b>>>0>fe>>>0)){x=1;break e}}x=0}else x=1;while(!1);if(ae=ae+1|0,!x){it=21;break}if(b=l[c>>2]|0,(ae|0)>=(b|0)){y=0,it=21;break}}return(it|0)==21?(D=It,y|0):0}function Zx(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0;var d=0,g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0,ne=0,de=0,fe=0,oe=0,ae=0,te=0,ke=0,Fe=0,Te=0,Pe=0,Et=0,mt=0,yt=0,rt=0,nt=0,it=0,It=0,Je=0,Ft=0,er=0;if(er=D,D=D+112|0,it=er+80|0,b=er+72|0,It=er,Je=er+56|0,u|0)return Ft=15,D=er,Ft|0;if(x=c+8|0,Ft=Gr((l[x>>2]<<5)+32|0)|0,!Ft)return Ft=13,D=er,Ft|0;if(aE(c,Ft),rt=c,nt=l[rt+4>>2]|0,u=b,l[u>>2]=l[rt>>2],l[u+4>>2]=nt,um(b,it),u=Hg(it,A,It)|0,u)rt=0,nt=0;else{if(u=l[b>>2]|0,g=l[x>>2]|0,(g|0)>0){_=l[c+12>>2]|0,d=0;do u=(l[_+(d<<3)>>2]|0)+u|0,d=d+1|0;while((d|0)!=(g|0));d=u}else d=u;u=It,g=l[u>>2]|0,u=l[u+4>>2]|0,_=((d|0)<0)<<31>>31,(u|0)<(_|0)|(u|0)==(_|0)&g>>>0<d>>>0?(u=It,l[u>>2]=d,l[u+4>>2]=_,u=_):d=g,rt=ct(d|0,u|0,12,0)|0,nt=z()|0,u=It,l[u>>2]=rt,l[u+4>>2]=nt,u=0}if(u|0)return Ge(Ft),Ft=u,D=er,Ft|0;if(d=Jr(rt,8)|0,!d)return Ge(Ft),Ft=13,D=er,Ft|0;if(y=Jr(rt,8)|0,!y)return Ge(Ft),Ge(d),Ft=13,D=er,Ft|0;mt=it,l[mt>>2]=0,l[mt+4>>2]=0,mt=c,yt=l[mt+4>>2]|0,u=b,l[u>>2]=l[mt>>2],l[u+4>>2]=yt,u=zg(b,rt,nt,A,it,d,y)|0;e:do if(u)Ge(d),Ge(y),Ge(Ft);else{t:do if((l[x>>2]|0)>0){for(_=c+12|0,g=0;u=zg((l[_>>2]|0)+(g<<3)|0,rt,nt,A,it,d,y)|0,g=g+1|0,!(u|0);)if((g|0)>=(l[x>>2]|0))break t;Ge(d),Ge(y),Ge(Ft);break e}while(!1);(nt|0)>0|(nt|0)==0&rt>>>0>0&&ks(y|0,0,rt<<3|0)|0,yt=it,mt=l[yt+4>>2]|0;t:do if((mt|0)>0|(mt|0)==0&(l[yt>>2]|0)>>>0>0){Te=d,Pe=y,Et=d,mt=y,yt=d,u=d,te=d,ke=y,Fe=y,d=y;n:for(;;){for(de=0,fe=0,oe=0,ae=0,g=0,_=0;;){y=It,b=y+56|0;do l[y>>2]=0,y=y+4|0;while((y|0)<(b|0));if(A=Te+(de<<3)|0,x=l[A>>2]|0,A=l[A+4>>2]|0,Ug(x,A,1,It,0)|0){y=It,b=y+56|0;do l[y>>2]=0,y=y+4|0;while((y|0)<(b|0));y=Jr(7,4)|0,y|0&&(gi(x,A,1,It,y,7,0,0)|0,Ge(y))}for(ne=0;;){H=It+(ne<<3)|0,Q=l[H>>2]|0,H=l[H+4>>2]|0;r:do if((Q|0)==0&(H|0)==0)y=g,b=_;else{if(C=mo(Q|0,H|0,rt|0,nt|0)|0,x=z()|0,y=h+(C<<3)|0,A=y,b=l[A>>2]|0,A=l[A+4>>2]|0,!((b|0)==0&(A|0)==0)){F=0,X=0;do{if((F|0)>(nt|0)|(F|0)==(nt|0)&X>>>0>rt>>>0)break n;if((b|0)==(Q|0)&(A|0)==(H|0)){y=g,b=_;break r}y=ct(C|0,x|0,1,0)|0,C=wA(y|0,z()|0,rt|0,nt|0)|0,x=z()|0,X=ct(X|0,F|0,1,0)|0,F=z()|0,y=h+(C<<3)|0,A=y,b=l[A>>2]|0,A=l[A+4>>2]|0}while(!((b|0)==0&(A|0)==0))}(Q|0)==0&(H|0)==0?(y=g,b=_):(Ba(Q,H,Je)|0,lE(c,Ft,Je)|0&&(X=ct(g|0,_|0,1,0)|0,_=z()|0,F=y,l[F>>2]=Q,l[F+4>>2]=H,g=Pe+(g<<3)|0,l[g>>2]=Q,l[g+4>>2]=H,g=X),y=g,b=_)}while(!1);if(ne=ne+1|0,ne>>>0>=7)break;g=y,_=b}if(de=ct(de|0,fe|0,1,0)|0,fe=z()|0,oe=ct(oe|0,ae|0,1,0)|0,ae=z()|0,_=it,g=l[_>>2]|0,_=l[_+4>>2]|0,(ae|0)<(_|0)|(ae|0)==(_|0)&oe>>>0<g>>>0)g=y,_=b;else break}if((_|0)>0|(_|0)==0&g>>>0>0){g=0,_=0;do ae=Te+(g<<3)|0,l[ae>>2]=0,l[ae+4>>2]=0,g=ct(g|0,_|0,1,0)|0,_=z()|0,ae=it,oe=l[ae+4>>2]|0;while((_|0)<(oe|0)|((_|0)==(oe|0)?g>>>0<(l[ae>>2]|0)>>>0:0))}if(ae=it,l[ae>>2]=y,l[ae+4>>2]=b,(b|0)>0|(b|0)==0&y>>>0>0)ne=d,de=Fe,fe=yt,oe=ke,ae=Pe,d=te,Fe=u,ke=Et,te=ne,u=de,yt=mt,mt=fe,Et=oe,Pe=Te,Te=ae;else break t}Ge(Et),Ge(mt),Ge(Ft),u=1;break e}else u=y;while(!1);Ge(Ft),Ge(d),Ge(u),u=0}while(!1);return Ft=u,D=er,Ft|0}function Gx(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0,y=0,b=0,x=0,C=0;if(C=D,D=D+176|0,b=C,(A|0)<1)return dm(u,0,0),x=0,D=C,x|0;for(y=c,y=ve(l[y>>2]|0,l[y+4>>2]|0,52)|0,z()|0,dm(u,(A|0)>6?A:6,y&15),y=0;h=c+(y<<3)|0,h=Fa(l[h>>2]|0,l[h+4>>2]|0,b)|0,!(h|0);){if(h=l[b>>2]|0,(h|0)>0){_=0;do g=b+8+(_<<4)|0,_=_+1|0,h=b+8+(((_|0)%(h|0)|0)<<4)|0,d=TE(u,h,g)|0,d?mm(u,d)|0:xE(u,g,h)|0,h=l[b>>2]|0;while((_|0)<(h|0))}if(y=y+1|0,(y|0)>=(A|0)){h=0,x=13;break}}return(x|0)==13?(D=C,h|0):(pm(u),x=h,D=C,x|0)}function Jx(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0;if(g=D,D=D+32|0,h=g,d=g+16|0,c=Gx(c,A,d)|0,c|0)return u=c,D=g,u|0;if(l[u>>2]=0,l[u+4>>2]=0,l[u+8>>2]=0,c=gm(d)|0,c|0)do{A=JT(u)|0;do eE(A,c)|0,_=c+16|0,l[h>>2]=l[_>>2],l[h+4>>2]=l[_+4>>2],l[h+8>>2]=l[_+8>>2],l[h+12>>2]=l[_+12>>2],mm(d,c)|0,c=EE(d,h)|0;while(c|0);c=gm(d)|0}while(c|0);return pm(d),c=tE(u)|0,c?(am(u),_=c,D=g,_|0):(_=0,D=g,_|0)}function jt(c){return c=c|0,c>>>0>121?(c=0,c|0):(c=l[7696+(c*28|0)+16>>2]|0,c|0)}function Df(c){return c=c|0,(c|0)==4|(c|0)==117|0}function Vg(c){return c=c|0,l[11120+((l[c>>2]|0)*216|0)+((l[c+4>>2]|0)*72|0)+((l[c+8>>2]|0)*24|0)+(l[c+12>>2]<<3)>>2]|0}function eT(c){return c=c|0,l[11120+((l[c>>2]|0)*216|0)+((l[c+4>>2]|0)*72|0)+((l[c+8>>2]|0)*24|0)+(l[c+12>>2]<<3)+4>>2]|0}function tT(c,A){c=c|0,A=A|0,c=7696+(c*28|0)|0,l[A>>2]=l[c>>2],l[A+4>>2]=l[c+4>>2],l[A+8>>2]=l[c+8>>2],l[A+12>>2]=l[c+12>>2]}function nT(c,A){c=c|0,A=A|0;var u=0,h=0;if(A>>>0>20)return A=-1,A|0;do if((l[11120+(A*216|0)>>2]|0)!=(c|0))if((l[11120+(A*216|0)+8>>2]|0)!=(c|0))if((l[11120+(A*216|0)+16>>2]|0)!=(c|0))if((l[11120+(A*216|0)+24>>2]|0)!=(c|0))if((l[11120+(A*216|0)+32>>2]|0)!=(c|0))if((l[11120+(A*216|0)+40>>2]|0)!=(c|0))if((l[11120+(A*216|0)+48>>2]|0)!=(c|0))if((l[11120+(A*216|0)+56>>2]|0)!=(c|0))if((l[11120+(A*216|0)+64>>2]|0)!=(c|0))if((l[11120+(A*216|0)+72>>2]|0)!=(c|0))if((l[11120+(A*216|0)+80>>2]|0)!=(c|0))if((l[11120+(A*216|0)+88>>2]|0)!=(c|0))if((l[11120+(A*216|0)+96>>2]|0)!=(c|0))if((l[11120+(A*216|0)+104>>2]|0)!=(c|0))if((l[11120+(A*216|0)+112>>2]|0)!=(c|0))if((l[11120+(A*216|0)+120>>2]|0)!=(c|0))if((l[11120+(A*216|0)+128>>2]|0)!=(c|0))if((l[11120+(A*216|0)+136>>2]|0)==(c|0))c=2,u=1,h=2;else{if((l[11120+(A*216|0)+144>>2]|0)==(c|0)){c=0,u=2,h=0;break}if((l[11120+(A*216|0)+152>>2]|0)==(c|0)){c=0,u=2,h=1;break}if((l[11120+(A*216|0)+160>>2]|0)==(c|0)){c=0,u=2,h=2;break}if((l[11120+(A*216|0)+168>>2]|0)==(c|0)){c=1,u=2,h=0;break}if((l[11120+(A*216|0)+176>>2]|0)==(c|0)){c=1,u=2,h=1;break}if((l[11120+(A*216|0)+184>>2]|0)==(c|0)){c=1,u=2,h=2;break}if((l[11120+(A*216|0)+192>>2]|0)==(c|0)){c=2,u=2,h=0;break}if((l[11120+(A*216|0)+200>>2]|0)==(c|0)){c=2,u=2,h=1;break}if((l[11120+(A*216|0)+208>>2]|0)==(c|0)){c=2,u=2,h=2;break}else c=-1;return c|0}else c=2,u=1,h=1;else c=2,u=1,h=0;else c=1,u=1,h=2;else c=1,u=1,h=1;else c=1,u=1,h=0;else c=0,u=1,h=2;else c=0,u=1,h=1;else c=0,u=1,h=0;else c=2,u=0,h=2;else c=2,u=0,h=1;else c=2,u=0,h=0;else c=1,u=0,h=2;else c=1,u=0,h=1;else c=1,u=0,h=0;else c=0,u=0,h=2;else c=0,u=0,h=1;else c=0,u=0,h=0;while(!1);return A=l[11120+(A*216|0)+(u*72|0)+(c*24|0)+(h<<3)+4>>2]|0,A|0}function jg(c,A){return c=c|0,A=A|0,(l[7696+(c*28|0)+20>>2]|0)==(A|0)?(A=1,A|0):(A=(l[7696+(c*28|0)+24>>2]|0)==(A|0),A|0)}function Bf(c,A){return c=c|0,A=A|0,l[848+(c*28|0)+(A<<2)>>2]|0}function Ff(c,A){return c=c|0,A=A|0,(l[848+(c*28|0)>>2]|0)==(A|0)?(A=0,A|0):(l[848+(c*28|0)+4>>2]|0)==(A|0)?(A=1,A|0):(l[848+(c*28|0)+8>>2]|0)==(A|0)?(A=2,A|0):(l[848+(c*28|0)+12>>2]|0)==(A|0)?(A=3,A|0):(l[848+(c*28|0)+16>>2]|0)==(A|0)?(A=4,A|0):(l[848+(c*28|0)+20>>2]|0)==(A|0)?(A=5,A|0):((l[848+(c*28|0)+24>>2]|0)==(A|0)?6:7)|0}function rT(){return 122}function iT(c){c=c|0;var A=0,u=0,h=0;A=0;do Se(A|0,0,45)|0,h=z()|0|134225919,u=c+(A<<3)|0,l[u>>2]=-1,l[u+4>>2]=h,A=A+1|0;while((A|0)!=122);return 0}function Wg(c){return c=c|0,+P[c+16>>3]<+P[c+24>>3]|0}function $g(c,A){c=c|0,A=A|0;var u=0,h=0,d=0;return u=+P[A>>3],!(u>=+P[c+8>>3])||!(u<=+P[c>>3])?(A=0,A|0):(h=+P[c+16>>3],u=+P[c+24>>3],d=+P[A+8>>3],A=d>=u,c=d<=h&1,h<u?A&&(c=1):A||(c=0),A=(c|0)!=0,A|0)}function Hg(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0,ne=0,de=0;H=D,D=D+288|0,C=H+264|0,F=H+96|0,x=H,y=x,b=y+96|0;do l[y>>2]=0,y=y+4|0;while((y|0)<(b|0));return A=Qf(A,x)|0,A|0?(Q=A,D=H,Q|0):(b=x,x=l[b>>2]|0,b=l[b+4>>2]|0,Ba(x,b,C)|0,Fa(x,b,F)|0,_=+Ua(C,F+8|0),P[C>>3]=+P[c>>3],b=C+8|0,P[b>>3]=+P[c+16>>3],P[F>>3]=+P[c+8>>3],x=F+8|0,P[x>>3]=+P[c+24>>3],d=+Ua(C,F),de=+P[b>>3]-+P[x>>3],g=+Ce(+de),ne=+P[C>>3]-+P[F>>3],h=+Ce(+ne),!(de==0|ne==0)&&(de=+vm(+g,+h),de=+pt(+(d*d/+Zf(+(de/+Zf(+g,+h)),3)/(_*(_*2.59807621135)*.8))),P[Ae>>3]=de,X=~~de>>>0,Q=+Ce(de)>=1?de>0?~~+wt(+Ne(de/4294967296),4294967295)>>>0:~~+pt((de-+(~~de>>>0))/4294967296)>>>0:0,(l[Ae+4>>2]&2146435072|0)!=2146435072)?(F=(X|0)==0&(Q|0)==0,A=u,l[A>>2]=F?1:X,l[A+4>>2]=F?0:Q,A=0):A=1,Q=A,D=H,Q|0)}function sT(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0;var d=0,g=0,_=0,y=0,b=0,x=0,C=0;x=D,D=D+288|0,_=x+264|0,y=x+96|0,b=x,d=b,g=d+96|0;do l[d>>2]=0,d=d+4|0;while((d|0)<(g|0));return u=Qf(u,b)|0,u|0?(h=u,D=x,h|0):(u=b,d=l[u>>2]|0,u=l[u+4>>2]|0,Ba(d,u,_)|0,Fa(d,u,y)|0,C=+Ua(_,y+8|0),C=+pt(+(+Ua(c,A)/(C*2))),P[Ae>>3]=C,u=~~C>>>0,d=+Ce(C)>=1?C>0?~~+wt(+Ne(C/4294967296),4294967295)>>>0:~~+pt((C-+(~~C>>>0))/4294967296)>>>0:0,(l[Ae+4>>2]&2146435072|0)==2146435072?(h=1,D=x,h|0):(b=(u|0)==0&(d|0)==0,l[h>>2]=b?1:u,l[h+4>>2]=b?0:d,h=0,D=x,h|0))}function oT(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0,l[c>>2]=A,l[c+4>>2]=u,l[c+8>>2]=h}function aT(c,A){c=c|0,A=A|0;var u=0,h=0,d=0,g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0;F=A+8|0,l[F>>2]=0,b=+P[c>>3],_=+Ce(+b),x=+P[c+8>>3],y=+Ce(+x)/.8660254037844386,_=_+y*.5,u=~~_,c=~~y,_=_-+(u|0),y=y-+(c|0);do if(_<.5)if(_<.3333333333333333)if(l[A>>2]=u,y<(_+1)*.5){l[A+4>>2]=c;break}else{c=c+1|0,l[A+4>>2]=c;break}else if(X=1-_,c=(!(y<X)&1)+c|0,l[A+4>>2]=c,X<=y&y<_*2){u=u+1|0,l[A>>2]=u;break}else{l[A>>2]=u;break}else{if(!(_<.6666666666666666))if(u=u+1|0,l[A>>2]=u,y<_*.5){l[A+4>>2]=c;break}else{c=c+1|0,l[A+4>>2]=c;break}if(y<1-_){if(l[A+4>>2]=c,_*2+-1<y){l[A>>2]=u;break}}else c=c+1|0,l[A+4>>2]=c;u=u+1|0,l[A>>2]=u}while(!1);do if(b<0)if(c&1){C=(c+1|0)/2|0,C=jn(u|0,((u|0)<0)<<31>>31|0,C|0,((C|0)<0)<<31>>31|0)|0,u=~~(+(u|0)-((+(C>>>0)+4294967296*+(z()|0))*2+1)),l[A>>2]=u;break}else{C=(c|0)/2|0,C=jn(u|0,((u|0)<0)<<31>>31|0,C|0,((C|0)<0)<<31>>31|0)|0,u=~~(+(u|0)-(+(C>>>0)+4294967296*+(z()|0))*2),l[A>>2]=u;break}while(!1);C=A+4|0,x<0&&(u=u-((c<<1|1|0)/2|0)|0,l[A>>2]=u,c=0-c|0,l[C>>2]=c),h=c-u|0,(u|0)<0?(d=0-u|0,l[C>>2]=h,l[F>>2]=d,l[A>>2]=0,c=h,u=0):d=0,(c|0)<0&&(u=u-c|0,l[A>>2]=u,d=d-c|0,l[F>>2]=d,l[C>>2]=0,c=0),g=u-d|0,h=c-d|0,(d|0)<0&&(l[A>>2]=g,l[C>>2]=h,l[F>>2]=0,c=h,u=g,d=0),h=(c|0)<(u|0)?c:u,h=(d|0)<(h|0)?d:h,!((h|0)<=0)&&(l[A>>2]=u-h,l[C>>2]=c-h,l[F>>2]=d-h)}function Vn(c){c=c|0;var A=0,u=0,h=0,d=0,g=0,_=0;A=l[c>>2]|0,_=c+4|0,u=l[_>>2]|0,(A|0)<0&&(u=u-A|0,l[_>>2]=u,g=c+8|0,l[g>>2]=(l[g>>2]|0)-A,l[c>>2]=0,A=0),(u|0)<0?(A=A-u|0,l[c>>2]=A,g=c+8|0,d=(l[g>>2]|0)-u|0,l[g>>2]=d,l[_>>2]=0,u=0):(d=c+8|0,g=d,d=l[d>>2]|0),(d|0)<0&&(A=A-d|0,l[c>>2]=A,u=u-d|0,l[_>>2]=u,l[g>>2]=0,d=0),h=(u|0)<(A|0)?u:A,h=(d|0)<(h|0)?d:h,!((h|0)<=0)&&(l[c>>2]=A-h,l[_>>2]=u-h,l[g>>2]=d-h)}function xs(c,A){c=c|0,A=A|0;var u=0,h=0;h=l[c+8>>2]|0,u=+((l[c+4>>2]|0)-h|0),P[A>>3]=+((l[c>>2]|0)-h|0)-u*.5,P[A+8>>3]=u*.8660254037844386}function Jn(c,A,u){c=c|0,A=A|0,u=u|0,l[u>>2]=(l[A>>2]|0)+(l[c>>2]|0),l[u+4>>2]=(l[A+4>>2]|0)+(l[c+4>>2]|0),l[u+8>>2]=(l[A+8>>2]|0)+(l[c+8>>2]|0)}function Lf(c,A,u){c=c|0,A=A|0,u=u|0,l[u>>2]=(l[c>>2]|0)-(l[A>>2]|0),l[u+4>>2]=(l[c+4>>2]|0)-(l[A+4>>2]|0),l[u+8>>2]=(l[c+8>>2]|0)-(l[A+8>>2]|0)}function Xg(c,A){c=c|0,A=A|0;var u=0,h=0;u=Qe(l[c>>2]|0,A)|0,l[c>>2]=u,u=c+4|0,h=Qe(l[u>>2]|0,A)|0,l[u>>2]=h,c=c+8|0,A=Qe(l[c>>2]|0,A)|0,l[c>>2]=A}function gA(c){c=c|0;var A=0,u=0,h=0,d=0,g=0,_=0,y=0;_=l[c>>2]|0,y=(_|0)<0,h=(l[c+4>>2]|0)-(y?_:0)|0,g=(h|0)<0,d=(g?0-h|0:0)+((l[c+8>>2]|0)-(y?_:0))|0,u=(d|0)<0,c=u?0:d,A=(g?0:h)-(u?d:0)|0,d=(y?0:_)-(g?h:0)-(u?d:0)|0,u=(A|0)<(d|0)?A:d,u=(c|0)<(u|0)?c:u,h=(u|0)>0,c=c-(h?u:0)|0,A=A-(h?u:0)|0;e:do switch(d-(h?u:0)|0){case 0:switch(A|0){case 0:return y=c|0?(c|0)==1?1:7:0,y|0;case 1:return y=c|0?(c|0)==1?3:7:2,y|0;default:break e}case 1:switch(A|0){case 0:return y=c|0?(c|0)==1?5:7:4,y|0;case 1:{if(!c)c=6;else break e;return c|0}default:break e}}while(!1);return y=7,y|0}function lT(c){c=c|0;var A=0,u=0,h=0,d=0,g=0,_=0,y=0;_=c+8|0,d=l[_>>2]|0,g=(l[c>>2]|0)-d|0,y=c+4|0,d=(l[y>>2]|0)-d|0;do if(g>>>0>715827881|d>>>0>715827881){if(u=(g|0)>0,u){if((2147483647-g|0)<(g|0)||(2147483647-(g<<1)|0)<(g|0))return y=1,y|0}else if((-2147483648-g|0)>(g|0)||(-2147483648-(g<<1)|0)>(g|0))return y=1,y|0;if(A=g*3|0,(d|0)>0){if((2147483647-d|0)<(d|0))return y=1,y|0}else if((-2147483648-d|0)>(d|0))return y=1,y|0;if(h=d<<1,(g|0)>-1){if((A|-2147483648|0)>=(d|0))return y=1,y|0}else if((A^-2147483648|0)<(d|0))return y=1,y|0;if(u){if((2147483647-g|0)<(h|0))A=1;else{u=h;break}return A|0}else{if((-2147483648-g|0)>(h|0))A=1;else{u=h;break}return A|0}}else u=d<<1,A=g*3|0;while(!1);h=Li(+(A-d|0)/7)|0,l[c>>2]=h,d=Li(+(u+g|0)/7)|0,l[y>>2]=d,l[_>>2]=0,u=(d|0)<(h|0),A=u?h:d,u=u?d:h;do if((u|0)<0){if((A|0)>0){if((A|-2147483648|0)<(u|0)&((u|0)!=-2147483648&(2147483647-A|0)>=(u|0)))break;$e(23313,22444,355,22455)}if((u|0)==-2147483648|(-2147483648-A|0)>(u|0)&&$e(23313,22444,355,22455),(A|0)>-1){if((A|-2147483648|0)<(u|0))break;$e(23313,22444,355,22455)}else{if((A^-2147483648|0)>=(u|0))break;$e(23313,22444,355,22455)}}while(!1);return A=d-h|0,(h|0)<0?(u=0-h|0,l[y>>2]=A,l[_>>2]=u,l[c>>2]=0,h=0):(A=d,u=0),(A|0)<0&&(h=h-A|0,l[c>>2]=h,u=u-A|0,l[_>>2]=u,l[y>>2]=0,A=0),g=h-u|0,d=A-u|0,(u|0)<0?(l[c>>2]=g,l[y>>2]=d,l[_>>2]=0,A=d,d=g,u=0):d=h,h=(A|0)<(d|0)?A:d,h=(u|0)<(h|0)?u:h,(h|0)<=0?(y=0,y|0):(l[c>>2]=d-h,l[y>>2]=A-h,l[_>>2]=u-h,y=0,y|0)}function AT(c){c=c|0;var A=0,u=0,h=0,d=0,g=0,_=0,y=0;_=c+8|0,d=l[_>>2]|0,g=(l[c>>2]|0)-d|0,y=c+4|0,d=(l[y>>2]|0)-d|0;do if(g>>>0>715827881|d>>>0>715827881){if(u=(g|0)>0,u){if((2147483647-g|0)<(g|0))return y=1,y|0}else if((-2147483648-g|0)>(g|0))return y=1,y|0;if(A=g<<1,(d|0)>0){if((2147483647-d|0)<(d|0)||(2147483647-(d<<1)|0)<(d|0))return y=1,y|0}else if((-2147483648-d|0)>(d|0)||(-2147483648-(d<<1)|0)>(d|0))return y=1,y|0;if(h=d*3|0,u){if((2147483647-A|0)<(d|0))return y=1,y|0}else if((-2147483648-A|0)>(d|0))return y=1,y|0;if((d|0)>-1){if((h|-2147483648|0)<(g|0)){u=h;break}else A=1;return A|0}else{if((h^-2147483648|0)<(g|0))A=1;else{u=h;break}return A|0}}else u=d*3|0,A=g<<1;while(!1);h=Li(+(A+d|0)/7)|0,l[c>>2]=h,d=Li(+(u-g|0)/7)|0,l[y>>2]=d,l[_>>2]=0,u=(d|0)<(h|0),A=u?h:d,u=u?d:h;do if((u|0)<0){if((A|0)>0){if((A|-2147483648|0)<(u|0)&((u|0)!=-2147483648&(2147483647-A|0)>=(u|0)))break;$e(23313,22444,404,22469)}if((u|0)==-2147483648|(-2147483648-A|0)>(u|0)&&$e(23313,22444,404,22469),(A|0)>-1){if((A|-2147483648|0)<(u|0))break;$e(23313,22444,404,22469)}else{if((A^-2147483648|0)>=(u|0))break;$e(23313,22444,404,22469)}}while(!1);return A=d-h|0,(h|0)<0?(u=0-h|0,l[y>>2]=A,l[_>>2]=u,l[c>>2]=0,h=0):(A=d,u=0),(A|0)<0&&(h=h-A|0,l[c>>2]=h,u=u-A|0,l[_>>2]=u,l[y>>2]=0,A=0),g=h-u|0,d=A-u|0,(u|0)<0?(l[c>>2]=g,l[y>>2]=d,l[_>>2]=0,A=d,d=g,u=0):d=h,h=(A|0)<(d|0)?A:d,h=(u|0)<(h|0)?u:h,(h|0)<=0?(y=0,y|0):(l[c>>2]=d-h,l[y>>2]=A-h,l[_>>2]=u-h,y=0,y|0)}function cT(c){c=c|0;var A=0,u=0,h=0,d=0,g=0,_=0,y=0;_=c+8|0,u=l[_>>2]|0,A=(l[c>>2]|0)-u|0,y=c+4|0,u=(l[y>>2]|0)-u|0,h=Li(+((A*3|0)-u|0)/7)|0,l[c>>2]=h,A=Li(+((u<<1)+A|0)/7)|0,l[y>>2]=A,l[_>>2]=0,u=A-h|0,(h|0)<0?(g=0-h|0,l[y>>2]=u,l[_>>2]=g,l[c>>2]=0,A=u,h=0,u=g):u=0,(A|0)<0&&(h=h-A|0,l[c>>2]=h,u=u-A|0,l[_>>2]=u,l[y>>2]=0,A=0),g=h-u|0,d=A-u|0,(u|0)<0?(l[c>>2]=g,l[y>>2]=d,l[_>>2]=0,A=d,d=g,u=0):d=h,h=(A|0)<(d|0)?A:d,h=(u|0)<(h|0)?u:h,!((h|0)<=0)&&(l[c>>2]=d-h,l[y>>2]=A-h,l[_>>2]=u-h)}function Qg(c){c=c|0;var A=0,u=0,h=0,d=0,g=0,_=0,y=0;_=c+8|0,u=l[_>>2]|0,A=(l[c>>2]|0)-u|0,y=c+4|0,u=(l[y>>2]|0)-u|0,h=Li(+((A<<1)+u|0)/7)|0,l[c>>2]=h,A=Li(+((u*3|0)-A|0)/7)|0,l[y>>2]=A,l[_>>2]=0,u=A-h|0,(h|0)<0?(g=0-h|0,l[y>>2]=u,l[_>>2]=g,l[c>>2]=0,A=u,h=0,u=g):u=0,(A|0)<0&&(h=h-A|0,l[c>>2]=h,u=u-A|0,l[_>>2]=u,l[y>>2]=0,A=0),g=h-u|0,d=A-u|0,(u|0)<0?(l[c>>2]=g,l[y>>2]=d,l[_>>2]=0,A=d,d=g,u=0):d=h,h=(A|0)<(d|0)?A:d,h=(u|0)<(h|0)?u:h,!((h|0)<=0)&&(l[c>>2]=d-h,l[y>>2]=A-h,l[_>>2]=u-h)}function mA(c){c=c|0;var A=0,u=0,h=0,d=0,g=0,_=0,y=0;A=l[c>>2]|0,_=c+4|0,u=l[_>>2]|0,y=c+8|0,h=l[y>>2]|0,d=u+(A*3|0)|0,l[c>>2]=d,u=h+(u*3|0)|0,l[_>>2]=u,A=(h*3|0)+A|0,l[y>>2]=A,h=u-d|0,(d|0)<0?(A=A-d|0,l[_>>2]=h,l[y>>2]=A,l[c>>2]=0,u=h,h=0):h=d,(u|0)<0&&(h=h-u|0,l[c>>2]=h,A=A-u|0,l[y>>2]=A,l[_>>2]=0,u=0),g=h-A|0,d=u-A|0,(A|0)<0?(l[c>>2]=g,l[_>>2]=d,l[y>>2]=0,h=g,A=0):d=u,u=(d|0)<(h|0)?d:h,u=(A|0)<(u|0)?A:u,!((u|0)<=0)&&(l[c>>2]=h-u,l[_>>2]=d-u,l[y>>2]=A-u)}function Ts(c){c=c|0;var A=0,u=0,h=0,d=0,g=0,_=0,y=0;d=l[c>>2]|0,_=c+4|0,A=l[_>>2]|0,y=c+8|0,u=l[y>>2]|0,h=(A*3|0)+d|0,d=u+(d*3|0)|0,l[c>>2]=d,l[_>>2]=h,A=(u*3|0)+A|0,l[y>>2]=A,u=h-d|0,(d|0)<0?(A=A-d|0,l[_>>2]=u,l[y>>2]=A,l[c>>2]=0,d=0):u=h,(u|0)<0&&(d=d-u|0,l[c>>2]=d,A=A-u|0,l[y>>2]=A,l[_>>2]=0,u=0),g=d-A|0,h=u-A|0,(A|0)<0?(l[c>>2]=g,l[_>>2]=h,l[y>>2]=0,d=g,A=0):h=u,u=(h|0)<(d|0)?h:d,u=(A|0)<(u|0)?A:u,!((u|0)<=0)&&(l[c>>2]=d-u,l[_>>2]=h-u,l[y>>2]=A-u)}function Yg(c,A){c=c|0,A=A|0;var u=0,h=0,d=0,g=0,_=0,y=0;(A+-1|0)>>>0>=6||(d=(l[15440+(A*12|0)>>2]|0)+(l[c>>2]|0)|0,l[c>>2]=d,y=c+4|0,h=(l[15440+(A*12|0)+4>>2]|0)+(l[y>>2]|0)|0,l[y>>2]=h,_=c+8|0,A=(l[15440+(A*12|0)+8>>2]|0)+(l[_>>2]|0)|0,l[_>>2]=A,u=h-d|0,(d|0)<0?(A=A-d|0,l[y>>2]=u,l[_>>2]=A,l[c>>2]=0,h=0):(u=h,h=d),(u|0)<0&&(h=h-u|0,l[c>>2]=h,A=A-u|0,l[_>>2]=A,l[y>>2]=0,u=0),g=h-A|0,d=u-A|0,(A|0)<0?(l[c>>2]=g,l[y>>2]=d,l[_>>2]=0,h=g,A=0):d=u,u=(d|0)<(h|0)?d:h,u=(A|0)<(u|0)?A:u,!((u|0)<=0)&&(l[c>>2]=h-u,l[y>>2]=d-u,l[_>>2]=A-u))}function Kg(c){c=c|0;var A=0,u=0,h=0,d=0,g=0,_=0,y=0;d=l[c>>2]|0,_=c+4|0,A=l[_>>2]|0,y=c+8|0,u=l[y>>2]|0,h=A+d|0,d=u+d|0,l[c>>2]=d,l[_>>2]=h,A=u+A|0,l[y>>2]=A,u=h-d|0,(d|0)<0?(A=A-d|0,l[_>>2]=u,l[y>>2]=A,l[c>>2]=0,h=0):(u=h,h=d),(u|0)<0&&(h=h-u|0,l[c>>2]=h,A=A-u|0,l[y>>2]=A,l[_>>2]=0,u=0),g=h-A|0,d=u-A|0,(A|0)<0?(l[c>>2]=g,l[_>>2]=d,l[y>>2]=0,h=g,A=0):d=u,u=(d|0)<(h|0)?d:h,u=(A|0)<(u|0)?A:u,!((u|0)<=0)&&(l[c>>2]=h-u,l[_>>2]=d-u,l[y>>2]=A-u)}function _A(c){c=c|0;var A=0,u=0,h=0,d=0,g=0,_=0,y=0;A=l[c>>2]|0,_=c+4|0,h=l[_>>2]|0,y=c+8|0,u=l[y>>2]|0,d=h+A|0,l[c>>2]=d,h=u+h|0,l[_>>2]=h,A=u+A|0,l[y>>2]=A,u=h-d|0,(d|0)<0?(A=A-d|0,l[_>>2]=u,l[y>>2]=A,l[c>>2]=0,h=0):(u=h,h=d),(u|0)<0&&(h=h-u|0,l[c>>2]=h,A=A-u|0,l[y>>2]=A,l[_>>2]=0,u=0),g=h-A|0,d=u-A|0,(A|0)<0?(l[c>>2]=g,l[_>>2]=d,l[y>>2]=0,h=g,A=0):d=u,u=(d|0)<(h|0)?d:h,u=(A|0)<(u|0)?A:u,!((u|0)<=0)&&(l[c>>2]=h-u,l[_>>2]=d-u,l[y>>2]=A-u)}function Es(c){switch(c=c|0,c|0){case 1:{c=5;break}case 5:{c=4;break}case 4:{c=6;break}case 6:{c=2;break}case 2:{c=3;break}case 3:{c=1;break}}return c|0}function Bi(c){switch(c=c|0,c|0){case 1:{c=3;break}case 3:{c=2;break}case 2:{c=6;break}case 6:{c=4;break}case 4:{c=5;break}case 5:{c=1;break}}return c|0}function qg(c){c=c|0;var A=0,u=0,h=0,d=0,g=0,_=0,y=0;A=l[c>>2]|0,_=c+4|0,u=l[_>>2]|0,y=c+8|0,h=l[y>>2]|0,d=u+(A<<1)|0,l[c>>2]=d,u=h+(u<<1)|0,l[_>>2]=u,A=(h<<1)+A|0,l[y>>2]=A,h=u-d|0,(d|0)<0?(A=A-d|0,l[_>>2]=h,l[y>>2]=A,l[c>>2]=0,u=h,h=0):h=d,(u|0)<0&&(h=h-u|0,l[c>>2]=h,A=A-u|0,l[y>>2]=A,l[_>>2]=0,u=0),g=h-A|0,d=u-A|0,(A|0)<0?(l[c>>2]=g,l[_>>2]=d,l[y>>2]=0,h=g,A=0):d=u,u=(d|0)<(h|0)?d:h,u=(A|0)<(u|0)?A:u,!((u|0)<=0)&&(l[c>>2]=h-u,l[_>>2]=d-u,l[y>>2]=A-u)}function Zg(c){c=c|0;var A=0,u=0,h=0,d=0,g=0,_=0,y=0;d=l[c>>2]|0,_=c+4|0,A=l[_>>2]|0,y=c+8|0,u=l[y>>2]|0,h=(A<<1)+d|0,d=u+(d<<1)|0,l[c>>2]=d,l[_>>2]=h,A=(u<<1)+A|0,l[y>>2]=A,u=h-d|0,(d|0)<0?(A=A-d|0,l[_>>2]=u,l[y>>2]=A,l[c>>2]=0,d=0):u=h,(u|0)<0&&(d=d-u|0,l[c>>2]=d,A=A-u|0,l[y>>2]=A,l[_>>2]=0,u=0),g=d-A|0,h=u-A|0,(A|0)<0?(l[c>>2]=g,l[_>>2]=h,l[y>>2]=0,d=g,A=0):h=u,u=(h|0)<(d|0)?h:d,u=(A|0)<(u|0)?A:u,!((u|0)<=0)&&(l[c>>2]=d-u,l[_>>2]=h-u,l[y>>2]=A-u)}function Uf(c,A){c=c|0,A=A|0;var u=0,h=0,d=0,g=0,_=0,y=0;return _=(l[c>>2]|0)-(l[A>>2]|0)|0,y=(_|0)<0,h=(l[c+4>>2]|0)-(l[A+4>>2]|0)-(y?_:0)|0,g=(h|0)<0,d=(y?0-_|0:0)+(l[c+8>>2]|0)-(l[A+8>>2]|0)+(g?0-h|0:0)|0,c=(d|0)<0,A=c?0:d,u=(g?0:h)-(c?d:0)|0,d=(y?0:_)-(g?h:0)-(c?d:0)|0,c=(u|0)<(d|0)?u:d,c=(A|0)<(c|0)?A:c,h=(c|0)>0,A=A-(h?c:0)|0,u=u-(h?c:0)|0,c=d-(h?c:0)|0,c=(c|0)>-1?c:0-c|0,u=(u|0)>-1?u:0-u|0,A=(A|0)>-1?A:0-A|0,A=(u|0)>(A|0)?u:A,((c|0)>(A|0)?c:A)|0}function uT(c,A){c=c|0,A=A|0;var u=0;u=l[c+8>>2]|0,l[A>>2]=(l[c>>2]|0)-u,l[A+4>>2]=(l[c+4>>2]|0)-u}function fT(c,A){c=c|0,A=A|0;var u=0,h=0,d=0,g=0,_=0,y=0;h=l[c>>2]|0,l[A>>2]=h,d=l[c+4>>2]|0,_=A+4|0,l[_>>2]=d,y=A+8|0,l[y>>2]=0,u=(d|0)<(h|0),c=u?h:d,u=u?d:h;do if((u|0)<0){if((c|0)>0){if((c|-2147483648|0)<(u|0)&((u|0)!=-2147483648&(2147483647-c|0)>=(u|0)))break;return c=1,c|0}if((u|0)==-2147483648|(-2147483648-c|0)>(u|0))return A=1,A|0;if((c|0)>-1){if((c|-2147483648|0)<(u|0))break;return c=1,c|0}else{if((c^-2147483648|0)<(u|0))c=1;else break;return c|0}}while(!1);return c=d-h|0,(h|0)<0?(u=0-h|0,l[_>>2]=c,l[y>>2]=u,l[A>>2]=0,h=0):(c=d,u=0),(c|0)<0&&(h=h-c|0,l[A>>2]=h,u=u-c|0,l[y>>2]=u,l[_>>2]=0,c=0),g=h-u|0,d=c-u|0,(u|0)<0?(l[A>>2]=g,l[_>>2]=d,l[y>>2]=0,c=d,d=g,u=0):d=h,h=(c|0)<(d|0)?c:d,h=(u|0)<(h|0)?u:h,(h|0)<=0?(A=0,A|0):(l[A>>2]=d-h,l[_>>2]=c-h,l[y>>2]=u-h,A=0,A|0)}function Gg(c){c=c|0;var A=0,u=0,h=0,d=0;A=c+8|0,d=l[A>>2]|0,u=d-(l[c>>2]|0)|0,l[c>>2]=u,h=c+4|0,c=(l[h>>2]|0)-d|0,l[h>>2]=c,l[A>>2]=0-(c+u)}function hT(c){c=c|0;var A=0,u=0,h=0,d=0,g=0,_=0,y=0;u=l[c>>2]|0,A=0-u|0,l[c>>2]=A,_=c+8|0,l[_>>2]=0,y=c+4|0,h=l[y>>2]|0,d=h+u|0,(u|0)>0?(l[y>>2]=d,l[_>>2]=u,l[c>>2]=0,A=0,h=d):u=0,(h|0)<0?(g=A-h|0,l[c>>2]=g,u=u-h|0,l[_>>2]=u,l[y>>2]=0,d=g-u|0,A=0-u|0,(u|0)<0?(l[c>>2]=d,l[y>>2]=A,l[_>>2]=0,h=A,u=0):(h=0,d=g)):d=A,A=(h|0)<(d|0)?h:d,A=(u|0)<(A|0)?u:A,!((A|0)<=0)&&(l[c>>2]=d-A,l[y>>2]=h-A,l[_>>2]=u-A)}function dT(c,A,u,h,d){c=c|0,A=A|0,u=u|0,h=h|0,d=d|0;var g=0,_=0,y=0,b=0,x=0,C=0,F=0;if(F=D,D=D+64|0,C=F,y=F+56|0,!(!0&(A&2013265920|0)==134217728&(!0&(h&2013265920|0)==134217728)))return d=5,D=F,d|0;if((c|0)==(u|0)&(A|0)==(h|0))return l[d>>2]=0,d=0,D=F,d|0;if(_=ve(c|0,A|0,52)|0,z()|0,_=_&15,x=ve(u|0,h|0,52)|0,z()|0,(_|0)!=(x&15|0))return d=12,D=F,d|0;if(g=_+-1|0,_>>>0>1){Wf(c,A,g,C)|0,Wf(u,h,g,y)|0,x=C,b=l[x>>2]|0,x=l[x+4>>2]|0;e:do if((b|0)==(l[y>>2]|0)&&(x|0)==(l[y+4>>2]|0)){_=(_^15)*3|0,g=ve(c|0,A|0,_|0)|0,z()|0,g=g&7,_=ve(u|0,h|0,_|0)|0,z()|0,_=_&7;do if((g|0)==0|(_|0)==0)l[d>>2]=1,g=0;else if((g|0)==7)g=5;else{if((g|0)==1|(_|0)==1&&Wt(b,x)|0){g=5;break}if((l[15536+(g<<2)>>2]|0)!=(_|0)&&(l[15568+(g<<2)>>2]|0)!=(_|0))break e;l[d>>2]=1,g=0}while(!1);return d=g,D=F,d|0}while(!1)}g=C,_=g+56|0;do l[g>>2]=0,g=g+4|0;while((g|0)<(_|0));return Fg(c,A,1,C)|0,A=C,!((l[A>>2]|0)==(u|0)&&(l[A+4>>2]|0)==(h|0))&&(A=C+8|0,!((l[A>>2]|0)==(u|0)&&(l[A+4>>2]|0)==(h|0)))&&(A=C+16|0,!((l[A>>2]|0)==(u|0)&&(l[A+4>>2]|0)==(h|0)))&&(A=C+24|0,!((l[A>>2]|0)==(u|0)&&(l[A+4>>2]|0)==(h|0)))&&(A=C+32|0,!((l[A>>2]|0)==(u|0)&&(l[A+4>>2]|0)==(h|0)))&&(A=C+40|0,!((l[A>>2]|0)==(u|0)&&(l[A+4>>2]|0)==(h|0)))?(g=C+48|0,g=((l[g>>2]|0)==(u|0)?(l[g+4>>2]|0)==(h|0):0)&1):g=1,l[d>>2]=g,d=0,D=F,d|0}function pT(c,A,u,h,d){return c=c|0,A=A|0,u=u|0,h=h|0,d=d|0,u=Of(c,A,u,h)|0,(u|0)==7?(d=11,d|0):(h=Se(u|0,0,56)|0,A=A&-2130706433|(z()|0)|268435456,l[d>>2]=c|h,l[d+4>>2]=A,d=0,d|0)}function gT(c,A,u){return c=c|0,A=A|0,u=u|0,!0&(A&2013265920|0)==268435456?(l[u>>2]=c,l[u+4>>2]=A&-2130706433|134217728,u=0,u|0):(u=6,u|0)}function mT(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0;return d=D,D=D+16|0,h=d,l[h>>2]=0,!0&(A&2013265920|0)==268435456?(g=ve(c|0,A|0,56)|0,z()|0,h=Cn(c,A&-2130706433|134217728,g&7,h,u)|0,D=d,h|0):(h=6,D=d,h|0)}function _T(c,A){c=c|0,A=A|0;var u=0;switch(u=ve(c|0,A|0,56)|0,z()|0,u&7){case 0:case 7:return u=0,u|0}return u=A&-2130706433|134217728,!(!0&(A&2013265920|0)==268435456)||!0&(A&117440512|0)==16777216&(Wt(c,u)|0)!=0?(u=0,u|0):(u=jf(c,u)|0,u|0)}function yT(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0;return d=D,D=D+16|0,h=d,!0&(A&2013265920|0)==268435456?(g=A&-2130706433|134217728,_=u,l[_>>2]=c,l[_+4>>2]=g,l[h>>2]=0,A=ve(c|0,A|0,56)|0,z()|0,h=Cn(c,g,A&7,h,u+8|0)|0,D=d,h|0):(h=6,D=d,h|0)}function vT(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0;return d=(Wt(c,A)|0)==0,A=A&-2130706433,h=u,l[h>>2]=d?c:0,l[h+4>>2]=d?A|285212672:0,h=u+8|0,l[h>>2]=c,l[h+4>>2]=A|301989888,h=u+16|0,l[h>>2]=c,l[h+4>>2]=A|318767104,h=u+24|0,l[h>>2]=c,l[h+4>>2]=A|335544320,h=u+32|0,l[h>>2]=c,l[h+4>>2]=A|352321536,u=u+40|0,l[u>>2]=c,l[u+4>>2]=A|369098752,0}function yA(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0;return _=D,D=D+16|0,d=_,g=A&-2130706433|134217728,!0&(A&2013265920|0)==268435456?(h=ve(c|0,A|0,56)|0,z()|0,h=yE(c,g,h&7)|0,(h|0)==-1?(l[u>>2]=0,g=6,D=_,g|0):(po(c,g,d)|0&&$e(23313,22484,282,22499),A=ve(c|0,A|0,52)|0,z()|0,A=A&15,Wt(c,g)|0?zf(d,A,h,2,u):Vf(d,A,h,2,u),g=0,D=_,g|0)):(g=6,D=_,g|0)}function wT(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0;h=D,D=D+16|0,d=h,bT(c,A,u,d),aT(d,u+4|0),D=h}function bT(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0;var d=0,g=0,_=0,y=0,b=0;if(y=D,D=D+16|0,b=y,xT(c,u,b),g=+Kt(+(1-+P[b>>3]*.5)),g<1e-16){l[h>>2]=0,l[h+4>>2]=0,l[h+8>>2]=0,l[h+12>>2]=0,D=y;return}if(b=l[u>>2]|0,d=+P[15920+(b*24|0)>>3],d=+La(d-+La(+jT(15600+(b<<4)|0,c))),Tr(A)|0?_=+La(d+-.3334731722518321):_=d,d=+_t(+g)/.381966011250105,(A|0)>0){c=0;do d=d*2.6457513110645907,c=c+1|0;while((c|0)!=(A|0))}g=+He(+_)*d,P[h>>3]=g,_=+Re(+_)*d,P[h+8>>3]=_,D=y}function xT(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0;if(g=D,D=D+32|0,d=g,_E(c,d),l[A>>2]=0,P[u>>3]=5,h=+hn(16400,d),h<+P[u>>3]&&(l[A>>2]=0,P[u>>3]=h),h=+hn(16424,d),h<+P[u>>3]&&(l[A>>2]=1,P[u>>3]=h),h=+hn(16448,d),h<+P[u>>3]&&(l[A>>2]=2,P[u>>3]=h),h=+hn(16472,d),h<+P[u>>3]&&(l[A>>2]=3,P[u>>3]=h),h=+hn(16496,d),h<+P[u>>3]&&(l[A>>2]=4,P[u>>3]=h),h=+hn(16520,d),h<+P[u>>3]&&(l[A>>2]=5,P[u>>3]=h),h=+hn(16544,d),h<+P[u>>3]&&(l[A>>2]=6,P[u>>3]=h),h=+hn(16568,d),h<+P[u>>3]&&(l[A>>2]=7,P[u>>3]=h),h=+hn(16592,d),h<+P[u>>3]&&(l[A>>2]=8,P[u>>3]=h),h=+hn(16616,d),h<+P[u>>3]&&(l[A>>2]=9,P[u>>3]=h),h=+hn(16640,d),h<+P[u>>3]&&(l[A>>2]=10,P[u>>3]=h),h=+hn(16664,d),h<+P[u>>3]&&(l[A>>2]=11,P[u>>3]=h),h=+hn(16688,d),h<+P[u>>3]&&(l[A>>2]=12,P[u>>3]=h),h=+hn(16712,d),h<+P[u>>3]&&(l[A>>2]=13,P[u>>3]=h),h=+hn(16736,d),h<+P[u>>3]&&(l[A>>2]=14,P[u>>3]=h),h=+hn(16760,d),h<+P[u>>3]&&(l[A>>2]=15,P[u>>3]=h),h=+hn(16784,d),h<+P[u>>3]&&(l[A>>2]=16,P[u>>3]=h),h=+hn(16808,d),h<+P[u>>3]&&(l[A>>2]=17,P[u>>3]=h),h=+hn(16832,d),h<+P[u>>3]&&(l[A>>2]=18,P[u>>3]=h),h=+hn(16856,d),!(h<+P[u>>3])){D=g;return}l[A>>2]=19,P[u>>3]=h,D=g}function Da(c,A,u,h,d){c=c|0,A=A|0,u=u|0,h=h|0,d=d|0;var g=0,_=0;if(g=+mE(c),g<1e-16){A=15600+(A<<4)|0,l[d>>2]=l[A>>2],l[d+4>>2]=l[A+4>>2],l[d+8>>2]=l[A+8>>2],l[d+12>>2]=l[A+12>>2];return}if(_=+at(+ +P[c+8>>3],+ +P[c>>3]),(u|0)>0){c=0;do g=g/2.6457513110645907,c=c+1|0;while((c|0)!=(u|0))}h?(g=g/3,u=(Tr(u)|0)==0,g=+Sn(+((u?g:g/2.6457513110645907)*.381966011250105))):(g=+Sn(+(g*.381966011250105)),Tr(u)|0&&(_=+La(_+.3334731722518321))),WT(15600+(A<<4)|0,+La(+P[15920+(A*24|0)>>3]-_),g,d)}function TT(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0;h=D,D=D+16|0,d=h,xs(c+4|0,d),Da(d,l[c>>2]|0,A,0,u),D=h}function zf(c,A,u,h,d){c=c|0,A=A|0,u=u|0,h=h|0,d=d|0;var g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0,ne=0,de=0,fe=0,oe=0,ae=0,te=0,ke=0,Fe=0,Te=0,Pe=0,Et=0,mt=0,yt=0,rt=0,nt=0,it=0,It=0,Je=0;if(it=D,D=D+272|0,g=it+256|0,oe=it+240|0,yt=it,rt=it+224|0,nt=it+208|0,ae=it+176|0,te=it+160|0,ke=it+192|0,Fe=it+144|0,Te=it+128|0,Pe=it+112|0,Et=it+96|0,mt=it+80|0,l[g>>2]=A,l[oe>>2]=l[c>>2],l[oe+4>>2]=l[c+4>>2],l[oe+8>>2]=l[c+8>>2],l[oe+12>>2]=l[c+12>>2],Jg(oe,g,yt),l[d>>2]=0,oe=h+u+((h|0)==5&1)|0,(oe|0)<=(u|0)){D=it;return}b=l[g>>2]|0,x=rt+4|0,C=ae+4|0,F=u+5|0,X=16880+(b<<2)|0,Q=16960+(b<<2)|0,H=Te+8|0,ne=Pe+8|0,de=Et+8|0,fe=nt+4|0,y=u;e:for(;;){_=yt+(((y|0)%5|0)<<4)|0,l[nt>>2]=l[_>>2],l[nt+4>>2]=l[_+4>>2],l[nt+8>>2]=l[_+8>>2],l[nt+12>>2]=l[_+12>>2];do;while((ho(nt,b,0,1)|0)==2);if((y|0)>(u|0)&(Tr(A)|0)!=0){if(l[ae>>2]=l[nt>>2],l[ae+4>>2]=l[nt+4>>2],l[ae+8>>2]=l[nt+8>>2],l[ae+12>>2]=l[nt+12>>2],xs(x,te),h=l[ae>>2]|0,g=l[17040+(h*80|0)+(l[rt>>2]<<2)>>2]|0,l[ae>>2]=l[18640+(h*80|0)+(g*20|0)>>2],_=l[18640+(h*80|0)+(g*20|0)+16>>2]|0,(_|0)>0){c=0;do Kg(C),c=c+1|0;while((c|0)<(_|0))}switch(_=18640+(h*80|0)+(g*20|0)+4|0,l[ke>>2]=l[_>>2],l[ke+4>>2]=l[_+4>>2],l[ke+8>>2]=l[_+8>>2],Xg(ke,(l[X>>2]|0)*3|0),Jn(C,ke,C),Vn(C),xs(C,Fe),It=+(l[Q>>2]|0),P[Te>>3]=It*3,P[H>>3]=0,Je=It*-1.5,P[Pe>>3]=Je,P[ne>>3]=It*2.598076211353316,P[Et>>3]=Je,P[de>>3]=It*-2.598076211353316,l[17040+((l[ae>>2]|0)*80|0)+(l[nt>>2]<<2)>>2]|0){case 1:{c=Pe,h=Te;break}case 3:{c=Et,h=Pe;break}case 2:{c=Te,h=Et;break}default:{c=12;break e}}fm(te,Fe,h,c,mt),Da(mt,l[ae>>2]|0,b,1,d+8+(l[d>>2]<<4)|0),l[d>>2]=(l[d>>2]|0)+1}if((y|0)<(F|0)&&(xs(fe,ae),Da(ae,l[nt>>2]|0,b,1,d+8+(l[d>>2]<<4)|0),l[d>>2]=(l[d>>2]|0)+1),l[rt>>2]=l[nt>>2],l[rt+4>>2]=l[nt+4>>2],l[rt+8>>2]=l[nt+8>>2],l[rt+12>>2]=l[nt+12>>2],y=y+1|0,(y|0)>=(oe|0)){c=3;break}}if((c|0)==3){D=it;return}else(c|0)==12&&$e(22522,22569,571,22579)}function Jg(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0,y=0,b=0;b=D,D=D+128|0,h=b+64|0,d=b,g=h,_=20240,y=g+60|0;do l[g>>2]=l[_>>2],g=g+4|0,_=_+4|0;while((g|0)<(y|0));g=d,_=20304,y=g+60|0;do l[g>>2]=l[_>>2],g=g+4|0,_=_+4|0;while((g|0)<(y|0));y=(Tr(l[A>>2]|0)|0)==0,h=y?h:d,d=c+4|0,qg(d),Zg(d),Tr(l[A>>2]|0)|0&&(Ts(d),l[A>>2]=(l[A>>2]|0)+1),l[u>>2]=l[c>>2],A=u+4|0,Jn(d,h,A),Vn(A),l[u+16>>2]=l[c>>2],A=u+20|0,Jn(d,h+12|0,A),Vn(A),l[u+32>>2]=l[c>>2],A=u+36|0,Jn(d,h+24|0,A),Vn(A),l[u+48>>2]=l[c>>2],A=u+52|0,Jn(d,h+36|0,A),Vn(A),l[u+64>>2]=l[c>>2],u=u+68|0,Jn(d,h+48|0,u),Vn(u),D=b}function ho(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0;var d=0,g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0;if(H=D,D=D+32|0,X=H+12|0,y=H,Q=c+4|0,F=l[16960+(A<<2)>>2]|0,C=(h|0)!=0,F=C?F*3|0:F,d=l[Q>>2]|0,x=c+8|0,_=l[x>>2]|0,C){if(g=c+12|0,h=l[g>>2]|0,d=_+d+h|0,(d|0)==(F|0))return Q=1,D=H,Q|0;b=g}else b=c+12|0,h=l[b>>2]|0,d=_+d+h|0;if((d|0)<=(F|0))return Q=0,D=H,Q|0;do if((h|0)>0){if(h=l[c>>2]|0,(_|0)>0){g=18640+(h*80|0)+60|0,h=c;break}h=18640+(h*80|0)+40|0,u?(oT(X,F,0,0),Lf(Q,X,y),_A(y),Jn(y,X,Q),g=h,h=c):(g=h,h=c)}else g=18640+((l[c>>2]|0)*80|0)+20|0,h=c;while(!1);if(l[h>>2]=l[g>>2],d=g+16|0,(l[d>>2]|0)>0){h=0;do Kg(Q),h=h+1|0;while((h|0)<(l[d>>2]|0))}return c=g+4|0,l[X>>2]=l[c>>2],l[X+4>>2]=l[c+4>>2],l[X+8>>2]=l[c+8>>2],A=l[16880+(A<<2)>>2]|0,Xg(X,C?A*3|0:A),Jn(Q,X,Q),Vn(Q),C?h=((l[x>>2]|0)+(l[Q>>2]|0)+(l[b>>2]|0)|0)==(F|0)?1:2:h=2,Q=h,D=H,Q|0}function ET(c,A){c=c|0,A=A|0;var u=0;do u=ho(c,A,0,1)|0;while((u|0)==2);return u|0}function Vf(c,A,u,h,d){c=c|0,A=A|0,u=u|0,h=h|0,d=d|0;var g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0,ne=0,de=0,fe=0,oe=0,ae=0,te=0,ke=0,Fe=0,Te=0,Pe=0,Et=0,mt=0,yt=0;if(Et=D,D=D+240|0,g=Et+224|0,ke=Et+208|0,Fe=Et,Te=Et+192|0,Pe=Et+176|0,de=Et+160|0,fe=Et+144|0,oe=Et+128|0,ae=Et+112|0,te=Et+96|0,l[g>>2]=A,l[ke>>2]=l[c>>2],l[ke+4>>2]=l[c+4>>2],l[ke+8>>2]=l[c+8>>2],l[ke+12>>2]=l[c+12>>2],em(ke,g,Fe),l[d>>2]=0,ne=h+u+((h|0)==6&1)|0,(ne|0)<=(u|0)){D=Et;return}b=l[g>>2]|0,x=u+6|0,C=16960+(b<<2)|0,F=fe+8|0,X=oe+8|0,Q=ae+8|0,H=Te+4|0,_=0,y=u,h=-1;e:for(;;){if(g=(y|0)%6|0,c=Fe+(g<<4)|0,l[Te>>2]=l[c>>2],l[Te+4>>2]=l[c+4>>2],l[Te+8>>2]=l[c+8>>2],l[Te+12>>2]=l[c+12>>2],c=_,_=ho(Te,b,0,1)|0,(y|0)>(u|0)&(Tr(A)|0)!=0&&(c|0)!=1&&(l[Te>>2]|0)!=(h|0)){switch(xs(Fe+(((g+5|0)%6|0)<<4)+4|0,Pe),xs(Fe+(g<<4)+4|0,de),mt=+(l[C>>2]|0),P[fe>>3]=mt*3,P[F>>3]=0,yt=mt*-1.5,P[oe>>3]=yt,P[X>>3]=mt*2.598076211353316,P[ae>>3]=yt,P[Q>>3]=mt*-2.598076211353316,g=l[ke>>2]|0,l[17040+(g*80|0)+(((h|0)==(g|0)?l[Te>>2]|0:h)<<2)>>2]|0){case 1:{c=oe,h=fe;break}case 3:{c=ae,h=oe;break}case 2:{c=fe,h=ae;break}default:{c=8;break e}}fm(Pe,de,h,c,te),!(hm(Pe,te)|0)&&!(hm(de,te)|0)&&(Da(te,l[ke>>2]|0,b,1,d+8+(l[d>>2]<<4)|0),l[d>>2]=(l[d>>2]|0)+1)}if((y|0)<(x|0)&&(xs(H,Pe),Da(Pe,l[Te>>2]|0,b,1,d+8+(l[d>>2]<<4)|0),l[d>>2]=(l[d>>2]|0)+1),y=y+1|0,(y|0)>=(ne|0)){c=3;break}else h=l[Te>>2]|0}if((c|0)==3){D=Et;return}else(c|0)==8&&$e(22606,22569,736,22651)}function em(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0,y=0,b=0;b=D,D=D+160|0,h=b+80|0,d=b,g=h,_=20368,y=g+72|0;do l[g>>2]=l[_>>2],g=g+4|0,_=_+4|0;while((g|0)<(y|0));g=d,_=20448,y=g+72|0;do l[g>>2]=l[_>>2],g=g+4|0,_=_+4|0;while((g|0)<(y|0));y=(Tr(l[A>>2]|0)|0)==0,h=y?h:d,d=c+4|0,qg(d),Zg(d),Tr(l[A>>2]|0)|0&&(Ts(d),l[A>>2]=(l[A>>2]|0)+1),l[u>>2]=l[c>>2],A=u+4|0,Jn(d,h,A),Vn(A),l[u+16>>2]=l[c>>2],A=u+20|0,Jn(d,h+12|0,A),Vn(A),l[u+32>>2]=l[c>>2],A=u+36|0,Jn(d,h+24|0,A),Vn(A),l[u+48>>2]=l[c>>2],A=u+52|0,Jn(d,h+36|0,A),Vn(A),l[u+64>>2]=l[c>>2],A=u+68|0,Jn(d,h+48|0,A),Vn(A),l[u+80>>2]=l[c>>2],u=u+84|0,Jn(d,h+60|0,u),Vn(u),D=b}function ST(c,A){return c=c|0,A=A|0,A=ve(c|0,A|0,52)|0,z()|0,A&15|0}function tm(c,A){return c=c|0,A=A|0,A=ve(c|0,A|0,45)|0,z()|0,A&127|0}function jf(c,A){c=c|0,A=A|0;var u=0,h=0,d=0,g=0,_=0,y=0;if(!(!0&(A&-16777216|0)==134217728)||(_=ve(c|0,A|0,45)|0,z()|0,_=_&127,_>>>0>121))return A=0,A|0;u=ve(c|0,A|0,52)|0,z()|0,u=u&15;do if(u|0){for(d=1,h=0;;){if(g=ve(c|0,A|0,(15-d|0)*3|0)|0,z()|0,g=g&7,(g|0)!=0&(h^1))if((g|0)==1&(jt(_)|0)!=0){y=0,h=13;break}else h=1;if((g|0)==7){y=0,h=13;break}if(d>>>0<u>>>0)d=d+1|0;else{h=9;break}}if((h|0)==9){if((u|0)==15)y=1;else break;return y|0}else if((h|0)==13)return y|0}while(!1);for(;;){if(y=ve(c|0,A|0,(14-u|0)*3|0)|0,z()|0,!((y&7|0)==7&!0)){y=0,h=13;break}if(u>>>0<14)u=u+1|0;else{y=1,h=13;break}}return(h|0)==13?y|0:0}function Wf(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0;var d=0,g=0;if(g=ve(c|0,A|0,52)|0,z()|0,g=g&15,u>>>0>15)return h=4,h|0;if((g|0)<(u|0))return h=12,h|0;if((g|0)==(u|0))return l[h>>2]=c,l[h+4>>2]=A,h=0,h|0;if(d=Se(u|0,0,52)|0,d=d|c,c=z()|0|A&-15728641,(g|0)>(u|0))do A=Se(7,0,(14-u|0)*3|0)|0,u=u+1|0,d=A|d,c=z()|0|c;while((u|0)<(g|0));return l[h>>2]=d,l[h+4>>2]=c,h=0,h|0}function vA(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0;var d=0,g=0,_=0;if(g=ve(c|0,A|0,52)|0,z()|0,g=g&15,!((u|0)<16&(g|0)<=(u|0)))return h=4,h|0;d=u-g|0,u=ve(c|0,A|0,45)|0,z()|0;e:do if(!(jt(u&127)|0))u=Fi(7,0,d,((d|0)<0)<<31>>31)|0,d=z()|0;else{t:do if(g|0){for(u=1;_=Se(7,0,(15-u|0)*3|0)|0,!!((_&c|0)==0&((z()|0)&A|0)==0);)if(u>>>0<g>>>0)u=u+1|0;else break t;u=Fi(7,0,d,((d|0)<0)<<31>>31)|0,d=z()|0;break e}while(!1);u=Fi(7,0,d,((d|0)<0)<<31>>31)|0,u=Wn(u|0,z()|0,5,0)|0,u=ct(u|0,z()|0,-5,-1)|0,u=Cs(u|0,z()|0,6,0)|0,u=ct(u|0,z()|0,1,0)|0,d=z()|0}while(!1);return _=h,l[_>>2]=u,l[_+4>>2]=d,_=0,_|0}function Wt(c,A){c=c|0,A=A|0;var u=0,h=0,d=0;if(d=ve(c|0,A|0,45)|0,z()|0,!(jt(d&127)|0))return d=0,d|0;d=ve(c|0,A|0,52)|0,z()|0,d=d&15;e:do if(!d)u=0;else for(h=1;;){if(u=ve(c|0,A|0,(15-h|0)*3|0)|0,z()|0,u=u&7,u|0)break e;if(h>>>0<d>>>0)h=h+1|0;else{u=0;break}}while(!1);return d=(u|0)==0&1,d|0}function CT(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0;var d=0,g=0,_=0,y=0;if(_=D,D=D+16|0,g=_,im(g,c,A,u),A=g,c=l[A>>2]|0,A=l[A+4>>2]|0,(c|0)==0&(A|0)==0)return D=_,0;d=0,u=0;do y=h+(d<<3)|0,l[y>>2]=c,l[y+4>>2]=A,d=ct(d|0,u|0,1,0)|0,u=z()|0,sm(g),y=g,c=l[y>>2]|0,A=l[y+4>>2]|0;while(!((c|0)==0&(A|0)==0));return D=_,0}function kT(c,A,u,h){return c=c|0,A=A|0,u=u|0,h=h|0,(h|0)<(u|0)?(u=A,h=c,Xe(u|0),h|0):(u=Se(-1,-1,((h-u|0)*3|0)+3|0)|0,h=Se(~u|0,~(z()|0)|0,(15-h|0)*3|0)|0,u=~(z()|0)&A,h=~h&c,Xe(u|0),h|0)}function PT(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0;var d=0;return d=ve(c|0,A|0,52)|0,z()|0,d=d&15,(u|0)<16&(d|0)<=(u|0)?((d|0)<(u|0)&&(d=Se(-1,-1,((u+-1-d|0)*3|0)+3|0)|0,d=Se(~d|0,~(z()|0)|0,(15-u|0)*3|0)|0,A=~(z()|0)&A,c=~d&c),d=Se(u|0,0,52)|0,u=A&-15728641|(z()|0),l[h>>2]=c|d,l[h+4>>2]=u,h=0,h|0):(h=4,h|0)}function RT(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0;var d=0,g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0,ne=0,de=0,fe=0,oe=0,ae=0,te=0,ke=0,Fe=0,Te=0,Pe=0;if((u|0)==0&(h|0)==0)return Te=0,Te|0;if(d=c,g=l[d>>2]|0,d=l[d+4>>2]|0,!0&(d&15728640|0)==0){if(!((h|0)>0|(h|0)==0&u>>>0>0)||(Te=A,l[Te>>2]=g,l[Te+4>>2]=d,(u|0)==1&(h|0)==0))return Te=0,Te|0;d=1;do ke=c+(d<<3)|0,Fe=l[ke+4>>2]|0,Te=A+(d<<3)|0,l[Te>>2]=l[ke>>2],l[Te+4>>2]=Fe,d=d+1|0;while(0<(h|0)|(h|0)==0&d>>>0<u>>>0);return d=0,d|0}if(te=u<<3,Fe=Gr(te)|0,!Fe)return Te=13,Te|0;if(xA(Fe|0,c|0,te|0)|0,ke=Jr(u,8)|0,!ke)return Ge(Fe),Te=13,Te|0;e:do if(u|0){t:for(;;){d=Fe,fe=l[d>>2]|0,d=l[d+4>>2]|0,oe=ve(fe|0,d|0,52)|0,z()|0,oe=oe&15,ae=oe+-1|0,de=(u|0)>0;n:do if((oe|0)!=0&de){if(Q=((u|0)<0)<<31>>31,H=Se(ae|0,0,52)|0,ne=z()|0,ae>>>0>15){if(!((fe|0)==0&(d|0)==0)){Te=17;break t}for(g=0;;){if(g=g+1|0,(g|0)>=(u|0))break n;if(h=Fe+(g<<3)|0,ne=l[h>>2]|0,h=l[h+4>>2]|0,!((ne|0)==0&(h|0)==0)){d=h,Te=17;break t}}}for(g=0,c=fe,h=d;;){if(!((c|0)==0&(h|0)==0)){if(!(!0&(h&117440512|0)==0)){Te=22;break t}if(y=ve(c|0,h|0,52)|0,z()|0,y=y&15,(y|0)<(ae|0)){d=12,Te=28;break t}if((y|0)!=(ae|0)&&(c=c|H,h=h&-15728641|ne,y>>>0>=oe>>>0)){_=ae;do X=Se(7,0,(14-_|0)*3|0)|0,_=_+1|0,c=X|c,h=z()|0|h;while(_>>>0<y>>>0)}if(_=mo(c|0,h|0,u|0,Q|0)|0,z()|0,x=ke+(_<<3)|0,y=x,b=l[y>>2]|0,y=l[y+4>>2]|0,(b|0)==0&(y|0)==0)_=x;else for(X=0;;){if((X|0)>(u|0)){Te=32;break t}if((b|0)==(c|0)&(y&-117440513|0)==(h|0)){C=ve(b|0,y|0,56)|0,z()|0,C=C&7,F=C+1|0,Pe=ve(b|0,y|0,45)|0,z()|0;r:do if(!(jt(Pe&127)|0))y=7;else{if(b=ve(b|0,y|0,52)|0,z()|0,b=b&15,!b){y=6;break}for(y=1;;){if(Pe=Se(7,0,(15-y|0)*3|0)|0,!((Pe&c|0)==0&((z()|0)&h|0)==0)){y=7;break r}if(y>>>0<b>>>0)y=y+1|0;else{y=6;break}}}while(!1);if((C+2|0)>>>0>y>>>0){Te=42;break t}Pe=Se(F|0,0,56)|0,h=z()|0|h&-117440513,F=x,l[F>>2]=0,l[F+4>>2]=0,c=Pe|c}else _=(_+1|0)%(u|0)|0;if(x=ke+(_<<3)|0,y=x,b=l[y>>2]|0,y=l[y+4>>2]|0,(b|0)==0&(y|0)==0){_=x;break}else X=X+1|0}Pe=_,l[Pe>>2]=c,l[Pe+4>>2]=h}if(g=g+1|0,(g|0)>=(u|0))break n;h=Fe+(g<<3)|0,c=l[h>>2]|0,h=l[h+4>>2]|0}}while(!1);if((u+5|0)>>>0<11){Te=85;break}if(ne=Jr((u|0)/6|0,8)|0,!ne){Te=49;break}n:do if(de){X=0,F=0;do{if(y=ke+(X<<3)|0,h=y,g=l[h>>2]|0,h=l[h+4>>2]|0,!((g|0)==0&(h|0)==0)){b=ve(g|0,h|0,56)|0,z()|0,b=b&7,c=b+1|0,x=h&-117440513,Pe=ve(g|0,h|0,45)|0,z()|0;r:do if(jt(Pe&127)|0){if(C=ve(g|0,h|0,52)|0,z()|0,C=C&15,C|0)for(_=1;;){if(Pe=Se(7,0,(15-_|0)*3|0)|0,!((g&Pe|0)==0&(x&(z()|0)|0)==0))break r;if(_>>>0<C>>>0)_=_+1|0;else break}h=Se(c|0,0,56)|0,g=h|g,h=z()|0|x,c=y,l[c>>2]=g,l[c+4>>2]=h,c=b+2|0}while(!1);(c|0)==7&&(Pe=ne+(F<<3)|0,l[Pe>>2]=g,l[Pe+4>>2]=h&-117440513,F=F+1|0)}X=X+1|0}while((X|0)!=(u|0));if(de){if(X=((u|0)<0)<<31>>31,Q=Se(ae|0,0,52)|0,H=z()|0,ae>>>0>15){if(!((fe|0)==0&(d|0)==0)){d=4,Te=84;break t}for(d=0;;){if(d=d+1|0,(d|0)>=(u|0)){g=0,d=F;break n}if(Pe=Fe+(d<<3)|0,!((l[Pe>>2]|0)==0&(l[Pe+4>>2]|0)==0)){d=4,Te=84;break t}}}for(C=0,g=0,x=fe;;){do if(!((x|0)==0&(d|0)==0)){if(y=ve(x|0,d|0,52)|0,z()|0,y=y&15,(y|0)<(ae|0)){d=12,Te=84;break t}do if((y|0)==(ae|0))h=x,y=d;else{if(h=x|Q,c=d&-15728641|H,y>>>0<oe>>>0){y=c;break}_=ae;do Pe=Se(7,0,(14-_|0)*3|0)|0,_=_+1|0,h=Pe|h,c=z()|0|c;while(_>>>0<y>>>0);y=c}while(!1);for(_=mo(h|0,y|0,u|0,X|0)|0,z()|0,c=0;;){if((c|0)>(u|0)){Te=77;break t}if(Pe=ke+(_<<3)|0,b=l[Pe+4>>2]|0,(b&-117440513|0)==(y|0)&&(l[Pe>>2]|0)==(h|0)){Te=79;break}if(_=(_+1|0)%(u|0)|0,Pe=ke+(_<<3)|0,(l[Pe>>2]|0)==(h|0)&&(l[Pe+4>>2]|0)==(y|0))break;c=c+1|0}if((Te|0)==79&&(Te=0,!0&(b&117440512|0)==100663296))break;Pe=A+(g<<3)|0,l[Pe>>2]=x,l[Pe+4>>2]=d,g=g+1|0}while(!1);if(d=C+1|0,(d|0)>=(u|0)){d=F;break n}Pe=Fe+(d<<3)|0,C=d,x=l[Pe>>2]|0,d=l[Pe+4>>2]|0}}else g=0,d=F}else g=0,d=0;while(!1);if(ks(ke|0,0,te|0)|0,xA(Fe|0,ne|0,d<<3|0)|0,Ge(ne),d)A=A+(g<<3)|0,u=d;else break e}if((Te|0)==17)!0&(d&117440512|0)==0?(d=4,Te=28):Te=22;else if((Te|0)==32)$e(23313,22674,362,22684);else{if((Te|0)==42)return Ge(Fe),Ge(ke),Pe=10,Pe|0;if((Te|0)==49)return Ge(Fe),Ge(ke),Pe=13,Pe|0;if((Te|0)==77)$e(23313,22674,462,22684);else{if((Te|0)==84)return Ge(ne),Ge(Fe),Ge(ke),Pe=d,Pe|0;if((Te|0)==85){xA(A|0,Fe|0,u<<3|0)|0;break}}}if((Te|0)==22)return Ge(Fe),Ge(ke),Pe=5,Pe|0;if((Te|0)==28)return Ge(Fe),Ge(ke),Pe=d,Pe|0}while(!1);return Ge(Fe),Ge(ke),Pe=0,Pe|0}function IT(c,A,u,h,d,g,_){c=c|0,A=A|0,u=u|0,h=h|0,d=d|0,g=g|0,_=_|0;var y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0,ne=0;if(ne=D,D=D+16|0,H=ne,!((u|0)>0|(u|0)==0&A>>>0>0))return H=0,D=ne,H|0;if((_|0)>=16)return H=12,D=ne,H|0;X=0,Q=0,F=0,y=0;e:for(;;){if(x=c+(X<<3)|0,b=l[x>>2]|0,x=l[x+4>>2]|0,C=ve(b|0,x|0,52)|0,z()|0,(C&15|0)>(_|0)){y=12,b=11;break}if(im(H,b,x,_),C=H,x=l[C>>2]|0,C=l[C+4>>2]|0,(x|0)==0&(C|0)==0)b=F;else{b=F;do{if(!((y|0)<(g|0)|(y|0)==(g|0)&b>>>0<d>>>0)){b=10;break e}F=h+(b<<3)|0,l[F>>2]=x,l[F+4>>2]=C,b=ct(b|0,y|0,1,0)|0,y=z()|0,sm(H),F=H,x=l[F>>2]|0,C=l[F+4>>2]|0}while(!((x|0)==0&(C|0)==0))}if(X=ct(X|0,Q|0,1,0)|0,Q=z()|0,(Q|0)<(u|0)|(Q|0)==(u|0)&X>>>0<A>>>0)F=b;else{y=0,b=11;break}}return(b|0)==10?(H=14,D=ne,H|0):(b|0)==11?(D=ne,y|0):0}function MT(c,A,u,h,d){c=c|0,A=A|0,u=u|0,h=h|0,d=d|0;var g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0;X=D,D=D+16|0,F=X;e:do if((u|0)>0|(u|0)==0&A>>>0>0){for(x=0,_=0,g=0,C=0;;){if(b=c+(x<<3)|0,y=l[b>>2]|0,b=l[b+4>>2]|0,!((y|0)==0&(b|0)==0)&&(b=(vA(y,b,h,F)|0)==0,y=F,_=ct(l[y>>2]|0,l[y+4>>2]|0,_|0,g|0)|0,g=z()|0,!b)){g=12;break}if(x=ct(x|0,C|0,1,0)|0,C=z()|0,!((C|0)<(u|0)|(C|0)==(u|0)&x>>>0<A>>>0))break e}return D=X,g|0}else _=0,g=0;while(!1);return l[d>>2]=_,l[d+4>>2]=g,d=0,D=X,d|0}function NT(c,A){return c=c|0,A=A|0,A=ve(c|0,A|0,52)|0,z()|0,A&1|0}function ar(c,A){c=c|0,A=A|0;var u=0,h=0,d=0;if(d=ve(c|0,A|0,52)|0,z()|0,d=d&15,!d)return d=0,d|0;for(h=1;;){if(u=ve(c|0,A|0,(15-h|0)*3|0)|0,z()|0,u=u&7,u|0){h=5;break}if(h>>>0<d>>>0)h=h+1|0;else{u=0,h=5;break}}return(h|0)==5?u|0:0}function $f(c,A){c=c|0,A=A|0;var u=0,h=0,d=0,g=0,_=0,y=0,b=0;if(b=ve(c|0,A|0,52)|0,z()|0,b=b&15,!b)return y=A,b=c,Xe(y|0),b|0;for(y=1,u=0;;){g=(15-y|0)*3|0,h=Se(7,0,g|0)|0,d=z()|0,_=ve(c|0,A|0,g|0)|0,z()|0,g=Se(Es(_&7)|0,0,g|0)|0,_=z()|0,c=g|c&~h,A=_|A&~d;e:do if(!u)if((g&h|0)==0&(_&d|0)==0)u=0;else if(h=ve(c|0,A|0,52)|0,z()|0,h=h&15,!h)u=1;else{u=1;t:for(;;){switch(_=ve(c|0,A|0,(15-u|0)*3|0)|0,z()|0,_&7){case 1:break t;case 0:break;default:{u=1;break e}}if(u>>>0<h>>>0)u=u+1|0;else{u=1;break e}}for(u=1;;)if(_=(15-u|0)*3|0,d=ve(c|0,A|0,_|0)|0,z()|0,g=Se(7,0,_|0)|0,A=A&~(z()|0),_=Se(Es(d&7)|0,0,_|0)|0,c=c&~g|_,A=A|(z()|0),u>>>0<h>>>0)u=u+1|0;else{u=1;break}}while(!1);if(y>>>0<b>>>0)y=y+1|0;else break}return Xe(A|0),c|0}function Ss(c,A){c=c|0,A=A|0;var u=0,h=0,d=0,g=0,_=0;if(h=ve(c|0,A|0,52)|0,z()|0,h=h&15,!h)return u=A,h=c,Xe(u|0),h|0;for(u=1;g=(15-u|0)*3|0,_=ve(c|0,A|0,g|0)|0,z()|0,d=Se(7,0,g|0)|0,A=A&~(z()|0),g=Se(Es(_&7)|0,0,g|0)|0,c=g|c&~d,A=z()|0|A,u>>>0<h>>>0;)u=u+1|0;return Xe(A|0),c|0}function OT(c,A){c=c|0,A=A|0;var u=0,h=0,d=0,g=0,_=0,y=0,b=0;if(b=ve(c|0,A|0,52)|0,z()|0,b=b&15,!b)return y=A,b=c,Xe(y|0),b|0;for(y=1,u=0;;){g=(15-y|0)*3|0,h=Se(7,0,g|0)|0,d=z()|0,_=ve(c|0,A|0,g|0)|0,z()|0,g=Se(Bi(_&7)|0,0,g|0)|0,_=z()|0,c=g|c&~h,A=_|A&~d;e:do if(!u)if((g&h|0)==0&(_&d|0)==0)u=0;else if(h=ve(c|0,A|0,52)|0,z()|0,h=h&15,!h)u=1;else{u=1;t:for(;;){switch(_=ve(c|0,A|0,(15-u|0)*3|0)|0,z()|0,_&7){case 1:break t;case 0:break;default:{u=1;break e}}if(u>>>0<h>>>0)u=u+1|0;else{u=1;break e}}for(u=1;;)if(d=(15-u|0)*3|0,g=Se(7,0,d|0)|0,_=A&~(z()|0),A=ve(c|0,A|0,d|0)|0,z()|0,A=Se(Bi(A&7)|0,0,d|0)|0,c=c&~g|A,A=_|(z()|0),u>>>0<h>>>0)u=u+1|0;else{u=1;break}}while(!1);if(y>>>0<b>>>0)y=y+1|0;else break}return Xe(A|0),c|0}function Hf(c,A){c=c|0,A=A|0;var u=0,h=0,d=0,g=0,_=0;if(h=ve(c|0,A|0,52)|0,z()|0,h=h&15,!h)return u=A,h=c,Xe(u|0),h|0;for(u=1;_=(15-u|0)*3|0,g=Se(7,0,_|0)|0,d=A&~(z()|0),A=ve(c|0,A|0,_|0)|0,z()|0,A=Se(Bi(A&7)|0,0,_|0)|0,c=A|c&~g,A=z()|0|d,u>>>0<h>>>0;)u=u+1|0;return Xe(A|0),c|0}function DT(c,A){c=c|0,A=A|0;var u=0,h=0,d=0,g=0,_=0,y=0,b=0,x=0,C=0;if(b=D,D=D+64|0,y=b+40|0,h=b+24|0,d=b+12|0,g=b,Se(A|0,0,52)|0,u=z()|0|134225919,!A)return(l[c+4>>2]|0)>2||(l[c+8>>2]|0)>2||(l[c+12>>2]|0)>2?(_=0,y=0,Xe(_|0),D=b,y|0):(Se(Vg(c)|0,0,45)|0,_=z()|0|u,y=-1,Xe(_|0),D=b,y|0);if(l[y>>2]=l[c>>2],l[y+4>>2]=l[c+4>>2],l[y+8>>2]=l[c+8>>2],l[y+12>>2]=l[c+12>>2],_=y+4|0,(A|0)>0)for(c=-1;l[h>>2]=l[_>>2],l[h+4>>2]=l[_+4>>2],l[h+8>>2]=l[_+8>>2],A&1?(cT(_),l[d>>2]=l[_>>2],l[d+4>>2]=l[_+4>>2],l[d+8>>2]=l[_+8>>2],mA(d)):(Qg(_),l[d>>2]=l[_>>2],l[d+4>>2]=l[_+4>>2],l[d+8>>2]=l[_+8>>2],Ts(d)),Lf(h,d,g),Vn(g),C=(15-A|0)*3|0,x=Se(7,0,C|0)|0,u=u&~(z()|0),C=Se(gA(g)|0,0,C|0)|0,c=C|c&~x,u=z()|0|u,(A|0)>1;)A=A+-1|0;else c=-1;e:do if((l[_>>2]|0)<=2&&(l[y+8>>2]|0)<=2&&(l[y+12>>2]|0)<=2){if(h=Vg(y)|0,A=Se(h|0,0,45)|0,A=A|c,c=z()|0|u&-1040385,g=eT(y)|0,!(jt(h)|0)){if((g|0)<=0)break;for(d=0;;){if(h=ve(A|0,c|0,52)|0,z()|0,h=h&15,h)for(u=1;C=(15-u|0)*3|0,y=ve(A|0,c|0,C|0)|0,z()|0,x=Se(7,0,C|0)|0,c=c&~(z()|0),C=Se(Es(y&7)|0,0,C|0)|0,A=A&~x|C,c=c|(z()|0),u>>>0<h>>>0;)u=u+1|0;if(d=d+1|0,(d|0)==(g|0))break e}}d=ve(A|0,c|0,52)|0,z()|0,d=d&15;t:do if(d){u=1;n:for(;;){switch(C=ve(A|0,c|0,(15-u|0)*3|0)|0,z()|0,C&7){case 1:break n;case 0:break;default:break t}if(u>>>0<d>>>0)u=u+1|0;else break t}if(jg(h,l[y>>2]|0)|0)for(u=1;y=(15-u|0)*3|0,x=Se(7,0,y|0)|0,C=c&~(z()|0),c=ve(A|0,c|0,y|0)|0,z()|0,c=Se(Bi(c&7)|0,0,y|0)|0,A=A&~x|c,c=C|(z()|0),u>>>0<d>>>0;)u=u+1|0;else for(u=1;C=(15-u|0)*3|0,y=ve(A|0,c|0,C|0)|0,z()|0,x=Se(7,0,C|0)|0,c=c&~(z()|0),C=Se(Es(y&7)|0,0,C|0)|0,A=A&~x|C,c=c|(z()|0),u>>>0<d>>>0;)u=u+1|0}while(!1);if((g|0)>0){u=0;do A=$f(A,c)|0,c=z()|0,u=u+1|0;while((u|0)!=(g|0))}}else A=0,c=0;while(!1);return x=c,C=A,Xe(x|0),D=b,C|0}function Tr(c){return c=c|0,(c|0)%2|0|0}function nm(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0;return d=D,D=D+16|0,h=d,A>>>0>15?(h=4,D=d,h|0):(l[c+4>>2]&2146435072|0)==2146435072||(l[c+8+4>>2]&2146435072|0)==2146435072?(h=3,D=d,h|0):(wT(c,A,h),A=DT(h,A)|0,h=z()|0,l[u>>2]=A,l[u+4>>2]=h,(A|0)==0&(h|0)==0&&$e(23313,22674,786,22697),h=0,D=d,h|0)}function Xf(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0;if(d=u+4|0,g=ve(c|0,A|0,52)|0,z()|0,g=g&15,_=ve(c|0,A|0,45)|0,z()|0,h=(g|0)==0,jt(_&127)|0){if(h)return _=1,_|0;h=1}else{if(h)return _=0,_|0;!(l[d>>2]|0)&&!(l[u+8>>2]|0)?h=(l[u+12>>2]|0)!=0&1:h=1}for(u=1;u&1?mA(d):Ts(d),_=ve(c|0,A|0,(15-u|0)*3|0)|0,z()|0,Yg(d,_&7),u>>>0<g>>>0;)u=u+1|0;return h|0}function po(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0,y=0,b=0,x=0,C=0;if(C=D,D=D+16|0,b=C,x=ve(c|0,A|0,45)|0,z()|0,x=x&127,x>>>0>121)return l[u>>2]=0,l[u+4>>2]=0,l[u+8>>2]=0,l[u+12>>2]=0,x=5,D=C,x|0;e:do if(jt(x)|0&&(g=ve(c|0,A|0,52)|0,z()|0,g=g&15,(g|0)!=0)){h=1;t:for(;;){switch(y=ve(c|0,A|0,(15-h|0)*3|0)|0,z()|0,y&7){case 5:break t;case 0:break;default:{h=A;break e}}if(h>>>0<g>>>0)h=h+1|0;else{h=A;break e}}for(d=1,h=A;A=(15-d|0)*3|0,_=Se(7,0,A|0)|0,y=h&~(z()|0),h=ve(c|0,h|0,A|0)|0,z()|0,h=Se(Bi(h&7)|0,0,A|0)|0,c=c&~_|h,h=y|(z()|0),d>>>0<g>>>0;)d=d+1|0}else h=A;while(!1);if(y=7696+(x*28|0)|0,l[u>>2]=l[y>>2],l[u+4>>2]=l[y+4>>2],l[u+8>>2]=l[y+8>>2],l[u+12>>2]=l[y+12>>2],!(Xf(c,h,u)|0))return x=0,D=C,x|0;if(_=u+4|0,l[b>>2]=l[_>>2],l[b+4>>2]=l[_+4>>2],l[b+8>>2]=l[_+8>>2],g=ve(c|0,h|0,52)|0,z()|0,y=g&15,g&1?(Ts(_),g=y+1|0):g=y,!(jt(x)|0))h=0;else{e:do if(!y)h=0;else for(A=1;;){if(d=ve(c|0,h|0,(15-A|0)*3|0)|0,z()|0,d=d&7,d|0){h=d;break e}if(A>>>0<y>>>0)A=A+1|0;else{h=0;break}}while(!1);h=(h|0)==4&1}if(!(ho(u,g,h,0)|0))(g|0)!=(y|0)&&(l[_>>2]=l[b>>2],l[_+4>>2]=l[b+4>>2],l[_+8>>2]=l[b+8>>2]);else{if(jt(x)|0)do;while(ho(u,g,0,0)|0);(g|0)!=(y|0)&&Qg(_)}return x=0,D=C,x|0}function Ba(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0;return g=D,D=D+16|0,h=g,d=po(c,A,h)|0,d|0?(D=g,d|0):(d=ve(c|0,A|0,52)|0,z()|0,TT(h,d&15,u),d=0,D=g,d|0)}function Fa(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0,y=0;if(_=D,D=D+16|0,g=_,h=po(c,A,g)|0,h|0)return g=h,D=_,g|0;h=ve(c|0,A|0,45)|0,z()|0,h=(jt(h&127)|0)==0,d=ve(c|0,A|0,52)|0,z()|0,d=d&15;e:do if(!h){if(d|0)for(h=1;;){if(y=Se(7,0,(15-h|0)*3|0)|0,!((y&c|0)==0&((z()|0)&A|0)==0))break e;if(h>>>0<d>>>0)h=h+1|0;else break}return zf(g,d,0,5,u),y=0,D=_,y|0}while(!1);return Vf(g,d,0,6,u),y=0,D=_,y|0}function BT(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0;if(d=ve(c|0,A|0,45)|0,z()|0,!(jt(d&127)|0))return d=2,l[u>>2]=d,0;if(d=ve(c|0,A|0,52)|0,z()|0,d=d&15,!d)return d=5,l[u>>2]=d,0;for(h=1;;){if(g=Se(7,0,(15-h|0)*3|0)|0,!((g&c|0)==0&((z()|0)&A|0)==0)){h=2,c=6;break}if(h>>>0<d>>>0)h=h+1|0;else{h=5,c=6;break}}return(c|0)==6&&(l[u>>2]=h),0}function rm(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0,y=0,b=0,x=0,C=0,F=0;F=D,D=D+128|0,x=F+112|0,g=F+96|0,C=F,d=ve(c|0,A|0,52)|0,z()|0,y=d&15,l[x>>2]=y,_=ve(c|0,A|0,45)|0,z()|0,_=_&127;e:do if(jt(_)|0){if(y|0)for(h=1;;){if(b=Se(7,0,(15-h|0)*3|0)|0,!((b&c|0)==0&((z()|0)&A|0)==0)){d=0;break e}if(h>>>0<y>>>0)h=h+1|0;else break}if(d&1)d=1;else return b=Se(y+1|0,0,52)|0,C=z()|0|A&-15728641,x=Se(7,0,(14-y|0)*3|0)|0,C=rm((b|c)&~x,C&~(z()|0),u)|0,D=F,C|0}else d=0;while(!1);if(h=po(c,A,g)|0,!h){d?(Jg(g,x,C),b=5):(em(g,x,C),b=6);e:do if(jt(_)|0)if(!y)c=5;else for(h=1;;){if(_=Se(7,0,(15-h|0)*3|0)|0,!((_&c|0)==0&((z()|0)&A|0)==0)){c=2;break e}if(h>>>0<y>>>0)h=h+1|0;else{c=5;break}}else c=2;while(!1);ks(u|0,-1,c<<2|0)|0;e:do if(d)for(g=0;;){if(_=C+(g<<4)|0,ET(_,l[x>>2]|0)|0,_=l[_>>2]|0,y=l[u>>2]|0,(y|0)==-1|(y|0)==(_|0))h=u;else{d=0;do{if(d=d+1|0,d>>>0>=c>>>0){h=1;break e}h=u+(d<<2)|0,y=l[h>>2]|0}while(!((y|0)==-1|(y|0)==(_|0)))}if(l[h>>2]=_,g=g+1|0,g>>>0>=b>>>0){h=0;break}}else for(g=0;;){if(_=C+(g<<4)|0,ho(_,l[x>>2]|0,0,1)|0,_=l[_>>2]|0,y=l[u>>2]|0,(y|0)==-1|(y|0)==(_|0))h=u;else{d=0;do{if(d=d+1|0,d>>>0>=c>>>0){h=1;break e}h=u+(d<<2)|0,y=l[h>>2]|0}while(!((y|0)==-1|(y|0)==(_|0)))}if(l[h>>2]=_,g=g+1|0,g>>>0>=b>>>0){h=0;break}}while(!1)}return C=h,D=F,C|0}function FT(){return 12}function Qf(c,A){c=c|0,A=A|0;var u=0,h=0,d=0,g=0,_=0,y=0,b=0;if(c>>>0>15)return y=4,y|0;if(Se(c|0,0,52)|0,y=z()|0|134225919,!c){u=0,h=0;do jt(h)|0&&(Se(h|0,0,45)|0,_=y|(z()|0),c=A+(u<<3)|0,l[c>>2]=-1,l[c+4>>2]=_,u=u+1|0),h=h+1|0;while((h|0)!=122);return u=0,u|0}u=0,_=0;do{if(jt(_)|0){for(Se(_|0,0,45)|0,h=1,d=-1,g=y|(z()|0);b=Se(7,0,(15-h|0)*3|0)|0,d=d&~b,g=g&~(z()|0),(h|0)!=(c|0);)h=h+1|0;b=A+(u<<3)|0,l[b>>2]=d,l[b+4>>2]=g,u=u+1|0}_=_+1|0}while((_|0)!=122);return u=0,u|0}function LT(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0;var d=0,g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0,ne=0,de=0,fe=0,oe=0;if(oe=D,D=D+16|0,de=oe,fe=ve(c|0,A|0,52)|0,z()|0,fe=fe&15,u>>>0>15)return fe=4,D=oe,fe|0;if((fe|0)<(u|0))return fe=12,D=oe,fe|0;if((fe|0)!=(u|0))if(g=Se(u|0,0,52)|0,g=g|c,y=z()|0|A&-15728641,(fe|0)>(u|0)){b=u;do ne=Se(7,0,(14-b|0)*3|0)|0,b=b+1|0,g=ne|g,y=z()|0|y;while((b|0)<(fe|0));ne=g}else ne=g;else ne=c,y=A;H=ve(ne|0,y|0,45)|0,z()|0;e:do if(jt(H&127)|0){if(b=ve(ne|0,y|0,52)|0,z()|0,b=b&15,b|0)for(g=1;;){if(H=Se(7,0,(15-g|0)*3|0)|0,!((H&ne|0)==0&((z()|0)&y|0)==0)){x=33;break e}if(g>>>0<b>>>0)g=g+1|0;else break}if(H=h,l[H>>2]=0,l[H+4>>2]=0,(fe|0)>(u|0)){for(H=A&-15728641,Q=fe;;){if(X=Q,Q=Q+-1|0,Q>>>0>15|(fe|0)<(Q|0)){x=19;break}if((fe|0)!=(Q|0))if(g=Se(Q|0,0,52)|0,g=g|c,b=z()|0|H,(fe|0)<(X|0))F=g;else{x=Q;do F=Se(7,0,(14-x|0)*3|0)|0,x=x+1|0,g=F|g,b=z()|0|b;while((x|0)<(fe|0));F=g}else F=c,b=A;if(C=ve(F|0,b|0,45)|0,z()|0,!(jt(C&127)|0))g=0;else{C=ve(F|0,b|0,52)|0,z()|0,C=C&15;t:do if(!C)g=0;else for(x=1;;){if(g=ve(F|0,b|0,(15-x|0)*3|0)|0,z()|0,g=g&7,g|0)break t;if(x>>>0<C>>>0)x=x+1|0;else{g=0;break}}while(!1);g=(g|0)==0&1}if(b=ve(c|0,A|0,(15-X|0)*3|0)|0,z()|0,b=b&7,(b|0)==7){d=5,x=42;break}if(g=(g|0)!=0,(b|0)==1&g){d=5,x=42;break}if(F=b+(((b|0)!=0&g)<<31>>31)|0,F|0&&(x=fe-X|0,x=Fi(7,0,x,((x|0)<0)<<31>>31)|0,C=z()|0,g?(g=Wn(x|0,C|0,5,0)|0,g=ct(g|0,z()|0,-5,-1)|0,g=Cs(g|0,z()|0,6,0)|0,g=ct(g|0,z()|0,1,0)|0,b=z()|0):(g=x,b=C),X=F+-1|0,X=Wn(x|0,C|0,X|0,((X|0)<0)<<31>>31|0)|0,X=ct(g|0,b|0,X|0,z()|0)|0,F=z()|0,C=h,C=ct(X|0,F|0,l[C>>2]|0,l[C+4>>2]|0)|0,F=z()|0,X=h,l[X>>2]=C,l[X+4>>2]=F),(Q|0)<=(u|0)){x=37;break}}if((x|0)==19)$e(23313,22674,1099,22710);else if((x|0)==37){_=h,d=l[_+4>>2]|0,_=l[_>>2]|0;break}else if((x|0)==42)return D=oe,d|0}else d=0,_=0}else x=33;while(!1);e:do if((x|0)==33)if(H=h,l[H>>2]=0,l[H+4>>2]=0,(fe|0)>(u|0)){for(g=fe;;){if(d=ve(c|0,A|0,(15-g|0)*3|0)|0,z()|0,d=d&7,(d|0)==7){d=5;break}if(_=fe-g|0,_=Fi(7,0,_,((_|0)<0)<<31>>31)|0,d=Wn(_|0,z()|0,d|0,0)|0,_=z()|0,H=h,_=ct(l[H>>2]|0,l[H+4>>2]|0,d|0,_|0)|0,d=z()|0,H=h,l[H>>2]=_,l[H+4>>2]=d,g=g+-1|0,(g|0)<=(u|0))break e}return D=oe,d|0}else d=0,_=0;while(!1);return vA(ne,y,fe,de)|0&&$e(23313,22674,1063,22725),fe=de,de=l[fe+4>>2]|0,((d|0)>-1|(d|0)==-1&_>>>0>4294967295)&((de|0)>(d|0)|((de|0)==(d|0)?(l[fe>>2]|0)>>>0>_>>>0:0))?(fe=0,D=oe,fe|0):($e(23313,22674,1139,22710),0)}function UT(c,A,u,h,d,g){c=c|0,A=A|0,u=u|0,h=h|0,d=d|0,g=g|0;var _=0,y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0,ne=0;if(F=D,D=D+16|0,_=F,d>>>0>15)return g=4,D=F,g|0;if(y=ve(u|0,h|0,52)|0,z()|0,y=y&15,(y|0)>(d|0))return g=12,D=F,g|0;if(vA(u,h,d,_)|0&&$e(23313,22674,1063,22725),C=_,x=l[C+4>>2]|0,!(((A|0)>-1|(A|0)==-1&c>>>0>4294967295)&((x|0)>(A|0)|((x|0)==(A|0)?(l[C>>2]|0)>>>0>c>>>0:0))))return g=2,D=F,g|0;C=d-y|0,d=Se(d|0,0,52)|0,b=z()|0|h&-15728641,x=g,l[x>>2]=d|u,l[x+4>>2]=b,x=ve(u|0,h|0,45)|0,z()|0;e:do if(jt(x&127)|0){if(y|0)for(_=1;;){if(x=Se(7,0,(15-_|0)*3|0)|0,!((x&u|0)==0&((z()|0)&h|0)==0))break e;if(_>>>0<y>>>0)_=_+1|0;else break}if((C|0)<1)return g=0,D=F,g|0;for(x=y^15,h=-1,b=1,_=1;;){y=C-b|0,y=Fi(7,0,y,((y|0)<0)<<31>>31)|0,u=z()|0;do if(_)if(_=Wn(y|0,u|0,5,0)|0,_=ct(_|0,z()|0,-5,-1)|0,_=Cs(_|0,z()|0,6,0)|0,d=z()|0,(A|0)>(d|0)|(A|0)==(d|0)&c>>>0>_>>>0){A=ct(c|0,A|0,-1,-1)|0,A=jn(A|0,z()|0,_|0,d|0)|0,_=z()|0,X=g,H=l[X>>2]|0,X=l[X+4>>2]|0,ne=(x+h|0)*3|0,Q=Se(7,0,ne|0)|0,X=X&~(z()|0),h=Cs(A|0,_|0,y|0,u|0)|0,c=z()|0,d=ct(h|0,c|0,2,0)|0,ne=Se(d|0,z()|0,ne|0)|0,X=z()|0|X,d=g,l[d>>2]=ne|H&~Q,l[d+4>>2]=X,c=Wn(h|0,c|0,y|0,u|0)|0,c=jn(A|0,_|0,c|0,z()|0)|0,_=0,A=z()|0;break}else{ne=g,Q=l[ne>>2]|0,ne=l[ne+4>>2]|0,H=Se(7,0,(x+h|0)*3|0)|0,ne=ne&~(z()|0),_=g,l[_>>2]=Q&~H,l[_+4>>2]=ne,_=1;break}else Q=g,d=l[Q>>2]|0,Q=l[Q+4>>2]|0,h=(x+h|0)*3|0,X=Se(7,0,h|0)|0,Q=Q&~(z()|0),ne=Cs(c|0,A|0,y|0,u|0)|0,_=z()|0,h=Se(ne|0,_|0,h|0)|0,Q=z()|0|Q,H=g,l[H>>2]=h|d&~X,l[H+4>>2]=Q,_=Wn(ne|0,_|0,y|0,u|0)|0,c=jn(c|0,A|0,_|0,z()|0)|0,_=0,A=z()|0;while(!1);if((C|0)>(b|0))h=~b,b=b+1|0;else{A=0;break}}return D=F,A|0}while(!1);if((C|0)<1)return ne=0,D=F,ne|0;for(d=y^15,_=1;;)if(H=C-_|0,H=Fi(7,0,H,((H|0)<0)<<31>>31)|0,ne=z()|0,b=g,u=l[b>>2]|0,b=l[b+4>>2]|0,y=(d-_|0)*3|0,h=Se(7,0,y|0)|0,b=b&~(z()|0),X=Cs(c|0,A|0,H|0,ne|0)|0,Q=z()|0,y=Se(X|0,Q|0,y|0)|0,b=z()|0|b,x=g,l[x>>2]=y|u&~h,l[x+4>>2]=b,ne=Wn(X|0,Q|0,H|0,ne|0)|0,c=jn(c|0,A|0,ne|0,z()|0)|0,A=z()|0,(C|0)<=(_|0)){A=0;break}else _=_+1|0;return D=F,A|0}function im(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0;var d=0,g=0;d=ve(A|0,u|0,52)|0,z()|0,d=d&15,(A|0)==0&(u|0)==0|((h|0)>15|(d|0)>(h|0))?(h=-1,d=-1,A=0,u=0):(g=kT(A,u,d+1|0,h)|0,u=(z()|0)&-15728641,A=Se(h|0,0,52)|0,A=g|A,u=u|(z()|0),g=(Wt(A,u)|0)==0,h=g?-1:h),g=c,l[g>>2]=A,l[g+4>>2]=u,l[c+8>>2]=d,l[c+12>>2]=h}function sm(c){c=c|0;var A=0,u=0,h=0,d=0,g=0,_=0,y=0,b=0,x=0;if(u=c,A=l[u>>2]|0,u=l[u+4>>2]|0,!((A|0)==0&(u|0)==0)&&(h=ve(A|0,u|0,52)|0,z()|0,h=h&15,y=Se(1,0,(h^15)*3|0)|0,A=ct(y|0,z()|0,A|0,u|0)|0,u=z()|0,y=c,l[y>>2]=A,l[y+4>>2]=u,y=c+8|0,_=l[y>>2]|0,!((h|0)<(_|0)))){for(b=c+12|0,g=h;;){if((g|0)==(_|0)){h=5;break}if(x=(g|0)==(l[b>>2]|0),d=(15-g|0)*3|0,h=ve(A|0,u|0,d|0)|0,z()|0,h=h&7,x&((h|0)==1&!0)){h=7;break}if(!((h|0)==7&!0)){h=10;break}if(x=Se(1,0,d|0)|0,A=ct(A|0,u|0,x|0,z()|0)|0,u=z()|0,x=c,l[x>>2]=A,l[x+4>>2]=u,(g|0)>(_|0))g=g+-1|0;else{h=10;break}}if((h|0)==5){x=c,l[x>>2]=0,l[x+4>>2]=0,l[y>>2]=-1,l[b>>2]=-1;return}else if((h|0)==7){_=Se(1,0,d|0)|0,_=ct(A|0,u|0,_|0,z()|0)|0,y=z()|0,x=c,l[x>>2]=_,l[x+4>>2]=y,l[b>>2]=g+-1;return}else if((h|0)==10)return}}function La(c){c=+c;var A=0;return A=c<0?c+6.283185307179586:c,+(c>=6.283185307179586?A+-6.283185307179586:A)}function go(c,A){return c=c|0,A=A|0,+Ce(+(+P[c>>3]-+P[A>>3]))<17453292519943298e-27?(A=+Ce(+(+P[c+8>>3]-+P[A+8>>3]))<17453292519943298e-27,A|0):(A=0,A|0)}function zT(c,A){c=c|0,A=A|0;var u=0,h=0,d=0,g=0;return d=+P[A>>3],h=+P[c>>3],g=+Re(+((d-h)*.5)),u=+Re(+((+P[A+8>>3]-+P[c+8>>3])*.5)),u=g*g+u*(+He(+d)*+He(+h)*u),+(+at(+ +Be(+u),+ +Be(+(1-u)))*2)}function Ua(c,A){c=c|0,A=A|0;var u=0,h=0,d=0,g=0;return d=+P[A>>3],h=+P[c>>3],g=+Re(+((d-h)*.5)),u=+Re(+((+P[A+8>>3]-+P[c+8>>3])*.5)),u=g*g+u*(+He(+d)*+He(+h)*u),+(+at(+ +Be(+u),+ +Be(+(1-u)))*2*6371.007180918475)}function VT(c,A){c=c|0,A=A|0;var u=0,h=0,d=0,g=0;return d=+P[A>>3],h=+P[c>>3],g=+Re(+((d-h)*.5)),u=+Re(+((+P[A+8>>3]-+P[c+8>>3])*.5)),u=g*g+u*(+He(+d)*+He(+h)*u),+(+at(+ +Be(+u),+ +Be(+(1-u)))*2*6371.007180918475*1e3)}function jT(c,A){c=c|0,A=A|0;var u=0,h=0,d=0,g=0,_=0;return g=+P[A>>3],h=+He(+g),d=+P[A+8>>3]-+P[c+8>>3],_=h*+Re(+d),u=+P[c>>3],+ +at(+_,+(+Re(+g)*+He(+u)-+He(+d)*(h*+Re(+u))))}function WT(c,A,u,h){c=c|0,A=+A,u=+u,h=h|0;var d=0,g=0,_=0,y=0;if(u<1e-16){l[h>>2]=l[c>>2],l[h+4>>2]=l[c+4>>2],l[h+8>>2]=l[c+8>>2],l[h+12>>2]=l[c+12>>2];return}g=A<0?A+6.283185307179586:A,g=A>=6.283185307179586?g+-6.283185307179586:g;do if(g<1e-16)A=+P[c>>3]+u,P[h>>3]=A,d=h;else{if(d=+Ce(+(g+-3.141592653589793))<1e-16,A=+P[c>>3],d){A=A-u,P[h>>3]=A,d=h;break}if(_=+He(+u),u=+Re(+u),A=_*+Re(+A)+ +He(+g)*(u*+He(+A)),A=A>1?1:A,A=+ht(+(A<-1?-1:A)),P[h>>3]=A,+Ce(+(A+-1.5707963267948966))<1e-16){P[h>>3]=1.5707963267948966,P[h+8>>3]=0;return}if(+Ce(+(A+1.5707963267948966))<1e-16){P[h>>3]=-1.5707963267948966,P[h+8>>3]=0;return}if(y=+He(+A),g=u*+Re(+g)/y,u=+P[c>>3],A=(_-+Re(+A)*+Re(+u))/+He(+u)/y,_=g>1?1:g,A=A>1?1:A,A=+P[c+8>>3]+ +at(+(_<-1?-1:_),+(A<-1?-1:A)),A>3.141592653589793)do A=A+-6.283185307179586;while(A>3.141592653589793);if(A<-3.141592653589793)do A=A+6.283185307179586;while(A<-3.141592653589793);P[h+8>>3]=A;return}while(!1);if(+Ce(+(A+-1.5707963267948966))<1e-16){P[d>>3]=1.5707963267948966,P[h+8>>3]=0;return}if(+Ce(+(A+1.5707963267948966))<1e-16){P[d>>3]=-1.5707963267948966,P[h+8>>3]=0;return}if(A=+P[c+8>>3],A>3.141592653589793)do A=A+-6.283185307179586;while(A>3.141592653589793);if(A<-3.141592653589793)do A=A+6.283185307179586;while(A<-3.141592653589793);P[h+8>>3]=A}function $T(c,A){return c=c|0,A=A|0,c>>>0>15?(A=4,A|0):(P[A>>3]=+P[20528+(c<<3)>>3],A=0,A|0)}function HT(c,A){return c=c|0,A=A|0,c>>>0>15?(A=4,A|0):(P[A>>3]=+P[20656+(c<<3)>>3],A=0,A|0)}function XT(c,A){return c=c|0,A=A|0,c>>>0>15?(A=4,A|0):(P[A>>3]=+P[20784+(c<<3)>>3],A=0,A|0)}function QT(c,A){return c=c|0,A=A|0,c>>>0>15?(A=4,A|0):(P[A>>3]=+P[20912+(c<<3)>>3],A=0,A|0)}function Yf(c,A){c=c|0,A=A|0;var u=0;return c>>>0>15?(A=4,A|0):(u=Fi(7,0,c,((c|0)<0)<<31>>31)|0,u=Wn(u|0,z()|0,120,0)|0,c=z()|0,l[A>>2]=u|2,l[A+4>>2]=c,A=0,A|0)}function om(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0;return X=+P[A>>3],C=+P[c>>3],b=+Re(+((X-C)*.5)),g=+P[A+8>>3],x=+P[c+8>>3],_=+Re(+((g-x)*.5)),y=+He(+C),F=+He(+X),_=b*b+_*(F*y*_),_=+at(+ +Be(+_),+ +Be(+(1-_)))*2,b=+P[u>>3],X=+Re(+((b-X)*.5)),h=+P[u+8>>3],g=+Re(+((h-g)*.5)),d=+He(+b),g=X*X+g*(F*d*g),g=+at(+ +Be(+g),+ +Be(+(1-g)))*2,b=+Re(+((C-b)*.5)),h=+Re(+((x-h)*.5)),h=b*b+h*(y*d*h),h=+at(+ +Be(+h),+ +Be(+(1-h)))*2,d=(_+g+h)*.5,+(+Sn(+ +Be(+(+_t(+(d*.5))*+_t(+((d-_)*.5))*+_t(+((d-g)*.5))*+_t(+((d-h)*.5)))))*4)}function Kf(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0,y=0;if(y=D,D=D+192|0,g=y+168|0,_=y,d=Ba(c,A,g)|0,d|0)return u=d,D=y,u|0;if(Fa(c,A,_)|0&&$e(23313,22742,386,22751),A=l[_>>2]|0,(A|0)>0){if(h=+om(_+8|0,_+8+(((A|0)!=1&1)<<4)|0,g)+0,(A|0)!=1){c=1;do d=c,c=c+1|0,h=h+ +om(_+8+(d<<4)|0,_+8+(((c|0)%(A|0)|0)<<4)|0,g);while((c|0)<(A|0))}}else h=0;return P[u>>3]=h,u=0,D=y,u|0}function YT(c,A,u){return c=c|0,A=A|0,u=u|0,c=Kf(c,A,u)|0,c|0||(P[u>>3]=+P[u>>3]*6371.007180918475*6371.007180918475),c|0}function KT(c,A,u){return c=c|0,A=A|0,u=u|0,c=Kf(c,A,u)|0,c|0||(P[u>>3]=+P[u>>3]*6371.007180918475*6371.007180918475*1e3*1e3),c|0}function qT(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0,y=0,b=0,x=0,C=0;if(y=D,D=D+176|0,_=y,c=yA(c,A,_)|0,c|0)return _=c,D=y,_|0;if(P[u>>3]=0,c=l[_>>2]|0,(c|0)<=1)return _=0,D=y,_|0;A=c+-1|0,c=0,h=+P[_+8>>3],d=+P[_+16>>3],g=0;do c=c+1|0,x=h,h=+P[_+8+(c<<4)>>3],C=+Re(+((h-x)*.5)),b=d,d=+P[_+8+(c<<4)+8>>3],b=+Re(+((d-b)*.5)),b=C*C+b*(+He(+h)*+He(+x)*b),g=g+ +at(+ +Be(+b),+ +Be(+(1-b)))*2;while((c|0)<(A|0));return P[u>>3]=g,_=0,D=y,_|0}function ZT(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0,y=0,b=0,x=0,C=0;if(y=D,D=D+176|0,_=y,c=yA(c,A,_)|0,c|0)return _=c,g=+P[u>>3],g=g*6371.007180918475,P[u>>3]=g,D=y,_|0;if(P[u>>3]=0,c=l[_>>2]|0,(c|0)<=1)return _=0,g=0,g=g*6371.007180918475,P[u>>3]=g,D=y,_|0;A=c+-1|0,c=0,h=+P[_+8>>3],d=+P[_+16>>3],g=0;do c=c+1|0,x=h,h=+P[_+8+(c<<4)>>3],C=+Re(+((h-x)*.5)),b=d,d=+P[_+8+(c<<4)+8>>3],b=+Re(+((d-b)*.5)),b=C*C+b*(+He(+x)*+He(+h)*b),g=g+ +at(+ +Be(+b),+ +Be(+(1-b)))*2;while((c|0)!=(A|0));return P[u>>3]=g,_=0,C=g,C=C*6371.007180918475,P[u>>3]=C,D=y,_|0}function GT(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0,y=0,b=0,x=0,C=0;if(y=D,D=D+176|0,_=y,c=yA(c,A,_)|0,c|0)return _=c,g=+P[u>>3],g=g*6371.007180918475,g=g*1e3,P[u>>3]=g,D=y,_|0;if(P[u>>3]=0,c=l[_>>2]|0,(c|0)<=1)return _=0,g=0,g=g*6371.007180918475,g=g*1e3,P[u>>3]=g,D=y,_|0;A=c+-1|0,c=0,h=+P[_+8>>3],d=+P[_+16>>3],g=0;do c=c+1|0,x=h,h=+P[_+8+(c<<4)>>3],C=+Re(+((h-x)*.5)),b=d,d=+P[_+8+(c<<4)+8>>3],b=+Re(+((d-b)*.5)),b=C*C+b*(+He(+x)*+He(+h)*b),g=g+ +at(+ +Be(+b),+ +Be(+(1-b)))*2;while((c|0)!=(A|0));return P[u>>3]=g,_=0,C=g,C=C*6371.007180918475,C=C*1e3,P[u>>3]=C,D=y,_|0}function JT(c){c=c|0;var A=0,u=0,h=0;return A=Jr(1,12)|0,A||$e(22832,22787,49,22845),u=c+4|0,h=l[u>>2]|0,h|0?(h=h+8|0,l[h>>2]=A,l[u>>2]=A,A|0):(l[c>>2]|0&&$e(22862,22787,61,22885),h=c,l[h>>2]=A,l[u>>2]=A,A|0)}function eE(c,A){c=c|0,A=A|0;var u=0,h=0;return h=Gr(24)|0,h||$e(22899,22787,78,22913),l[h>>2]=l[A>>2],l[h+4>>2]=l[A+4>>2],l[h+8>>2]=l[A+8>>2],l[h+12>>2]=l[A+12>>2],l[h+16>>2]=0,A=c+4|0,u=l[A>>2]|0,u|0?(l[u+16>>2]=h,l[A>>2]=h,h|0):(l[c>>2]|0&&$e(22928,22787,82,22913),l[c>>2]=h,l[A>>2]=h,h|0)}function am(c){c=c|0;var A=0,u=0,h=0,d=0;if(c)for(h=1;;){if(A=l[c>>2]|0,A|0)do{if(u=l[A>>2]|0,u|0)do d=u,u=l[u+16>>2]|0,Ge(d);while(u|0);d=A,A=l[A+8>>2]|0,Ge(d)}while(A|0);if(A=c,c=l[c+8>>2]|0,h||Ge(A),c)h=0;else break}}function tE(c){c=c|0;var A=0,u=0,h=0,d=0,g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0,ne=0,de=0,fe=0,oe=0,ae=0,te=0,ke=0,Fe=0,Te=0,Pe=0,Et=0,mt=0,yt=0,rt=0,nt=0,it=0,It=0,Je=0;if(d=c+8|0,l[d>>2]|0)return Je=1,Je|0;if(h=l[c>>2]|0,!h)return Je=0,Je|0;A=h,u=0;do u=u+1|0,A=l[A+8>>2]|0;while(A|0);if(u>>>0<2)return Je=0,Je|0;it=Gr(u<<2)|0,it||$e(22948,22787,317,22967),nt=Gr(u<<5)|0,nt||$e(22989,22787,321,22967),l[c>>2]=0,Fe=c+4|0,l[Fe>>2]=0,l[d>>2]=0,u=0,rt=0,ke=0,F=0;e:for(;;){if(C=l[h>>2]|0,C){g=0,_=C;do{if(b=+P[_+8>>3],A=_,_=l[_+16>>2]|0,x=(_|0)==0,d=x?C:_,y=+P[d+8>>3],+Ce(+(b-y))>3.141592653589793){Je=14;break}g=g+(y-b)*(+P[A>>3]+ +P[d>>3])}while(!x);if((Je|0)==14){Je=0,g=0,A=C;do te=+P[A+8>>3],yt=A+16|0,mt=l[yt>>2]|0,mt=mt|0?mt:C,ae=+P[mt+8>>3],g=g+(+P[A>>3]+ +P[mt>>3])*((ae<0?ae+6.283185307179586:ae)-(te<0?te+6.283185307179586:te)),A=l[(A|0?yt:h)>>2]|0;while(A|0)}g>0?(l[it+(rt<<2)>>2]=h,rt=rt+1|0,d=ke,A=F):Je=19}else Je=19;if((Je|0)==19){Je=0;do if(u){if(A=u+8|0,l[A>>2]|0){Je=21;break e}if(u=Jr(1,12)|0,!u){Je=23;break e}l[A>>2]=u,d=u+4|0,_=u,A=F}else if(F){d=Fe,_=F+8|0,A=h,u=c;break}else if(l[c>>2]|0){Je=27;break e}else{d=Fe,_=c,A=h,u=c;break}while(!1);if(l[_>>2]=h,l[d>>2]=h,_=nt+(ke<<5)|0,x=l[h>>2]|0,x){for(C=nt+(ke<<5)+8|0,P[C>>3]=17976931348623157e292,F=nt+(ke<<5)+24|0,P[F>>3]=17976931348623157e292,P[_>>3]=-17976931348623157e292,X=nt+(ke<<5)+16|0,P[X>>3]=-17976931348623157e292,fe=17976931348623157e292,oe=-17976931348623157e292,d=0,Q=x,b=17976931348623157e292,ne=17976931348623157e292,de=-17976931348623157e292,y=-17976931348623157e292;g=+P[Q>>3],te=+P[Q+8>>3],Q=l[Q+16>>2]|0,H=(Q|0)==0,ae=+P[(H?x:Q)+8>>3],g<b&&(P[C>>3]=g,b=g),te<ne&&(P[F>>3]=te,ne=te),g>de?P[_>>3]=g:g=de,te>y&&(P[X>>3]=te,y=te),fe=te>0&te<fe?te:fe,oe=te<0&te>oe?te:oe,d=d|+Ce(+(te-ae))>3.141592653589793,!H;)de=g;d&&(P[X>>3]=oe,P[F>>3]=fe)}else l[_>>2]=0,l[_+4>>2]=0,l[_+8>>2]=0,l[_+12>>2]=0,l[_+16>>2]=0,l[_+20>>2]=0,l[_+24>>2]=0,l[_+28>>2]=0;d=ke+1|0}if(yt=h+8|0,h=l[yt>>2]|0,l[yt>>2]=0,h)ke=d,F=A;else{Je=45;break}}if((Je|0)==21)$e(22765,22787,35,22799);else if((Je|0)==23)$e(22819,22787,37,22799);else if((Je|0)==27)$e(22862,22787,61,22885);else if((Je|0)==45){e:do if((rt|0)>0){for(yt=(d|0)==0,Et=d<<2,mt=(c|0)==0,Pe=0,A=0;;){if(Te=l[it+(Pe<<2)>>2]|0,yt)Je=73;else{if(ke=Gr(Et)|0,!ke){Je=50;break}if(Fe=Gr(Et)|0,!Fe){Je=52;break}t:do if(mt)u=0;else{for(d=0,u=0,_=c;h=nt+(d<<5)|0,lm(l[_>>2]|0,h,l[Te>>2]|0)|0?(l[ke+(u<<2)>>2]=_,l[Fe+(u<<2)>>2]=h,H=u+1|0):H=u,_=l[_+8>>2]|0,_;)d=d+1|0,u=H;if((H|0)>0)if(h=l[ke>>2]|0,(H|0)==1)u=h;else for(X=0,Q=-1,u=h,F=h;;){for(x=l[F>>2]|0,h=0,_=0;d=l[l[ke+(_<<2)>>2]>>2]|0,(d|0)==(x|0)?C=h:C=h+((lm(d,l[Fe+(_<<2)>>2]|0,l[x>>2]|0)|0)&1)|0,_=_+1|0,(_|0)!=(H|0);)h=C;if(d=(C|0)>(Q|0),u=d?F:u,h=X+1|0,(h|0)==(H|0))break t;X=h,Q=d?C:Q,F=l[ke+(h<<2)>>2]|0}else u=0}while(!1);if(Ge(ke),Ge(Fe),u){if(d=u+4|0,h=l[d>>2]|0,h)u=h+8|0;else if(l[u>>2]|0){Je=70;break}l[u>>2]=Te,l[d>>2]=Te}else Je=73}if((Je|0)==73){if(Je=0,A=l[Te>>2]|0,A|0)do Fe=A,A=l[A+16>>2]|0,Ge(Fe);while(A|0);Ge(Te),A=1}if(Pe=Pe+1|0,(Pe|0)>=(rt|0)){It=A;break e}}(Je|0)==50?$e(23004,22787,249,23023):(Je|0)==52?$e(23042,22787,252,23023):(Je|0)==70&&$e(22862,22787,61,22885)}else It=0;while(!1);return Ge(it),Ge(nt),Je=It,Je|0}return 0}function lm(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0,y=0,b=0,x=0,C=0;if(!($g(A,u)|0)||(A=Wg(A)|0,h=+P[u>>3],d=+P[u+8>>3],d=A&d<0?d+6.283185307179586:d,c=l[c>>2]|0,!c))return c=0,c|0;if(A){A=0,x=d,u=c;e:for(;;){for(;_=+P[u>>3],d=+P[u+8>>3],u=u+16|0,C=l[u>>2]|0,C=C|0?C:c,g=+P[C>>3],y=+P[C+8>>3],_>g?(b=_,_=y):(b=g,g=_,_=d,d=y),h=h==g|h==b?h+2220446049250313e-31:h,!!(h<g|h>b);)if(u=l[u>>2]|0,!u){u=22;break e}if(y=_<0?_+6.283185307179586:_,_=d<0?d+6.283185307179586:d,x=y==x|_==x?x+-2220446049250313e-31:x,b=y+(_-y)*((h-g)/(b-g)),(b<0?b+6.283185307179586:b)>x&&(A=A^1),u=l[u>>2]|0,!u){u=22;break}}if((u|0)==22)return A|0}else{A=0,x=d,u=c;e:for(;;){for(;_=+P[u>>3],d=+P[u+8>>3],u=u+16|0,C=l[u>>2]|0,C=C|0?C:c,g=+P[C>>3],y=+P[C+8>>3],_>g?(b=_,_=y):(b=g,g=_,_=d,d=y),h=h==g|h==b?h+2220446049250313e-31:h,!!(h<g|h>b);)if(u=l[u>>2]|0,!u){u=22;break e}if(x=_==x|d==x?x+-2220446049250313e-31:x,_+(d-_)*((h-g)/(b-g))>x&&(A=A^1),u=l[u>>2]|0,!u){u=22;break}}if((u|0)==22)return A|0}return 0}function mi(c,A,u,h,d){c=c|0,A=A|0,u=u|0,h=h|0,d=d|0;var g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0,ne=0,de=0,fe=0,oe=0;if(oe=D,D=D+32|0,fe=oe+16|0,de=oe,g=ve(c|0,A|0,52)|0,z()|0,g=g&15,Q=ve(u|0,h|0,52)|0,z()|0,(g|0)!=(Q&15|0))return fe=12,D=oe,fe|0;if(x=ve(c|0,A|0,45)|0,z()|0,x=x&127,C=ve(u|0,h|0,45)|0,z()|0,C=C&127,x>>>0>121|C>>>0>121)return fe=5,D=oe,fe|0;if(Q=(x|0)!=(C|0),Q){if(y=Ff(x,C)|0,(y|0)==7)return fe=1,D=oe,fe|0;b=Ff(C,x)|0,(b|0)==7?$e(23066,23090,161,23100):(H=y,_=b)}else H=0,_=0;F=jt(x)|0,X=jt(C)|0,l[fe>>2]=0,l[fe+4>>2]=0,l[fe+8>>2]=0,l[fe+12>>2]=0;do if(H){if(C=l[4272+(x*28|0)+(H<<2)>>2]|0,y=(C|0)>0,X)if(y){x=0,b=u,y=h;do b=OT(b,y)|0,y=z()|0,_=Bi(_)|0,(_|0)==1&&(_=Bi(1)|0),x=x+1|0;while((x|0)!=(C|0));C=_,x=b,b=y}else C=_,x=u,b=h;else if(y){x=0,b=u,y=h;do b=Hf(b,y)|0,y=z()|0,_=Bi(_)|0,x=x+1|0;while((x|0)!=(C|0));C=_,x=b,b=y}else C=_,x=u,b=h;if(Xf(x,b,fe)|0,Q||$e(23115,23090,191,23100),y=(F|0)!=0,_=(X|0)!=0,y&_&&$e(23142,23090,192,23100),y){if(_=ar(c,A)|0,(_|0)==7){g=5;break}if(ie[21872+(_*7|0)+H>>0]|0){g=1;break}b=l[21040+(_*28|0)+(H<<2)>>2]|0,x=b}else if(_){if(_=ar(x,b)|0,(_|0)==7){g=5;break}if(ie[21872+(_*7|0)+C>>0]|0){g=1;break}x=0,b=l[21040+(C*28|0)+(_<<2)>>2]|0}else x=0,b=0;if((x|b|0)<0)g=5;else{if((b|0)>0){y=fe+4|0,_=0;do _A(y),_=_+1|0;while((_|0)!=(b|0))}if(l[de>>2]=0,l[de+4>>2]=0,l[de+8>>2]=0,Yg(de,H),g|0)for(;Tr(g)|0?mA(de):Ts(de),(g|0)>1;)g=g+-1|0;if((x|0)>0){g=0;do _A(de),g=g+1|0;while((g|0)!=(x|0))}ne=fe+4|0,Jn(ne,de,ne),Vn(ne),ne=51}}else if(Xf(u,h,fe)|0,(F|0)!=0&(X|0)!=0)if((C|0)!=(x|0)&&$e(23173,23090,261,23100),_=ar(c,A)|0,g=ar(u,h)|0,(_|0)==7|(g|0)==7)g=5;else if(ie[21872+(_*7|0)+g>>0]|0)g=1;else if(_=l[21040+(_*28|0)+(g<<2)>>2]|0,(_|0)>0){y=fe+4|0,g=0;do _A(y),g=g+1|0;while((g|0)!=(_|0));ne=51}else ne=51;else ne=51;while(!1);return(ne|0)==51&&(g=fe+4|0,l[d>>2]=l[g>>2],l[d+4>>2]=l[g+4>>2],l[d+8>>2]=l[g+8>>2],g=0),fe=g,D=oe,fe|0}function Am(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0;var d=0,g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0,ne=0,de=0,fe=0,oe=0,ae=0;if(ne=D,D=D+48|0,x=ne+36|0,_=ne+24|0,y=ne+12|0,b=ne,d=ve(c|0,A|0,52)|0,z()|0,d=d&15,X=ve(c|0,A|0,45)|0,z()|0,X=X&127,X>>>0>121)return h=5,D=ne,h|0;if(C=jt(X)|0,Se(d|0,0,52)|0,de=z()|0|134225919,g=h,l[g>>2]=-1,l[g+4>>2]=de,!d)return d=gA(u)|0,(d|0)==7||(d=Bf(X,d)|0,(d|0)==127)?(de=1,D=ne,de|0):(Q=Se(d|0,0,45)|0,H=z()|0,X=h,H=l[X+4>>2]&-1040385|H,de=h,l[de>>2]=l[X>>2]|Q,l[de+4>>2]=H,de=0,D=ne,de|0);for(l[x>>2]=l[u>>2],l[x+4>>2]=l[u+4>>2],l[x+8>>2]=l[u+8>>2],u=d;;){if(g=u,u=u+-1|0,l[_>>2]=l[x>>2],l[_+4>>2]=l[x+4>>2],l[_+8>>2]=l[x+8>>2],Tr(g)|0){if(d=lT(x)|0,d|0){u=13;break}l[y>>2]=l[x>>2],l[y+4>>2]=l[x+4>>2],l[y+8>>2]=l[x+8>>2],mA(y)}else{if(d=AT(x)|0,d|0){u=13;break}l[y>>2]=l[x>>2],l[y+4>>2]=l[x+4>>2],l[y+8>>2]=l[x+8>>2],Ts(y)}if(Lf(_,y,b),Vn(b),d=h,oe=l[d>>2]|0,d=l[d+4>>2]|0,ae=(15-g|0)*3|0,fe=Se(7,0,ae|0)|0,d=d&~(z()|0),ae=Se(gA(b)|0,0,ae|0)|0,d=z()|0|d,de=h,l[de>>2]=ae|oe&~fe,l[de+4>>2]=d,(g|0)<=1){u=14;break}}e:do if((u|0)!=13&&(u|0)==14)if((l[x>>2]|0)<=1&&(l[x+4>>2]|0)<=1&&(l[x+8>>2]|0)<=1){u=gA(x)|0,d=Bf(X,u)|0,(d|0)==127?b=0:b=jt(d)|0;t:do if(u){if(C){if(d=ar(c,A)|0,(d|0)==7){d=5;break e}if(g=l[21248+(d*28|0)+(u<<2)>>2]|0,(g|0)>0){d=u,u=0;do d=Es(d)|0,u=u+1|0;while((u|0)!=(g|0))}else d=u;if((d|0)==1){d=9;break e}u=Bf(X,d)|0,(u|0)==127&&$e(23200,23090,411,23230),jt(u)|0?$e(23245,23090,412,23230):(H=u,Q=g,F=d)}else H=d,Q=0,F=u;if(y=l[4272+(X*28|0)+(F<<2)>>2]|0,(y|0)<=-1&&$e(23276,23090,419,23230),!b){if((Q|0)<0){d=5;break e}if(Q|0){g=h,d=0,u=l[g>>2]|0,g=l[g+4>>2]|0;do u=Ss(u,g)|0,g=z()|0,ae=h,l[ae>>2]=u,l[ae+4>>2]=g,d=d+1|0;while((d|0)<(Q|0))}if((y|0)<=0){d=H,u=58;break}for(g=h,d=0,u=l[g>>2]|0,g=l[g+4>>2]|0;;)if(u=Ss(u,g)|0,g=z()|0,ae=h,l[ae>>2]=u,l[ae+4>>2]=g,d=d+1|0,(d|0)==(y|0)){d=H,u=58;break t}}if(_=Ff(H,X)|0,(_|0)==7&&$e(23066,23090,428,23230),d=h,u=l[d>>2]|0,d=l[d+4>>2]|0,(y|0)>0){g=0;do u=Ss(u,d)|0,d=z()|0,ae=h,l[ae>>2]=u,l[ae+4>>2]=d,g=g+1|0;while((g|0)!=(y|0))}if(d=ar(u,d)|0,(d|0)==7&&$e(23313,23090,440,23230),u=Df(H)|0,u=l[(u?21664:21456)+(_*28|0)+(d<<2)>>2]|0,(u|0)<0&&$e(23313,23090,454,23230),!u)d=H,u=58;else{_=h,d=0,g=l[_>>2]|0,_=l[_+4>>2]|0;do g=$f(g,_)|0,_=z()|0,ae=h,l[ae>>2]=g,l[ae+4>>2]=_,d=d+1|0;while((d|0)<(u|0));d=H,u=58}}else if((C|0)!=0&(b|0)!=0){if(u=ar(c,A)|0,g=h,g=ar(l[g>>2]|0,l[g+4>>2]|0)|0,(u|0)==7|(g|0)==7){d=5;break e}if(g=l[21248+(u*28|0)+(g<<2)>>2]|0,(g|0)<0){d=5;break e}if(!g)u=59;else{y=h,u=0,_=l[y>>2]|0,y=l[y+4>>2]|0;do _=Ss(_,y)|0,y=z()|0,ae=h,l[ae>>2]=_,l[ae+4>>2]=y,u=u+1|0;while((u|0)<(g|0));u=58}}else u=58;while(!1);if((u|0)==58&&b&&(u=59),(u|0)==59&&(ae=h,(ar(l[ae>>2]|0,l[ae+4>>2]|0)|0)==1)){d=9;break}ae=h,fe=l[ae>>2]|0,ae=l[ae+4>>2]&-1040385,oe=Se(d|0,0,45)|0,ae=ae|(z()|0),d=h,l[d>>2]=fe|oe,l[d+4>>2]=ae,d=0}else d=1;while(!1);return ae=d,D=ne,ae|0}function nE(c,A,u,h,d,g){c=c|0,A=A|0,u=u|0,h=h|0,d=d|0,g=g|0;var _=0,y=0;return y=D,D=D+16|0,_=y,d?c=15:(c=mi(c,A,u,h,_)|0,c||(uT(_,g),c=0)),D=y,c|0}function rE(c,A,u,h,d){c=c|0,A=A|0,u=u|0,h=h|0,d=d|0;var g=0,_=0;return _=D,D=D+16|0,g=_,h?u=15:(u=fT(u,g)|0,u||(u=Am(c,A,g,d)|0)),D=_,u|0}function iE(c,A,u,h,d){c=c|0,A=A|0,u=u|0,h=h|0,d=d|0;var g=0,_=0,y=0,b=0;return b=D,D=D+32|0,_=b+12|0,y=b,g=mi(c,A,c,A,_)|0,g|0?(y=g,D=b,y|0):(c=mi(c,A,u,h,y)|0,c|0?(y=c,D=b,y|0):(_=Uf(_,y)|0,y=d,l[y>>2]=_,l[y+4>>2]=((_|0)<0)<<31>>31,y=0,D=b,y|0))}function sE(c,A,u,h,d){c=c|0,A=A|0,u=u|0,h=h|0,d=d|0;var g=0,_=0,y=0,b=0;return b=D,D=D+32|0,_=b+12|0,y=b,g=mi(c,A,c,A,_)|0,!g&&(g=mi(c,A,u,h,y)|0,!g)?(h=Uf(_,y)|0,h=ct(h|0,((h|0)<0)<<31>>31|0,1,0)|0,_=z()|0,y=d,l[y>>2]=h,l[y+4>>2]=_,y=0,D=b,y|0):(y=g,D=b,y|0)}function oE(c,A,u,h,d){c=c|0,A=A|0,u=u|0,h=h|0,d=d|0;var g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0,ne=0,de=0,fe=0,oe=0,ae=0,te=0,ke=0,Fe=0,Te=0,Pe=0;if(Te=D,D=D+48|0,_=Te+24|0,y=Te+12|0,Fe=Te,g=mi(c,A,c,A,_)|0,!g&&(g=mi(c,A,u,h,y)|0,!g)){te=Uf(_,y)|0,ke=((te|0)<0)<<31>>31,l[_>>2]=0,l[_+4>>2]=0,l[_+8>>2]=0,l[y>>2]=0,l[y+4>>2]=0,l[y+8>>2]=0,mi(c,A,c,A,_)|0&&$e(23313,23090,691,23299),mi(c,A,u,h,y)|0&&$e(23313,23090,696,23299),Gg(_),Gg(y),te?(F=l[_>>2]|0,H=+(te|0),fe=_+4|0,X=l[fe>>2]|0,oe=_+8|0,Q=l[oe>>2]|0,ae=_,h=F,g=X,u=Q,ne=+((l[y>>2]|0)-F|0)/H,de=+((l[y+4>>2]|0)-X|0)/H,H=+((l[y+8>>2]|0)-Q|0)/H):(g=_+4|0,u=_+8|0,fe=g,oe=u,ae=_,h=l[_>>2]|0,g=l[g>>2]|0,u=l[u>>2]|0,ne=0,de=0,H=0),l[Fe>>2]=h,Q=Fe+4|0,l[Q>>2]=g,X=Fe+8|0,l[X>>2]=u;e:do if((te|0)<0)g=0;else for(C=0,F=0,g=h;;){x=+(F>>>0)+4294967296*+(C|0),Pe=ne*x+ +(g|0),b=de*x+ +(l[fe>>2]|0),x=H*x+ +(l[oe>>2]|0),u=~~+bA(+Pe),_=~~+bA(+b),g=~~+bA(+x),Pe=+Ce(+(+(u|0)-Pe)),b=+Ce(+(+(_|0)-b)),x=+Ce(+(+(g|0)-x));do if(Pe>b&Pe>x)u=0-(_+g)|0,h=_;else if(y=0-u|0,b>x){h=y-g|0;break}else{h=_,g=y-_|0;break}while(!1);if(l[Fe>>2]=u,l[Q>>2]=h,l[X>>2]=g,hT(Fe),g=Am(c,A,Fe,d+(F<<3)|0)|0,g|0)break e;if(!((C|0)<(ke|0)|(C|0)==(ke|0)&F>>>0<te>>>0)){g=0;break e}g=ct(F|0,C|0,1,0)|0,y=z()|0,C=y,F=g,g=l[ae>>2]|0}while(!1);return Fe=g,D=Te,Fe|0}return Fe=g,D=Te,Fe|0}function Fi(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0;var d=0,g=0,_=0;if((u|0)==0&(h|0)==0)return d=0,g=1,Xe(d|0),g|0;g=c,d=A,c=1,A=0;do _=(u&1|0)==0&!0,c=Wn((_?1:g)|0,(_?0:d)|0,c|0,A|0)|0,A=z()|0,u=ym(u|0,h|0,1)|0,h=z()|0,g=Wn(g|0,d|0,g|0,d|0)|0,d=z()|0;while(!((u|0)==0&(h|0)==0));return Xe(A|0),c|0}function cm(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0;if(!($g(A,u)|0)||(A=Wg(A)|0,h=+P[u>>3],d=+P[u+8>>3],d=A&d<0?d+6.283185307179586:d,X=l[c>>2]|0,(X|0)<=0))return X=0,X|0;if(F=l[c+4>>2]|0,A){A=0,C=d,u=-1,c=0;e:for(;;){for(x=c;_=+P[F+(x<<4)>>3],d=+P[F+(x<<4)+8>>3],c=(u+2|0)%(X|0)|0,g=+P[F+(c<<4)>>3],y=+P[F+(c<<4)+8>>3],_>g?(b=_,_=y):(b=g,g=_,_=d,d=y),h=h==g|h==b?h+2220446049250313e-31:h,!!(h<g|h>b);)if(u=x+1|0,(u|0)>=(X|0)){u=22;break e}else c=x,x=u,u=c;if(y=_<0?_+6.283185307179586:_,_=d<0?d+6.283185307179586:d,C=y==C|_==C?C+-2220446049250313e-31:C,b=y+(_-y)*((h-g)/(b-g)),(b<0?b+6.283185307179586:b)>C&&(A=A^1),c=x+1|0,(c|0)>=(X|0)){u=22;break}else u=x}if((u|0)==22)return A|0}else{A=0,C=d,u=-1,c=0;e:for(;;){for(x=c;_=+P[F+(x<<4)>>3],d=+P[F+(x<<4)+8>>3],c=(u+2|0)%(X|0)|0,g=+P[F+(c<<4)>>3],y=+P[F+(c<<4)+8>>3],_>g?(b=_,_=y):(b=g,g=_,_=d,d=y),h=h==g|h==b?h+2220446049250313e-31:h,!!(h<g|h>b);)if(u=x+1|0,(u|0)>=(X|0)){u=22;break e}else c=x,x=u,u=c;if(C=_==C|d==C?C+-2220446049250313e-31:C,_+(d-_)*((h-g)/(b-g))>C&&(A=A^1),c=x+1|0,(c|0)>=(X|0)){u=22;break}else u=x}if((u|0)==22)return A|0}return 0}function um(c,A){c=c|0,A=A|0;var u=0,h=0,d=0,g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0,ne=0,de=0,fe=0,oe=0;if(H=l[c>>2]|0,!H){l[A>>2]=0,l[A+4>>2]=0,l[A+8>>2]=0,l[A+12>>2]=0,l[A+16>>2]=0,l[A+20>>2]=0,l[A+24>>2]=0,l[A+28>>2]=0;return}if(ne=A+8|0,P[ne>>3]=17976931348623157e292,de=A+24|0,P[de>>3]=17976931348623157e292,P[A>>3]=-17976931348623157e292,fe=A+16|0,P[fe>>3]=-17976931348623157e292,!((H|0)<=0)){for(X=l[c+4>>2]|0,x=17976931348623157e292,C=-17976931348623157e292,F=0,c=-1,g=17976931348623157e292,_=17976931348623157e292,b=-17976931348623157e292,h=-17976931348623157e292,Q=0;u=+P[X+(Q<<4)>>3],y=+P[X+(Q<<4)+8>>3],c=c+2|0,d=+P[X+(((c|0)==(H|0)?0:c)<<4)+8>>3],u<g&&(P[ne>>3]=u,g=u),y<_&&(P[de>>3]=y,_=y),u>b?P[A>>3]=u:u=b,y>h&&(P[fe>>3]=y,h=y),x=y>0&y<x?y:x,C=y<0&y>C?y:C,F=F|+Ce(+(y-d))>3.141592653589793,c=Q+1|0,(c|0)!=(H|0);)oe=Q,b=u,Q=c,c=oe;F&&(P[fe>>3]=C,P[de>>3]=x)}}function aE(c,A){c=c|0,A=A|0;var u=0,h=0,d=0,g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0,ne=0,de=0,fe=0,oe=0,ae=0,te=0,ke=0,Fe=0,Te=0;if(H=l[c>>2]|0,H){if(ne=A+8|0,P[ne>>3]=17976931348623157e292,de=A+24|0,P[de>>3]=17976931348623157e292,P[A>>3]=-17976931348623157e292,fe=A+16|0,P[fe>>3]=-17976931348623157e292,(H|0)>0){for(d=l[c+4>>2]|0,X=17976931348623157e292,Q=-17976931348623157e292,h=0,u=-1,b=17976931348623157e292,x=17976931348623157e292,F=-17976931348623157e292,_=-17976931348623157e292,oe=0;g=+P[d+(oe<<4)>>3],C=+P[d+(oe<<4)+8>>3],Fe=u+2|0,y=+P[d+(((Fe|0)==(H|0)?0:Fe)<<4)+8>>3],g<b&&(P[ne>>3]=g,b=g),C<x&&(P[de>>3]=C,x=C),g>F?P[A>>3]=g:g=F,C>_&&(P[fe>>3]=C,_=C),X=C>0&C<X?C:X,Q=C<0&C>Q?C:Q,h=h|+Ce(+(C-y))>3.141592653589793,u=oe+1|0,(u|0)!=(H|0);)Fe=oe,F=g,oe=u,u=Fe;h&&(P[fe>>3]=Q,P[de>>3]=X)}}else l[A>>2]=0,l[A+4>>2]=0,l[A+8>>2]=0,l[A+12>>2]=0,l[A+16>>2]=0,l[A+20>>2]=0,l[A+24>>2]=0,l[A+28>>2]=0;if(Fe=c+8|0,u=l[Fe>>2]|0,!((u|0)<=0)){ke=c+12|0,te=0;do if(d=l[ke>>2]|0,h=te,te=te+1|0,de=A+(te<<5)|0,fe=l[d+(h<<3)>>2]|0,fe){if(oe=A+(te<<5)+8|0,P[oe>>3]=17976931348623157e292,c=A+(te<<5)+24|0,P[c>>3]=17976931348623157e292,P[de>>3]=-17976931348623157e292,ae=A+(te<<5)+16|0,P[ae>>3]=-17976931348623157e292,(fe|0)>0){for(H=l[d+(h<<3)+4>>2]|0,X=17976931348623157e292,Q=-17976931348623157e292,d=0,h=-1,ne=0,b=17976931348623157e292,x=17976931348623157e292,C=-17976931348623157e292,_=-17976931348623157e292;g=+P[H+(ne<<4)>>3],F=+P[H+(ne<<4)+8>>3],h=h+2|0,y=+P[H+(((h|0)==(fe|0)?0:h)<<4)+8>>3],g<b&&(P[oe>>3]=g,b=g),F<x&&(P[c>>3]=F,x=F),g>C?P[de>>3]=g:g=C,F>_&&(P[ae>>3]=F,_=F),X=F>0&F<X?F:X,Q=F<0&F>Q?F:Q,d=d|+Ce(+(F-y))>3.141592653589793,h=ne+1|0,(h|0)!=(fe|0);)Te=ne,ne=h,C=g,h=Te;d&&(P[ae>>3]=Q,P[c>>3]=X)}}else l[de>>2]=0,l[de+4>>2]=0,l[de+8>>2]=0,l[de+12>>2]=0,l[de+16>>2]=0,l[de+20>>2]=0,l[de+24>>2]=0,l[de+28>>2]=0,u=l[Fe>>2]|0;while((te|0)<(u|0))}}function lE(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0;if(!(cm(c,A,u)|0))return d=0,d|0;if(d=c+8|0,(l[d>>2]|0)<=0)return d=1,d|0;for(h=c+12|0,c=0;;){if(g=c,c=c+1|0,cm((l[h>>2]|0)+(g<<3)|0,A+(c<<5)|0,u)|0){c=0,h=6;break}if((c|0)>=(l[d>>2]|0)){c=1,h=6;break}}return(h|0)==6?c|0:0}function AE(){return 8}function cE(){return 16}function uE(){return 168}function fE(){return 8}function hE(){return 16}function dE(){return 12}function pE(){return 8}function gE(c){return c=c|0,+(+((l[c>>2]|0)>>>0)+4294967296*+(l[c+4>>2]|0))}function mE(c){c=c|0;var A=0,u=0;return u=+P[c>>3],A=+P[c+8>>3],+ +Be(+(u*u+A*A))}function fm(c,A,u,h,d){c=c|0,A=A|0,u=u|0,h=h|0,d=d|0;var g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0;x=+P[c>>3],b=+P[A>>3]-x,y=+P[c+8>>3],_=+P[A+8>>3]-y,F=+P[u>>3],g=+P[h>>3]-F,X=+P[u+8>>3],C=+P[h+8>>3]-X,g=(g*(y-X)-(x-F)*C)/(b*C-_*g),P[d>>3]=x+b*g,P[d+8>>3]=y+_*g}function hm(c,A){return c=c|0,A=A|0,+Ce(+(+P[c>>3]-+P[A>>3]))<11920928955078125e-23?(A=+Ce(+(+P[c+8>>3]-+P[A+8>>3]))<11920928955078125e-23,A|0):(A=0,A|0)}function hn(c,A){c=c|0,A=A|0;var u=0,h=0,d=0;return d=+P[c>>3]-+P[A>>3],h=+P[c+8>>3]-+P[A+8>>3],u=+P[c+16>>3]-+P[A+16>>3],+(d*d+h*h+u*u)}function _E(c,A){c=c|0,A=A|0;var u=0,h=0,d=0;u=+P[c>>3],h=+He(+u),u=+Re(+u),P[A+16>>3]=u,u=+P[c+8>>3],d=h*+He(+u),P[A>>3]=d,u=h*+Re(+u),P[A+8>>3]=u}function yE(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0;if(g=D,D=D+16|0,d=g,h=Wt(c,A)|0,(u+-1|0)>>>0>5||(h=(h|0)!=0,(u|0)==1&h))return d=-1,D=g,d|0;do if(za(c,A,d)|0)h=-1;else if(h){h=((l[21936+(u<<2)>>2]|0)+5-(l[d>>2]|0)|0)%5|0;break}else{h=((l[21968+(u<<2)>>2]|0)+6-(l[d>>2]|0)|0)%6|0;break}while(!1);return d=h,D=g,d|0}function za(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0,y=0,b=0,x=0;if(x=D,D=D+32|0,_=x+16|0,y=x,h=po(c,A,_)|0,h|0)return u=h,D=x,u|0;g=tm(c,A)|0,b=ar(c,A)|0,tT(g,y),h=nT(g,l[_>>2]|0)|0;e:do if(jt(g)|0){do switch(g|0){case 4:{c=0;break}case 14:{c=1;break}case 24:{c=2;break}case 38:{c=3;break}case 49:{c=4;break}case 58:{c=5;break}case 63:{c=6;break}case 72:{c=7;break}case 83:{c=8;break}case 97:{c=9;break}case 107:{c=10;break}case 117:{c=11;break}default:{h=1;break e}}while(!1);if(d=l[22e3+(c*24|0)+8>>2]|0,A=l[22e3+(c*24|0)+16>>2]|0,c=l[_>>2]|0,(c|0)!=(l[y>>2]|0)&&(y=Df(g)|0,c=l[_>>2]|0,y|(c|0)==(A|0)&&(h=(h+1|0)%6|0)),(b|0)==3&(c|0)==(A|0)){h=(h+5|0)%6|0,d=22;break}(b|0)==5&(c|0)==(d|0)&&(h=(h+1|0)%6|0),d=22}else d=22;while(!1);return(d|0)==22&&(l[u>>2]=h,h=0),u=h,D=x,u|0}function Er(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0;var d=0,g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0,ne=0,de=0,fe=0,oe=0,ae=0;if(ae=D,D=D+32|0,oe=ae+24|0,de=ae+20|0,H=ae+8|0,Q=ae+16|0,X=ae,b=(Wt(c,A)|0)==0,b=b?6:5,C=ve(c|0,A|0,52)|0,z()|0,C=C&15,b>>>0<=u>>>0)return h=2,D=ae,h|0;F=(C|0)==0,!F&&(ne=Se(7,0,(C^15)*3|0)|0,(ne&c|0)==0&((z()|0)&A|0)==0)?d=u:g=4;e:do if((g|0)==4){if(d=(Wt(c,A)|0)!=0,((d?4:5)|0)<(u|0)||za(c,A,oe)|0||(g=(l[oe>>2]|0)+u|0,d?d=22288+(((g|0)%5|0)<<2)|0:d=22320+(((g|0)%6|0)<<2)|0,ne=l[d>>2]|0,(ne|0)==7))return h=1,D=ae,h|0;l[de>>2]=0,d=Cn(c,A,ne,de,H)|0;do if(!d){if(y=H,x=l[y>>2]|0,y=l[y+4>>2]|0,_=y>>>0<A>>>0|(y|0)==(A|0)&x>>>0<c>>>0,g=_?x:c,_=_?y:A,!F&&(F=Se(7,0,(C^15)*3|0)|0,(x&F|0)==0&(y&(z()|0)|0)==0))d=u;else{if(y=(u+-1+b|0)%(b|0)|0,d=Wt(c,A)|0,(y|0)<0&&$e(23313,23315,245,23324),b=(d|0)!=0,((b?4:5)|0)<(y|0)&&$e(23313,23315,245,23324),za(c,A,oe)|0&&$e(23313,23315,245,23324),d=(l[oe>>2]|0)+y|0,b?d=22288+(((d|0)%5|0)<<2)|0:d=22320+(((d|0)%6|0)<<2)|0,y=l[d>>2]|0,(y|0)==7&&$e(23313,23315,245,23324),l[Q>>2]=0,d=Cn(c,A,y,Q,X)|0,d|0)break;x=X,b=l[x>>2]|0,x=l[x+4>>2]|0;do if(x>>>0<_>>>0|(x|0)==(_|0)&b>>>0<g>>>0){if(Wt(b,x)|0?g=Of(b,x,c,A)|0:g=l[22384+((((l[Q>>2]|0)+(l[22352+(y<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,d=Wt(b,x)|0,(g+-1|0)>>>0>5){d=-1,g=b,_=x;break}if(d=(d|0)!=0,(g|0)==1&d){d=-1,g=b,_=x;break}do if(za(b,x,oe)|0)d=-1;else if(d){d=((l[21936+(g<<2)>>2]|0)+5-(l[oe>>2]|0)|0)%5|0;break}else{d=((l[21968+(g<<2)>>2]|0)+6-(l[oe>>2]|0)|0)%6|0;break}while(!1);g=b,_=x}else d=u;while(!1);y=H,x=l[y>>2]|0,y=l[y+4>>2]|0}if((g|0)==(x|0)&(_|0)==(y|0)){if(b=(Wt(x,y)|0)!=0,b?c=Of(x,y,c,A)|0:c=l[22384+((((l[de>>2]|0)+(l[22352+(ne<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,d=Wt(x,y)|0,(c+-1|0)>>>0<=5&&(fe=(d|0)!=0,!((c|0)==1&fe)))do if(za(x,y,oe)|0)d=-1;else if(fe){d=((l[21936+(c<<2)>>2]|0)+5-(l[oe>>2]|0)|0)%5|0;break}else{d=((l[21968+(c<<2)>>2]|0)+6-(l[oe>>2]|0)|0)%6|0;break}while(!1);else d=-1;d=d+1|0,d=(d|0)==6|b&(d|0)==5?0:d}A=_,c=g;break e}while(!1);return h=d,D=ae,h|0}while(!1);return fe=Se(d|0,0,56)|0,oe=z()|0|A&-2130706433|536870912,l[h>>2]=fe|c,l[h+4>>2]=oe,h=0,D=ae,h|0}function vE(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0;return g=(Wt(c,A)|0)==0,h=Er(c,A,0,u)|0,d=(h|0)==0,g?!d||(h=Er(c,A,1,u+8|0)|0,h|0)||(h=Er(c,A,2,u+16|0)|0,h|0)||(h=Er(c,A,3,u+24|0)|0,h|0)||(h=Er(c,A,4,u+32|0)|0,h)?(g=h,g|0):Er(c,A,5,u+40|0)|0:!d||(h=Er(c,A,1,u+8|0)|0,h|0)||(h=Er(c,A,2,u+16|0)|0,h|0)||(h=Er(c,A,3,u+24|0)|0,h|0)||(h=Er(c,A,4,u+32|0)|0,h|0)?(g=h,g|0):(g=u+40|0,l[g>>2]=0,l[g+4>>2]=0,g=0,g|0)}function wE(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0,y=0,b=0;return b=D,D=D+192|0,d=b,g=b+168|0,_=ve(c|0,A|0,56)|0,z()|0,_=_&7,y=A&-2130706433|134217728,h=po(c,y,g)|0,h|0?(y=h,D=b,y|0):(A=ve(c|0,A|0,52)|0,z()|0,A=A&15,Wt(c,y)|0?zf(g,A,_,1,d):Vf(g,A,_,1,d),y=d+8|0,l[u>>2]=l[y>>2],l[u+4>>2]=l[y+4>>2],l[u+8>>2]=l[y+8>>2],l[u+12>>2]=l[y+12>>2],y=0,D=b,y|0)}function bE(c,A){c=c|0,A=A|0;var u=0,h=0,d=0,g=0;return d=D,D=D+16|0,u=d,!(!0&(A&2013265920|0)==536870912)||(h=A&-2130706433|134217728,!(jf(c,h)|0))?(h=0,D=d,h|0):(g=ve(c|0,A|0,56)|0,z()|0,g=(Er(c,h,g&7,u)|0)==0,h=u,h=g&((l[h>>2]|0)==(c|0)?(l[h+4>>2]|0)==(A|0):0)&1,D=d,h|0)}function dm(c,A,u){c=c|0,A=A|0,u=u|0;var h=0;(A|0)>0?(h=Jr(A,4)|0,l[c>>2]=h,h||$e(23337,23360,40,23374)):l[c>>2]=0,l[c+4>>2]=A,l[c+8>>2]=0,l[c+12>>2]=u}function pm(c){c=c|0;var A=0,u=0,h=0,d=0,g=0,_=0,y=0;d=c+4|0,g=c+12|0,_=c+8|0;e:for(;;){for(u=l[d>>2]|0,A=0;;){if((A|0)>=(u|0))break e;if(h=l[c>>2]|0,y=l[h+(A<<2)>>2]|0,!y)A=A+1|0;else break}A=h+(~~(+Ce(+(+ft(10,+ +(15-(l[g>>2]|0)|0))*(+P[y>>3]+ +P[y+8>>3])))%+(u|0))>>>0<<2)|0,u=l[A>>2]|0;t:do if(u|0){if(h=y+32|0,(u|0)==(y|0))l[A>>2]=l[h>>2];else{if(u=u+32|0,A=l[u>>2]|0,!A)break;for(;(A|0)!=(y|0);)if(u=A+32|0,A=l[u>>2]|0,!A)break t;l[u>>2]=l[h>>2]}Ge(y),l[_>>2]=(l[_>>2]|0)+-1}while(!1)}Ge(l[c>>2]|0)}function gm(c){c=c|0;var A=0,u=0,h=0;for(h=l[c+4>>2]|0,u=0;;){if((u|0)>=(h|0)){A=0,u=4;break}if(A=l[(l[c>>2]|0)+(u<<2)>>2]|0,!A)u=u+1|0;else{u=4;break}}return(u|0)==4?A|0:0}function mm(c,A){c=c|0,A=A|0;var u=0,h=0,d=0,g=0;if(u=~~(+Ce(+(+ft(10,+ +(15-(l[c+12>>2]|0)|0))*(+P[A>>3]+ +P[A+8>>3])))%+(l[c+4>>2]|0))>>>0,u=(l[c>>2]|0)+(u<<2)|0,h=l[u>>2]|0,!h)return g=1,g|0;g=A+32|0;do if((h|0)!=(A|0)){if(u=l[h+32>>2]|0,!u)return g=1,g|0;for(d=u;;){if((d|0)==(A|0)){d=8;break}if(u=l[d+32>>2]|0,u)h=d,d=u;else{u=1,d=10;break}}if((d|0)==8){l[h+32>>2]=l[g>>2];break}else if((d|0)==10)return u|0}else l[u>>2]=l[g>>2];while(!1);return Ge(A),g=c+8|0,l[g>>2]=(l[g>>2]|0)+-1,g=0,g|0}function xE(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0;g=Gr(40)|0,g||$e(23390,23360,98,23403),l[g>>2]=l[A>>2],l[g+4>>2]=l[A+4>>2],l[g+8>>2]=l[A+8>>2],l[g+12>>2]=l[A+12>>2],d=g+16|0,l[d>>2]=l[u>>2],l[d+4>>2]=l[u+4>>2],l[d+8>>2]=l[u+8>>2],l[d+12>>2]=l[u+12>>2],l[g+32>>2]=0,d=~~(+Ce(+(+ft(10,+ +(15-(l[c+12>>2]|0)|0))*(+P[A>>3]+ +P[A+8>>3])))%+(l[c+4>>2]|0))>>>0,d=(l[c>>2]|0)+(d<<2)|0,h=l[d>>2]|0;do if(!h)l[d>>2]=g;else{for(;!(go(h,A)|0&&go(h+16|0,u)|0);)if(d=l[h+32>>2]|0,h=d|0?d:h,!(l[h+32>>2]|0)){_=10;break}if((_|0)==10){l[h+32>>2]=g;break}return Ge(g),_=h,_|0}while(!1);return _=c+8|0,l[_>>2]=(l[_>>2]|0)+1,_=g,_|0}function TE(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0;if(d=~~(+Ce(+(+ft(10,+ +(15-(l[c+12>>2]|0)|0))*(+P[A>>3]+ +P[A+8>>3])))%+(l[c+4>>2]|0))>>>0,d=l[(l[c>>2]|0)+(d<<2)>>2]|0,!d)return u=0,u|0;if(!u){for(c=d;;){if(go(c,A)|0){h=10;break}if(c=l[c+32>>2]|0,!c){c=0,h=10;break}}if((h|0)==10)return c|0}for(c=d;;){if(go(c,A)|0&&go(c+16|0,u)|0){h=10;break}if(c=l[c+32>>2]|0,!c){c=0,h=10;break}}return(h|0)==10?c|0:0}function EE(c,A){c=c|0,A=A|0;var u=0;if(u=~~(+Ce(+(+ft(10,+ +(15-(l[c+12>>2]|0)|0))*(+P[A>>3]+ +P[A+8>>3])))%+(l[c+4>>2]|0))>>>0,c=l[(l[c>>2]|0)+(u<<2)>>2]|0,!c)return u=0,u|0;for(;;){if(go(c,A)|0){A=5;break}if(c=l[c+32>>2]|0,!c){c=0,A=5;break}}return(A|0)==5?c|0:0}function SE(){return 23424}function CE(c){return c=+c,+ +wm(+c)}function Li(c){return c=+c,~~+CE(c)|0}function Gr(c){c=c|0;var A=0,u=0,h=0,d=0,g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0,ne=0,de=0,fe=0,oe=0,ae=0,te=0,ke=0;ke=D,D=D+16|0,X=ke;do if(c>>>0<245){if(x=c>>>0<11?16:c+11&-8,c=x>>>3,F=l[5857]|0,u=F>>>c,u&3|0)return A=(u&1^1)+c|0,c=23468+(A<<1<<2)|0,u=c+8|0,h=l[u>>2]|0,d=h+8|0,g=l[d>>2]|0,(g|0)==(c|0)?l[5857]=F&~(1<<A):(l[g+12>>2]=c,l[u>>2]=g),te=A<<3,l[h+4>>2]=te|3,te=h+te+4|0,l[te>>2]=l[te>>2]|1,te=d,D=ke,te|0;if(C=l[5859]|0,x>>>0>C>>>0){if(u|0)return A=2<<c,A=u<<c&(A|0-A),A=(A&0-A)+-1|0,y=A>>>12&16,A=A>>>y,u=A>>>5&8,A=A>>>u,g=A>>>2&4,A=A>>>g,c=A>>>1&2,A=A>>>c,h=A>>>1&1,h=(u|y|g|c|h)+(A>>>h)|0,A=23468+(h<<1<<2)|0,c=A+8|0,g=l[c>>2]|0,y=g+8|0,u=l[y>>2]|0,(u|0)==(A|0)?(c=F&~(1<<h),l[5857]=c):(l[u+12>>2]=A,l[c>>2]=u,c=F),te=h<<3,_=te-x|0,l[g+4>>2]=x|3,d=g+x|0,l[d+4>>2]=_|1,l[g+te>>2]=_,C|0&&(h=l[5862]|0,A=C>>>3,u=23468+(A<<1<<2)|0,A=1<<A,c&A?(c=u+8|0,A=l[c>>2]|0):(l[5857]=c|A,A=u,c=u+8|0),l[c>>2]=h,l[A+12>>2]=h,l[h+8>>2]=A,l[h+12>>2]=u),l[5859]=_,l[5862]=d,te=y,D=ke,te|0;if(g=l[5858]|0,g){for(u=(g&0-g)+-1|0,d=u>>>12&16,u=u>>>d,h=u>>>5&8,u=u>>>h,_=u>>>2&4,u=u>>>_,y=u>>>1&2,u=u>>>y,b=u>>>1&1,b=l[23732+((h|d|_|y|b)+(u>>>b)<<2)>>2]|0,u=b,y=b,b=(l[b+4>>2]&-8)-x|0;c=l[u+16>>2]|0,!(!c&&(c=l[u+20>>2]|0,!c));)_=(l[c+4>>2]&-8)-x|0,d=_>>>0<b>>>0,u=c,y=d?c:y,b=d?_:b;if(_=y+x|0,_>>>0>y>>>0){d=l[y+24>>2]|0,A=l[y+12>>2]|0;do if((A|0)==(y|0)){if(c=y+20|0,A=l[c>>2]|0,!A&&(c=y+16|0,A=l[c>>2]|0,!A)){u=0;break}for(;;)if(h=A+20|0,u=l[h>>2]|0,u)A=u,c=h;else if(h=A+16|0,u=l[h>>2]|0,u)A=u,c=h;else break;l[c>>2]=0,u=A}else u=l[y+8>>2]|0,l[u+12>>2]=A,l[A+8>>2]=u,u=A;while(!1);do if(d|0){if(A=l[y+28>>2]|0,c=23732+(A<<2)|0,(y|0)==(l[c>>2]|0)){if(l[c>>2]=u,!u){l[5858]=g&~(1<<A);break}}else if(te=d+16|0,l[((l[te>>2]|0)==(y|0)?te:d+20|0)>>2]=u,!u)break;l[u+24>>2]=d,A=l[y+16>>2]|0,A|0&&(l[u+16>>2]=A,l[A+24>>2]=u),A=l[y+20>>2]|0,A|0&&(l[u+20>>2]=A,l[A+24>>2]=u)}while(!1);return b>>>0<16?(te=b+x|0,l[y+4>>2]=te|3,te=y+te+4|0,l[te>>2]=l[te>>2]|1):(l[y+4>>2]=x|3,l[_+4>>2]=b|1,l[_+b>>2]=b,C|0&&(h=l[5862]|0,A=C>>>3,u=23468+(A<<1<<2)|0,A=1<<A,A&F?(c=u+8|0,A=l[c>>2]|0):(l[5857]=A|F,A=u,c=u+8|0),l[c>>2]=h,l[A+12>>2]=h,l[h+8>>2]=A,l[h+12>>2]=u),l[5859]=b,l[5862]=_),te=y+8|0,D=ke,te|0}else F=x}else F=x}else F=x}else if(c>>>0<=4294967231)if(c=c+11|0,x=c&-8,h=l[5858]|0,h){d=0-x|0,c=c>>>8,c?x>>>0>16777215?b=31:(F=(c+1048320|0)>>>16&8,ne=c<<F,y=(ne+520192|0)>>>16&4,ne=ne<<y,b=(ne+245760|0)>>>16&2,b=14-(y|F|b)+(ne<<b>>>15)|0,b=x>>>(b+7|0)&1|b<<1):b=0,u=l[23732+(b<<2)>>2]|0;e:do if(!u)u=0,c=0,ne=61;else for(c=0,y=x<<((b|0)==31?0:25-(b>>>1)|0),g=0;;){if(_=(l[u+4>>2]&-8)-x|0,_>>>0<d>>>0)if(_)c=u,d=_;else{c=u,d=0,ne=65;break e}if(ne=l[u+20>>2]|0,u=l[u+16+(y>>>31<<2)>>2]|0,g=(ne|0)==0|(ne|0)==(u|0)?g:ne,u)y=y<<1;else{u=g,ne=61;break}}while(!1);if((ne|0)==61){if((u|0)==0&(c|0)==0){if(c=2<<b,c=(c|0-c)&h,!c){F=x;break}F=(c&0-c)+-1|0,_=F>>>12&16,F=F>>>_,g=F>>>5&8,F=F>>>g,y=F>>>2&4,F=F>>>y,b=F>>>1&2,F=F>>>b,u=F>>>1&1,c=0,u=l[23732+((g|_|y|b|u)+(F>>>u)<<2)>>2]|0}u?ne=65:(y=c,_=d)}if((ne|0)==65)for(g=u;;)if(F=(l[g+4>>2]&-8)-x|0,u=F>>>0<d>>>0,d=u?F:d,c=u?g:c,u=l[g+16>>2]|0,u||(u=l[g+20>>2]|0),u)g=u;else{y=c,_=d;break}if(y|0&&_>>>0<((l[5859]|0)-x|0)>>>0&&(C=y+x|0,C>>>0>y>>>0)){g=l[y+24>>2]|0,A=l[y+12>>2]|0;do if((A|0)==(y|0)){if(c=y+20|0,A=l[c>>2]|0,!A&&(c=y+16|0,A=l[c>>2]|0,!A)){A=0;break}for(;;)if(d=A+20|0,u=l[d>>2]|0,u)A=u,c=d;else if(d=A+16|0,u=l[d>>2]|0,u)A=u,c=d;else break;l[c>>2]=0}else te=l[y+8>>2]|0,l[te+12>>2]=A,l[A+8>>2]=te;while(!1);do if(g){if(c=l[y+28>>2]|0,u=23732+(c<<2)|0,(y|0)==(l[u>>2]|0)){if(l[u>>2]=A,!A){h=h&~(1<<c),l[5858]=h;break}}else if(te=g+16|0,l[((l[te>>2]|0)==(y|0)?te:g+20|0)>>2]=A,!A)break;l[A+24>>2]=g,c=l[y+16>>2]|0,c|0&&(l[A+16>>2]=c,l[c+24>>2]=A),c=l[y+20>>2]|0,c&&(l[A+20>>2]=c,l[c+24>>2]=A)}while(!1);e:do if(_>>>0<16)te=_+x|0,l[y+4>>2]=te|3,te=y+te+4|0,l[te>>2]=l[te>>2]|1;else{if(l[y+4>>2]=x|3,l[C+4>>2]=_|1,l[C+_>>2]=_,A=_>>>3,_>>>0<256){u=23468+(A<<1<<2)|0,c=l[5857]|0,A=1<<A,c&A?(c=u+8|0,A=l[c>>2]|0):(l[5857]=c|A,A=u,c=u+8|0),l[c>>2]=C,l[A+12>>2]=C,l[C+8>>2]=A,l[C+12>>2]=u;break}if(A=_>>>8,A?_>>>0>16777215?u=31:(ae=(A+1048320|0)>>>16&8,te=A<<ae,oe=(te+520192|0)>>>16&4,te=te<<oe,u=(te+245760|0)>>>16&2,u=14-(oe|ae|u)+(te<<u>>>15)|0,u=_>>>(u+7|0)&1|u<<1):u=0,A=23732+(u<<2)|0,l[C+28>>2]=u,c=C+16|0,l[c+4>>2]=0,l[c>>2]=0,c=1<<u,!(h&c)){l[5858]=h|c,l[A>>2]=C,l[C+24>>2]=A,l[C+12>>2]=C,l[C+8>>2]=C;break}A=l[A>>2]|0;t:do if((l[A+4>>2]&-8|0)!=(_|0)){for(h=_<<((u|0)==31?0:25-(u>>>1)|0);u=A+16+(h>>>31<<2)|0,c=l[u>>2]|0,!!c;)if((l[c+4>>2]&-8|0)==(_|0)){A=c;break t}else h=h<<1,A=c;l[u>>2]=C,l[C+24>>2]=A,l[C+12>>2]=C,l[C+8>>2]=C;break e}while(!1);ae=A+8|0,te=l[ae>>2]|0,l[te+12>>2]=C,l[ae>>2]=C,l[C+8>>2]=te,l[C+12>>2]=A,l[C+24>>2]=0}while(!1);return te=y+8|0,D=ke,te|0}else F=x}else F=x;else F=-1;while(!1);if(u=l[5859]|0,u>>>0>=F>>>0)return A=u-F|0,c=l[5862]|0,A>>>0>15?(te=c+F|0,l[5862]=te,l[5859]=A,l[te+4>>2]=A|1,l[c+u>>2]=A,l[c+4>>2]=F|3):(l[5859]=0,l[5862]=0,l[c+4>>2]=u|3,te=c+u+4|0,l[te>>2]=l[te>>2]|1),te=c+8|0,D=ke,te|0;if(_=l[5860]|0,_>>>0>F>>>0)return oe=_-F|0,l[5860]=oe,te=l[5863]|0,ae=te+F|0,l[5863]=ae,l[ae+4>>2]=oe|1,l[te+4>>2]=F|3,te=te+8|0,D=ke,te|0;if(l[5975]|0?c=l[5977]|0:(l[5977]=4096,l[5976]=4096,l[5978]=-1,l[5979]=-1,l[5980]=0,l[5968]=0,l[5975]=X&-16^1431655768,c=4096),y=F+48|0,b=F+47|0,g=c+b|0,d=0-c|0,x=g&d,x>>>0<=F>>>0||(c=l[5967]|0,c|0&&(C=l[5965]|0,X=C+x|0,X>>>0<=C>>>0|X>>>0>c>>>0)))return te=0,D=ke,te|0;e:do if(l[5968]&4)A=0,ne=143;else{u=l[5863]|0;t:do if(u){for(h=23876;X=l[h>>2]|0,!(X>>>0<=u>>>0&&(X+(l[h+4>>2]|0)|0)>>>0>u>>>0);)if(c=l[h+8>>2]|0,c)h=c;else{ne=128;break t}if(A=g-_&d,A>>>0<2147483647)if(c=Ui(A|0)|0,(c|0)==((l[h>>2]|0)+(l[h+4>>2]|0)|0)){if((c|0)!=-1){_=A,g=c,ne=145;break e}}else h=c,ne=136;else A=0}else ne=128;while(!1);do if((ne|0)==128)if(u=Ui(0)|0,(u|0)!=-1&&(A=u,Q=l[5976]|0,H=Q+-1|0,A=(H&A|0?(H+A&0-Q)-A|0:0)+x|0,Q=l[5965]|0,H=A+Q|0,A>>>0>F>>>0&A>>>0<2147483647)){if(X=l[5967]|0,X|0&&H>>>0<=Q>>>0|H>>>0>X>>>0){A=0;break}if(c=Ui(A|0)|0,(c|0)==(u|0)){_=A,g=u,ne=145;break e}else h=c,ne=136}else A=0;while(!1);do if((ne|0)==136){if(u=0-A|0,!(y>>>0>A>>>0&(A>>>0<2147483647&(h|0)!=-1)))if((h|0)==-1){A=0;break}else{_=A,g=h,ne=145;break e}if(c=l[5977]|0,c=b-A+c&0-c,c>>>0>=2147483647){_=A,g=h,ne=145;break e}if((Ui(c|0)|0)==-1){Ui(u|0)|0,A=0;break}else{_=c+A|0,g=h,ne=145;break e}}while(!1);l[5968]=l[5968]|4,ne=143}while(!1);if((ne|0)==143&&x>>>0<2147483647&&(oe=Ui(x|0)|0,H=Ui(0)|0,de=H-oe|0,fe=de>>>0>(F+40|0)>>>0,!((oe|0)==-1|fe^1|oe>>>0<H>>>0&((oe|0)!=-1&(H|0)!=-1)^1))&&(_=fe?de:A,g=oe,ne=145),(ne|0)==145){A=(l[5965]|0)+_|0,l[5965]=A,A>>>0>(l[5966]|0)>>>0&&(l[5966]=A),b=l[5863]|0;e:do if(b){for(A=23876;;){if(c=l[A>>2]|0,u=l[A+4>>2]|0,(g|0)==(c+u|0)){ne=154;break}if(h=l[A+8>>2]|0,h)A=h;else break}if((ne|0)==154&&(ae=A+4|0,(l[A+12>>2]&8|0)==0)&&g>>>0>b>>>0&c>>>0<=b>>>0){l[ae>>2]=u+_,te=(l[5860]|0)+_|0,oe=b+8|0,oe=oe&7|0?0-oe&7:0,ae=b+oe|0,oe=te-oe|0,l[5863]=ae,l[5860]=oe,l[ae+4>>2]=oe|1,l[b+te+4>>2]=40,l[5864]=l[5979];break}for(g>>>0<(l[5861]|0)>>>0&&(l[5861]=g),u=g+_|0,A=23876;;){if((l[A>>2]|0)==(u|0)){ne=162;break}if(c=l[A+8>>2]|0,c)A=c;else break}if((ne|0)==162&&!(l[A+12>>2]&8|0)){l[A>>2]=g,C=A+4|0,l[C>>2]=(l[C>>2]|0)+_,C=g+8|0,C=g+(C&7|0?0-C&7:0)|0,A=u+8|0,A=u+(A&7|0?0-A&7:0)|0,x=C+F|0,y=A-C-F|0,l[C+4>>2]=F|3;t:do if((b|0)==(A|0))te=(l[5860]|0)+y|0,l[5860]=te,l[5863]=x,l[x+4>>2]=te|1;else{if((l[5862]|0)==(A|0)){te=(l[5859]|0)+y|0,l[5859]=te,l[5862]=x,l[x+4>>2]=te|1,l[x+te>>2]=te;break}if(c=l[A+4>>2]|0,(c&3|0)==1){_=c&-8,h=c>>>3;n:do if(c>>>0<256)if(c=l[A+8>>2]|0,u=l[A+12>>2]|0,(u|0)==(c|0)){l[5857]=l[5857]&~(1<<h);break}else{l[c+12>>2]=u,l[u+8>>2]=c;break}else{g=l[A+24>>2]|0,c=l[A+12>>2]|0;do if((c|0)==(A|0)){if(u=A+16|0,h=u+4|0,c=l[h>>2]|0,c)u=h;else if(c=l[u>>2]|0,!c){c=0;break}for(;;)if(d=c+20|0,h=l[d>>2]|0,h)c=h,u=d;else if(d=c+16|0,h=l[d>>2]|0,h)c=h,u=d;else break;l[u>>2]=0}else te=l[A+8>>2]|0,l[te+12>>2]=c,l[c+8>>2]=te;while(!1);if(!g)break;u=l[A+28>>2]|0,h=23732+(u<<2)|0;do if((l[h>>2]|0)!=(A|0)){if(te=g+16|0,l[((l[te>>2]|0)==(A|0)?te:g+20|0)>>2]=c,!c)break n}else{if(l[h>>2]=c,c|0)break;l[5858]=l[5858]&~(1<<u);break n}while(!1);if(l[c+24>>2]=g,u=A+16|0,h=l[u>>2]|0,h|0&&(l[c+16>>2]=h,l[h+24>>2]=c),u=l[u+4>>2]|0,!u)break;l[c+20>>2]=u,l[u+24>>2]=c}while(!1);A=A+_|0,d=_+y|0}else d=y;if(A=A+4|0,l[A>>2]=l[A>>2]&-2,l[x+4>>2]=d|1,l[x+d>>2]=d,A=d>>>3,d>>>0<256){u=23468+(A<<1<<2)|0,c=l[5857]|0,A=1<<A,c&A?(c=u+8|0,A=l[c>>2]|0):(l[5857]=c|A,A=u,c=u+8|0),l[c>>2]=x,l[A+12>>2]=x,l[x+8>>2]=A,l[x+12>>2]=u;break}A=d>>>8;do if(!A)h=0;else{if(d>>>0>16777215){h=31;break}ae=(A+1048320|0)>>>16&8,te=A<<ae,oe=(te+520192|0)>>>16&4,te=te<<oe,h=(te+245760|0)>>>16&2,h=14-(oe|ae|h)+(te<<h>>>15)|0,h=d>>>(h+7|0)&1|h<<1}while(!1);if(A=23732+(h<<2)|0,l[x+28>>2]=h,c=x+16|0,l[c+4>>2]=0,l[c>>2]=0,c=l[5858]|0,u=1<<h,!(c&u)){l[5858]=c|u,l[A>>2]=x,l[x+24>>2]=A,l[x+12>>2]=x,l[x+8>>2]=x;break}A=l[A>>2]|0;n:do if((l[A+4>>2]&-8|0)!=(d|0)){for(h=d<<((h|0)==31?0:25-(h>>>1)|0);u=A+16+(h>>>31<<2)|0,c=l[u>>2]|0,!!c;)if((l[c+4>>2]&-8|0)==(d|0)){A=c;break n}else h=h<<1,A=c;l[u>>2]=x,l[x+24>>2]=A,l[x+12>>2]=x,l[x+8>>2]=x;break t}while(!1);ae=A+8|0,te=l[ae>>2]|0,l[te+12>>2]=x,l[ae>>2]=x,l[x+8>>2]=te,l[x+12>>2]=A,l[x+24>>2]=0}while(!1);return te=C+8|0,D=ke,te|0}for(A=23876;c=l[A>>2]|0,!(c>>>0<=b>>>0&&(te=c+(l[A+4>>2]|0)|0,te>>>0>b>>>0));)A=l[A+8>>2]|0;d=te+-47|0,c=d+8|0,c=d+(c&7|0?0-c&7:0)|0,d=b+16|0,c=c>>>0<d>>>0?b:c,A=c+8|0,u=_+-40|0,oe=g+8|0,oe=oe&7|0?0-oe&7:0,ae=g+oe|0,oe=u-oe|0,l[5863]=ae,l[5860]=oe,l[ae+4>>2]=oe|1,l[g+u+4>>2]=40,l[5864]=l[5979],u=c+4|0,l[u>>2]=27,l[A>>2]=l[5969],l[A+4>>2]=l[5970],l[A+8>>2]=l[5971],l[A+12>>2]=l[5972],l[5969]=g,l[5970]=_,l[5972]=0,l[5971]=A,A=c+24|0;do ae=A,A=A+4|0,l[A>>2]=7;while((ae+8|0)>>>0<te>>>0);if((c|0)!=(b|0)){if(g=c-b|0,l[u>>2]=l[u>>2]&-2,l[b+4>>2]=g|1,l[c>>2]=g,A=g>>>3,g>>>0<256){u=23468+(A<<1<<2)|0,c=l[5857]|0,A=1<<A,c&A?(c=u+8|0,A=l[c>>2]|0):(l[5857]=c|A,A=u,c=u+8|0),l[c>>2]=b,l[A+12>>2]=b,l[b+8>>2]=A,l[b+12>>2]=u;break}if(A=g>>>8,A?g>>>0>16777215?h=31:(ae=(A+1048320|0)>>>16&8,te=A<<ae,oe=(te+520192|0)>>>16&4,te=te<<oe,h=(te+245760|0)>>>16&2,h=14-(oe|ae|h)+(te<<h>>>15)|0,h=g>>>(h+7|0)&1|h<<1):h=0,u=23732+(h<<2)|0,l[b+28>>2]=h,l[b+20>>2]=0,l[d>>2]=0,A=l[5858]|0,c=1<<h,!(A&c)){l[5858]=A|c,l[u>>2]=b,l[b+24>>2]=u,l[b+12>>2]=b,l[b+8>>2]=b;break}A=l[u>>2]|0;t:do if((l[A+4>>2]&-8|0)!=(g|0)){for(h=g<<((h|0)==31?0:25-(h>>>1)|0);u=A+16+(h>>>31<<2)|0,c=l[u>>2]|0,!!c;)if((l[c+4>>2]&-8|0)==(g|0)){A=c;break t}else h=h<<1,A=c;l[u>>2]=b,l[b+24>>2]=A,l[b+12>>2]=b,l[b+8>>2]=b;break e}while(!1);ae=A+8|0,te=l[ae>>2]|0,l[te+12>>2]=b,l[ae>>2]=b,l[b+8>>2]=te,l[b+12>>2]=A,l[b+24>>2]=0}}else te=l[5861]|0,(te|0)==0|g>>>0<te>>>0&&(l[5861]=g),l[5969]=g,l[5970]=_,l[5972]=0,l[5866]=l[5975],l[5865]=-1,l[5870]=23468,l[5869]=23468,l[5872]=23476,l[5871]=23476,l[5874]=23484,l[5873]=23484,l[5876]=23492,l[5875]=23492,l[5878]=23500,l[5877]=23500,l[5880]=23508,l[5879]=23508,l[5882]=23516,l[5881]=23516,l[5884]=23524,l[5883]=23524,l[5886]=23532,l[5885]=23532,l[5888]=23540,l[5887]=23540,l[5890]=23548,l[5889]=23548,l[5892]=23556,l[5891]=23556,l[5894]=23564,l[5893]=23564,l[5896]=23572,l[5895]=23572,l[5898]=23580,l[5897]=23580,l[5900]=23588,l[5899]=23588,l[5902]=23596,l[5901]=23596,l[5904]=23604,l[5903]=23604,l[5906]=23612,l[5905]=23612,l[5908]=23620,l[5907]=23620,l[5910]=23628,l[5909]=23628,l[5912]=23636,l[5911]=23636,l[5914]=23644,l[5913]=23644,l[5916]=23652,l[5915]=23652,l[5918]=23660,l[5917]=23660,l[5920]=23668,l[5919]=23668,l[5922]=23676,l[5921]=23676,l[5924]=23684,l[5923]=23684,l[5926]=23692,l[5925]=23692,l[5928]=23700,l[5927]=23700,l[5930]=23708,l[5929]=23708,l[5932]=23716,l[5931]=23716,te=_+-40|0,oe=g+8|0,oe=oe&7|0?0-oe&7:0,ae=g+oe|0,oe=te-oe|0,l[5863]=ae,l[5860]=oe,l[ae+4>>2]=oe|1,l[g+te+4>>2]=40,l[5864]=l[5979];while(!1);if(A=l[5860]|0,A>>>0>F>>>0)return oe=A-F|0,l[5860]=oe,te=l[5863]|0,ae=te+F|0,l[5863]=ae,l[ae+4>>2]=oe|1,l[te+4>>2]=F|3,te=te+8|0,D=ke,te|0}return te=SE()|0,l[te>>2]=12,te=0,D=ke,te|0}function Ge(c){c=c|0;var A=0,u=0,h=0,d=0,g=0,_=0,y=0,b=0;if(c){u=c+-8|0,d=l[5861]|0,c=l[c+-4>>2]|0,A=c&-8,b=u+A|0;do if(c&1)y=u,_=u;else{if(h=l[u>>2]|0,!(c&3)||(_=u+(0-h)|0,g=h+A|0,_>>>0<d>>>0))return;if((l[5862]|0)==(_|0)){if(c=b+4|0,A=l[c>>2]|0,(A&3|0)!=3){y=_,A=g;break}l[5859]=g,l[c>>2]=A&-2,l[_+4>>2]=g|1,l[_+g>>2]=g;return}if(u=h>>>3,h>>>0<256)if(c=l[_+8>>2]|0,A=l[_+12>>2]|0,(A|0)==(c|0)){l[5857]=l[5857]&~(1<<u),y=_,A=g;break}else{l[c+12>>2]=A,l[A+8>>2]=c,y=_,A=g;break}d=l[_+24>>2]|0,c=l[_+12>>2]|0;do if((c|0)==(_|0)){if(A=_+16|0,u=A+4|0,c=l[u>>2]|0,c)A=u;else if(c=l[A>>2]|0,!c){c=0;break}for(;;)if(h=c+20|0,u=l[h>>2]|0,u)c=u,A=h;else if(h=c+16|0,u=l[h>>2]|0,u)c=u,A=h;else break;l[A>>2]=0}else y=l[_+8>>2]|0,l[y+12>>2]=c,l[c+8>>2]=y;while(!1);if(d){if(A=l[_+28>>2]|0,u=23732+(A<<2)|0,(l[u>>2]|0)==(_|0)){if(l[u>>2]=c,!c){l[5858]=l[5858]&~(1<<A),y=_,A=g;break}}else if(y=d+16|0,l[((l[y>>2]|0)==(_|0)?y:d+20|0)>>2]=c,!c){y=_,A=g;break}l[c+24>>2]=d,A=_+16|0,u=l[A>>2]|0,u|0&&(l[c+16>>2]=u,l[u+24>>2]=c),A=l[A+4>>2]|0,A?(l[c+20>>2]=A,l[A+24>>2]=c,y=_,A=g):(y=_,A=g)}else y=_,A=g}while(!1);if(!(_>>>0>=b>>>0)&&(c=b+4|0,h=l[c>>2]|0,!!(h&1))){if(h&2)l[c>>2]=h&-2,l[y+4>>2]=A|1,l[_+A>>2]=A,d=A;else{if((l[5863]|0)==(b|0)){if(b=(l[5860]|0)+A|0,l[5860]=b,l[5863]=y,l[y+4>>2]=b|1,(y|0)!=(l[5862]|0))return;l[5862]=0,l[5859]=0;return}if((l[5862]|0)==(b|0)){b=(l[5859]|0)+A|0,l[5859]=b,l[5862]=_,l[y+4>>2]=b|1,l[_+b>>2]=b;return}d=(h&-8)+A|0,u=h>>>3;do if(h>>>0<256)if(A=l[b+8>>2]|0,c=l[b+12>>2]|0,(c|0)==(A|0)){l[5857]=l[5857]&~(1<<u);break}else{l[A+12>>2]=c,l[c+8>>2]=A;break}else{g=l[b+24>>2]|0,c=l[b+12>>2]|0;do if((c|0)==(b|0)){if(A=b+16|0,u=A+4|0,c=l[u>>2]|0,c)A=u;else if(c=l[A>>2]|0,!c){u=0;break}for(;;)if(h=c+20|0,u=l[h>>2]|0,u)c=u,A=h;else if(h=c+16|0,u=l[h>>2]|0,u)c=u,A=h;else break;l[A>>2]=0,u=c}else u=l[b+8>>2]|0,l[u+12>>2]=c,l[c+8>>2]=u,u=c;while(!1);if(g|0){if(c=l[b+28>>2]|0,A=23732+(c<<2)|0,(l[A>>2]|0)==(b|0)){if(l[A>>2]=u,!u){l[5858]=l[5858]&~(1<<c);break}}else if(h=g+16|0,l[((l[h>>2]|0)==(b|0)?h:g+20|0)>>2]=u,!u)break;l[u+24>>2]=g,c=b+16|0,A=l[c>>2]|0,A|0&&(l[u+16>>2]=A,l[A+24>>2]=u),c=l[c+4>>2]|0,c|0&&(l[u+20>>2]=c,l[c+24>>2]=u)}}while(!1);if(l[y+4>>2]=d|1,l[_+d>>2]=d,(y|0)==(l[5862]|0)){l[5859]=d;return}}if(c=d>>>3,d>>>0<256){u=23468+(c<<1<<2)|0,A=l[5857]|0,c=1<<c,A&c?(A=u+8|0,c=l[A>>2]|0):(l[5857]=A|c,c=u,A=u+8|0),l[A>>2]=y,l[c+12>>2]=y,l[y+8>>2]=c,l[y+12>>2]=u;return}c=d>>>8,c?d>>>0>16777215?h=31:(_=(c+1048320|0)>>>16&8,b=c<<_,g=(b+520192|0)>>>16&4,b=b<<g,h=(b+245760|0)>>>16&2,h=14-(g|_|h)+(b<<h>>>15)|0,h=d>>>(h+7|0)&1|h<<1):h=0,c=23732+(h<<2)|0,l[y+28>>2]=h,l[y+20>>2]=0,l[y+16>>2]=0,A=l[5858]|0,u=1<<h;e:do if(!(A&u))l[5858]=A|u,l[c>>2]=y,l[y+24>>2]=c,l[y+12>>2]=y,l[y+8>>2]=y;else{c=l[c>>2]|0;t:do if((l[c+4>>2]&-8|0)!=(d|0)){for(h=d<<((h|0)==31?0:25-(h>>>1)|0);u=c+16+(h>>>31<<2)|0,A=l[u>>2]|0,!!A;)if((l[A+4>>2]&-8|0)==(d|0)){c=A;break t}else h=h<<1,c=A;l[u>>2]=y,l[y+24>>2]=c,l[y+12>>2]=y,l[y+8>>2]=y;break e}while(!1);_=c+8|0,b=l[_>>2]|0,l[b+12>>2]=y,l[_>>2]=y,l[y+8>>2]=b,l[y+12>>2]=c,l[y+24>>2]=0}while(!1);if(b=(l[5865]|0)+-1|0,l[5865]=b,!(b|0)){for(c=23884;c=l[c>>2]|0,c;)c=c+8|0;l[5865]=-1}}}}function Jr(c,A){c=c|0,A=A|0;var u=0;return c?(u=Qe(A,c)|0,(A|c)>>>0>65535&&(u=((u>>>0)/(c>>>0)|0|0)==(A|0)?u:-1)):u=0,c=Gr(u)|0,!c||!(l[c+-4>>2]&3)||ks(c|0,0,u|0)|0,c|0}function ct(c,A,u,h){return c=c|0,A=A|0,u=u|0,h=h|0,u=c+u>>>0,Xe(A+h+(u>>>0<c>>>0|0)>>>0|0),u|0|0}function jn(c,A,u,h){return c=c|0,A=A|0,u=u|0,h=h|0,h=A-h-(u>>>0>c>>>0|0)>>>0,Xe(h|0),c-u>>>0|0|0}function _m(c){return c=c|0,(c?31-(qt(c^c-1)|0)|0:32)|0}function qf(c,A,u,h,d){c=c|0,A=A|0,u=u|0,h=h|0,d=d|0;var g=0,_=0,y=0,b=0,x=0,C=0,F=0,X=0,Q=0,H=0;if(C=c,b=A,x=b,_=u,X=h,y=X,!x)return g=(d|0)!=0,y?g?(l[d>>2]=c|0,l[d+4>>2]=A&0,X=0,d=0,Xe(X|0),d|0):(X=0,d=0,Xe(X|0),d|0):(g&&(l[d>>2]=(C>>>0)%(_>>>0),l[d+4>>2]=0),X=0,d=(C>>>0)/(_>>>0)>>>0,Xe(X|0),d|0);g=(y|0)==0;do if(_){if(!g){if(g=(qt(y|0)|0)-(qt(x|0)|0)|0,g>>>0<=31){F=g+1|0,y=31-g|0,A=g-31>>31,_=F,c=C>>>(F>>>0)&A|x<<y,A=x>>>(F>>>0)&A,g=0,y=C<<y;break}return d?(l[d>>2]=c|0,l[d+4>>2]=b|A&0,X=0,d=0,Xe(X|0),d|0):(X=0,d=0,Xe(X|0),d|0)}if(g=_-1|0,g&_|0){y=(qt(_|0)|0)+33-(qt(x|0)|0)|0,H=64-y|0,F=32-y|0,b=F>>31,Q=y-32|0,A=Q>>31,_=y,c=F-1>>31&x>>>(Q>>>0)|(x<<F|C>>>(y>>>0))&A,A=A&x>>>(y>>>0),g=C<<H&b,y=(x<<H|C>>>(Q>>>0))&b|C<<F&y-33>>31;break}return d|0&&(l[d>>2]=g&C,l[d+4>>2]=0),(_|0)==1?(Q=b|A&0,H=c|0|0,Xe(Q|0),H|0):(H=_m(_|0)|0,Q=x>>>(H>>>0)|0,H=x<<32-H|C>>>(H>>>0)|0,Xe(Q|0),H|0)}else{if(g)return d|0&&(l[d>>2]=(x>>>0)%(_>>>0),l[d+4>>2]=0),Q=0,H=(x>>>0)/(_>>>0)>>>0,Xe(Q|0),H|0;if(!C)return d|0&&(l[d>>2]=0,l[d+4>>2]=(x>>>0)%(y>>>0)),Q=0,H=(x>>>0)/(y>>>0)>>>0,Xe(Q|0),H|0;if(g=y-1|0,!(g&y))return d|0&&(l[d>>2]=c|0,l[d+4>>2]=g&x|A&0),Q=0,H=x>>>((_m(y|0)|0)>>>0),Xe(Q|0),H|0;if(g=(qt(y|0)|0)-(qt(x|0)|0)|0,g>>>0<=30){A=g+1|0,y=31-g|0,_=A,c=x<<y|C>>>(A>>>0),A=x>>>(A>>>0),g=0,y=C<<y;break}return d?(l[d>>2]=c|0,l[d+4>>2]=b|A&0,Q=0,H=0,Xe(Q|0),H|0):(Q=0,H=0,Xe(Q|0),H|0)}while(!1);if(!_)x=y,b=0,y=0;else{F=u|0|0,C=X|h&0,x=ct(F|0,C|0,-1,-1)|0,u=z()|0,b=y,y=0;do h=b,b=g>>>31|b<<1,g=y|g<<1,h=c<<1|h>>>31|0,X=c>>>31|A<<1|0,jn(x|0,u|0,h|0,X|0)|0,H=z()|0,Q=H>>31|((H|0)<0?-1:0)<<1,y=Q&1,c=jn(h|0,X|0,Q&F|0,(((H|0)<0?-1:0)>>31|((H|0)<0?-1:0)<<1)&C|0)|0,A=z()|0,_=_-1|0;while(_|0);x=b,b=0}return _=0,d|0&&(l[d>>2]=c,l[d+4>>2]=A),Q=(g|0)>>>31|(x|_)<<1|(_<<1|g>>>31)&0|b,H=(g<<1|0)&-2|y,Xe(Q|0),H|0}function Cs(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0;var d=0,g=0,_=0,y=0,b=0,x=0;return x=A>>31|((A|0)<0?-1:0)<<1,b=((A|0)<0?-1:0)>>31|((A|0)<0?-1:0)<<1,g=h>>31|((h|0)<0?-1:0)<<1,d=((h|0)<0?-1:0)>>31|((h|0)<0?-1:0)<<1,y=jn(x^c|0,b^A|0,x|0,b|0)|0,_=z()|0,c=g^x,A=d^b,jn((qf(y,_,jn(g^u|0,d^h|0,g|0,d|0)|0,z()|0,0)|0)^c|0,(z()|0)^A|0,c|0,A|0)|0}function kE(c,A){c=c|0,A=A|0;var u=0,h=0,d=0,g=0;return g=c&65535,d=A&65535,u=Qe(d,g)|0,h=c>>>16,c=(u>>>16)+(Qe(d,h)|0)|0,d=A>>>16,A=Qe(d,g)|0,Xe((c>>>16)+(Qe(d,h)|0)+(((c&65535)+A|0)>>>16)|0),c+A<<16|u&65535|0|0}function Wn(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0;var d=0,g=0;return d=c,g=u,u=kE(d,g)|0,c=z()|0,Xe((Qe(A,g)|0)+(Qe(h,d)|0)+c|c&0|0),u|0|0|0}function wA(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0;var d=0,g=0,_=0,y=0,b=0,x=0;return d=D,D=D+16|0,y=d|0,_=A>>31|((A|0)<0?-1:0)<<1,g=((A|0)<0?-1:0)>>31|((A|0)<0?-1:0)<<1,x=h>>31|((h|0)<0?-1:0)<<1,b=((h|0)<0?-1:0)>>31|((h|0)<0?-1:0)<<1,c=jn(_^c|0,g^A|0,_|0,g|0)|0,A=z()|0,qf(c,A,jn(x^u|0,b^h|0,x|0,b|0)|0,z()|0,y)|0,h=jn(l[y>>2]^_|0,l[y+4>>2]^g|0,_|0,g|0)|0,u=z()|0,D=d,Xe(u|0),h|0}function mo(c,A,u,h){c=c|0,A=A|0,u=u|0,h=h|0;var d=0,g=0;return g=D,D=D+16|0,d=g|0,qf(c,A,u,h,d)|0,D=g,Xe(l[d+4>>2]|0),l[d>>2]|0|0}function ym(c,A,u){return c=c|0,A=A|0,u=u|0,(u|0)<32?(Xe(A>>u|0),c>>>u|(A&(1<<u)-1)<<32-u):(Xe(((A|0)<0?-1:0)|0),A>>u-32|0)}function ve(c,A,u){return c=c|0,A=A|0,u=u|0,(u|0)<32?(Xe(A>>>u|0),c>>>u|(A&(1<<u)-1)<<32-u):(Xe(0),A>>>u-32|0)}function Se(c,A,u){return c=c|0,A=A|0,u=u|0,(u|0)<32?(Xe(A<<u|(c&(1<<u)-1<<32-u)>>>32-u|0),c<<u):(Xe(c<<u-32|0),0)}function vm(c,A){return c=+c,A=+A,c!=c?+A:A!=A?+c:+Vt(+c,+A)}function Zf(c,A){return c=+c,A=+A,c!=c?+A:A!=A?+c:+wt(+c,+A)}function bA(c){return c=+c,c>=0?+Ne(c+.5):+pt(c-.5)}function xA(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0;if((u|0)>=8192)return zx(c|0,A|0,u|0)|0,c|0;if(g=c|0,d=c+u|0,(c&3)==(A&3)){for(;c&3;){if(!u)return g|0;ie[c>>0]=ie[A>>0]|0,c=c+1|0,A=A+1|0,u=u-1|0}for(u=d&-4|0,h=u-64|0;(c|0)<=(h|0);)l[c>>2]=l[A>>2],l[c+4>>2]=l[A+4>>2],l[c+8>>2]=l[A+8>>2],l[c+12>>2]=l[A+12>>2],l[c+16>>2]=l[A+16>>2],l[c+20>>2]=l[A+20>>2],l[c+24>>2]=l[A+24>>2],l[c+28>>2]=l[A+28>>2],l[c+32>>2]=l[A+32>>2],l[c+36>>2]=l[A+36>>2],l[c+40>>2]=l[A+40>>2],l[c+44>>2]=l[A+44>>2],l[c+48>>2]=l[A+48>>2],l[c+52>>2]=l[A+52>>2],l[c+56>>2]=l[A+56>>2],l[c+60>>2]=l[A+60>>2],c=c+64|0,A=A+64|0;for(;(c|0)<(u|0);)l[c>>2]=l[A>>2],c=c+4|0,A=A+4|0}else for(u=d-4|0;(c|0)<(u|0);)ie[c>>0]=ie[A>>0]|0,ie[c+1>>0]=ie[A+1>>0]|0,ie[c+2>>0]=ie[A+2>>0]|0,ie[c+3>>0]=ie[A+3>>0]|0,c=c+4|0,A=A+4|0;for(;(c|0)<(d|0);)ie[c>>0]=ie[A>>0]|0,c=c+1|0,A=A+1|0;return g|0}function ks(c,A,u){c=c|0,A=A|0,u=u|0;var h=0,d=0,g=0,_=0;if(g=c+u|0,A=A&255,(u|0)>=67){for(;c&3;)ie[c>>0]=A,c=c+1|0;for(h=g&-4|0,_=A|A<<8|A<<16|A<<24,d=h-64|0;(c|0)<=(d|0);)l[c>>2]=_,l[c+4>>2]=_,l[c+8>>2]=_,l[c+12>>2]=_,l[c+16>>2]=_,l[c+20>>2]=_,l[c+24>>2]=_,l[c+28>>2]=_,l[c+32>>2]=_,l[c+36>>2]=_,l[c+40>>2]=_,l[c+44>>2]=_,l[c+48>>2]=_,l[c+52>>2]=_,l[c+56>>2]=_,l[c+60>>2]=_,c=c+64|0;for(;(c|0)<(h|0);)l[c>>2]=_,c=c+4|0}for(;(c|0)<(g|0);)ie[c>>0]=A,c=c+1|0;return g-u|0}function wm(c){return c=+c,c>=0?+Ne(c+.5):+pt(c-.5)}function Ui(c){c=c|0;var A=0,u=0,h=0;return h=Nf()|0,u=l[Ee>>2]|0,A=u+c|0,(c|0)>0&(A|0)<(u|0)|(A|0)<0?(jx(A|0)|0,fo(12),-1):(A|0)>(h|0)&&!(Vx(A|0)|0)?(fo(12),-1):(l[Ee>>2]=A,u|0)}return{___divdi3:Cs,___muldi3:Wn,___remdi3:wA,___uremdi3:mo,_areNeighborCells:dT,_bitshift64Ashr:ym,_bitshift64Lshr:ve,_bitshift64Shl:Se,_calloc:Jr,_cellAreaKm2:YT,_cellAreaM2:KT,_cellAreaRads2:Kf,_cellToBoundary:Fa,_cellToCenterChild:PT,_cellToChildPos:LT,_cellToChildren:CT,_cellToChildrenSize:vA,_cellToLatLng:Ba,_cellToLocalIj:nE,_cellToParent:Wf,_cellToVertex:Er,_cellToVertexes:vE,_cellsToDirectedEdge:pT,_cellsToLinkedMultiPolygon:Jx,_childPosToCell:UT,_compactCells:RT,_destroyLinkedMultiPolygon:am,_directedEdgeToBoundary:yA,_directedEdgeToCells:yT,_edgeLengthKm:ZT,_edgeLengthM:GT,_edgeLengthRads:qT,_emscripten_replace_memory:Wx,_free:Ge,_getBaseCellNumber:tm,_getDirectedEdgeDestination:mT,_getDirectedEdgeOrigin:gT,_getHexagonAreaAvgKm2:$T,_getHexagonAreaAvgM2:HT,_getHexagonEdgeLengthAvgKm:XT,_getHexagonEdgeLengthAvgM:QT,_getIcosahedronFaces:rm,_getNumCells:Yf,_getPentagons:Qf,_getRes0Cells:iT,_getResolution:ST,_greatCircleDistanceKm:Ua,_greatCircleDistanceM:VT,_greatCircleDistanceRads:zT,_gridDisk:Fg,_gridDiskDistances:Lg,_gridDistance:iE,_gridPathCells:oE,_gridPathCellsSize:sE,_gridRingUnsafe:Kx,_i64Add:ct,_i64Subtract:jn,_isPentagon:Wt,_isResClassIII:NT,_isValidCell:jf,_isValidDirectedEdge:_T,_isValidVertex:bE,_latLngToCell:nm,_llvm_maxnum_f64:vm,_llvm_minnum_f64:Zf,_llvm_round_f64:bA,_localIjToCell:rE,_malloc:Gr,_maxFaceCount:BT,_maxGridDiskSize:Yx,_maxPolygonToCellsSize:qx,_memcpy:xA,_memset:ks,_originToDirectedEdges:vT,_pentagonCount:FT,_polygonToCells:Zx,_readInt64AsDoubleFromPointer:gE,_res0CellCount:rT,_round:wm,_sbrk:Ui,_sizeOfCellBoundary:uE,_sizeOfCoordIJ:pE,_sizeOfGeoLoop:fE,_sizeOfGeoPolygon:hE,_sizeOfH3Index:AE,_sizeOfLatLng:cE,_sizeOfLinkedGeoPolygon:dE,_uncompactCells:IT,_uncompactCellsSize:MT,_vertexToLatLng:wE,establishStackSpace:Qx,stackAlloc:$x,stackRestore:Xx,stackSave:Hx}}(Pf,Rf,ue);e.___divdi3=we.___divdi3,e.___muldi3=we.___muldi3,e.___remdi3=we.___remdi3,e.___uremdi3=we.___uremdi3,e._areNeighborCells=we._areNeighborCells,e._bitshift64Ashr=we._bitshift64Ashr,e._bitshift64Lshr=we._bitshift64Lshr,e._bitshift64Shl=we._bitshift64Shl,e._calloc=we._calloc,e._cellAreaKm2=we._cellAreaKm2,e._cellAreaM2=we._cellAreaM2,e._cellAreaRads2=we._cellAreaRads2,e._cellToBoundary=we._cellToBoundary,e._cellToCenterChild=we._cellToCenterChild,e._cellToChildPos=we._cellToChildPos,e._cellToChildren=we._cellToChildren,e._cellToChildrenSize=we._cellToChildrenSize,e._cellToLatLng=we._cellToLatLng,e._cellToLocalIj=we._cellToLocalIj,e._cellToParent=we._cellToParent,e._cellToVertex=we._cellToVertex,e._cellToVertexes=we._cellToVertexes,e._cellsToDirectedEdge=we._cellsToDirectedEdge,e._cellsToLinkedMultiPolygon=we._cellsToLinkedMultiPolygon,e._childPosToCell=we._childPosToCell,e._compactCells=we._compactCells,e._destroyLinkedMultiPolygon=we._destroyLinkedMultiPolygon,e._directedEdgeToBoundary=we._directedEdgeToBoundary,e._directedEdgeToCells=we._directedEdgeToCells,e._edgeLengthKm=we._edgeLengthKm,e._edgeLengthM=we._edgeLengthM,e._edgeLengthRads=we._edgeLengthRads;var pA=e._emscripten_replace_memory=we._emscripten_replace_memory;e._free=we._free,e._getBaseCellNumber=we._getBaseCellNumber,e._getDirectedEdgeDestination=we._getDirectedEdgeDestination,e._getDirectedEdgeOrigin=we._getDirectedEdgeOrigin,e._getHexagonAreaAvgKm2=we._getHexagonAreaAvgKm2,e._getHexagonAreaAvgM2=we._getHexagonAreaAvgM2,e._getHexagonEdgeLengthAvgKm=we._getHexagonEdgeLengthAvgKm,e._getHexagonEdgeLengthAvgM=we._getHexagonEdgeLengthAvgM,e._getIcosahedronFaces=we._getIcosahedronFaces,e._getNumCells=we._getNumCells,e._getPentagons=we._getPentagons,e._getRes0Cells=we._getRes0Cells,e._getResolution=we._getResolution,e._greatCircleDistanceKm=we._greatCircleDistanceKm,e._greatCircleDistanceM=we._greatCircleDistanceM,e._greatCircleDistanceRads=we._greatCircleDistanceRads,e._gridDisk=we._gridDisk,e._gridDiskDistances=we._gridDiskDistances,e._gridDistance=we._gridDistance,e._gridPathCells=we._gridPathCells,e._gridPathCellsSize=we._gridPathCellsSize,e._gridRingUnsafe=we._gridRingUnsafe,e._i64Add=we._i64Add,e._i64Subtract=we._i64Subtract,e._isPentagon=we._isPentagon,e._isResClassIII=we._isResClassIII,e._isValidCell=we._isValidCell,e._isValidDirectedEdge=we._isValidDirectedEdge,e._isValidVertex=we._isValidVertex,e._latLngToCell=we._latLngToCell,e._llvm_maxnum_f64=we._llvm_maxnum_f64,e._llvm_minnum_f64=we._llvm_minnum_f64,e._llvm_round_f64=we._llvm_round_f64,e._localIjToCell=we._localIjToCell,e._malloc=we._malloc,e._maxFaceCount=we._maxFaceCount,e._maxGridDiskSize=we._maxGridDiskSize,e._maxPolygonToCellsSize=we._maxPolygonToCellsSize,e._memcpy=we._memcpy,e._memset=we._memset,e._originToDirectedEdges=we._originToDirectedEdges,e._pentagonCount=we._pentagonCount,e._polygonToCells=we._polygonToCells,e._readInt64AsDoubleFromPointer=we._readInt64AsDoubleFromPointer,e._res0CellCount=we._res0CellCount,e._round=we._round,e._sbrk=we._sbrk,e._sizeOfCellBoundary=we._sizeOfCellBoundary,e._sizeOfCoordIJ=we._sizeOfCoordIJ,e._sizeOfGeoLoop=we._sizeOfGeoLoop,e._sizeOfGeoPolygon=we._sizeOfGeoPolygon,e._sizeOfH3Index=we._sizeOfH3Index,e._sizeOfLatLng=we._sizeOfLatLng,e._sizeOfLinkedGeoPolygon=we._sizeOfLinkedGeoPolygon,e._uncompactCells=we._uncompactCells,e._uncompactCellsSize=we._uncompactCellsSize,e._vertexToLatLng=we._vertexToLatLng,e.establishStackSpace=we.establishStackSpace;var ws=e.stackAlloc=we.stackAlloc,If=e.stackRestore=we.stackRestore,Mf=e.stackSave=we.stackSave;if(e.asm=we,e.cwrap=k,e.setValue=T,e.getValue=E,xn){Zr(xn)||(xn=s(xn));{Dt();var co=function(S){S.byteLength&&(S=new Uint8Array(S)),le.set(S,w),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,xr()},Ma=function(){o(xn,co,function(){throw"could not load memory initializer "+xn})},Na=Ia(xn);if(Na)co(Na.buffer);else if(e.memoryInitializerRequest){var Oa=function(){var S=e.memoryInitializerRequest,O=S.response;if(S.status!==200&&S.status!==0){var q=Ia(e.memoryInitializerRequestURL);if(q)O=q.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+S.status+", retrying "+xn),Ma();return}}co(O)};e.memoryInitializerRequest.response?setTimeout(Oa,0):e.memoryInitializerRequest.addEventListener("load",Oa)}else Ma()}}var bs;Ze=function S(){bs||uo(),bs||(Ze=S)};function uo(S){if(un>0||(sn(),un>0))return;function O(){bs||(bs=!0,!N&&(lt(),gt(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),Ut()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),O()},1)):O()}e.run=uo;function pi(S){throw e.onAbort&&e.onAbort(S),S+="",a(S),f(S),N=!0,"abort("+S+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=pi,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return uo(),t}(typeof cn=="object"?cn:{}),st="number",Ke=st,el=st,et=st,tt=st,Yn=st,We=st,lU=[["sizeOfH3Index",st],["sizeOfLatLng",st],["sizeOfCellBoundary",st],["sizeOfGeoLoop",st],["sizeOfGeoPolygon",st],["sizeOfLinkedGeoPolygon",st],["sizeOfCoordIJ",st],["readInt64AsDoubleFromPointer",st],["isValidCell",el,[et,tt]],["latLngToCell",Ke,[st,st,Yn,We]],["cellToLatLng",Ke,[et,tt,We]],["cellToBoundary",Ke,[et,tt,We]],["maxGridDiskSize",Ke,[st,We]],["gridDisk",Ke,[et,tt,st,We]],["gridDiskDistances",Ke,[et,tt,st,We,We]],["gridRingUnsafe",Ke,[et,tt,st,We]],["maxPolygonToCellsSize",Ke,[We,Yn,st,We]],["polygonToCells",Ke,[We,Yn,st,We]],["cellsToLinkedMultiPolygon",Ke,[We,st,We]],["destroyLinkedMultiPolygon",null,[We]],["compactCells",Ke,[We,We,st,st]],["uncompactCells",Ke,[We,st,st,We,st,Yn]],["uncompactCellsSize",Ke,[We,st,st,Yn,We]],["isPentagon",el,[et,tt]],["isResClassIII",el,[et,tt]],["getBaseCellNumber",st,[et,tt]],["getResolution",st,[et,tt]],["maxFaceCount",Ke,[et,tt,We]],["getIcosahedronFaces",Ke,[et,tt,We]],["cellToParent",Ke,[et,tt,Yn,We]],["cellToChildren",Ke,[et,tt,Yn,We]],["cellToCenterChild",Ke,[et,tt,Yn,We]],["cellToChildrenSize",Ke,[et,tt,Yn,We]],["cellToChildPos",Ke,[et,tt,Yn,We]],["childPosToCell",Ke,[st,st,et,tt,Yn,We]],["areNeighborCells",Ke,[et,tt,et,tt,We]],["cellsToDirectedEdge",Ke,[et,tt,et,tt,We]],["getDirectedEdgeOrigin",Ke,[et,tt,We]],["getDirectedEdgeDestination",Ke,[et,tt,We]],["isValidDirectedEdge",el,[et,tt]],["directedEdgeToCells",Ke,[et,tt,We]],["originToDirectedEdges",Ke,[et,tt,We]],["directedEdgeToBoundary",Ke,[et,tt,We]],["gridDistance",Ke,[et,tt,et,tt,We]],["gridPathCells",Ke,[et,tt,et,tt,We]],["gridPathCellsSize",Ke,[et,tt,et,tt,We]],["cellToLocalIj",Ke,[et,tt,et,tt,st,We]],["localIjToCell",Ke,[et,tt,We,st,We]],["getHexagonAreaAvgM2",Ke,[Yn,We]],["getHexagonAreaAvgKm2",Ke,[Yn,We]],["getHexagonEdgeLengthAvgM",Ke,[Yn,We]],["getHexagonEdgeLengthAvgKm",Ke,[Yn,We]],["greatCircleDistanceM",st,[We,We]],["greatCircleDistanceKm",st,[We,We]],["greatCircleDistanceRads",st,[We,We]],["cellAreaM2",Ke,[et,tt,We]],["cellAreaKm2",Ke,[et,tt,We]],["cellAreaRads2",Ke,[et,tt,We]],["edgeLengthM",Ke,[et,tt,We]],["edgeLengthKm",Ke,[et,tt,We]],["edgeLengthRads",Ke,[et,tt,We]],["getNumCells",Ke,[Yn,We]],["getRes0Cells",Ke,[We]],["res0CellCount",st],["getPentagons",Ke,[st,We]],["pentagonCount",st],["cellToVertex",Ke,[et,tt,st,We]],["cellToVertexes",Ke,[et,tt,We]],["vertexToLatLng",Ke,[et,tt,We]],["isValidVertex",el,[et,tt]]],AU=0,cU=1,uU=2,fU=3,Rx=4,hU=5,dU=6,pU=7,gU=8,mU=9,_U=10,yU=11,vU=12,wU=13,bU=14,xU=15,Fn={};Fn[AU]="Success";Fn[cU]="The operation failed but a more specific error is not available";Fn[uU]="Argument was outside of acceptable range";Fn[fU]="Latitude or longitude arguments were outside of acceptable range";Fn[Rx]="Resolution argument was outside of acceptable range";Fn[hU]="Cell argument was not valid";Fn[dU]="Directed edge argument was not valid";Fn[pU]="Undirected edge argument was not valid";Fn[gU]="Vertex argument was not valid";Fn[mU]="Pentagon distortion was encountered";Fn[_U]="Duplicate input";Fn[yU]="Cell arguments were not neighbors";Fn[vU]="Cell arguments had incompatible resolutions";Fn[wU]="Memory allocation failed";Fn[bU]="Bounds of provided memory were insufficient";Fn[xU]="Mode or flags argument was not valid";var Ix=1e3,TU=1001,Mx=1002,Sf={};Sf[Ix]="Unknown unit";Sf[TU]="Array length out of bounds";Sf[Mx]="Got unexpected null value for H3 index";var EU="Unknown error";function Nx(t,e,n){var r=n&&"value"in n,i=new Error((t[e]||EU)+" (code: "+e+(r?", value: "+n.value:"")+")");return i.code=e,i}function Ox(t,e){var n=arguments.length===2?{value:e}:{};return Nx(Fn,t,n)}function Dx(t,e){var n=arguments.length===2?{value:e}:{};return Nx(Sf,t,n)}function ba(t){if(t!==0)throw Ox(t)}var bn={};lU.forEach(function(e){bn[e[0]]=cn.cwrap.apply(cn,e)});var Xo=16,SU=4,to=8,CU=8,G0=bn.sizeOfH3Index(),Bx=bn.sizeOfLatLng(),kU=bn.sizeOfCellBoundary();bn.sizeOfGeoPolygon();bn.sizeOfGeoLoop();bn.sizeOfLinkedGeoPolygon();bn.sizeOfCoordIJ();var wy={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function PU(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw Ox(Rx,t);return t}function RU(t){if(!t)throw Dx(Mx);return t}var IU=/[^0-9a-fA-F]/;function no(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||IU.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),Xo),n=parseInt(t.substring(t.length-8),Xo);return[n,e]}function by(t){if(t>=0)return t.toString(Xo);t=t&2147483647;var e=Fx(8,t.toString(Xo)),n=(parseInt(e[0],Xo)+8).toString(Xo);return e=n+e.substring(1),e}function MU(t,e){return by(e)+Fx(8,by(t))}function Fx(t,e){for(var n=t-e.length,r="",i=0;i<n;i++)r+="0";return r=r+e,r}function NU(t,e){e===void 0&&(e=0);var n=cn.getValue(t+G0*e,"i32"),r=cn.getValue(t+G0*e+SU,"i32");return r?MU(n,r):null}function OU(t,e){return e===void 0&&(e=0),cn.getValue(t+to*e,"double")}function DU(t){return bn.readInt64AsDoubleFromPointer(t)}function Iu(t){return HU(cn.getValue(t,"double"))}function Lx(t){return[Iu(t),Iu(t+to)]}function BU(t){return[Iu(t+to),Iu(t)]}function FU(t,e,n){for(var r=cn.getValue(t,"i32"),i=t+to,s=[],o=e?BU:Lx,a=0;a<r*2;a+=2)s.push(o(i+to*a));return n&&s.push(s[0]),s}function LU(t){var e=no(t),n=e[0],r=e[1];return!!bn.isValidCell(n,r)}function UU(t){var e=no(t),n=e[0],r=e[1];return!!bn.isPentagon(n,r)}function zU(t){var e=no(t),n=e[0],r=e[1];return bn.isValidCell(n,r)?bn.getResolution(n,r):-1}function VU(t,e,n){var r=cn._malloc(Bx);cn.HEAPF64.set([t,e].map($U),r/to);var i=cn._malloc(G0);try{return ba(bn.latLngToCell(r,n,i)),RU(NU(i))}finally{cn._free(i),cn._free(r)}}function Cf(t){var e=cn._malloc(Bx),n=no(t),r=n[0],i=n[1];try{return ba(bn.cellToLatLng(r,i,e)),Lx(e)}finally{cn._free(e)}}function J0(t,e){var n=cn._malloc(kU),r=no(t),i=r[0],s=r[1];try{return ba(bn.cellToBoundary(i,s,n)),FU(n,e,e)}finally{cn._free(n)}}function jU(t,e){var n=no(t),r=n[0],i=n[1],s=no(e),o=s[0],a=s[1],f=cn._malloc(CU);try{return ba(bn.gridDistance(r,i,o,a,f)),DU(f)}finally{cn._free(f)}}function WU(t,e){PU(t);var n=cn._malloc(to);try{switch(e){case wy.m:ba(bn.getHexagonEdgeLengthAvgM(t,n));break;case wy.km:ba(bn.getHexagonEdgeLengthAvgKm(t,n));break;default:throw Dx(Ix,e)}return OU(n)}finally{cn._free(n)}}function $U(t){return t*Math.PI/180}function HU(t){return t*180/Math.PI}function Ux(t,e){e=e===void 0?t[0][0]:e;for(const n of t){const r=n[0]-e;r>180?n[0]-=360:r<-180&&(n[0]+=360)}}function XU(t,e,n){const[r,i]=Cf(t),s=e.length;Ux(e,i);const o=e[0]===e[s-1]?s-1:s;for(let a=0;a<o;a++)e[a][0]=ha(i,e[a][0],n),e[a][1]=ha(r,e[a][1],n)}function QU(t,e,n){const r=t(e,n),[i,s]=Cf(r);return[s,i]}function xy(t,e=1){const n=J0(t,!0);return e!==1?XU(t,n,e):Ux(n),n}function YU(t){const e=new Float64Array(t.length*2);let n=0;for(const r of t)e[n++]=r[0],e[n++]=r[1];return e}const KU=10;function qU(t,e){let n;return t==null?n=e:typeof t=="object"?n={...t,coverage:e}:n={getHexagon:t,coverage:e},n}const ZU={...Ef.defaultProps,highPrecision:"auto",coverage:{type:"number",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:"accessor",value:t=>t.hexagon},extruded:!0};class Ra extends hA{initializeState(){Ra._checkH3Lib(),this.state={edgeLengthKM:0,resolution:-1}}shouldUpdateState({changeFlags:e}){return this._shouldUseHighPrecision()?e.propsOrDataChanged:e.somethingChanged}updateState({props:e,changeFlags:n}){if(e.highPrecision!==!0&&(n.dataChanged||n.updateTriggersChanged&&n.updateTriggersChanged.getHexagon)){const r=this._calculateH3DataProps();this.setState(r)}this._updateVertices(this.context.viewport)}_calculateH3DataProps(){let e=-1,n=!1,r=!1;const{iterable:i,objectInfo:s}=Pa(this.props.data);for(const o of i){s.index++;const a=this.props.getHexagon(o,s),f=zU(a);if(e<0){if(e=f,!this.props.highPrecision)break}else if(e!==f){r=!0;break}if(UU(a)){n=!0;break}}return{resolution:e,edgeLengthKM:e>=0?WU(e,"km"):0,hasMultipleRes:r,hasPentagon:n}}_shouldUseHighPrecision(){if(this.props.highPrecision==="auto"){const{resolution:e,hasPentagon:n,hasMultipleRes:r}=this.state,{viewport:i}=this.context;return!!(i!=null&&i.resolution)||r||n||e>=0&&e<=5}return this.props.highPrecision}_updateVertices(e){if(this._shouldUseHighPrecision())return;const{resolution:n,edgeLengthKM:r,centerHex:i}=this.state;if(n<0)return;const s=this.props.centerHexagon||VU(e.latitude,e.longitude,n);if(i===s)return;if(i)try{if(jU(i,s)*r<KU)return}catch{}const{unitsPerMeter:o}=e.distanceScales;let a=xy(s);const[f,p]=Cf(s),[m,v]=e.projectFlat([p,f]);a=a.map(w=>{const T=e.projectFlat(w);return[(T[0]-m)/o[0],(T[1]-v)/o[1]]}),this.setState({centerHex:s,vertices:a})}renderLayers(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}_getForwardProps(){const{elevationScale:e,material:n,coverage:r,extruded:i,wireframe:s,stroked:o,filled:a,lineWidthUnits:f,lineWidthScale:p,lineWidthMinPixels:m,lineWidthMaxPixels:v,getFillColor:w,getElevation:T,getLineColor:E,getLineWidth:N,transitions:j,updateTriggers:I}=this.props;return{elevationScale:e,extruded:i,coverage:r,wireframe:s,stroked:o,filled:a,lineWidthUnits:f,lineWidthScale:p,lineWidthMinPixels:m,lineWidthMaxPixels:v,material:n,getElevation:T,getFillColor:w,getLineColor:E,getLineWidth:N,transitions:j,updateTriggers:{getFillColor:I.getFillColor,getElevation:I.getElevation,getLineColor:I.getLineColor,getLineWidth:I.getLineWidth}}}_renderPolygonLayer(){const{data:e,getHexagon:n,updateTriggers:r,coverage:i}=this.props,s=this.getSubLayerClass("hexagon-cell-hifi",Ef),o=this._getForwardProps();return o.updateTriggers.getPolygon=qU(r.getHexagon,i),new s(o,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:o.updateTriggers}),{data:e,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:(a,f)=>{const p=n(a,f);return YU(xy(p,i))}})}_renderColumnLayer(){const{data:e,getHexagon:n,updateTriggers:r}=this.props,i=this.getSubLayerClass("hexagon-cell",Ig),s=this._getForwardProps();return s.updateTriggers.getPosition=r.getHexagon,new i(s,this.getSubLayerProps({id:"hexagon-cell",flatShading:!0,updateTriggers:s.updateTriggers}),{data:e,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:QU.bind(null,n)})}}Ra.defaultProps=ZU;Ra.layerName="H3HexagonLayer";Ra._checkH3Lib=()=>{};const GU={latitude:39.8283,longitude:-98.5795,zoom:3},ep={Reds:["#fee5d9","#fcae91","#fb6a4a","#de2d26","#a50f15"],Blues:["#eff3ff","#bdd7e7","#6baed6","#3182bd","#08519c"],Greens:["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],Greys:["#f7f7f7","#cccccc","#969696","#636363","#252525"],YlGnBu:["#ffffd9","#c7e9b4","#7fcdbb","#41b6c4","#225ea8"],YlOrRd:["#ffffb2","#fecc5c","#fd8d3c","#f03b20","#bd0026"],PuBuGn:["#f6eff7","#bdc9e1","#67a9cf","#1c9099","#016c59"],RdPu:["#feebe2","#fbb4b9","#f768a1","#c51b8a","#7a0177"]},Ty={OpenStreetMap:{version:8,sources:{osm:{type:"raster",tiles:["https://tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,attribution:" OpenStreetMap contributors"}},layers:[{id:"osm",type:"raster",source:"osm"}]},"Carto Light":"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json","Carto Dark":"https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json"},JU=({scale:t})=>{const e=ep[t];return V.jsx("div",{className:"flex h-4",children:e.map((n,r)=>V.jsx("div",{className:"flex-1",style:{backgroundColor:n}},r))})},e7=(t,e)=>{var n;return V.jsxs("div",{children:[V.jsx("span",{className:"text-xs text-gray-500",children:"Color Scale"}),V.jsxs("div",{className:"relative",children:[V.jsxs("select",{className:"mt-1 block w-full rounded-md border-gray-300 py-1 pl-2 pr-8 text-xs",value:((n=t.colorMapping)==null?void 0:n.colorScale)||"YlOrRd",onChange:r=>{var o,a;const i=r.target.value,s=((o=t.colorMapping)==null?void 0:o.column)||"";s&&e(t.id,{column:s,numClasses:((a=t.colorMapping)==null?void 0:a.numClasses)||5,breaks:[],colorScale:i})},children:[V.jsx("optgroup",{label:"Single-hue",children:["Reds","Blues","Greens","Greys"].map(r=>V.jsx("option",{value:r,children:r},r))}),V.jsx("optgroup",{label:"Multi-hue",children:["YlGnBu","YlOrRd","PuBuGn","RdPu"].map(r=>V.jsx("option",{value:r,children:r},r))})]}),t.colorMapping&&V.jsx("div",{className:"absolute left-0 right-0 top-full mt-1 bg-white border rounded-md shadow-lg z-10",children:V.jsx(JU,{scale:t.colorMapping.colorScale})})]})]})},t7=({layer:t})=>{var n,r,i,s;if(!((n=t.sizeMapping)!=null&&n.breaks.length))return null;const e=o=>{if(!t.sizeMapping)return 0;const a=o/(t.sizeMapping.numClasses-1);return t.sizeMapping.minSize+(t.sizeMapping.maxSize-t.sizeMapping.minSize)*a};return V.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-2 mb-2",children:[V.jsx("div",{className:"text-xs font-medium mb-2",children:t.sizeMapping.column}),V.jsxs("div",{className:"flex space-x-2",children:[V.jsx("div",{className:"w-6 h-32 relative",children:Array.from({length:t.sizeMapping.numClasses}).map((o,a)=>{const f=e(a);return V.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2",style:{bottom:`${a/(t.sizeMapping.numClasses-1)*100}%`,width:`${f*2}px`,height:`${f*2}px`,borderRadius:"50%",backgroundColor:t.color,opacity:t.opacity}},a)})}),V.jsxs("div",{className:"flex flex-col justify-between py-1 text-xs",children:[V.jsx("span",{children:(r=t.sizeMapping.breaks[t.sizeMapping.breaks.length-1])==null?void 0:r.toFixed(1)}),V.jsx("span",{children:(i=t.sizeMapping.breaks[Math.floor(t.sizeMapping.breaks.length/2)])==null?void 0:i.toFixed(1)}),V.jsx("span",{children:(s=t.sizeMapping.breaks[0])==null?void 0:s.toFixed(1)})]})]})]})},n7=()=>{var co,Ma,Na,Oa,bs,uo,pi;const t=pe.useRef(0),e=pe.useCallback(()=>(t.current+=1,t.current),[]),[n,r]=pe.useState([]),[i,s]=pe.useState(GU),[o,a]=pe.useState(!1),[f,p]=pe.useState(0),[m,v]=pe.useState(null),[w,T]=pe.useState(!1),[E,N]=pe.useState([]),[j,I]=pe.useState([]),[R,k]=pe.useState(!1),[B,Y]=pe.useState(Ty["Carto Light"]),[G,ce]=pe.useState(!1),[U,$]=pe.useState(null),[K,ue]=pe.useState({}),[ge,le]=pe.useState(!0),[he,Ue]=pe.useState(null),[je,ze]=pe.useState(null),me=pe.useRef(null),ye=pe.useRef(null),[De,Me]=pe.useState(!1);Sm.useEffect(()=>{if(m!=null&&m.properties){const S=Object.keys(m.properties);I(S),(E.length===0||!E.some(O=>S.includes(O)))&&N(S.slice(0,5))}},[m,E]);const Oe=S=>{N(O=>O.includes(S)?O.filter(q=>q!==S):[...O,S])},Le=pe.useCallback(S=>{switch(S.type){case"Point":return[S.coordinates];case"LineString":return S.coordinates;case"Polygon":return S.coordinates.flat();case"MultiPoint":return S.coordinates;case"MultiLineString":return S.coordinates.flat();case"MultiPolygon":return S.coordinates.flat(2);case"GeometryCollection":return S.geometries.flatMap(Le);default:return[]}},[]),xt=pe.useCallback(S=>{const O=S.features.flatMap(l=>Le(l.geometry));if(O.length===0)return null;const q=O.map(l=>l[1]),ie=O.map(l=>l[0]);return{minLat:Math.min(...q),maxLat:Math.max(...q),minLng:Math.min(...ie),maxLng:Math.max(...ie)}},[Le]),Rt=S=>{const O=["latitude","lat","y"],q=["longitude","lng","long","lon","x"];let ie=S.find(P=>O.some(Ae=>P.toLowerCase().trim()===Ae.toLowerCase())),l=S.find(P=>q.some(Ae=>P.toLowerCase().trim()===Ae.toLowerCase()));return(!ie||!l)&&(ie=S.find(P=>O.some(Ae=>P.toLowerCase().trim().startsWith(Ae.toLowerCase()+"_"))),l=S.find(P=>q.some(Ae=>P.toLowerCase().trim().startsWith(Ae.toLowerCase()+"_")))),ie&&l?{lat:ie,lng:l}:null},Ct=S=>{const O=["hex_id","h3_index","h3","hexagon"],q=S.find(ie=>O.some(l=>ie.toLowerCase().trim()===l.toLowerCase()));return q||S.find(ie=>O.some(l=>ie.toLowerCase().includes(l.toLowerCase())))||null},sn=S=>{try{return LU(S)}catch{return!1}},lt=pe.useCallback((S,O,q,ie,l,P,Ae,Ee,Ne)=>{const Ce=[],Be=Math.min(O+Ee,S.length);for(let Re=O;Re<Be;Re++){const _t=S[Re];if(!_t||_t.length===0)continue;const Kt=_t.map(pt=>String(pt).trim()),ht=parseFloat(Kt[P]),Sn=parseFloat(Kt[Ae]);if(isNaN(ht)||isNaN(Sn)||ht<-90||ht>90||Sn<-180||Sn>180)continue;const at={};q.forEach((pt,Qe)=>{ie.has(pt)&&(at[pt]=Kt[Qe])}),Ce.push({position:[Sn,ht],properties:at})}const ft=S.length-1,He=(Be-1)/ft*100;return Ne(Math.min(He,100)),{data:Ce,endIndex:Be}},[]),gt=S=>{var ie;const O=(ie=S.target.files)==null?void 0:ie[0];if(!O){Ue(null);return}ze(null),Ue(null);const q=new FileReader;q.onload=l=>{var P;try{const Ae=(P=l.target)==null?void 0:P.result,Ee=vy.parse(Ae,{header:!1,preview:11,skipEmptyLines:!0});Ee.errors.length>0&&console.warn("CSV parsing warnings:",Ee.errors);const Ne=Ee.data;if(Ne.length<2)throw new Error("CSV file is empty or has no data rows");const Ce=Ne[0].map(ht=>ht.trim()),Be=Ne.slice(1,11),ft=Ct(Ce),He=ft?Ce.indexOf(ft):-1;let Re=!1;if(He!==-1){const ht=Be[0][He];Re=sn(ht)}const _t=new Set;if(!Re){const ht=Rt(Ce);ht&&(_t.add(ht.lat),_t.add(ht.lng))}const Kt=new Set(Ce);Ue({headers:Ce,rows:Be,selectedColumns:Kt,coordinateColumns:_t,isH3Data:Re,h3Column:ft||void 0})}catch(Ae){console.error("Error parsing CSV:",Ae),alert(Ae instanceof Error?Ae.message:"Error parsing CSV file"),me.current&&(me.current.value=""),Ue(null)}},q.readAsText(O)},Ut=S=>{if(!he||he.coordinateColumns.has(S))return;const O=new Set(he.selectedColumns);O.has(S)?O.delete(S):O.add(S),Ue({...he,selectedColumns:O})},qe=()=>{he&&Ue({...he,selectedColumns:new Set(he.headers)})},zt=()=>{he&&Ue({...he,selectedColumns:new Set(he.coordinateColumns)})},Jt=()=>{var q,ie;if(!((ie=(q=me.current)==null?void 0:q.files)!=null&&ie[0])||!he)return;const S=me.current.files[0];a(!0),p(0);const O=new FileReader;O.onload=l=>{var P;try{const Ae=(P=l.target)==null?void 0:P.result,Ee=vy.parse(Ae,{header:!1,skipEmptyLines:!0});Ee.errors.length>0&&console.warn("CSV parsing warnings:",Ee.errors);const Ne=Ee.data,Ce=Ne[0].map(Be=>Be.trim());if(he.isH3Data&&he.h3Column){const Be=Ce.indexOf(he.h3Column),ft=Ne.slice(1).map(Re=>{const _t=Re.map(Sn=>String(Sn).trim()),Kt=_t[Be],ht={};return Ce.forEach((Sn,at)=>{he.selectedColumns.has(Sn)&&at!==Be&&(ht[Sn]=_t[at])}),{hex:Kt,properties:ht}}).filter(Re=>Re.hex&&sn(Re.hex));if(ft.length===0)throw new Error("No valid H3 indexes found in the data");const He={id:e(),name:S.name,visible:!0,data:ft,color:"#ff0000",opacity:.7,type:"h3"};if(r([...n,He]),ft.length>0){const Re=ft[0].hex,[_t,Kt]=Cf(Re);s({latitude:_t,longitude:Kt,zoom:11})}}else{const Be=Rt(Ce);if(!Be)throw new Error("Could not detect latitude and longitude columns");const ft=Ce.indexOf(Be.lat),He=Ce.indexOf(Be.lng),Re=1e4;let _t=1,Kt=[],ht={minLat:1/0,maxLat:-1/0,minLng:1/0,maxLng:-1/0};for(;_t<Ne.length;){const{data:Xe,endIndex:z}=lt(Ne,_t,Ce,he.selectedColumns,Be,ft,He,Re,p);Xe.forEach($e=>{ht.minLat=Math.min(ht.minLat,$e.position[1]),ht.maxLat=Math.max(ht.maxLat,$e.position[1]),ht.minLng=Math.min(ht.minLng,$e.position[0]),ht.maxLng=Math.max(ht.maxLng,$e.position[0])}),Kt=Kt.concat(Xe),_t=z}if(Kt.length===0)throw new Error("No valid data points found in CSV");const Sn=(ht.minLat+ht.maxLat)/2,at=(ht.minLng+ht.maxLng)/2,pt=ht.maxLat-ht.minLat,Qe=ht.maxLng-ht.minLng,wt=Math.max(pt,Qe),Vt=Math.min(20,Math.max(3,-Math.log2(wt*2.5))),qt={id:e(),name:S.name,visible:!0,data:Kt,color:"#ff0000",opacity:.7,type:"point",columns:Be,pointSize:5};r([...n,qt]),s({latitude:Sn,longitude:at,zoom:Vt})}}catch(Ae){console.error("Error processing CSV:",Ae),alert(Ae instanceof Error?Ae.message:"Error processing CSV file")}finally{a(!1),p(100),Ue(null),me.current&&(me.current.value="")}},O.readAsText(S)},Tt=S=>{var ie;const O=(ie=S.target.files)==null?void 0:ie[0];if(!O)return;const q=new FileReader;q.onload=l=>{var P;try{const Ae=JSON.parse((P=l.target)==null?void 0:P.result),Ee=new Set;Ae.features.forEach(Ne=>{Ne.properties&&Object.keys(Ne.properties).forEach(Ce=>Ee.add(Ce))}),ze({properties:Array.from(Ee),features:Ae.features.slice(0,10),selectedProperties:new Set(Ee)})}catch(Ae){console.error("Error parsing GeoJSON:",Ae),alert(Ae instanceof Error?Ae.message:"Error parsing GeoJSON file")}},q.readAsText(O)},kt=()=>{je&&ze({...je,selectedProperties:new Set(je.properties)})},At=()=>{je&&ze({...je,selectedProperties:new Set})},un=S=>{if(!je)return;const O=new Set(je.selectedProperties);O.has(S)?O.delete(S):O.add(S),ze({...je,selectedProperties:O})},Ze=()=>{var q,ie;if(!((ie=(q=ye.current)==null?void 0:q.files)!=null&&ie[0])||!je)return;const S=ye.current.files[0];a(!0),p(0);const O=new FileReader;O.onload=l=>{var P;try{const Ae=JSON.parse((P=l.target)==null?void 0:P.result),Ee={...Ae,features:Ae.features.map(Be=>({...Be,properties:Be.properties?Object.fromEntries(Object.entries(Be.properties).filter(([ft])=>je.selectedProperties.has(ft))):{}}))},Ne={id:e(),name:S.name,visible:!0,data:Ee,color:"#ff0000",opacity:.7,type:"geojson"};r([...n,Ne]);const Ce=xt(Ee);if(Ce){const Be=(Ce.minLat+Ce.maxLat)/2,ft=(Ce.minLng+Ce.maxLng)/2,He=Ce.maxLat-Ce.minLat,Re=Ce.maxLng-Ce.minLng,_t=Math.max(He,Re),Kt=Math.min(20,Math.max(3,-Math.log2(_t*2.5)));s({latitude:Be,longitude:ft,zoom:Kt})}console.log("Successfully added GeoJSON layer with selected properties")}catch(Ae){console.error("Error processing GeoJSON:",Ae),alert(Ae instanceof Error?Ae.message:"Error processing GeoJSON file")}finally{a(!1),p(100),ze(null),me.current&&(me.current.value="")}},O.onprogress=l=>{if(l.lengthComputable){const P=l.loaded/l.total*100;p(P)}},O.readAsText(S)},Dt=S=>{r(n.map(O=>O.id===S?{...O,visible:!O.visible}:O))},xr=S=>{r(n.filter(O=>O.id!==S)),v(null),N([]),ue(O=>{const q={...O};return delete q[S],q}),U===S&&$(null)},xn=(S,O)=>{r(n.map(q=>q.id===S?{...q,color:O}:q))},Ln=(S,O)=>{r(n.map(q=>q.id===S?{...q,opacity:O}:q))},Zr=(S,O)=>{r(n.map(q=>q.id===S?{...q,pointSize:O}:q))},Bt=S=>{const O=parseInt(S.slice(1,3),16),q=parseInt(S.slice(3,5),16),ie=parseInt(S.slice(5,7),16);return[O,q,ie]},Un=S=>{r(n.map(O=>O.id===S?{...O,isExpanded:!O.isExpanded}:O))},Ht=(S,O)=>!S||!O||S.geometry.type!==O.geometry.type?!1:S.geometry.type==="Point"&&O.geometry.type==="Point"||S.geometry.type==="Polygon"&&O.geometry.type==="Polygon"?JSON.stringify(S.geometry.coordinates)===JSON.stringify(O.geometry.coordinates):JSON.stringify(S.properties)===JSON.stringify(O.properties),Tn=(S,O,q)=>{ue(ie=>({...ie,[S]:[...ie[S]||[],{fn:O,info:q}]}))},or=(S,O)=>{ue(q=>{var ie;return{...q,[S]:((ie=q[S])==null?void 0:ie.filter((l,P)=>P!==O))||[]}})},Oi=(S,O)=>{var l,P,Ae;const q=Ee=>{const Ne=Ee==null?void 0:Ee[O];if(Ne==null||Ne==="")return 0;if(typeof Ne=="string"){const Ce=parseFloat(Ne);return isNaN(Ce)?0:Ce}return typeof Ne=="number"?Ne:0};let ie;return S.type==="geojson"?(ie=((l=K[S.id])==null?void 0:l.length)>0?S.data.features.filter(Ee=>K[S.id].every(Ne=>Ne.fn(Ee))):S.data.features,ie.map(Ee=>q(Ee.properties))):S.type==="point"?(ie=((P=K[S.id])==null?void 0:P.length)>0?S.data.filter(Ee=>K[S.id].every(Ne=>Ne.fn(Ee))):S.data,ie.map(Ee=>q(Ee.properties))):S.type==="h3"?(ie=((Ae=K[S.id])==null?void 0:Ae.length)>0?S.data.filter(Ee=>K[S.id].every(Ne=>Ne.fn({properties:Ee.properties}))):S.data,ie.map(Ee=>q(Ee.properties))):[]},Di=(S,O,q)=>{if(!q.breaks.length)return Bt(O);let ie=q.numClasses-1;for(let Ae=0;Ae<q.breaks.length;Ae++)if(S<=q.breaks[Ae]){ie=Ae;break}const P=ep[q.colorScale][ie];return Bt(P)},En=pe.useRef({}),zn=pe.useRef({}),Fr=(S,O)=>{r(n.map(q=>{if(q.id===S&&O){if(O.column){const l=Oi(q,O.column).map(Ae=>typeof Ae=="string"?parseFloat(Ae):Ae).filter(Ae=>!isNaN(Ae)).sort((Ae,Ee)=>Ae-Ee),P=[];for(let Ae=1;Ae<O.numClasses;Ae++){const Ee=Math.floor(Ae/O.numClasses*l.length);P.push(l[Ee])}O.breaks=P,O.colorScale=O.colorScale||"YlOrRd"}return{...q,colorMapping:{...O}}}return q}))},Ao=()=>{const S=O=>"coordinates"in O?JSON.stringify(O.coordinates):O.type==="GeometryCollection"?JSON.stringify(O.geometries.map(q=>S(q))):"";return n.filter(O=>O.visible).map(O=>{var Ee,Ne,Ce,Be,ft,He,Re,_t,Kt,ht,Sn;const[q,ie,l]=Bt(O.color);if(O.type==="h3"){const at=((Ee=K[O.id])==null?void 0:Ee.length)>0?O.data.filter(pt=>K[O.id].every(Qe=>Qe.fn({properties:pt.properties}))):O.data;return new Ra({id:`h3-layer-${O.id}`,data:at,pickable:!0,wireframe:!0,filled:!0,extruded:!1,getHexagon:pt=>pt.hex,getFillColor:pt=>{var Vt;const Qe=`${O.id}-${pt.hex}`;if(En.current[Qe])return En.current[Qe];let wt;if((Vt=O.colorMapping)!=null&&Vt.column){const qt=pt.properties[O.colorMapping.column],Xe=typeof qt=="string"?parseFloat(qt):qt;if(isNaN(Xe))wt=[q,ie,l,Math.round(O.opacity*255)];else{const[z,$e,fo]=Di(Xe,O.color,O.colorMapping);wt=[z,$e,fo,Math.round(O.opacity*255)]}}else wt=[q,ie,l,Math.round(O.opacity*255)];return En.current[Qe]=wt,wt},getLineColor:[255,255,255],lineWidthMinPixels:1,opacity:O.opacity,updateTriggers:{getFillColor:[O.id,O.color,O.opacity,(Ne=O.colorMapping)==null?void 0:Ne.column,(Ce=O.colorMapping)==null?void 0:Ce.breaks.join(",")]},onClick:pt=>{if(pt.object){const Qe=J0(pt.object.hex).map(([Vt,qt])=>[qt,Vt]),wt={type:"Feature",geometry:{type:"Polygon",coordinates:[Qe]},properties:pt.object.properties};De&&(m==null?void 0:m.geometry.type)==="Polygon"&&JSON.stringify(m.geometry.coordinates)===JSON.stringify([Qe])?(Me(!1),v(null)):(v(wt),Me(!0))}},onHover:pt=>{if(!De&&pt.object){const Qe={type:"Feature",geometry:{type:"Polygon",coordinates:[J0(pt.object.hex).map(([wt,Vt])=>[Vt,wt])]},properties:pt.object.properties};v(Qe)}else De||v(null)}})}else if(O.type==="point"){const at=O.data,pt=((Be=K[O.id])==null?void 0:Be.length)>0?at.filter(Qe=>K[O.id].every(wt=>wt.fn(Qe))):at;return new vf({id:`point-layer-${O.id}`,data:pt,getPosition:Qe=>Qe.position,getFillColor:Qe=>{var qt;const wt=`${O.id}-${Qe.position.join(",")}`;if(En.current[wt])return En.current[wt];let Vt;if((qt=O.colorMapping)!=null&&qt.column){const Xe=Qe.properties[O.colorMapping.column],z=typeof Xe=="string"?parseFloat(Xe):Xe;if(isNaN(z))Vt=[q,ie,l,Math.round(O.opacity*255)];else{const[$e,fo,Nf]=Di(z,O.color,O.colorMapping);Vt=[$e,fo,Nf,Math.round(O.opacity*255)]}}else Vt=[q,ie,l,Math.round(O.opacity*255)];return En.current[wt]=Vt,Vt},getRadius:Qe=>{var qt;const wt=`size-${O.id}-${Qe.position.join(",")}`;if(zn.current[wt])return zn.current[wt];let Vt;if((qt=O.sizeMapping)!=null&&qt.column){const Xe=Qe.properties[O.sizeMapping.column],z=typeof Xe=="string"?parseFloat(Xe):Xe;isNaN(z)?Vt=O.pointSize||5:Vt=Mf(z,O.sizeMapping)}else Vt=O.pointSize||5;return m&&m.geometry.type==="Point"&&JSON.stringify(m.geometry.coordinates)===JSON.stringify(Qe.position)&&(Vt*=2),zn.current[wt]=Vt,Vt},radiusScale:1,radiusUnits:"pixels",radiusMinPixels:1,radiusMaxPixels:50,pickable:!0,updateTriggers:{getRadius:[O.id,(m==null?void 0:m.geometry.type)==="Point"?JSON.stringify(m.geometry.coordinates):null,O.pointSize,(ft=O.sizeMapping)==null?void 0:ft.column,(He=O.sizeMapping)==null?void 0:He.breaks.join(",")],getFillColor:[O.id,O.color,O.opacity,(Re=O.colorMapping)==null?void 0:Re.column,(_t=O.colorMapping)==null?void 0:_t.breaks.join(",")]},onClick:Qe=>{if(Qe.object){const wt={type:"Feature",geometry:{type:"Point",coordinates:Qe.object.position},properties:Qe.object.properties};De&&(m==null?void 0:m.geometry.type)==="Point"&&JSON.stringify(m.geometry.coordinates)===JSON.stringify(Qe.object.position)?(Me(!1),v(null)):(v(wt),Me(!0))}},onHover:Qe=>{if(!De&&Qe.object){const wt={type:"Feature",geometry:{type:"Point",coordinates:Qe.object.position},properties:Qe.object.properties};v(wt)}else De||v(null)}})}const P=O.data,Ae={...P,features:((Kt=K[O.id])==null?void 0:Kt.length)>0?P.features.filter(at=>K[O.id].every(pt=>pt.fn(at))):P.features};return new Bg({id:`geojson-layer-${O.id}`,data:Ae,filled:!0,stroked:!0,lineWidthUnits:"pixels",lineWidthMinPixels:1,getFillColor:at=>{var wt,Vt;const pt=`${O.id}-${S(at.geometry)}`;if(En.current[pt])return En.current[pt];let Qe;if((wt=O.colorMapping)!=null&&wt.column){const qt=(Vt=at.properties)==null?void 0:Vt[O.colorMapping.column];if(typeof qt=="number"){const[Xe,z,$e]=Di(qt,O.color,O.colorMapping);Qe=[Xe,z,$e,Math.round(O.opacity*(m&&Ht(at,m)?255:128))]}else Qe=[q,ie,l,Math.round(O.opacity*(m&&Ht(at,m)?255:128))]}else Qe=[q,ie,l,Math.round(O.opacity*(m&&Ht(at,m)?255:128))];return En.current[pt]=Qe,Qe},getLineColor:[q,ie,l,255],pickable:!0,updateTriggers:{getFillColor:[O.id,O.color,O.opacity,m?S(m.geometry):null,(ht=O.colorMapping)==null?void 0:ht.column,(Sn=O.colorMapping)==null?void 0:Sn.breaks.join(",")],lineWidthMinPixels:[m?S(m.geometry):null]},onClick:at=>{at.object&&(De&&Ht(at.object,m)?(Me(!1),v(null)):(v(at.object),Me(!0)))},onHover:at=>{!De&&at.object?v(at.object):De||v(null)}})})},kf=()=>{const S={version:"1.0.0",viewState:i,basemap:B,layers:n.map(l=>{var P,Ae,Ee;return{name:l.name,type:l.type,visible:l.visible,color:l.color,opacity:l.opacity,pointSize:l.pointSize,columns:l.columns,data:l.data,filters:(P=K[l.id])==null?void 0:P.map(Ne=>Ne.info),selectedProperties:l.type==="geojson"?Object.keys(((Ae=l.data.features[0])==null?void 0:Ae.properties)||{}):Object.keys(((Ee=l.data[0])==null?void 0:Ee.properties)||{}),colorMapping:l.colorMapping,sizeMapping:l.sizeMapping}})},O=new Blob([JSON.stringify(S,null,2)],{type:"application/json"}),q=URL.createObjectURL(O),ie=document.createElement("a");ie.href=q,ie.download="map-configuration.json",document.body.appendChild(ie),ie.click(),document.body.removeChild(ie),URL.revokeObjectURL(q)},Ia=S=>{var q;const O=(q=S.target.files)==null?void 0:q[0];O&&Pf(O).then(()=>{S.target&&(S.target.value="")})},Pf=async S=>{try{const O=await S.text(),q=JSON.parse(O);if(!q.version)throw new Error("Invalid configuration file");r([]),ue({}),v(null),N([]),s(q.viewState),Y(q.basemap);const ie=q.layers.map(()=>e()),l={};q.layers.forEach((Ae,Ee)=>{Ae.filters&&Ae.filters.length>0&&(l[ie[Ee]]=Ae.filters.map(Ne=>({fn:Ce=>{var ft;const Be=(ft=Ce.properties)==null?void 0:ft[Ne.column];if(Ne.type==="numeric"){const He=parseFloat(Be);if(Ne.value.type==="range")return He>=Ne.value.min&&He<=Ne.value.max;if(Ne.value.type==="comparison"){const Re=parseFloat(String(Ne.value.value));switch(Ne.value.operator){case"<":return He<Re;case"<=":return He<=Re;case">":return He>Re;case">=":return He>=Re;case"=":return He===Re;default:return!0}}}else if(Ne.type==="text"){const He=String(Be).toLowerCase();if(Ne.value.type==="multiple")return Ne.value.values.some(Re=>He.includes(Re.toLowerCase()));if(Ne.value.type==="comparison"){const Re=String(Ne.value.value).toLowerCase();switch(Ne.value.operator){case"=":return He===Re;case"<":return He<Re;case"<=":return He<=Re;case">":return He>Re;case">=":return He>=Re;default:return!0}}}return!0},info:Ne})))}),ue(l);const P=q.layers.map((Ae,Ee)=>{const Ne=ie[Ee];let Ce=Ae.data;return l[Ne]&&(Ae.type==="geojson"?Ce={...Ae.data,features:Ae.data.features.filter(Be=>l[Ne].every(ft=>ft.fn(Be)))}:Ae.type==="point"?Ce=Ae.data.filter(Be=>l[Ne].every(ft=>ft.fn(Be))):Ae.type==="h3"&&(Ce=Ae.data.filter(Be=>l[Ne].every(ft=>ft.fn({properties:Be.properties}))))),{id:Ne,name:Ae.name,type:Ae.type,visible:Ae.visible,color:Ae.color,opacity:Ae.opacity,pointSize:Ae.pointSize,columns:Ae.columns,data:Ce,isExpanded:!1,colorMapping:Ae.colorMapping,sizeMapping:Ae.sizeMapping}});r(P)}catch(O){console.error("Error importing configuration:",O),alert("Error importing configuration file")}},Rf=({layer:S})=>{var q,ie,l,P;if(!((q=S.colorMapping)!=null&&q.breaks.length))return null;const O=Ae=>S.colorMapping?ep[S.colorMapping.colorScale][Ae]:"";return V.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-2 mb-2",children:[V.jsx("div",{className:"text-xs font-medium mb-2",children:S.colorMapping.column}),V.jsxs("div",{className:"flex space-x-2",children:[V.jsx("div",{className:"w-6 h-32",children:V.jsx("div",{className:"h-full flex flex-col",children:Array.from({length:S.colorMapping.numClasses}).map((Ae,Ee)=>V.jsx("div",{className:"flex-1",style:{backgroundColor:O(Ee)}},Ee))})}),V.jsxs("div",{className:"flex flex-col justify-between py-1 text-xs",children:[V.jsx("span",{children:(ie=S.colorMapping.breaks[S.colorMapping.breaks.length-1])==null?void 0:ie.toFixed(1)}),V.jsx("span",{children:(l=S.colorMapping.breaks[Math.floor(S.colorMapping.breaks.length/2)])==null?void 0:l.toFixed(1)}),V.jsx("span",{children:(P=S.colorMapping.breaks[0])==null?void 0:P.toFixed(1)})]})]})]})},we=S=>{r(n.map(O=>O.id===S?{...O,colorMapping:void 0}:O))},pA=S=>{const O=ie=>{if(ie==null||ie==="")return!1;if(typeof ie=="string"){const l=parseFloat(ie);return!isNaN(l)}return typeof ie=="number"&&!isNaN(ie)},q=ie=>{const l=ie.filter(Ae=>Ae!=null&&Ae!=="");return l.length===0?!1:l.filter(O).length/l.length>=.5};if(S.type==="geojson"&&S.data.features.length>0){const ie={};return S.data.features.forEach(l=>{l.properties&&Object.entries(l.properties).forEach(([P,Ae])=>{ie[P]||(ie[P]=[]),ie[P].push(Ae)})}),Object.entries(ie).filter(([l,P])=>q(P)).map(([l])=>l)}else if(S.type==="point"&&S.data.length>0){const ie={};return S.data.forEach(l=>{l.properties&&Object.entries(l.properties).forEach(([P,Ae])=>{ie[P]||(ie[P]=[]),ie[P].push(Ae)})}),Object.entries(ie).filter(([l,P])=>q(P)).map(([l])=>l)}else if(S.type==="h3"&&S.data.length>0){const ie={};return S.data.forEach(l=>{l.properties&&Object.entries(l.properties).forEach(([P,Ae])=>{ie[P]||(ie[P]=[]),ie[P].push(Ae)})}),Object.entries(ie).filter(([l,P])=>q(P)).map(([l])=>l)}return[]},ws=(S,O)=>{r(n.map(q=>{if(q.id===S&&O){if(O.column){const l=Oi(q,O.column).map(Ae=>typeof Ae=="string"?parseFloat(Ae):Ae).filter(Ae=>!isNaN(Ae)).sort((Ae,Ee)=>Ae-Ee),P=[];for(let Ae=1;Ae<O.numClasses;Ae++){const Ee=Math.floor(Ae/O.numClasses*l.length);P.push(l[Ee])}O.breaks=P}return{...q,sizeMapping:{...O}}}return q}))},If=S=>{r(n.map(O=>O.id===S?{...O,sizeMapping:void 0}:O))},Mf=(S,O)=>{if(!O.breaks.length)return O.minSize;let q=0;for(let l=0;l<O.breaks.length;l++)if(S<=O.breaks[l]){q=l;break}q===0&&S>O.breaks[O.breaks.length-1]&&(q=O.numClasses-1);const ie=q/(O.numClasses-1);return O.minSize+(O.maxSize-O.minSize)*ie};return V.jsxs("div",{className:"fixed inset-0",children:[V.jsx("div",{className:"absolute top-4 left-4 z-10",children:V.jsxs("div",{className:"bg-white rounded-lg shadow-lg",children:[V.jsx("button",{onClick:()=>k(!R),className:"w-full p-3 flex items-center justify-center hover:bg-gray-50 rounded-lg transition-colors",children:V.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:V.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),R&&V.jsx("div",{className:"p-4 border-t border-gray-200",children:V.jsxs("div",{className:"space-y-4",children:[V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-left",children:"Upload GeoJSON"}),V.jsx("input",{ref:ye,type:"file",accept:".json,.geojson",onChange:Tt,onClick:S=>{S.target.value=""},disabled:o,className:`block w-full text-sm text-gray-500
                      file:mr-4 file:py-2 file:px-4
                      file:rounded-md file:border-0
                      file:text-sm file:font-semibold
                      file:bg-blue-50 file:text-blue-700
                      hover:file:bg-blue-100
                      disabled:opacity-50 disabled:cursor-not-allowed`},"geojson-input")]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-left",children:"Upload CSV"}),V.jsx("input",{type:"file",accept:".csv",ref:me,onChange:gt,onClick:S=>{S.target.value=""},disabled:o,className:`block w-full text-sm text-gray-500
                      file:mr-4 file:py-2 file:px-4
                      file:rounded-md file:border-0
                      file:text-sm file:font-semibold
                      file:bg-blue-50 file:text-blue-700
                      hover:file:bg-blue-100
                      disabled:opacity-50 disabled:cursor-not-allowed`},"csv-input"),V.jsxs("div",{className:"mt-2 text-xs text-gray-500 space-y-1 text-left",children:[V.jsx("p",{children:"Supports two types of CSV files:"}),V.jsx("p",{children:"1. Point data with coordinate columns:"}),V.jsxs("ul",{className:"list-disc list-inside ml-2",children:[V.jsx("li",{children:"Latitude (lat/latitude/y)"}),V.jsx("li",{children:"Longitude (lng/long/longitude/x)"})]}),V.jsx("p",{children:"2. H3 hexagon data with index column:"}),V.jsx("ul",{className:"list-disc list-inside ml-2",children:V.jsx("li",{children:"H3 index (hex_id/h3_index/h3/hexagon)"})})]})]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 text-left",children:"Import Map Configuration"}),V.jsx("input",{type:"file",accept:".json",onChange:Ia,onClick:S=>{S.target.value=""},disabled:o,className:`block w-full text-sm text-gray-500
                      file:mr-4 file:py-2 file:px-4
                      file:rounded-md file:border-0
                      file:text-sm file:font-semibold
                      file:bg-blue-50 file:text-blue-700
                      hover:file:bg-blue-100
                      disabled:opacity-50 disabled:cursor-not-allowed`},"config-input"),V.jsxs("div",{className:"mt-2 text-xs text-gray-500 space-y-1 text-left",children:[V.jsx("p",{children:"Accepts only JSON configuration files previously exported from this tool."}),V.jsx("p",{children:"Configuration includes:"}),V.jsxs("ul",{className:"list-disc list-inside ml-2",children:[V.jsx("li",{children:"Layer settings and data"}),V.jsx("li",{children:"Map view state"}),V.jsx("li",{children:"Basemap selection"}),V.jsx("li",{children:"Filter configurations"})]})]})]}),V.jsx("button",{onClick:kf,disabled:n.length===0,className:"w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Export Current Configuration"})]})})]})}),o&&V.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:V.jsx("div",{className:"bg-white rounded-lg px-8 py-4",children:V.jsxs("p",{className:"text-lg font-medium text-gray-700",children:["Processing... ",Math.round(f),"%"]})})}),m&&V.jsxs("div",{className:"absolute top-4 right-4 z-[80] bg-white rounded-lg shadow-lg p-4 max-w-md",children:[V.jsxs("div",{className:"flex justify-between items-center mb-2",children:[V.jsxs("h3",{className:"text-sm font-medium text-gray-900",children:["Feature Properties ",De&&"(Locked)"]}),V.jsxs("div",{className:"flex items-center space-x-2",children:[V.jsx("button",{onClick:()=>T(!w),className:"text-gray-500 hover:text-gray-700",title:"Select columns to display",children:V.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:V.jsx("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})})}),V.jsx("button",{onClick:()=>{v(null),Me(!1)},className:"text-gray-500 hover:text-gray-700",children:V.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:V.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]}),w&&V.jsxs("div",{className:"mb-4 p-2 bg-gray-50 rounded",children:[V.jsx("h4",{className:"text-xs font-medium text-gray-700 mb-2",children:"Select columns to display:"}),V.jsx("div",{className:"space-y-1 max-h-40 overflow-y-auto",children:j.map(S=>V.jsxs("label",{className:"flex items-center space-x-2",children:[V.jsx("input",{type:"checkbox",checked:E.includes(S),onChange:()=>Oe(S),className:"h-3 w-3 text-blue-600 rounded border-gray-300"}),V.jsx("span",{className:"text-xs text-gray-600",children:S})]},S))})]}),V.jsx("div",{className:"text-sm text-gray-600 text-left",children:Object.entries(m.properties||{}).filter(([S])=>E.includes(S)).map(([S,O])=>V.jsxs("div",{className:"mb-1",children:[V.jsxs("span",{className:"font-medium",children:[S,":"]})," ",String(O)]},S))})]}),V.jsx("div",{className:"absolute bottom-4 left-4 z-10",children:V.jsx("div",{className:"flex flex-col space-y-2",children:V.jsx("button",{onClick:()=>le(!ge),className:"bg-white p-2 rounded-lg shadow-lg hover:bg-gray-50 transition-colors",title:ge?"Hide Layers":"Show Layers",children:V.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:V.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})})})}),ge&&V.jsxs("div",{className:"absolute bottom-16 left-4 z-10 bg-white rounded-lg shadow-lg p-4 max-w-md",children:[V.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Layers"}),V.jsx("div",{className:"space-y-4",children:n.map(S=>{var O,q;return V.jsxs("div",{className:"bg-white rounded-md border border-gray-200 overflow-hidden",children:[V.jsxs("div",{className:"flex items-center justify-between p-2",children:[V.jsxs("div",{className:"flex items-center space-x-2",children:[V.jsx("input",{type:"checkbox",checked:S.visible,onChange:()=>Dt(S.id),className:"h-4 w-4 text-blue-600 rounded border-gray-300"}),V.jsx("span",{className:"text-sm text-gray-700 truncate max-w-[150px]",children:S.name})]}),V.jsxs("div",{className:"flex items-center space-x-2",children:[V.jsx("button",{onClick:()=>Un(S.id),className:"text-gray-500 hover:text-gray-700",title:"Symbology",children:V.jsx(sU,{className:"h-5 w-5"})}),V.jsx("button",{onClick:()=>$(S.id),className:"text-gray-500 hover:text-gray-700",title:"Filter",children:V.jsx(rU,{className:"h-5 w-5"})}),V.jsx("button",{onClick:()=>xr(S.id),className:"text-red-600 hover:text-red-800",title:"Remove Layer",children:V.jsx(na,{className:"h-5 w-5"})})]})]}),S.isExpanded&&V.jsxs("div",{className:"border-t border-gray-200 p-2 space-y-2 bg-gray-50",children:[V.jsxs("div",{className:"flex items-center justify-between space-x-2",children:[V.jsx("span",{className:"text-xs text-gray-500",children:"Color"}),V.jsx("input",{type:"color",value:S.color,onChange:ie=>xn(S.id,ie.target.value),className:"h-6 w-6 rounded cursor-pointer"})]}),V.jsxs("div",{className:"space-y-1",children:[V.jsx("span",{className:"text-xs text-gray-500",children:"Color Based On"}),V.jsxs("select",{className:"mt-1 block w-full rounded-md border-gray-300 py-1 pl-2 pr-8 text-xs",value:((O=S.colorMapping)==null?void 0:O.column)||"",onChange:ie=>{var P;const l=ie.target.value;l?Fr(S.id,{column:l,numClasses:((P=S.colorMapping)==null?void 0:P.numClasses)||5,breaks:[],colorScale:"YlOrRd"}):we(S.id)},children:[V.jsx("option",{value:"",children:"None"}),pA(S).map(ie=>V.jsx("option",{value:ie,children:ie},ie))]}),S.colorMapping&&V.jsxs("div",{className:"space-y-2 mt-2",children:[V.jsx("div",{children:e7(S,Fr)}),V.jsxs("div",{className:"space-y-1",children:[V.jsxs("div",{className:"flex items-center justify-between",children:[V.jsx("span",{className:"text-xs text-gray-500",children:"Number of Classes"}),V.jsx("span",{className:"text-xs text-gray-600",children:S.colorMapping.numClasses})]}),V.jsx("input",{type:"range",min:"3",max:"10",step:"1",value:S.colorMapping.numClasses,onChange:ie=>{const l=parseInt(ie.target.value);Fr(S.id,{...S.colorMapping,numClasses:l,breaks:[]})},className:"w-full"})]})]})]}),V.jsxs("div",{className:"space-y-1",children:[V.jsxs("div",{className:"flex items-center justify-between",children:[V.jsx("span",{className:"text-xs text-gray-500",children:"Opacity"}),V.jsxs("span",{className:"text-xs text-gray-600",children:[Math.round(S.opacity*100),"%"]})]}),V.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:S.opacity,onChange:ie=>Ln(S.id,parseFloat(ie.target.value)),className:"w-full"})]}),S.type==="point"&&V.jsxs("div",{className:"space-y-2",children:[V.jsxs("div",{className:"space-y-1",children:[V.jsxs("div",{className:"flex items-center justify-between",children:[V.jsx("span",{className:"text-xs text-gray-500",children:"Point Size"}),V.jsxs("span",{className:"text-xs text-gray-600",children:[S.pointSize||5,"px"]})]}),V.jsx("input",{type:"range",min:"1",max:"20",step:"1",value:S.pointSize||5,onChange:ie=>{const l=parseInt(ie.target.value);Zr(S.id,l)},className:"w-full",disabled:!!S.sizeMapping})]}),V.jsxs("div",{className:"space-y-1",children:[V.jsx("span",{className:"text-xs text-gray-500",children:"Size Based On"}),V.jsxs("select",{className:"mt-1 block w-full rounded-md border-gray-300 py-1 pl-2 pr-8 text-xs",value:((q=S.sizeMapping)==null?void 0:q.column)||"",onChange:ie=>{var P;const l=ie.target.value;l?ws(S.id,{column:l,numClasses:((P=S.sizeMapping)==null?void 0:P.numClasses)||5,breaks:[],minSize:2,maxSize:10}):If(S.id)},children:[V.jsx("option",{value:"",children:"None"}),pA(S).map(ie=>V.jsx("option",{value:ie,children:ie},ie))]}),S.sizeMapping&&V.jsxs("div",{className:"space-y-2 mt-2",children:[V.jsxs("div",{className:"space-y-1",children:[V.jsxs("div",{className:"flex items-center justify-between",children:[V.jsx("span",{className:"text-xs text-gray-500",children:"Number of Classes"}),V.jsx("span",{className:"text-xs text-gray-600",children:S.sizeMapping.numClasses})]}),V.jsx("input",{type:"range",min:"3",max:"10",step:"1",value:S.sizeMapping.numClasses,onChange:ie=>{const l=parseInt(ie.target.value);ws(S.id,{...S.sizeMapping,numClasses:l,breaks:[]})},className:"w-full"})]}),V.jsxs("div",{className:"space-y-1",children:[V.jsxs("div",{className:"flex items-center justify-between",children:[V.jsx("span",{className:"text-xs text-gray-500",children:"Size Range (px)"}),V.jsxs("span",{className:"text-xs text-gray-600",children:[S.sizeMapping.minSize,"-",S.sizeMapping.maxSize,"px"]})]}),V.jsxs("div",{className:"relative",children:[V.jsx("div",{className:"h-1 bg-gray-200 rounded-full",children:V.jsx("div",{className:"absolute h-1 bg-blue-500 rounded-full",style:{left:`${(S.sizeMapping.minSize-1)/24*100}%`,width:`${(S.sizeMapping.maxSize-S.sizeMapping.minSize)/24*100}%`}})}),V.jsx("input",{type:"range",min:"1",max:"25",step:"1",value:S.sizeMapping.minSize,onChange:ie=>{const l=parseInt(ie.target.value);l<=S.sizeMapping.maxSize&&ws(S.id,{...S.sizeMapping,minSize:l,breaks:[]})},className:"absolute top-0 left-0 w-full h-1 appearance-none bg-transparent [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:border-2 [&::-webkit-slider-thumb]:border-blue-500 [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:relative [&::-webkit-slider-thumb]:z-20 [&::-moz-range-thumb]:appearance-none [&::-moz-range-thumb]:h-4 [&::-moz-range-thumb]:w-4 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-white [&::-moz-range-thumb]:border-2 [&::-moz-range-thumb]:border-blue-500 [&::-moz-range-thumb]:cursor-pointer [&::-moz-range-thumb]:relative [&::-moz-range-thumb]:z-20"}),V.jsx("input",{type:"range",min:"1",max:"25",step:"1",value:S.sizeMapping.maxSize,onChange:ie=>{const l=parseInt(ie.target.value);l>=S.sizeMapping.minSize&&ws(S.id,{...S.sizeMapping,maxSize:l,breaks:[]})},className:"absolute top-0 left-0 w-full h-1 appearance-none bg-transparent [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:border-2 [&::-webkit-slider-thumb]:border-blue-500 [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:relative [&::-webkit-slider-thumb]:z-20 [&::-moz-range-thumb]:appearance-none [&::-moz-range-thumb]:h-4 [&::-moz-range-thumb]:w-4 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-white [&::-moz-range-thumb]:border-2 [&::-moz-range-thumb]:border-blue-500 [&::-moz-range-thumb]:cursor-pointer [&::-moz-range-thumb]:relative [&::-moz-range-thumb]:z-20"})]}),V.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[V.jsx("span",{children:"1px"}),V.jsx("span",{children:"25px"})]})]})]})]})]})]})]},S.id)})})]}),V.jsx(aU,{isOpen:U!==null,onClose:()=>$(null),data:((co=n.find(S=>S.id===U))==null?void 0:co.type)==="point"?(Ma=n.find(S=>S.id===U))==null?void 0:Ma.data:((Na=n.find(S=>S.id===U))==null?void 0:Na.type)==="h3"?(Oa=n.find(S=>S.id===U))==null?void 0:Oa.data.map(S=>S.properties):((bs=n.find(S=>S.id===U))==null?void 0:bs.data.features)||[],onApplyFilter:(S,O)=>{if(U!==null){const q=n.find(ie=>ie.id===U);q&&Tn(U,l=>q.type==="h3"?S(l.properties):S(l),O)}$(null)},activeFilters:U!==null?((uo=K[U])==null?void 0:uo.map(S=>S.info))||[]:[],onRemoveFilter:S=>U!==null&&or(U,S),layerType:(pi=n.find(S=>S.id===U))==null?void 0:pi.type}),V.jsx(kB,{style:{width:"100%",height:"100%"},viewState:i,onViewStateChange:({viewState:S})=>{"latitude"in S&&"longitude"in S&&"zoom"in S&&s(S)},controller:!0,layers:Ao(),children:V.jsx(tF,{mapStyle:B})}),V.jsx("div",{className:"absolute bottom-28 right-4 space-y-4 z-[30]",children:n.map(S=>{var O,q;return S.visible?V.jsxs(Sm.Fragment,{children:[((O=S.colorMapping)==null?void 0:O.column)&&V.jsx(Rf,{layer:S}),S.type==="point"&&((q=S.sizeMapping)==null?void 0:q.column)&&V.jsx(t7,{layer:S})]},S.id):null})}),V.jsxs("div",{className:"absolute bottom-16 right-4 z-[60]",children:[V.jsxs("button",{onClick:()=>ce(!G),className:"bg-white px-3 py-2 rounded-lg shadow-lg text-sm text-gray-700 hover:bg-gray-50 flex items-center space-x-2",children:[V.jsx("span",{children:"Base Map"}),V.jsx("svg",{className:`h-4 w-4 transform transition-transform ${G?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:V.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),G&&V.jsx("div",{className:"absolute bottom-12 right-0 bg-white rounded-lg shadow-lg py-2 min-w-[120px] z-[70]",children:Object.entries(Ty).map(([S,O])=>V.jsx("button",{onClick:()=>{Y(O),ce(!1)},className:`block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 ${B===O?"bg-blue-50 text-blue-700":"text-gray-700"}`,children:S},S))})]}),V.jsx("div",{className:"absolute bottom-4 right-4 z-50 flex items-center space-x-4 text-sm text-gray-600",children:V.jsxs("div",{className:"flex items-center space-x-2",children:[V.jsx("span",{children:"Boyang Sa"}),V.jsx("a",{href:"https://boyangsa.com",target:"_blank",rel:"noopener noreferrer",className:"text-gray-600 hover:text-gray-900",title:"Personal Website",children:V.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:V.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})})}),V.jsx("a",{href:"https://github.com/bobsa514/mapviewer-gl",target:"_blank",rel:"noopener noreferrer",className:"text-gray-600 hover:text-gray-900",title:"GitHub",children:V.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:V.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 2C6.477 2 2 6.477 2 12c0 4.42 2.865 8.17 6.839 9.49.5.092.682-.217.682-.482 0-.237-.008-.866-.013-1.7-2.782.604-3.369-1.34-3.369-1.34-.454-1.156-1.11-1.464-1.11-1.464-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.087 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.269 2.75 1.025A9.578 9.578 0 0112 6.836c.85.004 1.705.114 2.504.336 1.909-1.294 2.747-1.025 2.747-1.025.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.578.688.48C19.138 20.167 22 16.418 22 12c0-5.523-4.477-10-10-10z"})})})]})}),he&&V.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:V.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-[90vw] w-[1000px] max-h-[90vh] overflow-hidden flex flex-col",children:[V.jsxs("div",{className:"flex justify-between items-center mb-4",children:[V.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Preview CSV Data"}),V.jsx("button",{onClick:()=>Ue(null),className:"text-gray-500 hover:text-gray-700",children:V.jsx(na,{className:"h-6 w-6"})})]}),V.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[V.jsxs("div",{className:"flex items-center space-x-2",children:[V.jsx("button",{onClick:qe,className:"px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 rounded",children:"Select All"}),V.jsx("button",{onClick:zt,className:"px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 rounded",children:"Deselect All"})]}),V.jsxs("div",{className:"text-sm text-gray-500",children:[he.selectedColumns.size," of ",he.headers.length," columns selected"]})]}),V.jsx("div",{className:"flex-1 overflow-auto",children:V.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[V.jsx("thead",{className:"bg-gray-50 sticky top-0",children:V.jsxs("tr",{children:[V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-10",children:"Row"}),he.headers.map((S,O)=>V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:V.jsxs("div",{className:"flex flex-col space-y-2",children:[V.jsx("span",{children:S}),V.jsxs("label",{className:"flex items-center space-x-2",children:[V.jsx("input",{type:"checkbox",checked:he.selectedColumns.has(S),onChange:()=>Ut(S),disabled:he.coordinateColumns.has(S),className:`h-4 w-4 rounded border-gray-300 ${he.coordinateColumns.has(S)?"bg-blue-100 text-blue-600 cursor-not-allowed":"text-blue-600"}`}),V.jsx("span",{className:"text-xs font-normal",children:he.coordinateColumns.has(S)&&"(Required)"})]})]})},O))]})}),V.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:he.rows.map((S,O)=>V.jsxs("tr",{className:O%2===0?"bg-white":"bg-gray-50",children:[V.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:O+1}),S.map((q,ie)=>V.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:q},ie))]},O))})]})}),V.jsxs("div",{className:"mt-4 flex justify-end space-x-3",children:[V.jsx("button",{onClick:()=>Ue(null),className:"px-4 py-2 text-gray-700 hover:text-gray-900 font-medium",children:"Cancel"}),V.jsx("button",{onClick:Jt,className:"px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700",disabled:he.selectedColumns.size===0,children:"Proceed with Selected Columns"})]})]})}),je&&V.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:V.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-[90vw] w-[1000px] max-h-[90vh] overflow-hidden flex flex-col",children:[V.jsxs("div",{className:"flex justify-between items-center mb-4",children:[V.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Preview GeoJSON Data"}),V.jsx("button",{onClick:()=>ze(null),className:"text-gray-500 hover:text-gray-700",children:V.jsx(na,{className:"h-6 w-6"})})]}),V.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[V.jsxs("div",{className:"flex items-center space-x-2",children:[V.jsx("button",{onClick:kt,className:"px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 rounded",children:"Select All"}),V.jsx("button",{onClick:At,className:"px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 rounded",children:"Deselect All"})]}),V.jsxs("div",{className:"text-sm text-gray-500",children:[je.selectedProperties.size," of ",je.properties.length," properties selected"]})]}),V.jsx("div",{className:"flex-1 overflow-auto",children:V.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[V.jsx("thead",{className:"bg-gray-50 sticky top-0",children:V.jsxs("tr",{children:[V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-10",children:"Property"}),je.features.slice(0,5).map((S,O)=>V.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:["Feature ",O+1]},O))]})}),V.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:je.properties.map((S,O)=>V.jsxs("tr",{className:O%2===0?"bg-white":"bg-gray-50",children:[V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsxs("div",{className:"flex items-center space-x-2",children:[V.jsx("input",{type:"checkbox",checked:je.selectedProperties.has(S),onChange:()=>un(S),className:"h-4 w-4 rounded border-gray-300 text-blue-600"}),V.jsx("span",{className:"text-sm text-gray-900",children:S})]})}),je.features.slice(0,5).map((q,ie)=>{var l;return V.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(l=q.properties)==null?void 0:l[S]},ie)})]},O))})]})}),V.jsxs("div",{className:"mt-4 flex justify-end space-x-3",children:[V.jsx("button",{onClick:()=>ze(null),className:"px-4 py-2 text-gray-700 hover:text-gray-900 font-medium",children:"Cancel"}),V.jsx("button",{onClick:Ze,className:"px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700",disabled:je.selectedProperties.size===0,children:"Proceed with Selected Properties"})]})]})})]})};function r7(){return V.jsx("div",{className:"w-screen h-screen overflow-hidden",children:V.jsx(n7,{})})}L3(document.getElementById("root")).render(V.jsx(pe.StrictMode,{children:V.jsx(r7,{})}));export{IE as c,tp as g};
//# sourceMappingURL=index-CTvjARNI.js.map
